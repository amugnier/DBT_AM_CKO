2020-11-05 08:33:49.161660 (MainThread): Running with dbt=0.18.1
2020-11-05 08:33:49.467726 (MainThread): Loading KWallet
2020-11-05 08:33:49.470726 (MainThread): Loading SecretService
2020-11-05 08:33:49.472726 (MainThread): Loading Windows
2020-11-05 08:33:49.676814 (MainThread): Loading chainer
2020-11-05 08:33:49.678815 (MainThread): Loading macOS
2020-11-05 08:33:50.454769 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 08:33:50.458254 (MainThread): Tracking: tracking
2020-11-05 08:33:50.459254 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246ED945C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246ED92A7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246ED92ADF0>]}
2020-11-05 08:33:50.519265 (MainThread): Partial parsing not enabled
2020-11-05 08:33:50.526266 (MainThread): Parsing macros\adapters.sql
2020-11-05 08:33:50.636287 (MainThread): Parsing macros\catalog.sql
2020-11-05 08:33:50.643290 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 08:33:50.671478 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 08:33:50.678485 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 08:33:50.690486 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 08:33:50.705212 (MainThread): Parsing macros\core.sql
2020-11-05 08:33:50.717212 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 08:33:50.830246 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 08:33:50.854811 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 08:33:50.858155 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 08:33:50.863342 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 08:33:50.869360 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 08:33:50.873364 (MainThread): Parsing macros\etc\query.sql
2020-11-05 08:33:50.877359 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 08:33:50.903367 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 08:33:50.944364 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 08:33:50.950371 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 08:33:50.968139 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 08:33:51.024147 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 08:33:51.173696 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 08:33:51.180204 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 08:33:51.237205 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 08:33:51.259709 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 08:33:51.275209 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 08:33:51.295712 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 08:33:51.304713 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 08:33:51.309713 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 08:33:51.319215 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 08:33:51.341718 (MainThread): Partial parsing not enabled
2020-11-05 08:33:51.446231 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 08:33:51.509239 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 08:33:52.088730 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 08:33:52.206244 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 08:33:52.211745 (MainThread): 
2020-11-05 08:33:52.213745 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 08:33:52.226746 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 08:33:52.267752 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 08:33:52.267752 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 08:33:52.268252 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 08:33:54.722416 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 2 in 2.45 seconds
2020-11-05 08:33:54.751419 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 08:33:55.022505 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_cko_dbt_am".
2020-11-05 08:33:55.023505 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_analytics_cko_dbt_am".
2020-11-05 08:33:55.023505 (ThreadPoolExecutor-0_0): Creating schema "analytics.cko_dbt_am"
2020-11-05 08:33:55.040505 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_cko_dbt_am".
2020-11-05 08:33:55.041505 (ThreadPoolExecutor-0_0): On create_analytics_cko_dbt_am: BEGIN
2020-11-05 08:33:55.041505 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2020-11-05 08:33:56.311854 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 1.27 seconds
2020-11-05 08:33:56.312854 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_cko_dbt_am".
2020-11-05 08:33:56.312854 (ThreadPoolExecutor-0_0): On create_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "create_analytics_cko_dbt_am"} */
create schema if not exists analytics.cko_dbt_am
2020-11-05 08:33:56.833878 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.52 seconds
2020-11-05 08:33:56.838879 (ThreadPoolExecutor-0_0): On create_analytics_cko_dbt_am: COMMIT
2020-11-05 08:33:56.838879 (ThreadPoolExecutor-0_0): Using snowflake connection "create_analytics_cko_dbt_am".
2020-11-05 08:33:56.839878 (ThreadPoolExecutor-0_0): On create_analytics_cko_dbt_am: COMMIT
2020-11-05 08:33:57.007821 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.17 seconds
2020-11-05 08:33:57.008821 (ThreadPoolExecutor-0_0): On create_analytics_cko_dbt_am: Close
2020-11-05 08:33:57.288071 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 08:33:57.333089 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 08:33:57.334088 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 08:33:57.335074 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 08:33:59.409264 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 0 in 2.07 seconds
2020-11-05 08:33:59.410264 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 08:33:59.655751 (MainThread): Using snowflake connection "master".
2020-11-05 08:33:59.656751 (MainThread): On master: BEGIN
2020-11-05 08:33:59.657750 (MainThread): Opening a new connection, currently in state init
2020-11-05 08:34:06.520023 (MainThread): SQL status: SUCCESS 1 in 6.86 seconds
2020-11-05 08:34:06.521024 (MainThread): On master: COMMIT
2020-11-05 08:34:06.522025 (MainThread): Using snowflake connection "master".
2020-11-05 08:34:06.522525 (MainThread): On master: COMMIT
2020-11-05 08:34:06.811606 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2020-11-05 08:34:06.812124 (MainThread): On master: Close
2020-11-05 08:34:07.174371 (MainThread): 09:34:07 | Concurrency: 1 threads (target='dev')
2020-11-05 08:34:07.176354 (MainThread): 09:34:07 | 
2020-11-05 08:34:07.213029 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 08:34:07.222029 (Thread-1): 09:34:07 | 1 of 2 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 08:34:07.227042 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 08:34:07.228043 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 08:34:07.385605 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 08:34:07.393589 (Thread-1): finished collecting timing info
2020-11-05 08:34:07.654150 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 08:34:07.667151 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 08:34:07.668151 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 08:34:07.668652 (Thread-1): Opening a new connection, currently in state init
2020-11-05 08:34:10.401578 (Thread-1): SQL status: SUCCESS 1 in 2.73 seconds
2020-11-05 08:34:10.402580 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 08:34:10.402580 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 08:34:12.603628 (Thread-1): SQL status: SUCCESS 1 in 2.20 seconds
2020-11-05 08:34:12.609628 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 08:34:12.610628 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 08:34:12.611628 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 08:34:12.779913 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-11-05 08:34:12.861939 (Thread-1): finished collecting timing info
2020-11-05 08:34:12.863940 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 08:34:13.128820 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e04836-4a41-41b8-b9cb-63774f5e7f4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246EDE97D00>]}
2020-11-05 08:34:13.135305 (Thread-1): 09:34:13 | 1 of 2 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 5.90s]
2020-11-05 08:34:13.138263 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 08:34:13.144031 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 08:34:13.151033 (Thread-1): 09:34:13 | 2 of 2 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 08:34:13.153032 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 08:34:13.154030 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 08:34:13.216050 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 08:34:13.220034 (Thread-1): finished collecting timing info
2020-11-05 08:34:13.365962 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 08:34:13.371959 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 08:34:13.372961 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 08:34:13.372961 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 08:34:15.706252 (Thread-1): SQL status: SUCCESS 1 in 2.33 seconds
2020-11-05 08:34:15.707253 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 08:34:15.707253 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 08:34:16.225293 (Thread-1): SQL status: SUCCESS 1 in 0.52 seconds
2020-11-05 08:34:16.230292 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 08:34:16.231293 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 08:34:16.231293 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 08:34:16.440400 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-11-05 08:34:16.459411 (Thread-1): finished collecting timing info
2020-11-05 08:34:16.460912 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 08:34:16.767018 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e04836-4a41-41b8-b9cb-63774f5e7f4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246EDED6BE0>]}
2020-11-05 08:34:16.774005 (Thread-1): 09:34:16 | 2 of 2 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 3.61s]
2020-11-05 08:34:16.777807 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 08:34:16.783831 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 08:34:16.784831 (MainThread): Using snowflake connection "master".
2020-11-05 08:34:16.784831 (MainThread): On master: BEGIN
2020-11-05 08:34:16.785831 (MainThread): Opening a new connection, currently in state closed
2020-11-05 08:34:18.532261 (MainThread): SQL status: SUCCESS 1 in 1.75 seconds
2020-11-05 08:34:18.533262 (MainThread): On master: COMMIT
2020-11-05 08:34:18.534262 (MainThread): Using snowflake connection "master".
2020-11-05 08:34:18.534262 (MainThread): On master: COMMIT
2020-11-05 08:34:18.861274 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2020-11-05 08:34:18.862274 (MainThread): On master: Close
2020-11-05 08:34:19.087106 (MainThread): 09:34:19 | 
2020-11-05 08:34:19.114105 (MainThread): 09:34:19 | Finished running 1 table model, 1 view model in 26.87s.
2020-11-05 08:34:19.116619 (MainThread): Connection 'master' was properly closed.
2020-11-05 08:34:19.117619 (MainThread): Connection 'create_analytics_cko_dbt_am' was properly closed.
2020-11-05 08:34:19.118120 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 08:34:19.118621 (MainThread): Connection 'model.cko_dbt_am.my_second_dbt_model' was properly closed.
2020-11-05 08:34:19.165634 (MainThread): 
2020-11-05 08:34:19.185635 (MainThread): Completed successfully
2020-11-05 08:34:19.193636 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-11-05 08:34:19.196635 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246EDED1B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246EDED1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246EDED1F70>]}
2020-11-05 08:34:19.199638 (MainThread): Flushing usage events
2020-11-05 08:45:12.397902 (MainThread): Running with dbt=0.18.1
2020-11-05 08:45:12.910502 (MainThread): Loading KWallet
2020-11-05 08:45:12.913502 (MainThread): Loading SecretService
2020-11-05 08:45:12.916503 (MainThread): Loading Windows
2020-11-05 08:45:13.132045 (MainThread): Loading chainer
2020-11-05 08:45:13.134044 (MainThread): Loading macOS
2020-11-05 08:45:14.050831 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 08:45:14.052830 (MainThread): Tracking: tracking
2020-11-05 08:45:14.052830 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E82D4C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E82C77F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E82C7E20>]}
2020-11-05 08:45:14.102830 (MainThread): Partial parsing not enabled
2020-11-05 08:45:14.105847 (MainThread): Parsing macros\adapters.sql
2020-11-05 08:45:14.186343 (MainThread): Parsing macros\catalog.sql
2020-11-05 08:45:14.191842 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 08:45:14.217880 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 08:45:14.223864 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 08:45:14.234865 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 08:45:14.245881 (MainThread): Parsing macros\core.sql
2020-11-05 08:45:14.256884 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 08:45:14.375915 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 08:45:14.400960 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 08:45:14.403959 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 08:45:14.407959 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 08:45:14.413958 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 08:45:14.418961 (MainThread): Parsing macros\etc\query.sql
2020-11-05 08:45:14.422960 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 08:45:14.447945 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 08:45:14.487470 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 08:45:14.493454 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 08:45:14.511962 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 08:45:14.567965 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 08:45:14.645015 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 08:45:14.649999 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 08:45:14.695040 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 08:45:14.712060 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 08:45:14.726045 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 08:45:14.744062 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 08:45:14.752047 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 08:45:14.757063 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 08:45:14.762063 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 08:45:14.782054 (MainThread): Partial parsing not enabled
2020-11-05 08:45:14.900099 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 08:45:14.968103 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 08:45:14.997114 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 08:45:15.567255 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 08:45:15.684278 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 08:45:15.686281 (MainThread): 
2020-11-05 08:45:15.688278 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 08:45:15.701279 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 08:45:15.733300 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 08:45:15.734299 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 08:45:15.734299 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 08:45:18.996893 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 3.26 seconds
2020-11-05 08:45:19.022878 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 08:45:20.429721 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 08:45:20.498749 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 08:45:20.499750 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 08:45:20.504749 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 08:45:23.189198 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 2.68 seconds
2020-11-05 08:45:23.195198 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 08:45:23.523260 (MainThread): Using snowflake connection "master".
2020-11-05 08:45:23.524260 (MainThread): On master: BEGIN
2020-11-05 08:45:23.524260 (MainThread): Opening a new connection, currently in state init
2020-11-05 08:45:25.345274 (MainThread): SQL status: SUCCESS 1 in 1.82 seconds
2020-11-05 08:45:25.345773 (MainThread): On master: COMMIT
2020-11-05 08:45:25.346773 (MainThread): Using snowflake connection "master".
2020-11-05 08:45:25.347274 (MainThread): On master: COMMIT
2020-11-05 08:45:25.688077 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2020-11-05 08:45:25.689080 (MainThread): On master: Close
2020-11-05 08:45:26.249604 (MainThread): 09:45:26 | Concurrency: 1 threads (target='dev')
2020-11-05 08:45:26.258616 (MainThread): 09:45:26 | 
2020-11-05 08:45:26.312619 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 08:45:26.319620 (Thread-1): 09:45:26 | 1 of 3 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 08:45:26.322621 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 08:45:26.323623 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 08:45:26.476647 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 08:45:26.480148 (Thread-1): finished collecting timing info
2020-11-05 08:45:26.784186 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 08:45:26.793188 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 08:45:26.793688 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 08:45:26.794189 (Thread-1): Opening a new connection, currently in state init
2020-11-05 08:45:28.376418 (Thread-1): unclosed <socket.socket fd=1540, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.5.101', 54774), raddr=('168.63.27.166', 443)>
2020-11-05 08:45:28.380418 (Thread-1): SQL status: SUCCESS 1 in 1.59 seconds
2020-11-05 08:45:28.381416 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 08:45:28.382417 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 08:45:30.939962 (Thread-1): SQL status: SUCCESS 1 in 2.56 seconds
2020-11-05 08:45:30.945946 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 08:45:30.946964 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 08:45:30.946964 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 08:45:31.112149 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2020-11-05 08:45:31.198666 (Thread-1): finished collecting timing info
2020-11-05 08:45:31.199666 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 08:45:31.486362 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5185f4e7-4e24-419a-b26f-71629cc31c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E87DE670>]}
2020-11-05 08:45:31.494364 (Thread-1): 09:45:31 | 1 of 3 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 5.16s]
2020-11-05 08:45:31.497363 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 08:45:31.499362 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 08:45:31.510364 (Thread-1): 09:45:31 | 2 of 3 START view model cko_dbt_am.users_extract..................... [RUN]
2020-11-05 08:45:31.519880 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 08:45:31.521880 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 08:45:31.592401 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 08:45:31.596398 (Thread-1): finished collecting timing info
2020-11-05 08:45:31.750457 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 08:45:31.757457 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 08:45:31.758457 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 08:45:31.758457 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 08:45:34.349635 (Thread-1): SQL status: SUCCESS 1 in 2.59 seconds
2020-11-05 08:45:34.350634 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 08:45:34.351146 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */

  create or replace  view analytics.cko_dbt_am.users_extract  as (
    /* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
  );
2020-11-05 08:45:34.882332 (Thread-1): SQL status: SUCCESS 1 in 0.53 seconds
2020-11-05 08:45:34.887332 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 08:45:34.888331 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 08:45:34.888331 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 08:45:35.085212 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-11-05 08:45:35.103213 (Thread-1): finished collecting timing info
2020-11-05 08:45:35.105213 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 08:45:35.444584 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5185f4e7-4e24-419a-b26f-71629cc31c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E88FDBE0>]}
2020-11-05 08:45:35.451586 (Thread-1): 09:45:35 | 2 of 3 OK created view model cko_dbt_am.users_extract................ [SUCCESS 1 in 3.93s]
2020-11-05 08:45:35.454584 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 08:45:35.455584 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 08:45:35.462114 (Thread-1): 09:45:35 | 3 of 3 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 08:45:35.466114 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 08:45:35.467113 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 08:45:35.532630 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 08:45:35.536629 (Thread-1): finished collecting timing info
2020-11-05 08:45:35.564144 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 08:45:35.572145 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 08:45:35.573145 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 08:45:35.573645 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 08:45:37.890603 (Thread-1): SQL status: SUCCESS 1 in 2.32 seconds
2020-11-05 08:45:37.891603 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 08:45:37.892103 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 08:45:38.466796 (Thread-1): SQL status: SUCCESS 1 in 0.57 seconds
2020-11-05 08:45:38.472797 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 08:45:38.473798 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 08:45:38.473798 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 08:45:38.701896 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-11-05 08:45:38.721909 (Thread-1): finished collecting timing info
2020-11-05 08:45:38.722909 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 08:45:39.061474 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5185f4e7-4e24-419a-b26f-71629cc31c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E88E93A0>]}
2020-11-05 08:45:39.070474 (Thread-1): 09:45:39 | 3 of 3 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 3.60s]
2020-11-05 08:45:39.091477 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 08:45:39.097978 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 08:45:39.098978 (MainThread): Using snowflake connection "master".
2020-11-05 08:45:39.099480 (MainThread): On master: BEGIN
2020-11-05 08:45:39.102977 (MainThread): Opening a new connection, currently in state closed
2020-11-05 08:45:40.685561 (MainThread): SQL status: SUCCESS 1 in 1.58 seconds
2020-11-05 08:45:40.686561 (MainThread): On master: COMMIT
2020-11-05 08:45:40.686561 (MainThread): Using snowflake connection "master".
2020-11-05 08:45:40.686561 (MainThread): On master: COMMIT
2020-11-05 08:45:40.996268 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2020-11-05 08:45:40.997269 (MainThread): On master: Close
2020-11-05 08:45:41.239554 (MainThread): 09:45:41 | 
2020-11-05 08:45:41.243554 (MainThread): 09:45:41 | Finished running 1 table model, 2 view models in 25.55s.
2020-11-05 08:45:41.250555 (MainThread): Connection 'master' was properly closed.
2020-11-05 08:45:41.250555 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 08:45:41.251555 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 08:45:41.251555 (MainThread): Connection 'model.cko_dbt_am.my_second_dbt_model' was properly closed.
2020-11-05 08:45:41.329585 (MainThread): 
2020-11-05 08:45:41.339586 (MainThread): Completed successfully
2020-11-05 08:45:41.350585 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-11-05 08:45:41.357098 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E88FBEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E88FB130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2E88FB370>]}
2020-11-05 08:45:41.358099 (MainThread): Flushing usage events
2020-11-05 12:00:41.062764 (MainThread): Running with dbt=0.18.1
2020-11-05 12:00:41.652540 (MainThread): Loading KWallet
2020-11-05 12:00:41.656541 (MainThread): Loading SecretService
2020-11-05 12:00:41.658692 (MainThread): Loading Windows
2020-11-05 12:00:41.877933 (MainThread): Loading chainer
2020-11-05 12:00:41.879934 (MainThread): Loading macOS
2020-11-05 12:00:42.889464 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 12:00:42.892464 (MainThread): Tracking: tracking
2020-11-05 12:00:42.893463 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221718D4C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221718BA7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221718BAE20>]}
2020-11-05 12:00:43.043453 (MainThread): Partial parsing not enabled
2020-11-05 12:00:43.057465 (MainThread): Parsing macros\adapters.sql
2020-11-05 12:00:43.317360 (MainThread): Parsing macros\catalog.sql
2020-11-05 12:00:43.334371 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 12:00:43.414398 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 12:00:43.432425 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 12:00:43.468439 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 12:00:43.513213 (MainThread): Parsing macros\core.sql
2020-11-05 12:00:43.548795 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 12:00:43.958937 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 12:00:44.041462 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 12:00:44.050975 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 12:00:44.074325 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 12:00:44.094335 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 12:00:44.109352 (MainThread): Parsing macros\etc\query.sql
2020-11-05 12:00:44.329589 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 12:00:44.733765 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 12:00:44.903787 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 12:00:44.914288 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 12:00:44.952293 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 12:00:45.193323 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 12:00:45.305340 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 12:00:45.313340 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 12:00:45.382045 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 12:00:45.410054 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 12:00:45.431877 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 12:00:45.457903 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 12:00:45.470421 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 12:00:45.477421 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 12:00:45.486434 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 12:00:45.530424 (MainThread): Partial parsing not enabled
2020-11-05 12:00:45.842525 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 12:00:45.991637 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 12:00:46.067168 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 12:00:46.186694 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 12:00:47.418996 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 12:00:47.587059 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 12:00:47.590069 (MainThread): 
2020-11-05 12:00:47.591057 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 12:00:47.612375 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 12:00:47.662798 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 12:00:47.663299 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 12:00:47.663799 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 12:00:53.357811 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 5.69 seconds
2020-11-05 12:00:53.372810 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 12:00:54.755389 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 12:00:54.807376 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 12:00:54.809377 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 12:00:54.810377 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 12:00:58.263452 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 3.45 seconds
2020-11-05 12:00:58.285468 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 12:01:00.212960 (MainThread): Using snowflake connection "master".
2020-11-05 12:01:00.213961 (MainThread): On master: BEGIN
2020-11-05 12:01:00.213961 (MainThread): Opening a new connection, currently in state init
2020-11-05 12:01:05.026883 (MainThread): SQL status: SUCCESS 1 in 4.81 seconds
2020-11-05 12:01:05.027883 (MainThread): On master: COMMIT
2020-11-05 12:01:05.028884 (MainThread): Using snowflake connection "master".
2020-11-05 12:01:05.028884 (MainThread): On master: COMMIT
2020-11-05 12:01:07.910729 (MainThread): SQL status: SUCCESS 1 in 2.88 seconds
2020-11-05 12:01:07.910729 (MainThread): On master: Close
2020-11-05 12:01:08.195873 (MainThread): 13:01:08 | Concurrency: 1 threads (target='dev')
2020-11-05 12:01:08.196854 (MainThread): 13:01:08 | 
2020-11-05 12:01:08.220029 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 12:01:08.231014 (Thread-1): 13:01:08 | 1 of 4 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 12:01:08.234032 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 12:01:08.234032 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 12:01:08.376108 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 12:01:08.383896 (Thread-1): finished collecting timing info
2020-11-05 12:01:08.624460 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 12:01:08.635463 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 12:01:08.635463 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 12:01:08.636463 (Thread-1): Opening a new connection, currently in state init
2020-11-05 12:01:12.181126 (Thread-1): SQL status: SUCCESS 1 in 3.54 seconds
2020-11-05 12:01:12.181126 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 12:01:12.182126 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 12:01:22.529205 (Thread-1): SQL status: SUCCESS 1 in 10.35 seconds
2020-11-05 12:01:22.535705 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 12:01:22.536705 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 12:01:22.537204 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 12:01:23.265911 (Thread-1): SQL status: SUCCESS 1 in 0.73 seconds
2020-11-05 12:01:23.315422 (Thread-1): finished collecting timing info
2020-11-05 12:01:23.315923 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 12:01:25.059142 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea081df4-7278-40df-b9b0-05cac01f23f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022171D98550>]}
2020-11-05 12:01:25.065668 (Thread-1): 13:01:25 | 1 of 4 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 16.82s]
2020-11-05 12:21:53.800331 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 12:21:53.816332 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 12:21:53.896844 (Thread-1): 13:21:53 | 2 of 4 START Table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 12:21:53.944349 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 12:21:53.948353 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 12:21:54.056365 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 12:21:54.063366 (Thread-1): finished collecting timing info
2020-11-05 12:21:54.097869 (Thread-1): finished collecting timing info
2020-11-05 12:21:54.101370 (Thread-1): Compilation Error in model pageviews_extract (models\pageviews_extract.sql)
  No materialization 'Table' was found for adapter snowflake! (searched types 'default' and 'snowflake')
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 222, in execute
    missing_materialization(model, self.adapter.type())
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\exceptions.py", line 611, in missing_materialization
    raise_compiler_error(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model pageviews_extract (models\pageviews_extract.sql)
  No materialization 'Table' was found for adapter snowflake! (searched types 'default' and 'snowflake')
2020-11-05 12:21:54.116371 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea081df4-7278-40df-b9b0-05cac01f23f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022171E91490>]}
2020-11-05 12:21:54.125372 (Thread-1): 13:21:54 | 2 of 4 ERROR creating Table model cko_dbt_am.pageviews_extract....... [ERROR in 0.19s]
2020-11-05 12:21:54.285895 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 12:21:54.286894 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 12:21:54.294394 (Thread-1): 13:21:54 | 3 of 4 START view model cko_dbt_am.users_extract..................... [RUN]
2020-11-05 12:21:54.296894 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 12:21:54.298395 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 12:21:54.365903 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 12:21:54.369905 (Thread-1): finished collecting timing info
2020-11-05 12:21:54.525923 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 12:21:54.535425 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 12:21:54.536426 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 12:21:54.537426 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 12:21:57.454405 (Thread-1): SQL status: SUCCESS 1 in 2.92 seconds
2020-11-05 12:21:57.455404 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 12:21:57.456404 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */

  create or replace  view analytics.cko_dbt_am.users_extract  as (
    /* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
  );
2020-11-05 12:21:58.218881 (Thread-1): SQL status: SUCCESS 1 in 0.76 seconds
2020-11-05 12:21:58.228392 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 12:21:58.229391 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 12:21:58.230392 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 12:21:58.478697 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2020-11-05 12:21:58.499697 (Thread-1): finished collecting timing info
2020-11-05 12:21:58.500697 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 12:21:58.776826 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea081df4-7278-40df-b9b0-05cac01f23f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022171EC1970>]}
2020-11-05 12:21:58.783826 (Thread-1): 13:21:58 | 3 of 4 OK created view model cko_dbt_am.users_extract................ [SUCCESS 1 in 4.48s]
2020-11-05 12:21:58.786827 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 12:21:58.787826 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 12:21:58.793826 (Thread-1): 13:21:58 | 4 of 4 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 12:21:58.794827 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 12:21:58.795826 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 12:21:58.856855 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 12:21:58.860856 (Thread-1): finished collecting timing info
2020-11-05 12:21:58.900858 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 12:21:58.907369 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 12:21:58.908370 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 12:21:58.908870 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 12:22:00.596769 (Thread-1): SQL status: SUCCESS 1 in 1.69 seconds
2020-11-05 12:22:00.596769 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 12:22:00.597770 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 12:22:02.987305 (Thread-1): SQL status: SUCCESS 1 in 2.39 seconds
2020-11-05 12:22:02.995319 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 12:22:02.996317 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 12:22:02.997319 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 12:22:03.144366 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-11-05 12:22:03.175881 (Thread-1): finished collecting timing info
2020-11-05 12:22:03.177882 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 12:22:03.837683 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea081df4-7278-40df-b9b0-05cac01f23f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022171D5A2B0>]}
2020-11-05 12:22:03.848701 (Thread-1): 13:22:03 | 4 of 4 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 5.04s]
2020-11-05 12:22:03.860702 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 12:22:03.882215 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 12:22:03.883215 (MainThread): Using snowflake connection "master".
2020-11-05 12:22:03.884215 (MainThread): On master: BEGIN
2020-11-05 12:22:03.884215 (MainThread): Opening a new connection, currently in state closed
2020-11-05 12:22:05.966139 (MainThread): SQL status: SUCCESS 1 in 2.08 seconds
2020-11-05 12:22:05.967140 (MainThread): On master: COMMIT
2020-11-05 12:22:05.976641 (MainThread): Using snowflake connection "master".
2020-11-05 12:22:05.980641 (MainThread): On master: COMMIT
2020-11-05 12:22:06.319221 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2020-11-05 12:22:06.320222 (MainThread): On master: Close
2020-11-05 12:22:06.684410 (MainThread): 13:22:06 | 
2020-11-05 12:22:06.685410 (MainThread): 13:22:06 | Finished running 1 table model, 1 Table model, 2 view models in 1279.09s.
2020-11-05 12:22:06.686409 (MainThread): Connection 'master' was properly closed.
2020-11-05 12:22:06.687426 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 12:22:06.687426 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 12:22:06.688425 (MainThread): Connection 'model.cko_dbt_am.my_second_dbt_model' was properly closed.
2020-11-05 12:22:06.793437 (MainThread): 
2020-11-05 12:22:06.796440 (MainThread): Completed with 1 error and 0 warnings:
2020-11-05 12:22:06.799438 (MainThread): 
2020-11-05 12:22:06.800440 (MainThread): Compilation Error in model pageviews_extract (models\pageviews_extract.sql)
2020-11-05 12:22:06.802439 (MainThread):   No materialization 'Table' was found for adapter snowflake! (searched types 'default' and 'snowflake')
2020-11-05 12:22:06.804439 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2020-11-05 12:22:06.810439 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022171ED2A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022171ED2C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022171ED2070>]}
2020-11-05 12:22:06.811440 (MainThread): Flushing usage events
2020-11-05 12:22:48.927355 (MainThread): Running with dbt=0.18.1
2020-11-05 12:22:49.424919 (MainThread): Loading KWallet
2020-11-05 12:22:49.427918 (MainThread): Loading SecretService
2020-11-05 12:22:49.431420 (MainThread): Loading Windows
2020-11-05 12:22:49.676950 (MainThread): Loading chainer
2020-11-05 12:22:49.679451 (MainThread): Loading macOS
2020-11-05 12:22:50.710082 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 12:22:50.712081 (MainThread): Tracking: tracking
2020-11-05 12:22:50.712582 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F563C24B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F563C12790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F563C12E50>]}
2020-11-05 12:22:50.769088 (MainThread): Partial parsing not enabled
2020-11-05 12:22:50.774089 (MainThread): Parsing macros\adapters.sql
2020-11-05 12:22:50.860600 (MainThread): Parsing macros\catalog.sql
2020-11-05 12:22:50.867101 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 12:22:50.896605 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 12:22:50.903606 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 12:22:50.916608 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 12:22:50.932609 (MainThread): Parsing macros\core.sql
2020-11-05 12:22:50.945111 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 12:22:51.071628 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 12:22:51.101631 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 12:22:51.104631 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 12:22:51.110131 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 12:22:51.118133 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 12:22:51.123134 (MainThread): Parsing macros\etc\query.sql
2020-11-05 12:22:51.126634 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 12:22:51.154137 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 12:22:51.195643 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 12:22:51.202145 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 12:22:51.230648 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 12:22:51.292155 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 12:22:51.375665 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 12:22:51.381666 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 12:22:51.458676 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 12:22:51.479178 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 12:22:51.499181 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 12:22:51.517183 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 12:22:51.527686 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 12:22:51.532685 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 12:22:51.538686 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 12:22:51.559189 (MainThread): Partial parsing not enabled
2020-11-05 12:22:51.678704 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 12:22:51.747713 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 12:22:51.776716 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 12:22:51.807220 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 12:22:52.452093 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 12:22:52.600613 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 12:22:52.605113 (MainThread): 
2020-11-05 12:22:52.608114 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 12:22:52.630116 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 12:22:52.665121 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 12:22:52.665121 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 12:22:52.665621 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 12:22:54.095402 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.43 seconds
2020-11-05 12:22:54.106404 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 12:22:54.323442 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 12:22:54.341443 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 12:22:54.341443 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 12:22:54.342442 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 12:22:55.288358 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 0.95 seconds
2020-11-05 12:22:55.306380 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 12:22:55.520244 (MainThread): Using snowflake connection "master".
2020-11-05 12:22:55.521244 (MainThread): On master: BEGIN
2020-11-05 12:22:55.521244 (MainThread): Opening a new connection, currently in state init
2020-11-05 12:22:57.324795 (MainThread): SQL status: SUCCESS 1 in 1.80 seconds
2020-11-05 12:22:57.325796 (MainThread): On master: COMMIT
2020-11-05 12:22:57.326795 (MainThread): Using snowflake connection "master".
2020-11-05 12:22:57.326795 (MainThread): On master: COMMIT
2020-11-05 12:22:57.734033 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2020-11-05 12:22:57.735032 (MainThread): On master: Close
2020-11-05 12:22:58.442489 (MainThread): 13:22:58 | Concurrency: 1 threads (target='dev')
2020-11-05 12:22:58.443492 (MainThread): 13:22:58 | 
2020-11-05 12:22:58.525518 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 12:22:58.533517 (Thread-1): 13:22:58 | 1 of 4 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 12:22:58.535520 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 12:22:58.536525 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 12:22:58.695047 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 12:22:58.699047 (Thread-1): finished collecting timing info
2020-11-05 12:22:58.980589 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 12:22:59.019095 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 12:22:59.020094 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 12:22:59.020595 (Thread-1): Opening a new connection, currently in state init
2020-11-05 12:23:00.436445 (Thread-1): SQL status: SUCCESS 1 in 1.42 seconds
2020-11-05 12:23:00.436445 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 12:23:00.436445 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 12:23:03.135716 (Thread-1): SQL status: SUCCESS 1 in 2.70 seconds
2020-11-05 12:23:03.141715 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 12:23:03.142715 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 12:23:03.142715 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 12:23:03.286786 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 12:23:03.399812 (Thread-1): finished collecting timing info
2020-11-05 12:23:03.401813 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 12:23:04.189873 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b2fcbad-f78e-4ffe-8333-9790602f87e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5640C7820>]}
2020-11-05 12:23:04.195874 (Thread-1): 13:23:04 | 1 of 4 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 5.65s]
2020-11-05 12:23:04.198859 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 12:23:04.199858 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 12:23:04.209858 (Thread-1): 13:23:04 | 2 of 4 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 12:23:04.212858 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 12:23:04.213859 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 12:23:04.262405 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 12:23:04.265888 (Thread-1): finished collecting timing info
2020-11-05 12:23:04.292902 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 12:23:04.302900 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 12:23:04.303901 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 12:23:04.304901 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 12:23:06.060788 (Thread-1): SQL status: SUCCESS 1 in 1.76 seconds
2020-11-05 12:23:06.061788 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 12:23:06.061788 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-10,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 12:23:10.790507 (Thread-1): SQL status: SUCCESS 1 in 4.73 seconds
2020-11-05 12:23:10.794507 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 12:23:10.795507 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 12:23:10.796507 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 12:23:10.973507 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-11-05 12:23:10.985491 (Thread-1): finished collecting timing info
2020-11-05 12:23:10.986491 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 12:23:11.395550 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b2fcbad-f78e-4ffe-8333-9790602f87e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F564260DC0>]}
2020-11-05 12:23:11.401566 (Thread-1): 13:23:11 | 2 of 4 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 7.18s]
2020-11-05 12:23:11.405550 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 12:23:11.406550 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 12:23:11.418552 (Thread-1): 13:23:11 | 3 of 4 START view model cko_dbt_am.users_extract..................... [RUN]
2020-11-05 12:23:11.421551 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 12:23:11.422552 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 12:23:11.466102 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 12:23:11.469102 (Thread-1): finished collecting timing info
2020-11-05 12:23:11.604162 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 12:23:11.610143 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 12:23:11.611144 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 12:23:11.612144 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 12:23:13.525640 (Thread-1): SQL status: SUCCESS 1 in 1.91 seconds
2020-11-05 12:23:13.526640 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 12:23:13.526640 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */

  create or replace  view analytics.cko_dbt_am.users_extract  as (
    /* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
  );
2020-11-05 12:23:14.454383 (Thread-1): SQL status: SUCCESS 1 in 0.93 seconds
2020-11-05 12:23:14.459383 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 12:23:14.460384 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 12:23:14.460883 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 12:23:16.036842 (Thread-1): SQL status: SUCCESS 1 in 1.57 seconds
2020-11-05 12:23:16.054864 (Thread-1): finished collecting timing info
2020-11-05 12:23:16.055847 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 12:23:16.825987 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b2fcbad-f78e-4ffe-8333-9790602f87e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F56420B040>]}
2020-11-05 12:23:16.833498 (Thread-1): 13:23:16 | 3 of 4 OK created view model cko_dbt_am.users_extract................ [SUCCESS 1 in 5.41s]
2020-11-05 12:23:16.835915 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 12:23:16.837423 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 12:23:16.843441 (Thread-1): 13:23:16 | 4 of 4 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 12:23:16.847436 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 12:23:16.849437 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 12:23:16.911439 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 12:23:16.916439 (Thread-1): finished collecting timing info
2020-11-05 12:23:16.995468 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 12:23:17.006469 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 12:23:17.006469 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 12:23:17.007470 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 12:23:19.421568 (Thread-1): SQL status: SUCCESS 1 in 2.41 seconds
2020-11-05 12:23:19.422568 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 12:23:19.423568 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 12:23:20.142676 (Thread-1): SQL status: SUCCESS 1 in 0.72 seconds
2020-11-05 12:23:20.147675 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 12:23:20.148675 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 12:23:20.149675 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 12:23:20.411288 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-11-05 12:23:20.429692 (Thread-1): finished collecting timing info
2020-11-05 12:23:20.430693 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 12:23:21.041342 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b2fcbad-f78e-4ffe-8333-9790602f87e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5640C7E20>]}
2020-11-05 12:23:21.048341 (Thread-1): 13:23:21 | 4 of 4 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 4.19s]
2020-11-05 12:23:21.051341 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 12:23:21.058342 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 12:23:21.059343 (MainThread): Using snowflake connection "master".
2020-11-05 12:23:21.059343 (MainThread): On master: BEGIN
2020-11-05 12:23:21.060346 (MainThread): Opening a new connection, currently in state closed
2020-11-05 12:23:23.249700 (MainThread): SQL status: SUCCESS 1 in 2.19 seconds
2020-11-05 12:23:23.249700 (MainThread): On master: COMMIT
2020-11-05 12:23:23.250700 (MainThread): Using snowflake connection "master".
2020-11-05 12:23:23.251700 (MainThread): On master: COMMIT
2020-11-05 12:23:23.538530 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2020-11-05 12:23:23.539531 (MainThread): On master: Close
2020-11-05 12:23:23.786239 (MainThread): 13:23:23 | 
2020-11-05 12:23:23.788222 (MainThread): 13:23:23 | Finished running 2 table models, 2 view models in 31.18s.
2020-11-05 12:23:23.794221 (MainThread): Connection 'master' was properly closed.
2020-11-05 12:23:23.795222 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 12:23:23.796224 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 12:23:23.796224 (MainThread): Connection 'model.cko_dbt_am.my_second_dbt_model' was properly closed.
2020-11-05 12:23:23.873753 (MainThread): 
2020-11-05 12:23:23.875754 (MainThread): Completed successfully
2020-11-05 12:23:23.882265 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-11-05 12:23:23.885269 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F563E8A7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5641ACC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5641ACBE0>]}
2020-11-05 12:23:23.886264 (MainThread): Flushing usage events
2020-11-05 17:50:37.173148 (MainThread): Running with dbt=0.18.1
2020-11-05 17:50:37.706154 (MainThread): Loading KWallet
2020-11-05 17:50:37.709153 (MainThread): Loading SecretService
2020-11-05 17:50:37.711785 (MainThread): Loading Windows
2020-11-05 17:50:37.953503 (MainThread): Loading chainer
2020-11-05 17:50:37.955517 (MainThread): Loading macOS
2020-11-05 17:50:38.898790 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 17:50:38.902790 (MainThread): Tracking: tracking
2020-11-05 17:50:38.904790 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF7E703A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF7E6F4880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF7E6F4E80>]}
2020-11-05 17:50:38.958179 (MainThread): Partial parsing not enabled
2020-11-05 17:50:38.963183 (MainThread): Parsing macros\adapters.sql
2020-11-05 17:50:39.046191 (MainThread): Parsing macros\catalog.sql
2020-11-05 17:50:39.052696 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 17:50:39.082702 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 17:50:39.090252 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 17:50:39.101258 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 17:50:39.117985 (MainThread): Parsing macros\core.sql
2020-11-05 17:50:39.129290 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 17:50:39.246967 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 17:50:39.276482 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 17:50:39.280676 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 17:50:39.286682 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 17:50:39.294684 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 17:50:39.299683 (MainThread): Parsing macros\etc\query.sql
2020-11-05 17:50:39.305683 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 17:50:39.335686 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 17:50:39.376706 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 17:50:39.382707 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 17:50:39.411822 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 17:50:39.488847 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 17:50:39.601866 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 17:50:39.608868 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 17:50:39.667230 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 17:50:39.690237 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 17:50:39.706238 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 17:50:39.727239 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 17:50:39.735241 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 17:50:39.741249 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 17:50:39.747750 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 17:50:39.766755 (MainThread): Partial parsing not enabled
2020-11-05 17:50:39.865774 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 17:50:39.923779 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 17:50:39.950785 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 17:50:39.976792 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 17:50:40.001794 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 17:50:40.025795 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 17:50:40.594971 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 17:50:40.726995 (MainThread): Found 6 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 17:50:40.729995 (MainThread): 
2020-11-05 17:50:40.731996 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 17:50:40.754472 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 17:50:40.788835 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 17:50:40.788835 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 17:50:40.788835 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 17:50:43.487126 (ThreadPoolExecutor-0_0): unclosed <socket.socket fd=1268, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.5.101', 61743), raddr=('168.63.27.166', 443)>
2020-11-05 17:50:45.182761 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 4.39 seconds
2020-11-05 17:50:45.211820 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 17:50:45.648079 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 17:50:45.692081 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 17:50:45.693081 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 17:50:45.694081 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 17:50:48.178166 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 2.48 seconds
2020-11-05 17:50:48.201169 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 17:50:48.522775 (MainThread): Using snowflake connection "master".
2020-11-05 17:50:48.523775 (MainThread): On master: BEGIN
2020-11-05 17:50:48.524774 (MainThread): Opening a new connection, currently in state init
2020-11-05 17:50:50.163430 (MainThread): SQL status: SUCCESS 1 in 1.64 seconds
2020-11-05 17:50:50.164417 (MainThread): On master: COMMIT
2020-11-05 17:50:50.164930 (MainThread): Using snowflake connection "master".
2020-11-05 17:50:50.165430 (MainThread): On master: COMMIT
2020-11-05 17:50:50.508021 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2020-11-05 17:50:50.509021 (MainThread): On master: Close
2020-11-05 17:50:51.063267 (MainThread): 18:50:51 | Concurrency: 1 threads (target='dev')
2020-11-05 17:50:58.180540 (MainThread): 18:50:58 | 
2020-11-05 17:50:58.212555 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 17:50:58.219555 (Thread-1): 18:50:58 | 1 of 6 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 17:50:58.221567 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 17:50:58.222568 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 17:50:58.389596 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 17:50:58.395096 (Thread-1): finished collecting timing info
2020-11-05 17:50:58.645130 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 17:50:58.654131 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 17:50:58.654631 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 17:50:58.655130 (Thread-1): Opening a new connection, currently in state init
2020-11-05 17:51:02.213995 (Thread-1): SQL status: SUCCESS 1 in 3.56 seconds
2020-11-05 17:51:02.214995 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 17:51:02.215994 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 17:51:04.789572 (Thread-1): SQL status: SUCCESS 1 in 2.57 seconds
2020-11-05 17:51:04.794572 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 17:51:04.795572 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 17:51:04.795572 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 17:51:05.130827 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2020-11-05 17:51:05.209837 (Thread-1): finished collecting timing info
2020-11-05 17:51:05.210838 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 17:51:06.348310 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2deb86ff-4073-4753-a543-ae390b79798b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF7EC4AA30>]}
2020-11-05 17:51:06.353832 (Thread-1): 18:51:06 | 1 of 6 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 8.13s]
2020-11-05 17:51:06.356833 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 17:51:06.357816 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 17:51:06.365819 (Thread-1): 18:51:06 | 2 of 6 START table model cko_dbt_am.pageviews_extract_ephemere....... [RUN]
2020-11-05 17:51:06.367818 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 17:51:06.368818 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 17:51:06.415836 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 17:51:06.419821 (Thread-1): finished collecting timing info
2020-11-05 17:51:06.447336 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 17:51:06.456349 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 17:51:06.457349 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: BEGIN
2020-11-05 17:51:06.457349 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 17:51:09.217572 (Thread-1): SQL status: SUCCESS 1 in 2.76 seconds
2020-11-05 17:51:09.218572 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 17:51:09.219572 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract_ephemere"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract_ephemere  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
      );
2020-11-05 17:51:11.234365 (Thread-1): SQL status: SUCCESS 1 in 2.01 seconds
2020-11-05 17:51:11.239382 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 17:51:11.239382 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 17:51:11.240382 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 17:51:12.347527 (Thread-1): SQL status: SUCCESS 1 in 1.11 seconds
2020-11-05 17:51:12.359052 (Thread-1): finished collecting timing info
2020-11-05 17:51:12.360553 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: Close
2020-11-05 17:51:12.849871 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2deb86ff-4073-4753-a543-ae390b79798b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF7ED4D970>]}
2020-11-05 17:51:12.856872 (Thread-1): 18:51:12 | 2 of 6 OK created table model cko_dbt_am.pageviews_extract_ephemere.. [SUCCESS 1 in 6.48s]
2020-11-05 17:51:12.859385 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 17:51:12.860385 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 17:51:12.866885 (Thread-1): 18:51:12 | 3 of 6 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 17:51:12.869370 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 17:51:12.870388 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 17:51:12.919885 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 17:51:12.923885 (Thread-1): finished collecting timing info
2020-11-05 17:51:12.952888 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 17:51:12.963898 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 17:51:12.964899 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 17:51:12.965899 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 17:51:15.554562 (Thread-1): SQL status: SUCCESS 1 in 2.59 seconds
2020-11-05 17:51:15.554562 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 17:51:15.554562 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 17:51:19.071396 (Thread-1): SQL status: SUCCESS 1 in 3.52 seconds
2020-11-05 17:51:19.076396 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 17:51:19.077396 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 17:51:19.077396 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 17:51:19.374205 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2020-11-05 17:51:19.387211 (Thread-1): finished collecting timing info
2020-11-05 17:51:19.389209 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 17:51:21.001273 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2deb86ff-4073-4753-a543-ae390b79798b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF7ED68B80>]}
2020-11-05 17:51:21.008273 (Thread-1): 18:51:21 | 3 of 6 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 8.13s]
2020-11-05 17:51:21.011290 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 17:51:21.011290 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 17:51:21.017289 (Thread-1): 18:51:21 | 4 of 6 START view model cko_dbt_am.users_extract..................... [RUN]
2020-11-05 17:51:21.019290 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 17:51:21.020273 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 17:51:21.063288 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 17:51:21.066788 (Thread-1): finished collecting timing info
2020-11-05 17:51:21.201865 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 17:51:21.208850 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 17:51:21.208850 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 17:51:21.209850 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 17:51:27.018216 (Thread-1): SQL status: SUCCESS 1 in 5.81 seconds
2020-11-05 17:51:27.019235 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 17:51:27.019235 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */

  create or replace  view analytics.cko_dbt_am.users_extract  as (
    /* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
  );
2020-11-05 17:51:27.707661 (Thread-1): SQL status: SUCCESS 1 in 0.69 seconds
2020-11-05 17:51:27.712661 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 17:51:27.713678 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 17:51:27.714677 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 17:51:28.031379 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2020-11-05 17:51:28.049380 (Thread-1): finished collecting timing info
2020-11-05 17:51:28.051380 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 17:51:28.513134 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2deb86ff-4073-4753-a543-ae390b79798b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF7EBB6820>]}
2020-11-05 17:51:28.520124 (Thread-1): 18:51:28 | 4 of 6 OK created view model cko_dbt_am.users_extract................ [SUCCESS 1 in 7.49s]
2020-11-05 17:51:28.522108 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 17:51:28.523125 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 17:51:28.529125 (Thread-1): 18:51:28 | 5 of 6 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 17:51:28.532110 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 17:51:28.533128 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 17:51:28.585651 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 17:51:28.590059 (Thread-1): finished collecting timing info
2020-11-05 17:51:28.616061 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 17:51:28.622062 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 17:51:28.623063 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 17:51:28.624062 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 17:51:34.036166 (Thread-1): SQL status: SUCCESS 1 in 5.41 seconds
2020-11-05 17:51:34.037164 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 17:51:34.037164 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 17:51:34.682688 (Thread-1): SQL status: SUCCESS 1 in 0.64 seconds
2020-11-05 17:51:34.687688 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 17:51:34.688687 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 17:51:34.688687 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 17:51:35.032390 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2020-11-05 17:51:35.050374 (Thread-1): finished collecting timing info
2020-11-05 17:51:35.051374 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 17:51:35.668762 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2deb86ff-4073-4753-a543-ae390b79798b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF7ED512B0>]}
2020-11-05 17:51:35.675762 (Thread-1): 18:51:35 | 5 of 6 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 7.14s]
2020-11-05 17:51:35.678762 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 17:51:35.678762 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 17:51:35.684762 (Thread-1): 18:51:35 | 6 of 6 START table model cko_dbt_am.users_extract_Ephemere........... [RUN]
2020-11-05 17:51:35.688763 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 17:51:35.688763 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 17:51:35.744789 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 17:51:35.749790 (Thread-1): finished collecting timing info
2020-11-05 17:51:35.775791 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 17:51:35.782791 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 17:51:35.783792 (Thread-1): On model.cko_dbt_am.users_extract_Ephemere: BEGIN
2020-11-05 17:51:35.784792 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 17:51:39.405863 (Thread-1): SQL status: SUCCESS 1 in 3.62 seconds
2020-11-05 17:51:39.406864 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 17:51:39.407864 (Thread-1): On model.cko_dbt_am.users_extract_Ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract_Ephemere"} */


      create or replace transient table analytics.cko_dbt_am.users_extract_Ephemere  as
      (-- Use the `ref` function to select from other models


select *
From "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"

where user_id in (Select Distinct user_id in FROM analytics.cko_dbt_am.pageviews_extract_ephemere)
      );
2020-11-05 17:51:40.398462 (Thread-1): Snowflake query id: 0198120f-0010-c0cf-0000-6c5d00014d3e
2020-11-05 17:51:40.399462 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 18 unexpected 'Select'.
syntax error line 9 at position 6 unexpected ')'.
2020-11-05 17:51:40.400480 (Thread-1): finished collecting timing info
2020-11-05 17:51:40.401480 (Thread-1): On model.cko_dbt_am.users_extract_Ephemere: ROLLBACK
2020-11-05 17:51:40.784297 (Thread-1): On model.cko_dbt_am.users_extract_Ephemere: Close
2020-11-05 17:51:41.270780 (Thread-1): Database Error in model users_extract_Ephemere (models\users_extract_Ephemere.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 18 unexpected 'Select'.
  syntax error line 9 at position 6 unexpected ')'.
  compiled SQL at target\run\cko_dbt_am\models\users_extract_Ephemere.sql
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 8 at position 18 unexpected 'Select'.
syntax error line 9 at position 6 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\users\alexandre\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model users_extract_Ephemere (models\users_extract_Ephemere.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 18 unexpected 'Select'.
  syntax error line 9 at position 6 unexpected ')'.
  compiled SQL at target\run\cko_dbt_am\models\users_extract_Ephemere.sql
2020-11-05 17:51:41.300519 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2deb86ff-4073-4753-a543-ae390b79798b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF7EDA7D00>]}
2020-11-05 17:51:41.307535 (Thread-1): 18:51:41 | 6 of 6 ERROR creating table model cko_dbt_am.users_extract_Ephemere.. [ERROR in 5.61s]
2020-11-05 17:51:41.310519 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 17:51:41.318521 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 17:51:41.319521 (MainThread): Using snowflake connection "master".
2020-11-05 17:51:41.320521 (MainThread): On master: BEGIN
2020-11-05 17:51:41.320521 (MainThread): Opening a new connection, currently in state closed
2020-11-05 17:51:44.089605 (MainThread): SQL status: SUCCESS 1 in 2.77 seconds
2020-11-05 17:51:44.090622 (MainThread): On master: COMMIT
2020-11-05 17:51:44.091122 (MainThread): Using snowflake connection "master".
2020-11-05 17:51:44.091622 (MainThread): On master: COMMIT
2020-11-05 17:51:44.541270 (MainThread): SQL status: SUCCESS 1 in 0.45 seconds
2020-11-05 17:51:44.542271 (MainThread): On master: Close
2020-11-05 17:51:45.034942 (MainThread): 18:51:45 | 
2020-11-05 17:51:45.035923 (MainThread): 18:51:45 | Finished running 4 table models, 2 view models in 64.30s.
2020-11-05 17:51:45.036925 (MainThread): Connection 'master' was properly closed.
2020-11-05 17:51:45.037926 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 17:51:45.038925 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 17:51:45.039924 (MainThread): Connection 'model.cko_dbt_am.users_extract_Ephemere' was properly closed.
2020-11-05 17:51:45.166456 (MainThread): 
2020-11-05 17:51:45.167479 (MainThread): Completed with 1 error and 0 warnings:
2020-11-05 17:51:45.170456 (MainThread): 
2020-11-05 17:51:45.171456 (MainThread): Database Error in model users_extract_Ephemere (models\users_extract_Ephemere.sql)
2020-11-05 17:51:45.172457 (MainThread):   001003 (42000): SQL compilation error:
2020-11-05 17:51:45.177454 (MainThread):   syntax error line 8 at position 18 unexpected 'Select'.
2020-11-05 17:51:45.184454 (MainThread):   syntax error line 9 at position 6 unexpected ')'.
2020-11-05 17:51:45.186455 (MainThread):   compiled SQL at target\run\cko_dbt_am\models\users_extract_Ephemere.sql
2020-11-05 17:51:45.189468 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
2020-11-05 17:51:45.197968 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF7ED87CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF7ED87730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DF7ED87700>]}
2020-11-05 17:51:45.199468 (MainThread): Flushing usage events
2020-11-05 17:52:34.717632 (MainThread): Running with dbt=0.18.1
2020-11-05 17:52:35.074176 (MainThread): Loading KWallet
2020-11-05 17:52:35.078176 (MainThread): Loading SecretService
2020-11-05 17:52:35.080676 (MainThread): Loading Windows
2020-11-05 17:52:35.291704 (MainThread): Loading chainer
2020-11-05 17:52:35.293205 (MainThread): Loading macOS
2020-11-05 17:52:36.155815 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 17:52:36.157815 (MainThread): Tracking: tracking
2020-11-05 17:52:36.158315 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E6A934910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E6A91D7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E6A91DEB0>]}
2020-11-05 17:52:36.208824 (MainThread): Partial parsing not enabled
2020-11-05 17:52:36.212824 (MainThread): Parsing macros\adapters.sql
2020-11-05 17:52:36.287857 (MainThread): Parsing macros\catalog.sql
2020-11-05 17:52:36.293859 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 17:52:36.319843 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 17:52:36.324859 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 17:52:36.336844 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 17:52:36.347844 (MainThread): Parsing macros\core.sql
2020-11-05 17:52:36.358368 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 17:52:36.470908 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 17:52:36.495924 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 17:52:36.498925 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 17:52:36.503926 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 17:52:36.509912 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 17:52:36.513926 (MainThread): Parsing macros\etc\query.sql
2020-11-05 17:52:36.516926 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 17:52:36.543911 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 17:52:36.579956 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 17:52:36.585957 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 17:52:36.602959 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 17:52:36.657984 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 17:52:36.727009 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 17:52:36.732009 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 17:52:36.777037 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 17:52:36.796055 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 17:52:36.810050 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 17:52:36.827055 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 17:52:36.834056 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 17:52:36.838056 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 17:52:36.844058 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 17:52:36.862066 (MainThread): Partial parsing not enabled
2020-11-05 17:52:36.959597 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 17:52:37.012136 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 17:52:37.041139 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 17:52:37.071168 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 17:52:37.096153 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 17:52:37.120170 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 17:52:37.662358 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 17:52:37.791382 (MainThread): Found 6 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 17:52:37.794385 (MainThread): 
2020-11-05 17:52:37.796384 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 17:52:37.819388 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 17:52:37.854893 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 17:52:37.854893 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 17:52:37.855394 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 17:52:40.600973 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.75 seconds
2020-11-05 17:52:40.633001 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 17:52:41.662320 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 17:52:41.707339 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 17:52:41.707339 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 17:52:41.708340 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 17:52:44.552630 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 2.84 seconds
2020-11-05 17:52:44.580631 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 17:52:45.415026 (MainThread): Using snowflake connection "master".
2020-11-05 17:52:45.416027 (MainThread): On master: BEGIN
2020-11-05 17:52:45.417027 (MainThread): Opening a new connection, currently in state init
2020-11-05 17:52:51.258997 (MainThread): SQL status: SUCCESS 1 in 5.84 seconds
2020-11-05 17:52:51.259996 (MainThread): On master: COMMIT
2020-11-05 17:52:51.260998 (MainThread): Using snowflake connection "master".
2020-11-05 17:52:51.261996 (MainThread): On master: COMMIT
2020-11-05 17:52:51.782666 (MainThread): SQL status: SUCCESS 1 in 0.52 seconds
2020-11-05 17:52:51.782666 (MainThread): On master: Close
2020-11-05 17:52:53.087684 (MainThread): 18:52:53 | Concurrency: 1 threads (target='dev')
2020-11-05 17:52:53.089195 (MainThread): 18:52:53 | 
2020-11-05 17:52:53.154212 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 17:52:53.158213 (Thread-1): 18:52:53 | 1 of 6 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 17:52:53.159212 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 17:52:53.161211 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 17:52:53.234230 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 17:52:53.236230 (Thread-1): finished collecting timing info
2020-11-05 17:52:53.332242 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 17:52:53.335749 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 17:52:53.335749 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 17:52:53.336750 (Thread-1): Opening a new connection, currently in state init
2020-11-05 17:52:56.147222 (Thread-1): SQL status: SUCCESS 1 in 2.81 seconds
2020-11-05 17:52:56.154222 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 17:52:56.156223 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 17:52:57.552494 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2020-11-05 17:52:57.558493 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 17:52:57.559493 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 17:52:57.559493 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 17:52:57.876790 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2020-11-05 17:52:57.965771 (Thread-1): finished collecting timing info
2020-11-05 17:52:57.966754 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 17:52:58.492154 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c323343-bdc2-448a-930d-3148e49f8b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E6AE4E670>]}
2020-11-05 17:52:58.499138 (Thread-1): 18:52:58 | 1 of 6 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 5.33s]
2020-11-05 17:52:58.501831 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 17:52:58.502840 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 17:52:58.510839 (Thread-1): 18:52:58 | 2 of 6 START table model cko_dbt_am.pageviews_extract_ephemere....... [RUN]
2020-11-05 17:52:58.515840 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 17:52:58.515840 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 17:52:58.563394 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 17:52:58.567378 (Thread-1): finished collecting timing info
2020-11-05 17:52:58.655406 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 17:52:58.727421 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 17:52:58.727920 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: BEGIN
2020-11-05 17:52:58.728921 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 17:53:01.438298 (Thread-1): SQL status: SUCCESS 1 in 2.71 seconds
2020-11-05 17:53:01.439298 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 17:53:01.439298 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract_ephemere"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract_ephemere  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
      );
2020-11-05 17:53:03.516850 (Thread-1): SQL status: SUCCESS 1 in 2.08 seconds
2020-11-05 17:53:03.522349 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 17:53:03.523367 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 17:53:03.523867 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 17:53:03.811113 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2020-11-05 17:53:03.823130 (Thread-1): finished collecting timing info
2020-11-05 17:53:03.824129 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: Close
2020-11-05 17:53:04.245606 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c323343-bdc2-448a-930d-3148e49f8b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E6AE49D90>]}
2020-11-05 17:53:04.253121 (Thread-1): 18:53:04 | 2 of 6 OK created table model cko_dbt_am.pageviews_extract_ephemere.. [SUCCESS 1 in 5.73s]
2020-11-05 17:53:04.256120 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 17:53:04.257638 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 17:53:04.265161 (Thread-1): 18:53:04 | 3 of 6 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 17:53:04.267159 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 17:53:04.268159 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 17:53:04.312146 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 17:53:04.316146 (Thread-1): finished collecting timing info
2020-11-05 17:53:04.343152 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 17:53:04.353661 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 17:53:04.354661 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 17:53:04.355161 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 17:53:07.118082 (Thread-1): SQL status: SUCCESS 1 in 2.76 seconds
2020-11-05 17:53:07.118582 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 17:53:07.119082 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 17:53:12.082102 (Thread-1): SQL status: SUCCESS 1 in 4.96 seconds
2020-11-05 17:53:12.084602 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 17:53:12.085103 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 17:53:12.085602 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 17:53:12.311630 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-11-05 17:53:12.316132 (Thread-1): finished collecting timing info
2020-11-05 17:53:12.316631 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 17:53:13.189751 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c323343-bdc2-448a-930d-3148e49f8b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E6AF32E80>]}
2020-11-05 17:53:13.196736 (Thread-1): 18:53:13 | 3 of 6 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 8.92s]
2020-11-05 17:53:13.199736 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 17:53:13.200737 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 17:53:13.206736 (Thread-1): 18:53:13 | 4 of 6 START view model cko_dbt_am.users_extract..................... [RUN]
2020-11-05 17:53:13.209754 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 17:53:13.210735 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 17:53:13.257265 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 17:53:13.261249 (Thread-1): finished collecting timing info
2020-11-05 17:53:13.444288 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 17:53:13.451289 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 17:53:13.452289 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 17:53:13.452789 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 17:53:16.928048 (Thread-1): SQL status: SUCCESS 1 in 3.48 seconds
2020-11-05 17:53:16.929048 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 17:53:16.929548 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */

  create or replace  view analytics.cko_dbt_am.users_extract  as (
    /* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
  );
2020-11-05 17:53:17.605839 (Thread-1): SQL status: SUCCESS 1 in 0.68 seconds
2020-11-05 17:53:17.611856 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 17:53:17.612853 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 17:53:17.612853 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 17:53:18.351075 (Thread-1): SQL status: SUCCESS 1 in 0.74 seconds
2020-11-05 17:53:18.370076 (Thread-1): finished collecting timing info
2020-11-05 17:53:18.371075 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 17:53:19.346000 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c323343-bdc2-448a-930d-3148e49f8b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E6AE4E850>]}
2020-11-05 17:53:19.353526 (Thread-1): 18:53:19 | 4 of 6 OK created view model cko_dbt_am.users_extract................ [SUCCESS 1 in 6.14s]
2020-11-05 17:53:19.356512 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 17:53:19.357512 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 17:53:19.363523 (Thread-1): 18:53:19 | 5 of 6 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 17:53:19.367523 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 17:53:19.368522 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 17:53:19.431526 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 17:53:19.437527 (Thread-1): finished collecting timing info
2020-11-05 17:53:19.467554 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 17:53:19.474553 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 17:53:19.475553 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 17:53:19.475553 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 17:53:23.121021 (Thread-1): SQL status: SUCCESS 1 in 3.65 seconds
2020-11-05 17:53:23.124020 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 17:53:23.125021 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 17:53:23.805909 (Thread-1): SQL status: SUCCESS 1 in 0.68 seconds
2020-11-05 17:53:23.808910 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 17:53:23.809410 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 17:53:23.809410 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 17:53:24.131372 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2020-11-05 17:53:24.138371 (Thread-1): finished collecting timing info
2020-11-05 17:53:24.138872 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 17:53:24.692489 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c323343-bdc2-448a-930d-3148e49f8b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E6AE4EAC0>]}
2020-11-05 17:53:24.694989 (Thread-1): 18:53:24 | 5 of 6 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 5.32s]
2020-11-05 17:53:24.704996 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 17:53:24.704996 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 17:53:24.707996 (Thread-1): 18:53:24 | 6 of 6 START table model cko_dbt_am.users_extract_Ephemere........... [RUN]
2020-11-05 17:53:24.708997 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 17:53:24.708997 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 17:53:24.727997 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 17:53:24.728998 (Thread-1): finished collecting timing info
2020-11-05 17:53:24.739999 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 17:53:24.743000 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 17:53:24.743000 (Thread-1): On model.cko_dbt_am.users_extract_Ephemere: BEGIN
2020-11-05 17:53:24.743000 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 17:53:28.904444 (Thread-1): SQL status: SUCCESS 1 in 4.16 seconds
2020-11-05 17:53:28.905457 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 17:53:28.906457 (Thread-1): On model.cko_dbt_am.users_extract_Ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract_Ephemere"} */


      create or replace transient table analytics.cko_dbt_am.users_extract_Ephemere  as
      (-- Use the `ref` function to select from other models


select *
From "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"

where user_id in (Select Distinct user_id FROM analytics.cko_dbt_am.pageviews_extract_ephemere)
      );
2020-11-05 17:53:30.672699 (Thread-1): SQL status: SUCCESS 1 in 1.77 seconds
2020-11-05 17:53:30.677700 (Thread-1): On model.cko_dbt_am.users_extract_Ephemere: COMMIT
2020-11-05 17:53:30.678683 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 17:53:30.679683 (Thread-1): On model.cko_dbt_am.users_extract_Ephemere: COMMIT
2020-11-05 17:53:30.998811 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2020-11-05 17:53:31.012309 (Thread-1): finished collecting timing info
2020-11-05 17:53:31.013309 (Thread-1): On model.cko_dbt_am.users_extract_Ephemere: Close
2020-11-05 17:53:31.604136 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c323343-bdc2-448a-930d-3148e49f8b1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E6AFAF340>]}
2020-11-05 17:53:31.611148 (Thread-1): 18:53:31 | 6 of 6 OK created table model cko_dbt_am.users_extract_Ephemere...... [SUCCESS 1 in 6.89s]
2020-11-05 17:53:31.615150 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 17:53:31.621150 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 17:53:31.622150 (MainThread): Using snowflake connection "master".
2020-11-05 17:53:31.623150 (MainThread): On master: BEGIN
2020-11-05 17:53:31.624149 (MainThread): Opening a new connection, currently in state closed
2020-11-05 17:53:34.291584 (MainThread): SQL status: SUCCESS 1 in 2.67 seconds
2020-11-05 17:53:34.291584 (MainThread): On master: COMMIT
2020-11-05 17:53:34.292589 (MainThread): Using snowflake connection "master".
2020-11-05 17:53:34.293584 (MainThread): On master: COMMIT
2020-11-05 17:53:34.833418 (MainThread): SQL status: SUCCESS 1 in 0.54 seconds
2020-11-05 17:53:34.833418 (MainThread): On master: Close
2020-11-05 17:53:36.208232 (MainThread): 18:53:36 | 
2020-11-05 17:53:36.211230 (MainThread): 18:53:36 | Finished running 4 table models, 2 view models in 58.41s.
2020-11-05 17:53:36.212232 (MainThread): Connection 'master' was properly closed.
2020-11-05 17:53:36.212232 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 17:53:36.213232 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 17:53:36.213232 (MainThread): Connection 'model.cko_dbt_am.users_extract_Ephemere' was properly closed.
2020-11-05 17:53:36.337778 (MainThread): 
2020-11-05 17:53:36.338781 (MainThread): Completed successfully
2020-11-05 17:53:36.340778 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2020-11-05 17:53:36.347780 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E6AFABC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E6AFAB0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E6AFABE20>]}
2020-11-05 17:53:36.349779 (MainThread): Flushing usage events
2020-11-05 17:53:46.291833 (MainThread): The 'warn' method is deprecated, use 'warning' instead
2020-11-05 17:53:46.292860 (MainThread): Error sending message, disabling tracking
2020-11-05 17:56:40.524278 (MainThread): Running with dbt=0.18.1
2020-11-05 17:56:40.807334 (MainThread): Loading KWallet
2020-11-05 17:56:40.810334 (MainThread): Loading SecretService
2020-11-05 17:56:40.812334 (MainThread): Loading Windows
2020-11-05 17:56:40.996403 (MainThread): Loading chainer
2020-11-05 17:56:40.997404 (MainThread): Loading macOS
2020-11-05 17:56:41.785268 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 17:56:41.787268 (MainThread): Tracking: tracking
2020-11-05 17:56:41.787268 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C5B4B48E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C5B49E880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C5B49EEB0>]}
2020-11-05 17:56:41.836763 (MainThread): Partial parsing not enabled
2020-11-05 17:56:41.839780 (MainThread): Parsing macros\adapters.sql
2020-11-05 17:56:41.967789 (MainThread): Parsing macros\catalog.sql
2020-11-05 17:56:41.988820 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 17:56:42.071469 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 17:56:42.093484 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 17:56:42.128999 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 17:56:42.164003 (MainThread): Parsing macros\core.sql
2020-11-05 17:56:42.202024 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 17:56:42.579129 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 17:56:42.654184 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 17:56:42.666168 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 17:56:42.683212 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 17:56:42.706226 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 17:56:42.727227 (MainThread): Parsing macros\etc\query.sql
2020-11-05 17:56:42.740213 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 17:56:42.831271 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 17:56:42.980292 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 17:56:43.008804 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 17:56:43.089814 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 17:56:43.279371 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 17:56:43.564712 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 17:56:43.610730 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 17:56:43.790789 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 17:56:43.852791 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 17:56:43.899844 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 17:56:43.963849 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 17:56:44.001893 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 17:56:44.017892 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 17:56:44.042894 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 17:56:44.101905 (MainThread): Partial parsing not enabled
2020-11-05 17:56:44.383520 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 17:56:44.542074 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 17:56:44.616109 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 17:56:44.703152 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 17:56:44.778651 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 17:56:44.854168 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 17:56:46.950900 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 17:56:47.161969 (MainThread): Found 6 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 17:56:47.168984 (MainThread): 
2020-11-05 17:56:47.170471 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 17:56:47.202994 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 17:56:47.251984 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 17:56:47.251984 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 17:56:47.251984 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 17:56:50.310629 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 3.06 seconds
2020-11-05 17:56:50.343132 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 17:56:50.455148 (ThreadPoolExecutor-0_0): unclosed <socket.socket fd=600, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.5.101', 62209), raddr=('168.63.27.166', 443)>
2020-11-05 17:56:52.286382 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 17:56:52.304385 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 17:56:52.304884 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 17:56:52.305385 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 17:56:53.624001 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.32 seconds
2020-11-05 17:56:53.661002 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 17:56:53.891084 (MainThread): Using snowflake connection "master".
2020-11-05 17:56:53.892083 (MainThread): On master: BEGIN
2020-11-05 17:56:53.892083 (MainThread): Opening a new connection, currently in state init
2020-11-05 17:56:55.430836 (MainThread): SQL status: SUCCESS 1 in 1.54 seconds
2020-11-05 17:56:55.430836 (MainThread): On master: COMMIT
2020-11-05 17:56:55.431837 (MainThread): Using snowflake connection "master".
2020-11-05 17:56:55.431837 (MainThread): On master: COMMIT
2020-11-05 17:56:55.732914 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2020-11-05 17:56:55.733915 (MainThread): On master: Close
2020-11-05 17:56:55.927896 (MainThread): 18:56:55 | Concurrency: 1 threads (target='dev')
2020-11-05 17:56:55.929893 (MainThread): 18:56:55 | 
2020-11-05 17:56:55.951894 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 17:56:55.955900 (Thread-1): 18:56:55 | 1 of 6 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 17:56:55.956897 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 17:56:55.957898 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 17:56:56.044932 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 17:56:56.048928 (Thread-1): finished collecting timing info
2020-11-05 17:56:56.161450 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 17:56:56.165949 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 17:56:56.166450 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 17:56:56.166450 (Thread-1): Opening a new connection, currently in state init
2020-11-05 17:56:58.178508 (Thread-1): SQL status: SUCCESS 1 in 2.01 seconds
2020-11-05 17:56:58.179507 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 17:56:58.180508 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 17:56:59.180954 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2020-11-05 17:56:59.186454 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 17:56:59.187455 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 17:56:59.188455 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 17:56:59.335551 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-11-05 17:56:59.480570 (Thread-1): finished collecting timing info
2020-11-05 17:56:59.482070 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 17:56:59.745105 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c63f6b72-83f2-4e46-9996-edd16323ec8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C5B9C87F0>]}
2020-11-05 17:56:59.748601 (Thread-1): 18:56:59 | 1 of 6 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 3.79s]
2020-11-05 17:56:59.763603 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 17:56:59.764103 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 17:56:59.767102 (Thread-1): 18:56:59 | 2 of 6 START table model cko_dbt_am.pageviews_extract_ephemere....... [RUN]
2020-11-05 17:56:59.770105 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 17:56:59.770604 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 17:56:59.798107 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 17:56:59.800107 (Thread-1): finished collecting timing info
2020-11-05 17:56:59.815610 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 17:56:59.820109 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 17:56:59.820610 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: BEGIN
2020-11-05 17:56:59.820610 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 17:57:01.064608 (Thread-1): SQL status: SUCCESS 1 in 1.24 seconds
2020-11-05 17:57:01.066625 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 17:57:01.070618 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract_ephemere"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract_ephemere  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
      );
2020-11-05 17:57:03.700088 (Thread-1): SQL status: SUCCESS 1 in 2.63 seconds
2020-11-05 17:57:03.706089 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 17:57:03.708087 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 17:57:03.709089 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 17:57:03.852886 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 17:57:03.865887 (Thread-1): finished collecting timing info
2020-11-05 17:57:03.867887 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: Close
2020-11-05 17:57:04.110875 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c63f6b72-83f2-4e46-9996-edd16323ec8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C5B9E6070>]}
2020-11-05 17:57:04.117875 (Thread-1): 18:57:04 | 2 of 6 OK created table model cko_dbt_am.pageviews_extract_ephemere.. [SUCCESS 1 in 4.34s]
2020-11-05 17:57:04.119875 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 17:57:04.121875 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 17:57:04.129879 (Thread-1): 18:57:04 | 3 of 6 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 17:57:04.132875 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 17:57:04.134877 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 17:57:04.180924 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 17:57:04.184408 (Thread-1): finished collecting timing info
2020-11-05 17:57:04.220925 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 17:57:04.232925 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 17:57:04.233926 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 17:57:04.234926 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 17:57:06.236151 (Thread-1): SQL status: SUCCESS 1 in 2.00 seconds
2020-11-05 17:57:06.236151 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 17:57:06.237151 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 17:57:09.784802 (Thread-1): SQL status: SUCCESS 1 in 3.55 seconds
2020-11-05 17:57:09.786803 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 17:57:09.787302 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 17:57:09.787302 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 17:57:09.939821 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-11-05 17:57:09.944321 (Thread-1): finished collecting timing info
2020-11-05 17:57:09.944820 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 17:57:10.132868 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c63f6b72-83f2-4e46-9996-edd16323ec8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C5B9E6820>]}
2020-11-05 17:57:10.134868 (Thread-1): 18:57:10 | 3 of 6 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 6.00s]
2020-11-05 17:57:10.136869 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 17:57:10.137869 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 17:57:10.139869 (Thread-1): 18:57:10 | 4 of 6 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 17:57:10.140869 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 17:57:10.141869 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 17:57:10.158878 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 17:57:10.160380 (Thread-1): finished collecting timing info
2020-11-05 17:57:10.170887 (Thread-1): Dropping relation "ANALYTICS"."CKO_DBT_AM"."USERS_EXTRACT" because it is of type view
2020-11-05 17:57:10.186888 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 17:57:10.187889 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */
drop view if exists "ANALYTICS"."CKO_DBT_AM"."USERS_EXTRACT" cascade
2020-11-05 17:57:10.187889 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 17:57:11.202267 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2020-11-05 17:57:11.208267 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 17:57:11.214269 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 17:57:11.215267 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 17:57:11.427861 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-11-05 17:57:11.428862 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 17:57:11.429361 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 17:57:13.274111 (Thread-1): SQL status: SUCCESS 1 in 1.84 seconds
2020-11-05 17:57:13.279096 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 17:57:13.280113 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 17:57:13.280113 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 17:57:13.432882 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-11-05 17:57:13.443882 (Thread-1): finished collecting timing info
2020-11-05 17:57:13.444882 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 17:57:13.662845 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c63f6b72-83f2-4e46-9996-edd16323ec8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C5BB31BB0>]}
2020-11-05 17:57:13.669845 (Thread-1): 18:57:13 | 4 of 6 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 3.52s]
2020-11-05 17:57:13.672829 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 17:57:13.673847 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 17:57:13.682848 (Thread-1): 18:57:13 | 5 of 6 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 17:57:13.684847 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 17:57:13.685846 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 17:57:13.754846 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 17:57:13.758847 (Thread-1): finished collecting timing info
2020-11-05 17:57:13.966781 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 17:57:13.981781 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 17:57:13.982782 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 17:57:13.982782 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 17:57:16.290370 (Thread-1): SQL status: SUCCESS 1 in 2.31 seconds
2020-11-05 17:57:16.291370 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 17:57:16.291868 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 17:57:16.953331 (Thread-1): SQL status: SUCCESS 1 in 0.66 seconds
2020-11-05 17:57:16.958348 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 17:57:16.958348 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 17:57:16.959347 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 17:57:17.284317 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2020-11-05 17:57:17.302367 (Thread-1): finished collecting timing info
2020-11-05 17:57:17.304352 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 17:57:17.617690 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c63f6b72-83f2-4e46-9996-edd16323ec8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C5BB2E370>]}
2020-11-05 17:57:17.624690 (Thread-1): 18:57:17 | 5 of 6 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 3.93s]
2020-11-05 17:57:17.626691 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 17:57:17.627691 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 17:57:17.633691 (Thread-1): 18:57:17 | 6 of 6 START table model cko_dbt_am.users_extract_Ephemere........... [RUN]
2020-11-05 17:57:17.639675 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 17:57:17.640694 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 17:57:17.697205 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 17:57:17.700705 (Thread-1): finished collecting timing info
2020-11-05 17:57:17.726717 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 17:57:17.733718 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 17:57:17.733718 (Thread-1): On model.cko_dbt_am.users_extract_Ephemere: BEGIN
2020-11-05 17:57:17.734718 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 17:57:19.999436 (Thread-1): SQL status: SUCCESS 1 in 2.26 seconds
2020-11-05 17:57:20.000452 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 17:57:20.000452 (Thread-1): On model.cko_dbt_am.users_extract_Ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract_Ephemere"} */


      create or replace transient table analytics.cko_dbt_am.users_extract_Ephemere  as
      (-- Use the `ref` function to select from other models


select *
From "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"

where user_id in (Select Distinct user_id FROM analytics.cko_dbt_am.pageviews_extract_ephemere)
      );
2020-11-05 17:57:21.595695 (Thread-1): SQL status: SUCCESS 1 in 1.59 seconds
2020-11-05 17:57:21.600695 (Thread-1): On model.cko_dbt_am.users_extract_Ephemere: COMMIT
2020-11-05 17:57:21.601696 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 17:57:21.602695 (Thread-1): On model.cko_dbt_am.users_extract_Ephemere: COMMIT
2020-11-05 17:57:21.763298 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2020-11-05 17:57:21.775300 (Thread-1): finished collecting timing info
2020-11-05 17:57:21.776799 (Thread-1): On model.cko_dbt_am.users_extract_Ephemere: Close
2020-11-05 17:57:22.041061 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c63f6b72-83f2-4e46-9996-edd16323ec8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C5BAE5550>]}
2020-11-05 17:57:22.048563 (Thread-1): 18:57:22 | 6 of 6 OK created table model cko_dbt_am.users_extract_Ephemere...... [SUCCESS 1 in 4.40s]
2020-11-05 17:57:22.102569 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 17:57:22.112569 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 17:57:22.114071 (MainThread): Using snowflake connection "master".
2020-11-05 17:57:22.115070 (MainThread): On master: BEGIN
2020-11-05 17:57:22.115570 (MainThread): Opening a new connection, currently in state closed
2020-11-05 17:57:23.688456 (MainThread): SQL status: SUCCESS 1 in 1.57 seconds
2020-11-05 17:57:23.689458 (MainThread): On master: COMMIT
2020-11-05 17:57:23.689458 (MainThread): Using snowflake connection "master".
2020-11-05 17:57:23.690456 (MainThread): On master: COMMIT
2020-11-05 17:57:23.963394 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2020-11-05 17:57:23.963394 (MainThread): On master: Close
2020-11-05 17:57:24.170431 (MainThread): 18:57:24 | 
2020-11-05 17:57:24.171431 (MainThread): 18:57:24 | Finished running 5 table models, 1 view model in 37.00s.
2020-11-05 17:57:24.171431 (MainThread): Connection 'master' was properly closed.
2020-11-05 17:57:24.171431 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 17:57:24.172431 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 17:57:24.172431 (MainThread): Connection 'model.cko_dbt_am.users_extract_Ephemere' was properly closed.
2020-11-05 17:57:24.212433 (MainThread): 
2020-11-05 17:57:24.218433 (MainThread): Completed successfully
2020-11-05 17:57:24.221434 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2020-11-05 17:57:24.223433 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C5BAFF310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C5BAFF550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C5BAFF340>]}
2020-11-05 17:57:24.223433 (MainThread): Flushing usage events
2020-11-05 18:00:21.463008 (MainThread): Running with dbt=0.18.1
2020-11-05 18:00:21.715363 (MainThread): Loading KWallet
2020-11-05 18:00:21.718354 (MainThread): Loading SecretService
2020-11-05 18:00:21.722351 (MainThread): Loading Windows
2020-11-05 18:00:21.917391 (MainThread): Loading chainer
2020-11-05 18:00:21.919392 (MainThread): Loading macOS
2020-11-05 18:00:22.775055 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 18:00:22.777554 (MainThread): Tracking: tracking
2020-11-05 18:00:22.778055 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C87CA74C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C87CA587F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C87CA58E20>]}
2020-11-05 18:00:22.848563 (MainThread): Partial parsing not enabled
2020-11-05 18:00:22.852063 (MainThread): Parsing macros\adapters.sql
2020-11-05 18:00:22.935074 (MainThread): Parsing macros\catalog.sql
2020-11-05 18:00:22.941077 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 18:00:22.968079 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 18:00:22.973580 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 18:00:22.985080 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 18:00:22.996582 (MainThread): Parsing macros\core.sql
2020-11-05 18:00:23.007099 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 18:00:23.154157 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 18:00:23.239199 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 18:00:23.247199 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 18:00:23.260201 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 18:00:23.275201 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 18:00:23.288203 (MainThread): Parsing macros\etc\query.sql
2020-11-05 18:00:23.297203 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 18:00:23.368247 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 18:00:23.486290 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 18:00:23.500293 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 18:00:23.551310 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 18:00:23.723374 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 18:00:23.935413 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 18:00:23.952947 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 18:00:24.097484 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 18:00:24.193511 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 18:00:24.242025 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 18:00:24.298033 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 18:00:24.321051 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 18:00:24.333537 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 18:00:24.348539 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 18:00:24.397545 (MainThread): Partial parsing not enabled
2020-11-05 18:00:24.670598 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:00:24.814153 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:00:24.886686 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:00:24.959711 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 18:00:25.035732 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:00:25.106752 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 18:00:26.558332 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 18:00:26.926459 (MainThread): Found 6 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 18:00:26.934461 (MainThread): 
2020-11-05 18:00:26.937460 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 18:00:27.001492 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 18:00:27.099013 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 18:00:27.099513 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 18:00:27.100013 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 18:00:29.458122 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.36 seconds
2020-11-05 18:00:29.485140 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 18:00:30.004962 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 18:00:30.046486 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 18:00:30.046486 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 18:00:30.047486 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 18:00:31.624472 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.58 seconds
2020-11-05 18:00:31.658489 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 18:00:31.987923 (MainThread): Using snowflake connection "master".
2020-11-05 18:00:31.988923 (MainThread): On master: BEGIN
2020-11-05 18:00:31.988923 (MainThread): Opening a new connection, currently in state init
2020-11-05 18:00:33.678322 (MainThread): SQL status: SUCCESS 1 in 1.69 seconds
2020-11-05 18:00:33.679305 (MainThread): On master: COMMIT
2020-11-05 18:00:33.680306 (MainThread): Using snowflake connection "master".
2020-11-05 18:00:33.681304 (MainThread): On master: COMMIT
2020-11-05 18:00:34.025649 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2020-11-05 18:00:34.026650 (MainThread): On master: Close
2020-11-05 18:00:34.359861 (MainThread): 19:00:34 | Concurrency: 1 threads (target='dev')
2020-11-05 18:00:34.361861 (MainThread): 19:00:34 | 
2020-11-05 18:00:34.399874 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 18:00:34.407874 (Thread-1): 19:00:34 | 1 of 6 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 18:00:34.409883 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:00:34.410879 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 18:00:34.556902 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 18:00:34.560401 (Thread-1): finished collecting timing info
2020-11-05 18:00:34.808977 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 18:00:34.816978 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:00:34.817976 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 18:00:34.818477 (Thread-1): Opening a new connection, currently in state init
2020-11-05 18:00:36.400524 (Thread-1): SQL status: SUCCESS 1 in 1.58 seconds
2020-11-05 18:00:36.401524 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:00:36.401524 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 18:00:38.113714 (Thread-1): SQL status: SUCCESS 1 in 1.71 seconds
2020-11-05 18:00:38.118714 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 18:00:38.120713 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:00:38.120713 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 18:00:38.277165 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2020-11-05 18:00:38.357695 (Thread-1): finished collecting timing info
2020-11-05 18:00:38.358695 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 18:00:38.566464 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fedb8d0-2472-451f-a83e-783e4e37087f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C87D0C64C0>]}
2020-11-05 18:00:38.573466 (Thread-1): 19:00:38 | 1 of 6 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 4.16s]
2020-11-05 18:00:38.576464 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 18:00:38.577466 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 18:00:38.587978 (Thread-1): 19:00:38 | 2 of 6 START table model cko_dbt_am.pageviews_extract_ephemere....... [RUN]
2020-11-05 18:00:38.594978 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 18:00:38.602984 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 18:00:38.658981 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 18:00:38.664494 (Thread-1): finished collecting timing info
2020-11-05 18:00:38.694497 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 18:00:38.702998 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 18:00:38.703998 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: BEGIN
2020-11-05 18:00:38.704497 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:00:40.738229 (Thread-1): SQL status: SUCCESS 1 in 2.03 seconds
2020-11-05 18:00:40.739256 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 18:00:40.739756 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract_ephemere"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract_ephemere  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
      );
2020-11-05 18:00:46.372934 (Thread-1): SQL status: SUCCESS 1 in 5.63 seconds
2020-11-05 18:00:46.377946 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 18:00:46.378945 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 18:00:46.378945 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 18:00:46.576508 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-11-05 18:00:46.588509 (Thread-1): finished collecting timing info
2020-11-05 18:00:46.589509 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: Close
2020-11-05 18:00:46.814370 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fedb8d0-2472-451f-a83e-783e4e37087f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C87D0C0580>]}
2020-11-05 18:00:46.821369 (Thread-1): 19:00:46 | 2 of 6 OK created table model cko_dbt_am.pageviews_extract_ephemere.. [SUCCESS 1 in 8.22s]
2020-11-05 18:00:46.825354 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 18:00:46.826353 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 18:00:46.835356 (Thread-1): 19:00:46 | 3 of 6 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 18:00:46.838356 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:00:46.839354 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 18:00:46.890914 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 18:00:46.894898 (Thread-1): finished collecting timing info
2020-11-05 18:00:46.922902 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 18:00:46.935901 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:00:46.936902 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 18:00:46.936902 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:00:48.764539 (Thread-1): SQL status: SUCCESS 1 in 1.83 seconds
2020-11-05 18:00:48.765538 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:00:48.765538 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 18:00:52.054334 (Thread-1): SQL status: SUCCESS 1 in 3.29 seconds
2020-11-05 18:00:52.059334 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 18:00:52.059334 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:00:52.060334 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 18:00:52.276419 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2020-11-05 18:00:52.288433 (Thread-1): finished collecting timing info
2020-11-05 18:00:52.289933 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 18:00:52.573504 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fedb8d0-2472-451f-a83e-783e4e37087f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C87CF5ED60>]}
2020-11-05 18:00:52.584523 (Thread-1): 19:00:52 | 3 of 6 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 5.73s]
2020-11-05 18:00:52.592522 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 18:00:52.594523 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 18:00:52.608534 (Thread-1): 19:00:52 | 4 of 6 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 18:00:52.619538 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:00:52.619538 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 18:00:52.722055 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 18:00:52.742558 (Thread-1): finished collecting timing info
2020-11-05 18:00:52.798065 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 18:00:52.804565 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:00:52.805566 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 18:00:52.806067 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:00:54.358156 (Thread-1): SQL status: SUCCESS 1 in 1.55 seconds
2020-11-05 18:00:54.359174 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:00:54.359174 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 18:00:56.216254 (Thread-1): SQL status: SUCCESS 1 in 1.86 seconds
2020-11-05 18:00:56.221254 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 18:00:56.222255 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:00:56.222753 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 18:00:56.384299 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2020-11-05 18:00:56.395301 (Thread-1): finished collecting timing info
2020-11-05 18:00:56.396312 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 18:00:56.600411 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fedb8d0-2472-451f-a83e-783e4e37087f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C87D0E4EB0>]}
2020-11-05 18:00:56.608413 (Thread-1): 19:00:56 | 4 of 6 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 3.98s]
2020-11-05 18:00:56.615408 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 18:00:56.617410 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 18:00:56.628413 (Thread-1): 19:00:56 | 5 of 6 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 18:00:56.639413 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:00:56.640411 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 18:00:56.719429 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 18:00:56.724430 (Thread-1): finished collecting timing info
2020-11-05 18:00:56.905451 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 18:00:56.931956 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:00:56.932955 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 18:00:56.933455 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:00:58.064269 (Thread-1): SQL status: SUCCESS 1 in 1.13 seconds
2020-11-05 18:00:58.065271 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:00:58.065271 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 18:00:58.746508 (Thread-1): SQL status: SUCCESS 1 in 0.68 seconds
2020-11-05 18:00:58.751510 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 18:00:58.751510 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:00:58.752508 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 18:00:58.904299 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-11-05 18:00:58.924301 (Thread-1): finished collecting timing info
2020-11-05 18:00:58.925299 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 18:00:59.156907 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fedb8d0-2472-451f-a83e-783e4e37087f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C87D0E4B80>]}
2020-11-05 18:00:59.163910 (Thread-1): 19:00:59 | 5 of 6 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 2.52s]
2020-11-05 18:00:59.166909 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 18:00:59.168909 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 18:00:59.178910 (Thread-1): 19:00:59 | 6 of 6 START table model cko_dbt_am.users_extract_Ephemere........... [RUN]
2020-11-05 18:00:59.190911 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 18:00:59.191912 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 18:00:59.246953 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 18:00:59.249946 (Thread-1): finished collecting timing info
2020-11-05 18:00:59.275950 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 18:00:59.283948 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 18:00:59.283948 (Thread-1): On model.cko_dbt_am.users_extract_Ephemere: BEGIN
2020-11-05 18:00:59.284950 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:01:01.235624 (Thread-1): SQL status: SUCCESS 1 in 1.95 seconds
2020-11-05 18:01:01.236624 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 18:01:01.236624 (Thread-1): On model.cko_dbt_am.users_extract_Ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract_Ephemere"} */


      create or replace transient table analytics.cko_dbt_am.users_extract_Ephemere  as
      (-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM analytics.cko_dbt_am.pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"

where user_id in (SELECT user_id FROM active_user)
      );
2020-11-05 18:01:03.338620 (Thread-1): SQL status: SUCCESS 1 in 2.10 seconds
2020-11-05 18:01:03.343621 (Thread-1): On model.cko_dbt_am.users_extract_Ephemere: COMMIT
2020-11-05 18:01:03.344621 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 18:01:03.345621 (Thread-1): On model.cko_dbt_am.users_extract_Ephemere: COMMIT
2020-11-05 18:01:03.521088 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-11-05 18:01:03.532088 (Thread-1): finished collecting timing info
2020-11-05 18:01:03.533088 (Thread-1): On model.cko_dbt_am.users_extract_Ephemere: Close
2020-11-05 18:01:04.108712 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fedb8d0-2472-451f-a83e-783e4e37087f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C87D0E4F10>]}
2020-11-05 18:01:04.114712 (Thread-1): 19:01:04 | 6 of 6 OK created table model cko_dbt_am.users_extract_Ephemere...... [SUCCESS 1 in 4.92s]
2020-11-05 18:01:04.117775 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 18:01:04.128785 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 18:01:04.130784 (MainThread): Using snowflake connection "master".
2020-11-05 18:01:04.130784 (MainThread): On master: BEGIN
2020-11-05 18:01:04.131785 (MainThread): Opening a new connection, currently in state closed
2020-11-05 18:01:06.454979 (MainThread): SQL status: SUCCESS 1 in 2.32 seconds
2020-11-05 18:01:06.454979 (MainThread): On master: COMMIT
2020-11-05 18:01:06.455978 (MainThread): Using snowflake connection "master".
2020-11-05 18:01:06.456978 (MainThread): On master: COMMIT
2020-11-05 18:01:07.326756 (MainThread): SQL status: SUCCESS 1 in 0.87 seconds
2020-11-05 18:01:07.327755 (MainThread): On master: Close
2020-11-05 18:01:07.799936 (MainThread): 19:01:07 | 
2020-11-05 18:01:07.801935 (MainThread): 19:01:07 | Finished running 5 table models, 1 view model in 40.86s.
2020-11-05 18:01:07.809937 (MainThread): Connection 'master' was properly closed.
2020-11-05 18:01:07.810437 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 18:01:07.810936 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 18:01:07.811437 (MainThread): Connection 'model.cko_dbt_am.users_extract_Ephemere' was properly closed.
2020-11-05 18:01:07.942471 (MainThread): 
2020-11-05 18:01:07.951471 (MainThread): Completed successfully
2020-11-05 18:01:07.961474 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2020-11-05 18:01:07.965974 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C87D10C6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C87D10CB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C87D10CB80>]}
2020-11-05 18:01:07.967474 (MainThread): Flushing usage events
2020-11-05 18:23:37.257341 (MainThread): Running with dbt=0.18.1
2020-11-05 18:23:38.296066 (MainThread): Loading KWallet
2020-11-05 18:23:38.303081 (MainThread): Loading SecretService
2020-11-05 18:23:38.309820 (MainThread): Loading Windows
2020-11-05 18:23:38.927378 (MainThread): Loading chainer
2020-11-05 18:23:38.932396 (MainThread): Loading macOS
2020-11-05 18:23:41.405634 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 18:23:41.410134 (MainThread): Tracking: tracking
2020-11-05 18:23:41.411635 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E7D0C4940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E7D0AC7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E7D0ACDF0>]}
2020-11-05 18:23:41.484116 (MainThread): Partial parsing not enabled
2020-11-05 18:23:41.489110 (MainThread): Parsing macros\adapters.sql
2020-11-05 18:23:41.605032 (MainThread): Parsing macros\catalog.sql
2020-11-05 18:23:41.614049 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 18:23:41.658048 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 18:23:41.668037 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 18:23:41.686057 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 18:23:41.705342 (MainThread): Parsing macros\core.sql
2020-11-05 18:23:41.723408 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 18:23:41.902893 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 18:23:41.942895 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 18:23:41.947894 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 18:23:41.954896 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 18:23:41.963883 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 18:23:41.970896 (MainThread): Parsing macros\etc\query.sql
2020-11-05 18:23:41.975438 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 18:23:42.010982 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 18:23:42.065972 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 18:23:42.074774 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 18:23:42.100457 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 18:23:42.184096 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 18:23:42.290104 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 18:23:42.297596 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 18:23:42.367974 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 18:23:42.395502 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 18:23:42.416720 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 18:23:42.444710 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 18:23:42.456723 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 18:23:42.464711 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 18:23:42.472725 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 18:23:42.500228 (MainThread): Partial parsing not enabled
2020-11-05 18:23:42.638260 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:23:42.720281 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:23:42.765284 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:23:42.804556 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 18:23:42.844561 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 18:23:42.862561 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E7D12FCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E7D2B7EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E7D2B7B50>]}
2020-11-05 18:23:42.862561 (MainThread): Flushing usage events
2020-11-05 18:23:45.056004 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-05 18:23:45.057005 (MainThread): Encountered an error:
2020-11-05 18:23:45.058005 (MainThread): Compilation Error in model pageviews_history (models\pageviews_history.sql)
  expected token ')', got 'integer'
    line 6
      {% if (SELECT 1
2020-11-05 18:23:45.081619 (MainThread): Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 496, in catch_jinja
    yield
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 6, in template
jinja2.exceptions.TemplateSyntaxError: expected token ')', got 'integer'
  line 6
    {% if (SELECT 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\main.py", line 255, in run_from_args
    results = task.run()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\runnable.py", line 399, in run
    self._runtime_initialize()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 748, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 349, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 204, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 177, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\parser\base.py", line 429, in parse_file
    self.parse_node(file_block)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\parser\base.py", line 402, in parse_node
    self.render_update(node, config)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\parser\base.py", line 377, in render_update
    self.render_with_context(node, config)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\parser\base.py", line 288, in render_with_context
    get_rendered(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 570, in get_rendered
    template = get_template(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "c:\users\alexandre\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model pageviews_history (models\pageviews_history.sql)
  expected token ')', got 'integer'
    line 6
      {% if (SELECT 1

2020-11-05 18:26:45.096583 (MainThread): Running with dbt=0.18.1
2020-11-05 18:26:45.454539 (MainThread): Loading KWallet
2020-11-05 18:26:45.460538 (MainThread): Loading SecretService
2020-11-05 18:26:45.467540 (MainThread): Loading Windows
2020-11-05 18:26:46.016227 (MainThread): Loading chainer
2020-11-05 18:26:46.019226 (MainThread): Loading macOS
2020-11-05 18:26:47.676003 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 18:26:47.679015 (MainThread): Tracking: tracking
2020-11-05 18:26:47.679015 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6B21F5EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6B21E5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6B21E5D60>]}
2020-11-05 18:26:47.800061 (MainThread): Partial parsing not enabled
2020-11-05 18:26:47.809078 (MainThread): Parsing macros\adapters.sql
2020-11-05 18:26:48.051145 (MainThread): Parsing macros\catalog.sql
2020-11-05 18:26:48.067146 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 18:26:48.145182 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 18:26:48.162183 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 18:26:48.203213 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 18:26:48.234208 (MainThread): Parsing macros\core.sql
2020-11-05 18:26:48.263227 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 18:26:48.645351 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 18:26:48.732370 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 18:26:48.740873 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 18:26:48.755890 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 18:26:48.771392 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 18:26:48.785379 (MainThread): Parsing macros\etc\query.sql
2020-11-05 18:26:48.794380 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 18:26:48.867389 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 18:26:48.979903 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 18:26:48.995405 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 18:26:49.052436 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 18:26:49.218494 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 18:26:49.427562 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 18:26:49.441560 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 18:26:49.571633 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 18:26:49.625171 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 18:26:49.666159 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 18:26:49.718183 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 18:26:49.741185 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 18:26:49.754204 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 18:26:49.769187 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 18:26:49.818238 (MainThread): Partial parsing not enabled
2020-11-05 18:26:50.106311 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:26:50.303851 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:26:50.339857 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:26:50.375861 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 18:26:50.412865 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 18:26:50.423867 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6B225DCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6B23E6EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6B23E6B50>]}
2020-11-05 18:26:50.424367 (MainThread): Flushing usage events
2020-11-05 18:26:51.936572 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-05 18:26:51.937573 (MainThread): Encountered an error:
2020-11-05 18:26:51.938557 (MainThread): Compilation Error in model pageviews_history (models\pageviews_history.sql)
  expected token ')', got 'integer'
    line 6
      {% if (SELECT 1
2020-11-05 18:26:51.959569 (MainThread): Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 496, in catch_jinja
    yield
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 6, in template
jinja2.exceptions.TemplateSyntaxError: expected token ')', got 'integer'
  line 6
    {% if (SELECT 1

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\main.py", line 255, in run_from_args
    results = task.run()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\runnable.py", line 399, in run
    self._runtime_initialize()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 748, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 349, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 204, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 177, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\parser\base.py", line 429, in parse_file
    self.parse_node(file_block)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\parser\base.py", line 402, in parse_node
    self.render_update(node, config)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\parser\base.py", line 377, in render_update
    self.render_with_context(node, config)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\parser\base.py", line 288, in render_with_context
    get_rendered(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 570, in get_rendered
    template = get_template(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "c:\users\alexandre\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model pageviews_history (models\pageviews_history.sql)
  expected token ')', got 'integer'
    line 6
      {% if (SELECT 1

2020-11-05 18:33:09.378295 (MainThread): Running with dbt=0.18.1
2020-11-05 18:33:09.764844 (MainThread): Loading KWallet
2020-11-05 18:33:09.767844 (MainThread): Loading SecretService
2020-11-05 18:33:09.771346 (MainThread): Loading Windows
2020-11-05 18:33:10.007376 (MainThread): Loading chainer
2020-11-05 18:33:10.009376 (MainThread): Loading macOS
2020-11-05 18:33:11.351547 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 18:33:11.354547 (MainThread): Tracking: tracking
2020-11-05 18:33:11.356048 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002528BF94E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002528BF85730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002528BF85DC0>]}
2020-11-05 18:33:11.455060 (MainThread): Partial parsing not enabled
2020-11-05 18:33:11.461561 (MainThread): Parsing macros\adapters.sql
2020-11-05 18:33:11.595577 (MainThread): Parsing macros\catalog.sql
2020-11-05 18:33:11.602077 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 18:33:11.633583 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 18:33:11.641084 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 18:33:11.657085 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 18:33:11.672090 (MainThread): Parsing macros\core.sql
2020-11-05 18:33:11.685588 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 18:33:11.828607 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 18:33:11.855109 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 18:33:11.859111 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 18:33:11.865111 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 18:33:11.874612 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 18:33:11.880113 (MainThread): Parsing macros\etc\query.sql
2020-11-05 18:33:11.884614 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 18:33:11.917118 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 18:33:11.961124 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 18:33:11.969125 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 18:33:11.995629 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 18:33:12.061136 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 18:33:12.149148 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 18:33:12.154648 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 18:33:12.206154 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 18:33:12.227658 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 18:33:12.245160 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 18:33:12.264162 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 18:33:12.273665 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 18:33:12.280165 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 18:33:12.287165 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 18:33:12.309168 (MainThread): Partial parsing not enabled
2020-11-05 18:33:12.421684 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:33:12.484190 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:33:12.519696 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:33:12.546698 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 18:33:12.574700 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 18:33:12.605706 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_load".
2020-11-05 18:33:12.643210 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:33:12.674215 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 18:33:13.335798 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002528C14CF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002528C126190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002528C2E4E20>]}
2020-11-05 18:33:13.336299 (MainThread): Flushing usage events
2020-11-05 18:33:14.324450 (MainThread): Connection 'model.cko_dbt_am.users_extract_Ephemere' was properly closed.
2020-11-05 18:33:14.324951 (MainThread): Encountered an error:
2020-11-05 18:33:14.342453 (MainThread): Compilation Error in model pageviews_history_load (models\pageviews_history_load.sql)
  Model 'model.cko_dbt_am.pageviews_history_load' (models\pageviews_history_load.sql) depends on a node named 'users_extract_ephemere' which was not found
2020-11-05 18:33:14.352954 (MainThread): Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\main.py", line 255, in run_from_args
    results = task.run()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\runnable.py", line 399, in run
    self._runtime_initialize()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 748, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 351, in load_all
    manifest = loader.create_manifest()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 327, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 298, in process_manifest
    process_refs(manifest, project_name)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 644, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 626, in _process_refs_for_node
    invalid_ref_fail_unless_test(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 383, in invalid_ref_fail_unless_test
    ref_target_not_found(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\exceptions.py", line 538, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model pageviews_history_load (models\pageviews_history_load.sql)
  Model 'model.cko_dbt_am.pageviews_history_load' (models\pageviews_history_load.sql) depends on a node named 'users_extract_ephemere' which was not found

2020-11-05 18:34:29.979690 (MainThread): Running with dbt=0.18.1
2020-11-05 18:34:30.246974 (MainThread): Loading KWallet
2020-11-05 18:34:30.248974 (MainThread): Loading SecretService
2020-11-05 18:34:30.251974 (MainThread): Loading Windows
2020-11-05 18:34:30.468507 (MainThread): Loading chainer
2020-11-05 18:34:30.470008 (MainThread): Loading macOS
2020-11-05 18:34:31.387688 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 18:34:31.392685 (MainThread): Tracking: tracking
2020-11-05 18:34:31.393671 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211B589AAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211B589A670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211B589AD30>]}
2020-11-05 18:34:31.534763 (MainThread): Partial parsing not enabled
2020-11-05 18:34:31.543752 (MainThread): Parsing macros\adapters.sql
2020-11-05 18:34:31.765812 (MainThread): Parsing macros\catalog.sql
2020-11-05 18:34:31.790813 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 18:34:31.863882 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 18:34:31.879869 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 18:34:31.916382 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 18:34:31.950894 (MainThread): Parsing macros\core.sql
2020-11-05 18:34:31.981895 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 18:34:32.323031 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 18:34:32.396072 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 18:34:32.405085 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 18:34:32.419102 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 18:34:32.435125 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 18:34:32.448126 (MainThread): Parsing macros\etc\query.sql
2020-11-05 18:34:32.458129 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 18:34:32.535160 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 18:34:32.647189 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 18:34:32.663192 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 18:34:32.716707 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 18:34:32.877250 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 18:34:33.092337 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 18:34:33.107363 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 18:34:33.246406 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 18:34:33.297425 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 18:34:33.337460 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 18:34:33.390478 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 18:34:33.413490 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 18:34:33.426529 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 18:34:33.442516 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 18:34:33.492518 (MainThread): Partial parsing not enabled
2020-11-05 18:34:33.764741 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:34:33.909312 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:34:33.984307 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:34:34.065335 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 18:34:34.148362 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 18:34:34.230381 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_load".
2020-11-05 18:34:34.314410 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:34:34.393452 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 18:34:35.852074 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 18:34:36.262909 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 18:34:36.271911 (MainThread): 
2020-11-05 18:34:36.276909 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 18:34:36.365429 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 18:34:36.460811 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 18:34:36.461311 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 18:34:36.461811 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 18:34:38.215004 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.75 seconds
2020-11-05 18:34:38.248846 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 18:34:38.576727 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 18:34:38.621254 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 18:34:38.622254 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 18:34:38.623253 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 18:34:40.167255 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.54 seconds
2020-11-05 18:34:40.199256 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 18:34:40.447080 (MainThread): Using snowflake connection "master".
2020-11-05 18:34:40.448079 (MainThread): On master: BEGIN
2020-11-05 18:34:40.449079 (MainThread): Opening a new connection, currently in state init
2020-11-05 18:34:42.297455 (MainThread): SQL status: SUCCESS 1 in 1.85 seconds
2020-11-05 18:34:42.298455 (MainThread): On master: COMMIT
2020-11-05 18:34:42.299454 (MainThread): Using snowflake connection "master".
2020-11-05 18:34:42.299454 (MainThread): On master: COMMIT
2020-11-05 18:34:42.733504 (MainThread): SQL status: SUCCESS 1 in 0.43 seconds
2020-11-05 18:34:42.735505 (MainThread): On master: Close
2020-11-05 18:34:42.953032 (MainThread): 19:34:42 | Concurrency: 1 threads (target='dev')
2020-11-05 18:34:42.954534 (MainThread): 19:34:42 | 
2020-11-05 18:34:43.123563 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 18:34:43.127064 (Thread-1): 19:34:43 | 1 of 8 START ephemere model cko_dbt_am.pageviews_extract_ephemere.... [RUN]
2020-11-05 18:34:43.128567 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 18:34:43.129066 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 18:34:43.195573 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 18:34:43.202573 (Thread-1): finished collecting timing info
2020-11-05 18:34:43.211574 (Thread-1): finished collecting timing info
2020-11-05 18:34:43.213076 (Thread-1): Compilation Error in model pageviews_extract_ephemere (models\pageviews_extract_ephemere.sql)
  No materialization 'ephemere' was found for adapter snowflake! (searched types 'default' and 'snowflake')
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 222, in execute
    missing_materialization(model, self.adapter.type())
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\exceptions.py", line 611, in missing_materialization
    raise_compiler_error(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model pageviews_extract_ephemere (models\pageviews_extract_ephemere.sql)
  No materialization 'ephemere' was found for adapter snowflake! (searched types 'default' and 'snowflake')
2020-11-05 18:34:43.219077 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94c08e0f-2459-4358-92fa-fe6da2958f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211B5E20370>]}
2020-11-05 18:34:43.222577 (Thread-1): 19:34:43 | 1 of 8 ERROR creating ephemere model cko_dbt_am.pageviews_extract_ephemere [ERROR in 0.09s]
2020-11-05 18:34:43.231578 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 18:34:43.234578 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 18:34:43.238078 (Thread-1): 19:34:43 | 2 of 8 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 18:34:43.241084 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:34:43.245079 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 18:34:43.285084 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 18:34:43.287584 (Thread-1): finished collecting timing info
2020-11-05 18:34:43.413600 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 18:34:43.418601 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:34:43.418601 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 18:34:43.419101 (Thread-1): Opening a new connection, currently in state init
2020-11-05 18:34:44.607324 (Thread-1): SQL status: SUCCESS 1 in 1.19 seconds
2020-11-05 18:34:44.607324 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:34:44.608324 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 18:34:46.529601 (Thread-1): SQL status: SUCCESS 1 in 1.92 seconds
2020-11-05 18:34:46.534602 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 18:34:46.535599 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:34:46.536599 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 18:34:46.767172 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-11-05 18:34:46.856688 (Thread-1): finished collecting timing info
2020-11-05 18:34:46.857688 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 18:34:47.106772 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94c08e0f-2459-4358-92fa-fe6da2958f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211B5E2B7F0>]}
2020-11-05 18:34:47.113784 (Thread-1): 19:34:47 | 2 of 8 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 3.86s]
2020-11-05 18:34:47.116784 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 18:34:47.117783 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 18:34:47.129784 (Thread-1): 19:34:47 | 3 of 8 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 18:34:47.132784 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:34:47.133785 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 18:34:47.202802 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 18:34:47.208302 (Thread-1): finished collecting timing info
2020-11-05 18:34:47.244307 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 18:34:47.254308 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:34:47.254809 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 18:34:47.255308 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:34:49.011153 (Thread-1): SQL status: SUCCESS 1 in 1.76 seconds
2020-11-05 18:34:49.012153 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:34:49.013154 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 18:34:52.981266 (Thread-1): SQL status: SUCCESS 1 in 3.97 seconds
2020-11-05 18:34:52.987267 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 18:34:52.988267 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:34:52.989267 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 18:34:53.139794 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-11-05 18:34:53.152798 (Thread-1): finished collecting timing info
2020-11-05 18:34:53.154298 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 18:34:53.346821 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94c08e0f-2459-4358-92fa-fe6da2958f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211B5F60C10>]}
2020-11-05 18:34:53.353321 (Thread-1): 19:34:53 | 3 of 8 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 6.21s]
2020-11-05 18:34:53.357322 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 18:34:53.358823 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 18:34:53.371325 (Thread-1): 19:34:53 | 4 of 8 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 18:34:53.373825 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:34:53.374824 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 18:34:53.423329 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 18:34:53.427833 (Thread-1): finished collecting timing info
2020-11-05 18:34:53.454834 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 18:34:53.463335 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:34:53.463836 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 18:34:53.464337 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:35:00.614565 (Thread-1): SQL status: SUCCESS 1 in 7.15 seconds
2020-11-05 18:35:00.614565 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:35:00.614565 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 18:35:02.610137 (Thread-1): SQL status: SUCCESS 1 in 1.99 seconds
2020-11-05 18:35:02.617133 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 18:35:02.619129 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:35:02.619640 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 18:35:02.753844 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2020-11-05 18:35:02.766845 (Thread-1): finished collecting timing info
2020-11-05 18:35:02.767846 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 18:35:02.975955 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94c08e0f-2459-4358-92fa-fe6da2958f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211B5B532B0>]}
2020-11-05 18:35:02.982941 (Thread-1): 19:35:02 | 4 of 8 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 9.60s]
2020-11-05 18:35:36.294285 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 18:35:36.295284 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 18:35:36.297284 (Thread-1): 19:35:36 | 5 of 8 SKIP relation cko_dbt_am.users_extract_Ephemere............... [SKIP]
2020-11-05 18:35:36.298284 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 18:35:36.300285 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 18:35:36.310285 (Thread-1): 19:35:36 | 6 of 8 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 18:35:36.313287 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:35:36.314287 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 18:35:36.387315 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 18:35:36.390315 (Thread-1): finished collecting timing info
2020-11-05 18:35:36.560846 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 18:35:36.571848 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:35:36.572349 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 18:35:36.572847 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:35:38.254121 (Thread-1): SQL status: SUCCESS 1 in 1.68 seconds
2020-11-05 18:35:38.255138 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:35:38.255638 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 18:35:38.678853 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2020-11-05 18:35:38.683853 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 18:35:38.684853 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:35:38.684853 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 18:35:38.824137 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 18:35:38.843152 (Thread-1): finished collecting timing info
2020-11-05 18:35:38.845153 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 18:35:39.147665 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94c08e0f-2459-4358-92fa-fe6da2958f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211B5E2BFD0>]}
2020-11-05 18:35:39.153665 (Thread-1): 19:35:39 | 6 of 8 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 2.83s]
2020-11-05 18:35:39.156354 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 18:35:39.157361 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_load
2020-11-05 18:35:39.158362 (Thread-1): 19:35:39 | 7 of 8 SKIP relation cko_dbt_am.pageviews_history_load............... [SKIP]
2020-11-05 18:35:39.160234 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_load
2020-11-05 18:35:39.164244 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-05 18:35:39.164743 (Thread-1): 19:35:39 | 8 of 8 SKIP relation cko_dbt_am.pageviews_history.................... [SKIP]
2020-11-05 18:35:39.166753 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-05 18:35:39.171262 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 18:35:39.172262 (MainThread): Using snowflake connection "master".
2020-11-05 18:35:39.172761 (MainThread): On master: BEGIN
2020-11-05 18:35:39.173261 (MainThread): Opening a new connection, currently in state closed
2020-11-05 18:35:40.903828 (MainThread): SQL status: SUCCESS 1 in 1.73 seconds
2020-11-05 18:35:40.904828 (MainThread): On master: COMMIT
2020-11-05 18:35:40.905829 (MainThread): Using snowflake connection "master".
2020-11-05 18:35:40.906828 (MainThread): On master: COMMIT
2020-11-05 18:35:41.191282 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2020-11-05 18:35:41.192284 (MainThread): On master: Close
2020-11-05 18:35:41.423883 (MainThread): 19:35:41 | 
2020-11-05 18:35:41.424883 (MainThread): 19:35:41 | Finished running 3 ephemere models, 4 table models, 1 view model in 65.15s.
2020-11-05 18:35:41.426377 (MainThread): Connection 'master' was properly closed.
2020-11-05 18:35:41.427386 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 18:35:41.427386 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 18:35:41.428387 (MainThread): Connection 'model.cko_dbt_am.my_second_dbt_model' was properly closed.
2020-11-05 18:35:41.572649 (MainThread): 
2020-11-05 18:35:41.574650 (MainThread): Completed with 1 error and 0 warnings:
2020-11-05 18:35:41.575650 (MainThread): 
2020-11-05 18:35:41.576649 (MainThread): Compilation Error in model pageviews_extract_ephemere (models\pageviews_extract_ephemere.sql)
2020-11-05 18:35:41.578649 (MainThread):   No materialization 'ephemere' was found for adapter snowflake! (searched types 'default' and 'snowflake')
2020-11-05 18:35:41.579650 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=3 TOTAL=8
2020-11-05 18:35:41.582652 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211B5F669D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211B5FB70D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211B5FB7940>]}
2020-11-05 18:35:41.587654 (MainThread): Flushing usage events
2020-11-05 18:38:48.002812 (MainThread): Running with dbt=0.18.1
2020-11-05 18:38:48.448868 (MainThread): Loading KWallet
2020-11-05 18:38:48.451367 (MainThread): Loading SecretService
2020-11-05 18:38:48.453871 (MainThread): Loading Windows
2020-11-05 18:38:48.654431 (MainThread): Loading chainer
2020-11-05 18:38:48.656431 (MainThread): Loading macOS
2020-11-05 18:38:49.719786 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 18:38:49.721787 (MainThread): Tracking: tracking
2020-11-05 18:38:49.722786 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABA3454DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABA343F850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABA343FE20>]}
2020-11-05 18:38:49.794301 (MainThread): Partial parsing not enabled
2020-11-05 18:38:49.797658 (MainThread): Parsing macros\adapters.sql
2020-11-05 18:38:49.908697 (MainThread): Parsing macros\catalog.sql
2020-11-05 18:38:49.914699 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 18:38:49.954684 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 18:38:49.960684 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 18:38:49.976686 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 18:38:49.992698 (MainThread): Parsing macros\core.sql
2020-11-05 18:38:50.008703 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 18:38:50.173728 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 18:38:50.212745 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 18:38:50.215745 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 18:38:50.224749 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 18:38:50.230747 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 18:38:50.239748 (MainThread): Parsing macros\etc\query.sql
2020-11-05 18:38:50.243746 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 18:38:50.277749 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 18:38:50.329765 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 18:38:50.339765 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 18:38:50.362767 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 18:38:50.439783 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 18:38:50.538816 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 18:38:50.543815 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 18:38:50.592342 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 18:38:50.610849 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 18:38:50.624850 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 18:38:50.641851 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 18:38:50.650852 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 18:38:50.654852 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 18:38:50.661837 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 18:38:50.680345 (MainThread): Partial parsing not enabled
2020-11-05 18:38:50.770876 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:38:50.821905 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:38:50.846923 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:38:50.872924 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 18:38:50.900942 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 18:38:50.929958 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_load".
2020-11-05 18:38:50.962945 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:38:50.989953 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 18:38:51.958326 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 18:38:52.360968 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 18:38:52.367985 (MainThread): 
2020-11-05 18:38:52.369970 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 18:38:52.418027 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 18:38:52.510068 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 18:38:52.511070 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 18:38:52.512069 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 18:38:54.606619 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.10 seconds
2020-11-05 18:38:54.634638 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 18:38:54.924550 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 18:38:54.966567 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 18:38:54.967566 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 18:38:54.967566 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 18:38:56.795272 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.83 seconds
2020-11-05 18:38:56.828271 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 18:38:57.060213 (MainThread): Using snowflake connection "master".
2020-11-05 18:38:57.061214 (MainThread): On master: BEGIN
2020-11-05 18:38:57.062214 (MainThread): Opening a new connection, currently in state init
2020-11-05 18:38:58.823612 (MainThread): SQL status: SUCCESS 1 in 1.76 seconds
2020-11-05 18:38:58.824612 (MainThread): On master: COMMIT
2020-11-05 18:38:58.825612 (MainThread): Using snowflake connection "master".
2020-11-05 18:38:58.825612 (MainThread): On master: COMMIT
2020-11-05 18:38:59.071707 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2020-11-05 18:38:59.072714 (MainThread): On master: Close
2020-11-05 18:38:59.292799 (MainThread): 19:38:59 | Concurrency: 1 threads (target='dev')
2020-11-05 18:38:59.303800 (MainThread): 19:38:59 | 
2020-11-05 18:38:59.350803 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 18:38:59.357316 (Thread-1): 19:38:59 | 1 of 5 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 18:38:59.360815 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:38:59.361816 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 18:38:59.576893 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 18:38:59.580393 (Thread-1): finished collecting timing info
2020-11-05 18:38:59.864929 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 18:38:59.873929 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:38:59.874930 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 18:38:59.875430 (Thread-1): Opening a new connection, currently in state init
2020-11-05 18:39:01.059259 (Thread-1): SQL status: SUCCESS 1 in 1.18 seconds
2020-11-05 18:39:01.059759 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:39:01.059759 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 18:39:02.046918 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2020-11-05 18:39:02.051902 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 18:39:02.052921 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:39:02.053917 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 18:39:02.199067 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-11-05 18:39:02.286093 (Thread-1): finished collecting timing info
2020-11-05 18:39:02.288096 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 18:39:02.499986 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd05b1b5a-0949-49a9-85fb-af21a472284a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABA39D5C70>]}
2020-11-05 18:39:02.506986 (Thread-1): 19:39:02 | 1 of 5 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 3.14s]
2020-11-05 18:39:02.508970 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 18:39:02.510988 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 18:39:02.514970 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 18:39:02.514970 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 18:39:02.560483 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 18:39:02.564486 (Thread-1): finished collecting timing info
2020-11-05 18:39:02.566986 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 18:39:02.567485 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 18:39:02.574487 (Thread-1): 19:39:02 | 2 of 5 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 18:39:02.575999 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:39:02.576998 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 18:39:02.627000 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 18:39:02.631002 (Thread-1): finished collecting timing info
2020-11-05 18:39:02.661015 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 18:39:02.671017 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:39:02.671518 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 18:39:02.672017 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:39:04.729134 (Thread-1): SQL status: SUCCESS 1 in 2.06 seconds
2020-11-05 18:39:04.730135 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:39:04.730135 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 18:39:09.783816 (Thread-1): SQL status: SUCCESS 1 in 5.05 seconds
2020-11-05 18:39:09.788819 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 18:39:09.789818 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:39:09.789818 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 18:39:09.934659 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 18:39:09.946171 (Thread-1): finished collecting timing info
2020-11-05 18:39:09.947671 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 18:39:10.170268 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd05b1b5a-0949-49a9-85fb-af21a472284a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABA39D54C0>]}
2020-11-05 18:39:10.176269 (Thread-1): 19:39:10 | 2 of 5 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 7.59s]
2020-11-05 18:39:10.179253 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 18:39:10.180254 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 18:39:10.186254 (Thread-1): 19:39:10 | 3 of 5 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 18:39:10.190271 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:39:10.191254 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 18:39:10.237273 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 18:39:10.242773 (Thread-1): finished collecting timing info
2020-11-05 18:39:10.268286 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 18:39:10.275285 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:39:10.276286 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 18:39:10.276286 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:39:12.129142 (Thread-1): SQL status: SUCCESS 1 in 1.85 seconds
2020-11-05 18:39:12.130159 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:39:12.130659 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 18:39:14.013803 (Thread-1): SQL status: SUCCESS 1 in 1.88 seconds
2020-11-05 18:39:14.019304 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 18:39:14.020304 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:39:14.021304 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 18:39:14.236631 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-11-05 18:39:14.248633 (Thread-1): finished collecting timing info
2020-11-05 18:39:14.249631 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 18:39:14.522740 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd05b1b5a-0949-49a9-85fb-af21a472284a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABA3B679D0>]}
2020-11-05 18:39:14.529251 (Thread-1): 19:39:14 | 3 of 5 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 4.33s]
2020-11-05 18:39:14.532250 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 18:39:14.533253 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 18:39:14.540251 (Thread-1): 19:39:14 | 4 of 5 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 18:39:14.543253 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:39:14.544253 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 18:39:14.615271 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 18:39:14.619770 (Thread-1): finished collecting timing info
2020-11-05 18:39:14.805294 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 18:39:14.812296 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:39:14.812795 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 18:39:14.813296 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:39:16.663578 (Thread-1): SQL status: SUCCESS 1 in 1.85 seconds
2020-11-05 18:39:16.663578 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:39:16.663578 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 18:39:17.126672 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2020-11-05 18:39:17.128679 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 18:39:17.128679 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:39:17.128679 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 18:39:17.260730 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2020-11-05 18:39:17.266728 (Thread-1): finished collecting timing info
2020-11-05 18:39:17.267729 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 18:39:17.479890 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd05b1b5a-0949-49a9-85fb-af21a472284a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABA3B4FF40>]}
2020-11-05 18:39:17.486890 (Thread-1): 19:39:17 | 4 of 5 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 2.94s]
2020-11-05 18:39:17.490891 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 18:39:17.491890 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 18:39:17.492891 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 18:39:17.493874 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 18:39:17.606907 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 18:39:17.612907 (Thread-1): finished collecting timing info
2020-11-05 18:39:17.615907 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 18:39:17.618419 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_load
2020-11-05 18:39:17.620418 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_load".
2020-11-05 18:39:17.620919 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_load
2020-11-05 18:39:17.817930 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_load"
2020-11-05 18:39:17.822431 (Thread-1): finished collecting timing info
2020-11-05 18:39:17.860935 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_load
2020-11-05 18:39:17.863436 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-05 18:39:17.869937 (Thread-1): 19:39:17 | 5 of 5 START table model cko_dbt_am.pageviews_history................ [RUN]
2020-11-05 18:39:17.872438 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 18:39:17.872937 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-05 18:39:17.983452 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 18:39:17.987450 (Thread-1): finished collecting timing info
2020-11-05 18:39:18.017456 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 18:39:18.035957 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 18:39:18.036956 (Thread-1): On model.cko_dbt_am.pageviews_history: BEGIN
2020-11-05 18:39:18.037476 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:39:20.317830 (Thread-1): SQL status: SUCCESS 1 in 2.28 seconds
2020-11-05 18:39:20.318331 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 18:39:20.318331 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_history  as
      (with __dbt__CTE__pageviews_extract_ephemere as (
/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
),  __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM __dbt__CTE__pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"

where user_id in (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_load as (
-- Use the `ref` function to select from other models


with pageviews_extract_ephemere as __dbt__CTE__pageviews_extract_ephemere)
with users_extract_ephemere as __dbt__CTE__users_extract_Ephemere



select pageviews_extract_ephemere.*,users_extract_ephemere.Customer_postcode
From pageviews_extract_ephemere
LEFT JOIN users_extract_ephemere on users_extract_ephemere.user_id=pageviews_extract_ephemere.user_id
)/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 


-- INIT
CREATE TABLE pageviews_history
		(
    	user_id bigint,
   	 	 pageview_date_hour datetime,
    	count_pageviews as int,
    	count_disctint_pageviews as int,
		)

/*

insert into "ANALYTICS"."CKO_DBT_AM"."pageviews_history"
		Select * FROM __dbt__CTE__pageviews_history_load


	*/
      );
2020-11-05 18:39:20.458850 (Thread-1): Snowflake query id: 0198123f-00c0-289d-0000-6c5d00019642
2020-11-05 18:39:20.459349 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 34 at position 35 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
syntax error line 35 at position 0 unexpected 'with'.
syntax error line 49 at position 0 unexpected 'CREATE'.
2020-11-05 18:39:20.459349 (Thread-1): finished collecting timing info
2020-11-05 18:39:20.460349 (Thread-1): On model.cko_dbt_am.pageviews_history: ROLLBACK
2020-11-05 18:39:20.698879 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-05 18:39:20.902914 (Thread-1): Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 34 at position 35 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
  syntax error line 35 at position 0 unexpected 'with'.
  syntax error line 49 at position 0 unexpected 'CREATE'.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 34 at position 35 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
syntax error line 35 at position 0 unexpected 'with'.
syntax error line 49 at position 0 unexpected 'CREATE'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\users\alexandre\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 34 at position 35 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
  syntax error line 35 at position 0 unexpected 'with'.
  syntax error line 49 at position 0 unexpected 'CREATE'.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
2020-11-05 18:39:20.917912 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd05b1b5a-0949-49a9-85fb-af21a472284a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABA3B50B80>]}
2020-11-05 18:39:20.920913 (Thread-1): 19:39:20 | 5 of 5 ERROR creating table model cko_dbt_am.pageviews_history....... [ERROR in 3.05s]
2020-11-05 18:39:20.921919 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-05 18:39:20.923911 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 18:39:20.924913 (MainThread): Using snowflake connection "master".
2020-11-05 18:39:20.924913 (MainThread): On master: BEGIN
2020-11-05 18:39:20.924913 (MainThread): Opening a new connection, currently in state closed
2020-11-05 18:39:22.720256 (MainThread): SQL status: SUCCESS 1 in 1.79 seconds
2020-11-05 18:39:22.720756 (MainThread): On master: COMMIT
2020-11-05 18:39:22.721755 (MainThread): Using snowflake connection "master".
2020-11-05 18:39:22.722238 (MainThread): On master: COMMIT
2020-11-05 18:39:22.943705 (MainThread): SQL status: SUCCESS 1 in 0.22 seconds
2020-11-05 18:39:22.944704 (MainThread): On master: Close
2020-11-05 18:39:23.140609 (MainThread): 19:39:23 | 
2020-11-05 18:39:23.141609 (MainThread): 19:39:23 | Finished running 4 table models, 1 view model in 30.77s.
2020-11-05 18:39:23.142595 (MainThread): Connection 'master' was properly closed.
2020-11-05 18:39:23.143591 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 18:39:23.143591 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 18:39:23.144609 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-05 18:39:23.247132 (MainThread): 
2020-11-05 18:39:23.252132 (MainThread): Completed with 1 error and 0 warnings:
2020-11-05 18:39:23.256133 (MainThread): 
2020-11-05 18:39:23.257134 (MainThread): Database Error in model pageviews_history (models\pageviews_history.sql)
2020-11-05 18:39:23.261132 (MainThread):   001003 (42000): SQL compilation error:
2020-11-05 18:39:23.262134 (MainThread):   syntax error line 34 at position 35 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
2020-11-05 18:39:23.264134 (MainThread):   syntax error line 35 at position 0 unexpected 'with'.
2020-11-05 18:39:23.266133 (MainThread):   syntax error line 49 at position 0 unexpected 'CREATE'.
2020-11-05 18:39:23.277133 (MainThread):   compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
2020-11-05 18:39:23.284135 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2020-11-05 18:39:23.297135 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABA3B69520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABA3B69910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABA3B69DF0>]}
2020-11-05 18:39:23.298135 (MainThread): Flushing usage events
2020-11-05 18:45:33.302848 (MainThread): Running with dbt=0.18.1
2020-11-05 18:45:33.667264 (MainThread): Loading KWallet
2020-11-05 18:45:33.670107 (MainThread): Loading SecretService
2020-11-05 18:45:33.674107 (MainThread): Loading Windows
2020-11-05 18:45:33.905663 (MainThread): Loading chainer
2020-11-05 18:45:33.908661 (MainThread): Loading macOS
2020-11-05 18:45:34.910144 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 18:45:34.913644 (MainThread): Tracking: tracking
2020-11-05 18:45:34.914644 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340D763A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340D74F8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340D74FEB0>]}
2020-11-05 18:45:34.974650 (MainThread): Partial parsing not enabled
2020-11-05 18:45:34.979651 (MainThread): Parsing macros\adapters.sql
2020-11-05 18:45:35.067955 (MainThread): Parsing macros\catalog.sql
2020-11-05 18:45:35.074173 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 18:45:35.105701 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 18:45:35.112702 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 18:45:35.123701 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 18:45:35.136703 (MainThread): Parsing macros\core.sql
2020-11-05 18:45:35.149704 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 18:45:35.279747 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 18:45:35.309784 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 18:45:35.314787 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 18:45:35.320784 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 18:45:35.325784 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 18:45:35.331786 (MainThread): Parsing macros\etc\query.sql
2020-11-05 18:45:35.335567 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 18:45:35.364590 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 18:45:35.409620 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 18:45:35.416434 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 18:45:35.435443 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 18:45:35.496489 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 18:45:35.572025 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 18:45:35.577850 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 18:45:35.631380 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 18:45:35.651391 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 18:45:35.667753 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 18:45:35.686134 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 18:45:35.694143 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 18:45:35.700141 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 18:45:35.707142 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 18:45:35.729142 (MainThread): Partial parsing not enabled
2020-11-05 18:45:35.837179 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:45:35.894203 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:45:35.930204 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:45:35.956205 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 18:45:35.989222 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 18:45:36.022224 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_load".
2020-11-05 18:45:36.054241 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:45:36.084276 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 18:45:36.688941 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 18:45:36.845970 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 18:45:36.855971 (MainThread): 
2020-11-05 18:45:36.862972 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 18:45:36.890991 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 18:45:36.935995 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 18:45:36.935995 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 18:45:36.936996 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 18:45:39.991471 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 3.05 seconds
2020-11-05 18:45:40.002472 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 18:45:40.554215 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 18:45:40.571725 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 18:45:40.571725 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 18:45:40.571725 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 18:45:42.080752 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.51 seconds
2020-11-05 18:45:42.117757 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 18:45:42.442319 (MainThread): Using snowflake connection "master".
2020-11-05 18:45:42.443319 (MainThread): On master: BEGIN
2020-11-05 18:45:42.444319 (MainThread): Opening a new connection, currently in state init
2020-11-05 18:45:44.289636 (MainThread): SQL status: SUCCESS 1 in 1.85 seconds
2020-11-05 18:45:44.289636 (MainThread): On master: COMMIT
2020-11-05 18:45:44.289636 (MainThread): Using snowflake connection "master".
2020-11-05 18:45:44.290634 (MainThread): On master: COMMIT
2020-11-05 18:45:44.920466 (MainThread): SQL status: SUCCESS 1 in 0.63 seconds
2020-11-05 18:45:44.921463 (MainThread): On master: Close
2020-11-05 18:45:45.360775 (MainThread): 19:45:45 | Concurrency: 1 threads (target='dev')
2020-11-05 18:45:45.362788 (MainThread): 19:45:45 | 
2020-11-05 18:45:45.505312 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 18:45:45.511828 (Thread-1): 19:45:45 | 1 of 5 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 18:45:45.513811 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:45:45.517813 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 18:45:45.728895 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 18:45:45.736895 (Thread-1): finished collecting timing info
2020-11-05 18:45:46.147010 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 18:45:46.159512 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:45:46.160512 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 18:45:46.161512 (Thread-1): Opening a new connection, currently in state init
2020-11-05 18:45:47.450056 (Thread-1): SQL status: SUCCESS 1 in 1.29 seconds
2020-11-05 18:45:47.451056 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:45:47.451056 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 18:45:49.353752 (Thread-1): SQL status: SUCCESS 1 in 1.90 seconds
2020-11-05 18:45:49.358751 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 18:45:49.359752 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:45:49.359752 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 18:45:49.561135 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-11-05 18:45:49.670664 (Thread-1): finished collecting timing info
2020-11-05 18:45:49.671664 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 18:45:49.958264 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61f83d2c-8dbf-4dfe-8aeb-048ab4c0f35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340DCCB4C0>]}
2020-11-05 18:45:49.965265 (Thread-1): 19:45:49 | 1 of 5 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 4.44s]
2020-11-05 18:45:49.969263 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 18:45:49.970264 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 18:45:49.972268 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 18:45:49.973265 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 18:45:50.062788 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 18:45:50.068289 (Thread-1): finished collecting timing info
2020-11-05 18:45:50.071288 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 18:45:50.073288 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 18:45:50.079789 (Thread-1): 19:45:50 | 2 of 5 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 18:45:50.107794 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:45:50.108794 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 18:45:50.196805 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 18:45:50.208306 (Thread-1): finished collecting timing info
2020-11-05 18:45:50.242311 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 18:45:50.254811 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:45:50.255811 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 18:45:50.256812 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:45:51.985983 (Thread-1): SQL status: SUCCESS 1 in 1.73 seconds
2020-11-05 18:45:51.986982 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:45:51.987983 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 18:45:55.698024 (Thread-1): SQL status: SUCCESS 1 in 3.71 seconds
2020-11-05 18:45:55.700025 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 18:45:55.700025 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:45:55.700025 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 18:45:55.941124 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2020-11-05 18:45:55.948123 (Thread-1): finished collecting timing info
2020-11-05 18:45:55.948123 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 18:45:56.180659 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61f83d2c-8dbf-4dfe-8aeb-048ab4c0f35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340DCCB160>]}
2020-11-05 18:45:56.183659 (Thread-1): 19:45:56 | 2 of 5 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 6.07s]
2020-11-05 18:45:56.193663 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 18:45:56.194160 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 18:45:56.196662 (Thread-1): 19:45:56 | 3 of 5 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 18:45:56.197660 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:45:56.198160 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 18:45:56.217163 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 18:45:56.218664 (Thread-1): finished collecting timing info
2020-11-05 18:45:56.231166 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 18:45:56.233665 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:45:56.234166 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 18:45:56.234666 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:45:57.882895 (Thread-1): SQL status: SUCCESS 1 in 1.65 seconds
2020-11-05 18:45:57.883395 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:45:57.883395 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 18:45:59.681302 (Thread-1): SQL status: SUCCESS 1 in 1.80 seconds
2020-11-05 18:45:59.690304 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 18:45:59.691304 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:45:59.691804 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 18:45:59.872826 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-11-05 18:45:59.888328 (Thread-1): finished collecting timing info
2020-11-05 18:45:59.889830 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 18:46:00.355983 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61f83d2c-8dbf-4dfe-8aeb-048ab4c0f35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340DCCB940>]}
2020-11-05 18:46:00.358984 (Thread-1): 19:46:00 | 3 of 5 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 4.16s]
2020-11-05 18:46:00.364484 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 18:46:00.365484 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 18:46:00.369985 (Thread-1): 19:46:00 | 4 of 5 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 18:46:00.371985 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:46:00.372485 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 18:46:00.408490 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 18:46:00.411490 (Thread-1): finished collecting timing info
2020-11-05 18:46:00.516004 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 18:46:00.519504 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:46:00.520005 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 18:46:00.520005 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:46:01.760943 (Thread-1): SQL status: SUCCESS 1 in 1.24 seconds
2020-11-05 18:46:01.762943 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:46:01.762943 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 18:46:02.447690 (Thread-1): SQL status: SUCCESS 1 in 0.68 seconds
2020-11-05 18:46:02.452703 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 18:46:02.453702 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:46:02.453702 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 18:46:02.626730 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-11-05 18:46:02.648233 (Thread-1): finished collecting timing info
2020-11-05 18:46:02.649732 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 18:46:02.898793 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61f83d2c-8dbf-4dfe-8aeb-048ab4c0f35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340DDD2640>]}
2020-11-05 18:46:02.906293 (Thread-1): 19:46:02 | 4 of 5 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 2.53s]
2020-11-05 18:46:02.966581 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 18:46:02.967581 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 18:46:02.969080 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 18:46:02.970581 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 18:46:03.273593 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 18:46:03.380106 (Thread-1): finished collecting timing info
2020-11-05 18:46:03.382606 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 18:46:03.384607 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_load
2020-11-05 18:46:03.387108 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_load".
2020-11-05 18:46:03.388108 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_load
2020-11-05 18:46:03.540626 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_load"
2020-11-05 18:46:03.548127 (Thread-1): finished collecting timing info
2020-11-05 18:46:03.549627 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_load
2020-11-05 18:46:03.573131 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-05 18:46:03.576630 (Thread-1): 19:46:03 | 5 of 5 START table model cko_dbt_am.pageviews_history................ [RUN]
2020-11-05 18:46:03.624636 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 18:46:03.625136 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-05 18:46:03.727649 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 18:46:03.774655 (Thread-1): finished collecting timing info
2020-11-05 18:46:03.794658 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 18:46:03.823162 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 18:46:03.823662 (Thread-1): On model.cko_dbt_am.pageviews_history: BEGIN
2020-11-05 18:46:03.823662 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:46:05.539194 (Thread-1): SQL status: SUCCESS 1 in 1.72 seconds
2020-11-05 18:46:05.540192 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 18:46:05.540693 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_history  as
      (with __dbt__CTE__pageviews_extract_ephemere as (
/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
),  __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM __dbt__CTE__pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"

where user_id in (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_load as (
-- Use the `ref` function to select from other models


with pageviews_extract_ephemere as __dbt__CTE__pageviews_extract_ephemere)
with users_extract_ephemere as __dbt__CTE__users_extract_Ephemere



select pageviews_extract_ephemere.*,users_extract_ephemere.Customer_postcode
From pageviews_extract_ephemere
LEFT JOIN users_extract_ephemere on users_extract_ephemere.user_id=pageviews_extract_ephemere.user_id
)/* Config line */



CREATE  TABLE  "ANALYTICS"."CKO_DBT_AM"."pageviews_history"
		(
    	user_id bigint,
   	 	 pageview_date_hour datetime,
    	count_pageviews int,
    	count_disctint_pageviews int
		)
/*
insert into "ANALYTICS"."CKO_DBT_AM"."pageviews_history"
		Select * FROM __dbt__CTE__pageviews_history_load

*/
      );
2020-11-05 18:46:05.749391 (Thread-1): Snowflake query id: 01981246-0024-74dc-0000-6c5d00019726
2020-11-05 18:46:05.749391 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 34 at position 35 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
syntax error line 35 at position 0 unexpected 'with'.
syntax error line 46 at position 0 unexpected 'CREATE'.
2020-11-05 18:46:05.750390 (Thread-1): finished collecting timing info
2020-11-05 18:46:05.752407 (Thread-1): On model.cko_dbt_am.pageviews_history: ROLLBACK
2020-11-05 18:46:06.278525 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-05 18:46:06.793926 (Thread-1): Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 34 at position 35 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
  syntax error line 35 at position 0 unexpected 'with'.
  syntax error line 46 at position 0 unexpected 'CREATE'.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 34 at position 35 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
syntax error line 35 at position 0 unexpected 'with'.
syntax error line 46 at position 0 unexpected 'CREATE'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\users\alexandre\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 34 at position 35 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
  syntax error line 35 at position 0 unexpected 'with'.
  syntax error line 46 at position 0 unexpected 'CREATE'.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
2020-11-05 18:46:06.832431 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61f83d2c-8dbf-4dfe-8aeb-048ab4c0f35c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340DE5E310>]}
2020-11-05 18:46:06.842433 (Thread-1): 19:46:06 | 5 of 5 ERROR creating table model cko_dbt_am.pageviews_history....... [ERROR in 3.21s]
2020-11-05 18:46:06.989451 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-05 18:46:07.003951 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 18:46:07.005451 (MainThread): Using snowflake connection "master".
2020-11-05 18:46:07.005951 (MainThread): On master: BEGIN
2020-11-05 18:46:07.006450 (MainThread): Opening a new connection, currently in state closed
2020-11-05 18:46:08.697632 (MainThread): SQL status: SUCCESS 1 in 1.69 seconds
2020-11-05 18:46:08.700632 (MainThread): On master: COMMIT
2020-11-05 18:46:08.701633 (MainThread): Using snowflake connection "master".
2020-11-05 18:46:08.702133 (MainThread): On master: COMMIT
2020-11-05 18:46:09.036792 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2020-11-05 18:46:09.037793 (MainThread): On master: Close
2020-11-05 18:46:09.340377 (MainThread): 19:46:09 | 
2020-11-05 18:46:09.359380 (MainThread): 19:46:09 | Finished running 4 table models, 1 view model in 32.48s.
2020-11-05 18:46:09.365378 (MainThread): Connection 'master' was properly closed.
2020-11-05 18:46:09.368380 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 18:46:09.369381 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 18:46:09.370378 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-05 18:46:09.605928 (MainThread): 
2020-11-05 18:46:09.611928 (MainThread): Completed with 1 error and 0 warnings:
2020-11-05 18:46:09.613928 (MainThread): 
2020-11-05 18:46:09.614928 (MainThread): Database Error in model pageviews_history (models\pageviews_history.sql)
2020-11-05 18:46:09.617428 (MainThread):   001003 (42000): SQL compilation error:
2020-11-05 18:46:09.627430 (MainThread):   syntax error line 34 at position 35 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
2020-11-05 18:46:09.628431 (MainThread):   syntax error line 35 at position 0 unexpected 'with'.
2020-11-05 18:46:09.629430 (MainThread):   syntax error line 46 at position 0 unexpected 'CREATE'.
2020-11-05 18:46:09.642934 (MainThread):   compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
2020-11-05 18:46:09.663435 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2020-11-05 18:46:09.680436 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340DE59430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340DE59160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340DE59610>]}
2020-11-05 18:46:09.682439 (MainThread): Flushing usage events
2020-11-05 18:49:53.148552 (MainThread): Running with dbt=0.18.1
2020-11-05 18:49:53.451600 (MainThread): Loading KWallet
2020-11-05 18:49:53.454599 (MainThread): Loading SecretService
2020-11-05 18:49:53.457100 (MainThread): Loading Windows
2020-11-05 18:49:53.655168 (MainThread): Loading chainer
2020-11-05 18:49:53.656669 (MainThread): Loading macOS
2020-11-05 18:49:54.678355 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 18:49:54.680855 (MainThread): Tracking: tracking
2020-11-05 18:49:54.680855 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001895B2F5C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001895B2E67F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001895B2E6DF0>]}
2020-11-05 18:49:54.768366 (MainThread): Partial parsing not enabled
2020-11-05 18:49:54.772867 (MainThread): Parsing macros\adapters.sql
2020-11-05 18:49:54.865379 (MainThread): Parsing macros\catalog.sql
2020-11-05 18:49:54.881381 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 18:49:54.909384 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 18:49:54.919385 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 18:49:54.931387 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 18:49:54.942889 (MainThread): Parsing macros\core.sql
2020-11-05 18:49:54.956890 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 18:49:55.198920 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 18:49:55.226932 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 18:49:55.242926 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 18:49:55.256428 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 18:49:55.268430 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 18:49:55.273931 (MainThread): Parsing macros\etc\query.sql
2020-11-05 18:49:55.277430 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 18:49:55.331438 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 18:49:55.386945 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 18:49:55.399946 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 18:49:55.424950 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 18:49:55.519961 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 18:49:55.643977 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 18:49:55.656479 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 18:49:55.720038 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 18:49:55.752541 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 18:49:55.780546 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 18:49:55.810549 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 18:49:55.820551 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 18:49:55.828552 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 18:49:55.844553 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 18:49:55.864556 (MainThread): Partial parsing not enabled
2020-11-05 18:49:56.031578 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:49:56.119089 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:49:56.157093 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:49:56.189098 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 18:49:56.221102 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 18:49:56.250605 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_load".
2020-11-05 18:49:56.280613 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:49:56.314614 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 18:49:56.939839 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 18:49:57.084873 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 18:49:57.086872 (MainThread): 
2020-11-05 18:49:57.087874 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 18:49:57.105876 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 18:49:57.142877 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 18:49:57.143384 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 18:49:57.143384 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 18:50:00.353183 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 3.21 seconds
2020-11-05 18:50:00.364684 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 18:50:00.800739 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 18:50:00.817242 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 18:50:00.817242 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 18:50:00.817741 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 18:50:01.989627 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.17 seconds
2020-11-05 18:50:02.002616 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 18:50:02.396342 (MainThread): Using snowflake connection "master".
2020-11-05 18:50:02.397342 (MainThread): On master: BEGIN
2020-11-05 18:50:02.397342 (MainThread): Opening a new connection, currently in state init
2020-11-05 18:50:04.482750 (MainThread): SQL status: SUCCESS 1 in 2.09 seconds
2020-11-05 18:50:04.483251 (MainThread): On master: COMMIT
2020-11-05 18:50:04.483751 (MainThread): Using snowflake connection "master".
2020-11-05 18:50:04.483751 (MainThread): On master: COMMIT
2020-11-05 18:50:04.935861 (MainThread): SQL status: SUCCESS 1 in 0.45 seconds
2020-11-05 18:50:04.935861 (MainThread): On master: Close
2020-11-05 18:50:05.308641 (MainThread): 19:50:05 | Concurrency: 1 threads (target='dev')
2020-11-05 18:50:05.311640 (MainThread): 19:50:05 | 
2020-11-05 18:50:05.391184 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 18:50:05.398173 (Thread-1): 19:50:05 | 1 of 5 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 18:50:05.400331 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:50:05.400331 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 18:50:05.628994 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 18:50:05.633496 (Thread-1): finished collecting timing info
2020-11-05 18:50:06.012544 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 18:50:06.024539 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:50:06.025537 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 18:50:06.026037 (Thread-1): Opening a new connection, currently in state init
2020-11-05 18:50:07.553333 (Thread-1): SQL status: SUCCESS 1 in 1.53 seconds
2020-11-05 18:50:07.554333 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:50:07.554333 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 18:50:08.760544 (Thread-1): SQL status: SUCCESS 1 in 1.20 seconds
2020-11-05 18:50:08.765564 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 18:50:08.766562 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:50:08.767561 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 18:50:08.977739 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-11-05 18:50:09.064283 (Thread-1): finished collecting timing info
2020-11-05 18:50:09.065283 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 18:50:09.289258 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8baa3935-a983-45d3-9add-2f6fb8eb52fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001895B85CD60>]}
2020-11-05 18:50:09.296758 (Thread-1): 19:50:09 | 1 of 5 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 3.89s]
2020-11-05 18:50:09.300259 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 18:50:09.301270 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 18:50:09.304270 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 18:50:09.304270 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 18:50:09.376275 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 18:50:09.380274 (Thread-1): finished collecting timing info
2020-11-05 18:50:09.385787 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 18:50:09.386788 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 18:50:09.395786 (Thread-1): 19:50:09 | 2 of 5 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 18:50:09.404788 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:50:09.405288 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 18:50:09.483799 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 18:50:09.489801 (Thread-1): finished collecting timing info
2020-11-05 18:50:09.529804 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 18:50:09.544807 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:50:09.545308 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 18:50:09.546309 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:50:11.858964 (Thread-1): SQL status: SUCCESS 1 in 2.31 seconds
2020-11-05 18:50:11.858964 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:50:11.859964 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 18:50:15.326523 (Thread-1): SQL status: SUCCESS 1 in 3.47 seconds
2020-11-05 18:50:15.333024 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 18:50:15.334026 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:50:15.334525 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 18:50:15.518548 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-11-05 18:50:15.533050 (Thread-1): finished collecting timing info
2020-11-05 18:50:15.534551 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 18:50:15.746582 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8baa3935-a983-45d3-9add-2f6fb8eb52fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001895B7F5280>]}
2020-11-05 18:50:15.750582 (Thread-1): 19:50:15 | 2 of 5 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 6.34s]
2020-11-05 18:50:15.751582 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 18:50:15.752582 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 18:50:15.755582 (Thread-1): 19:50:15 | 3 of 5 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 18:50:15.757582 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:50:15.757582 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 18:50:15.780582 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 18:50:15.782583 (Thread-1): finished collecting timing info
2020-11-05 18:50:15.797584 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 18:50:15.800583 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:50:15.801585 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 18:50:15.801585 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:50:17.121491 (Thread-1): SQL status: SUCCESS 1 in 1.32 seconds
2020-11-05 18:50:17.122491 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:50:17.122992 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 18:50:18.725007 (Thread-1): SQL status: SUCCESS 1 in 1.60 seconds
2020-11-05 18:50:18.730006 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 18:50:18.731007 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:50:18.732006 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 18:50:18.927366 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-11-05 18:50:18.939379 (Thread-1): finished collecting timing info
2020-11-05 18:50:18.940878 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 18:50:19.150460 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8baa3935-a983-45d3-9add-2f6fb8eb52fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001895B96F2B0>]}
2020-11-05 18:50:19.157472 (Thread-1): 19:50:19 | 3 of 5 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 3.39s]
2020-11-05 18:50:19.162471 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 18:50:19.163471 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 18:50:19.170472 (Thread-1): 19:50:19 | 4 of 5 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 18:50:19.172474 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:50:19.173474 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 18:50:19.249490 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 18:50:19.253493 (Thread-1): finished collecting timing info
2020-11-05 18:50:19.453518 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 18:50:19.460519 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:50:19.461018 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 18:50:19.461520 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:50:21.478587 (Thread-1): unclosed <socket.socket fd=1532, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.5.101', 64838), raddr=('168.63.27.166', 443)>
2020-11-05 18:50:21.480087 (Thread-1): SQL status: SUCCESS 1 in 2.02 seconds
2020-11-05 18:50:21.480587 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:50:21.480587 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 18:50:22.630320 (Thread-1): SQL status: SUCCESS 1 in 1.15 seconds
2020-11-05 18:50:22.632319 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 18:50:22.632819 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:50:22.632819 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 18:50:23.143551 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2020-11-05 18:50:23.150554 (Thread-1): finished collecting timing info
2020-11-05 18:50:23.150554 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 18:50:23.367599 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8baa3935-a983-45d3-9add-2f6fb8eb52fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001895B85CB80>]}
2020-11-05 18:50:23.370598 (Thread-1): 19:50:23 | 4 of 5 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 4.20s]
2020-11-05 18:50:23.371598 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 18:50:23.372599 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 18:50:23.372599 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 18:50:23.373600 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 18:50:23.398600 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 18:50:23.400601 (Thread-1): finished collecting timing info
2020-11-05 18:50:23.402603 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 18:50:23.403601 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_load
2020-11-05 18:50:23.404601 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_load".
2020-11-05 18:50:23.404601 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_load
2020-11-05 18:50:23.434110 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_load"
2020-11-05 18:50:23.435610 (Thread-1): finished collecting timing info
2020-11-05 18:50:23.437611 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_load
2020-11-05 18:50:23.438619 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-05 18:50:23.441620 (Thread-1): 19:50:23 | 5 of 5 START table model cko_dbt_am.pageviews_history................ [RUN]
2020-11-05 18:50:23.447619 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 18:50:23.447619 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-05 18:50:23.497622 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 18:50:23.498623 (Thread-1): finished collecting timing info
2020-11-05 18:50:23.549634 (Thread-1): finished collecting timing info
2020-11-05 18:50:23.551134 (Thread-1): Compilation Error in model pageviews_history (models\pageviews_history.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete "ANALYTICS"."CKO_DBT_AM"."pageviews_history", or rename it to be less ambiguous.
  Searched for: ANALYTICS.CKO_DBT_AM.PAGEVIEWS_HISTORY
  Found: "ANALYTICS"."CKO_DBT_AM"."pageviews_history"
  
  > in macro materialization_table_snowflake (macros\materializations\table.sql)
  > called by model pageviews_history (models\pageviews_history.sql)
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 37, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 718, in get_relation
    matches = self._make_match(relations_list, database, schema,
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 707, in _make_match
    if relation.matches(**search):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\relation.py", line 99, in matches
    dbt.exceptions.approximate_relation_match(target, self)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\exceptions.py", line 704, in approximate_relation_match
    raise_compiler_error(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model pageviews_history (models\pageviews_history.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete "ANALYTICS"."CKO_DBT_AM"."pageviews_history", or rename it to be less ambiguous.
  Searched for: ANALYTICS.CKO_DBT_AM.PAGEVIEWS_HISTORY
  Found: "ANALYTICS"."CKO_DBT_AM"."pageviews_history"
  
  > in macro materialization_table_snowflake (macros\materializations\table.sql)
  > called by model pageviews_history (models\pageviews_history.sql)
2020-11-05 18:50:23.562135 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8baa3935-a983-45d3-9add-2f6fb8eb52fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001895BA0A340>]}
2020-11-05 18:50:23.566137 (Thread-1): 19:50:23 | 5 of 5 ERROR creating table model cko_dbt_am.pageviews_history....... [ERROR in 0.12s]
2020-11-05 18:50:23.745159 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-05 18:50:23.747659 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 18:50:23.748159 (MainThread): Using snowflake connection "master".
2020-11-05 18:50:23.748159 (MainThread): On master: BEGIN
2020-11-05 18:50:23.748159 (MainThread): Opening a new connection, currently in state closed
2020-11-05 18:50:25.023795 (MainThread): SQL status: SUCCESS 1 in 1.28 seconds
2020-11-05 18:50:25.024794 (MainThread): On master: COMMIT
2020-11-05 18:50:25.025795 (MainThread): Using snowflake connection "master".
2020-11-05 18:50:25.025795 (MainThread): On master: COMMIT
2020-11-05 18:50:25.441904 (MainThread): SQL status: SUCCESS 1 in 0.42 seconds
2020-11-05 18:50:25.442904 (MainThread): On master: Close
2020-11-05 18:50:25.691968 (MainThread): 19:50:25 | 
2020-11-05 18:50:25.698982 (MainThread): 19:50:25 | Finished running 4 table models, 1 view model in 28.60s.
2020-11-05 18:50:25.700482 (MainThread): Connection 'master' was properly closed.
2020-11-05 18:50:25.700981 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 18:50:25.701481 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 18:50:25.701982 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-05 18:50:25.828050 (MainThread): 
2020-11-05 18:50:25.829050 (MainThread): Completed with 1 error and 0 warnings:
2020-11-05 18:50:25.836051 (MainThread): 
2020-11-05 18:50:25.839051 (MainThread): Compilation Error in model pageviews_history (models\pageviews_history.sql)
2020-11-05 18:50:25.849052 (MainThread):   When searching for a relation, dbt found an approximate match. Instead of guessing 
2020-11-05 18:50:25.899568 (MainThread):   which relation to use, dbt will move on. Please delete "ANALYTICS"."CKO_DBT_AM"."pageviews_history", or rename it to be less ambiguous.
2020-11-05 18:50:25.987084 (MainThread):   Searched for: ANALYTICS.CKO_DBT_AM.PAGEVIEWS_HISTORY
2020-11-05 18:50:26.038101 (MainThread):   Found: "ANALYTICS"."CKO_DBT_AM"."pageviews_history"
2020-11-05 18:50:26.170119 (MainThread):   
2020-11-05 18:50:26.261700 (MainThread):   > in macro materialization_table_snowflake (macros\materializations\table.sql)
2020-11-05 18:50:26.307207 (MainThread):   > called by model pageviews_history (models\pageviews_history.sql)
2020-11-05 18:50:26.383217 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2020-11-05 18:50:26.406718 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001895B99BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001895B99BA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001895B99B6D0>]}
2020-11-05 18:50:26.408219 (MainThread): Flushing usage events
2020-11-05 18:55:23.239163 (MainThread): Running with dbt=0.18.1
2020-11-05 18:55:23.500249 (MainThread): Loading KWallet
2020-11-05 18:55:23.506757 (MainThread): Loading SecretService
2020-11-05 18:55:23.512757 (MainThread): Loading Windows
2020-11-05 18:55:24.118375 (MainThread): Loading chainer
2020-11-05 18:55:24.122375 (MainThread): Loading macOS
2020-11-05 18:55:25.735580 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 18:55:25.738080 (MainThread): Tracking: tracking
2020-11-05 18:55:25.738578 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD3B9D3B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD3B9C3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD3B9C3BE0>]}
2020-11-05 18:55:25.791586 (MainThread): Partial parsing not enabled
2020-11-05 18:55:25.795086 (MainThread): Parsing macros\adapters.sql
2020-11-05 18:55:25.875096 (MainThread): Parsing macros\catalog.sql
2020-11-05 18:55:25.881097 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 18:55:25.908101 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 18:55:25.914101 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 18:55:25.926103 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 18:55:25.938604 (MainThread): Parsing macros\core.sql
2020-11-05 18:55:25.950106 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 18:55:26.068622 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 18:55:26.095125 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 18:55:26.098125 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 18:55:26.103626 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 18:55:26.110126 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 18:55:26.115127 (MainThread): Parsing macros\etc\query.sql
2020-11-05 18:55:26.119128 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 18:55:26.147632 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 18:55:26.186136 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 18:55:26.192137 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 18:55:26.210640 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 18:55:26.268647 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 18:55:26.338657 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 18:55:26.344658 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 18:55:26.389707 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 18:55:26.407721 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 18:55:26.421704 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 18:55:26.439705 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 18:55:26.447707 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 18:55:26.452706 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 18:55:26.457708 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 18:55:26.475214 (MainThread): Partial parsing not enabled
2020-11-05 18:55:26.703826 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:55:26.864862 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:55:26.937890 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:55:27.010956 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 18:55:27.087472 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 18:55:27.167004 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 18:55:27.256029 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:55:27.328081 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 18:55:28.863010 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 18:55:29.284593 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 18:55:29.293607 (MainThread): 
2020-11-05 18:55:29.296108 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 18:55:29.357622 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 18:55:29.457173 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 18:55:29.457673 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 18:55:29.458673 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 18:55:31.450795 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.99 seconds
2020-11-05 18:55:31.462794 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 18:55:31.723886 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 18:55:31.739895 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 18:55:31.740895 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 18:55:31.740895 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 18:55:33.413720 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.67 seconds
2020-11-05 18:55:33.452757 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 18:55:33.741676 (ThreadPoolExecutor-1_0): unclosed <socket.socket fd=1492, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.5.101', 64951), raddr=('168.63.27.166', 443)>
2020-11-05 18:55:33.751679 (MainThread): Using snowflake connection "master".
2020-11-05 18:55:33.752677 (MainThread): On master: BEGIN
2020-11-05 18:55:33.753178 (MainThread): Opening a new connection, currently in state init
2020-11-05 18:55:35.776719 (MainThread): SQL status: SUCCESS 1 in 2.02 seconds
2020-11-05 18:55:35.777719 (MainThread): On master: COMMIT
2020-11-05 18:55:35.778719 (MainThread): Using snowflake connection "master".
2020-11-05 18:55:35.778719 (MainThread): On master: COMMIT
2020-11-05 18:55:36.023711 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2020-11-05 18:55:36.024712 (MainThread): On master: Close
2020-11-05 18:55:36.253971 (MainThread): 19:55:36 | Concurrency: 1 threads (target='dev')
2020-11-05 18:55:36.255481 (MainThread): 19:55:36 | 
2020-11-05 18:55:36.384515 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 18:55:36.391015 (Thread-1): 19:55:36 | 1 of 5 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 18:55:36.396515 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:55:36.399015 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 18:55:36.535270 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 18:55:36.538254 (Thread-1): finished collecting timing info
2020-11-05 18:55:36.764814 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 18:55:36.771815 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:55:36.772315 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 18:55:36.772816 (Thread-1): Opening a new connection, currently in state init
2020-11-05 18:55:38.305040 (Thread-1): SQL status: SUCCESS 1 in 1.53 seconds
2020-11-05 18:55:38.306058 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:55:38.307057 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 18:55:39.747130 (Thread-1): SQL status: SUCCESS 1 in 1.44 seconds
2020-11-05 18:55:39.753130 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 18:55:39.754130 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:55:39.754130 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 18:55:39.891903 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 18:55:39.975448 (Thread-1): finished collecting timing info
2020-11-05 18:55:39.976434 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 18:55:40.210862 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29812af3-be3b-4c24-8921-5db360ccde87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD3BF45D60>]}
2020-11-05 18:55:40.217863 (Thread-1): 19:55:40 | 1 of 5 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 3.82s]
2020-11-05 18:55:40.220847 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 18:55:40.221848 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 18:55:40.224847 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 18:55:40.224847 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 18:55:40.281851 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 18:55:40.285852 (Thread-1): finished collecting timing info
2020-11-05 18:55:40.292367 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 18:55:40.295367 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 18:55:40.302868 (Thread-1): 19:55:40 | 2 of 5 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 18:55:40.304879 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:55:40.306879 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 18:55:40.350880 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 18:55:40.354880 (Thread-1): finished collecting timing info
2020-11-05 18:55:40.381882 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 18:55:40.391895 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:55:40.392895 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 18:55:40.393896 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:55:42.023499 (Thread-1): SQL status: SUCCESS 1 in 1.63 seconds
2020-11-05 18:55:42.024516 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:55:42.024516 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 18:55:45.615749 (Thread-1): SQL status: SUCCESS 1 in 3.59 seconds
2020-11-05 18:55:45.620749 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 18:55:45.621749 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:55:45.621749 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 18:55:45.763413 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 18:55:45.775398 (Thread-1): finished collecting timing info
2020-11-05 18:55:45.777398 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 18:55:46.097137 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29812af3-be3b-4c24-8921-5db360ccde87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD3BD864F0>]}
2020-11-05 18:55:46.104137 (Thread-1): 19:55:46 | 2 of 5 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 5.79s]
2020-11-05 18:55:46.109138 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 18:55:46.110137 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 18:55:46.122139 (Thread-1): 19:55:46 | 3 of 5 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 18:55:46.171166 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:55:46.173168 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 18:55:46.234170 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 18:55:46.238169 (Thread-1): finished collecting timing info
2020-11-05 18:55:46.288689 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 18:55:46.295190 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:55:46.296190 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 18:55:46.296690 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:55:48.490683 (Thread-1): SQL status: SUCCESS 1 in 2.19 seconds
2020-11-05 18:55:48.491681 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:55:48.491681 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 18:55:50.599431 (Thread-1): SQL status: SUCCESS 1 in 2.11 seconds
2020-11-05 18:55:50.604431 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 18:55:50.604431 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:55:50.605431 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 18:55:50.740794 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 18:55:50.752808 (Thread-1): finished collecting timing info
2020-11-05 18:55:50.753808 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 18:55:50.999887 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29812af3-be3b-4c24-8921-5db360ccde87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD3BF40F10>]}
2020-11-05 18:55:51.006886 (Thread-1): 19:55:51 | 3 of 5 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 4.83s]
2020-11-05 18:55:51.075913 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 18:55:51.078914 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 18:55:51.092916 (Thread-1): 19:55:51 | 4 of 5 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 18:55:51.121919 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:55:51.122918 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 18:55:51.185937 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 18:55:51.189936 (Thread-1): finished collecting timing info
2020-11-05 18:55:51.388462 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 18:55:51.395464 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:55:51.396464 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 18:55:51.396963 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:55:52.967253 (Thread-1): SQL status: SUCCESS 1 in 1.57 seconds
2020-11-05 18:55:52.968237 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:55:52.968237 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 18:55:53.559700 (Thread-1): SQL status: SUCCESS 1 in 0.59 seconds
2020-11-05 18:55:53.563699 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 18:55:53.564684 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:55:53.565700 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 18:55:53.739306 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-11-05 18:55:53.758308 (Thread-1): finished collecting timing info
2020-11-05 18:55:53.760308 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 18:55:54.028745 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29812af3-be3b-4c24-8921-5db360ccde87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD3C06FA00>]}
2020-11-05 18:55:54.035760 (Thread-1): 19:55:54 | 4 of 5 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 2.91s]
2020-11-05 18:55:54.038744 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 18:55:54.040743 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 18:55:54.041744 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 18:55:54.043748 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 18:55:54.114275 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 18:55:54.117760 (Thread-1): finished collecting timing info
2020-11-05 18:55:54.119771 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 18:55:54.121771 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 18:55:54.123772 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 18:55:54.124770 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 18:55:54.192775 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-05 18:55:54.197775 (Thread-1): finished collecting timing info
2020-11-05 18:55:54.199775 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 18:55:54.206790 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-05 18:55:54.213792 (Thread-1): 19:55:54 | 5 of 5 START table model cko_dbt_am.pageviews_history................ [RUN]
2020-11-05 18:55:54.216293 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 18:55:54.217293 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-05 18:55:54.282806 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 18:55:54.286808 (Thread-1): finished collecting timing info
2020-11-05 18:55:54.320831 (Thread-1): finished collecting timing info
2020-11-05 18:55:54.322832 (Thread-1): Compilation Error in model pageviews_history (models\pageviews_history.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete "ANALYTICS"."CKO_DBT_AM"."pageviews_history", or rename it to be less ambiguous.
  Searched for: ANALYTICS.CKO_DBT_AM.PAGEVIEWS_HISTORY
  Found: "ANALYTICS"."CKO_DBT_AM"."pageviews_history"
  
  > in macro materialization_table_snowflake (macros\materializations\table.sql)
  > called by model pageviews_history (models\pageviews_history.sql)
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 37, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 718, in get_relation
    matches = self._make_match(relations_list, database, schema,
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 707, in _make_match
    if relation.matches(**search):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\relation.py", line 99, in matches
    dbt.exceptions.approximate_relation_match(target, self)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\exceptions.py", line 704, in approximate_relation_match
    raise_compiler_error(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model pageviews_history (models\pageviews_history.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete "ANALYTICS"."CKO_DBT_AM"."pageviews_history", or rename it to be less ambiguous.
  Searched for: ANALYTICS.CKO_DBT_AM.PAGEVIEWS_HISTORY
  Found: "ANALYTICS"."CKO_DBT_AM"."pageviews_history"
  
  > in macro materialization_table_snowflake (macros\materializations\table.sql)
  > called by model pageviews_history (models\pageviews_history.sql)
2020-11-05 18:55:54.345849 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29812af3-be3b-4c24-8921-5db360ccde87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD3C0F7220>]}
2020-11-05 18:55:54.351850 (Thread-1): 19:55:54 | 5 of 5 ERROR creating table model cko_dbt_am.pageviews_history....... [ERROR in 0.13s]
2020-11-05 18:55:54.355834 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-05 18:55:54.364834 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 18:55:54.366835 (MainThread): Using snowflake connection "master".
2020-11-05 18:55:54.366835 (MainThread): On master: BEGIN
2020-11-05 18:55:54.367836 (MainThread): Opening a new connection, currently in state closed
2020-11-05 18:55:56.299842 (MainThread): SQL status: SUCCESS 1 in 1.93 seconds
2020-11-05 18:55:56.300843 (MainThread): On master: COMMIT
2020-11-05 18:55:56.301842 (MainThread): Using snowflake connection "master".
2020-11-05 18:55:56.302843 (MainThread): On master: COMMIT
2020-11-05 18:55:56.540602 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2020-11-05 18:55:56.541602 (MainThread): On master: Close
2020-11-05 18:55:56.732197 (MainThread): 19:55:56 | 
2020-11-05 18:55:56.734182 (MainThread): 19:55:56 | Finished running 4 table models, 1 view model in 27.44s.
2020-11-05 18:55:56.743181 (MainThread): Connection 'master' was properly closed.
2020-11-05 18:55:56.744183 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 18:55:56.745183 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 18:55:56.746182 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-05 18:55:56.844023 (MainThread): 
2020-11-05 18:55:56.847006 (MainThread): Completed with 1 error and 0 warnings:
2020-11-05 18:55:56.852006 (MainThread): 
2020-11-05 18:55:56.857006 (MainThread): Compilation Error in model pageviews_history (models\pageviews_history.sql)
2020-11-05 18:55:56.865008 (MainThread):   When searching for a relation, dbt found an approximate match. Instead of guessing 
2020-11-05 18:55:56.867009 (MainThread):   which relation to use, dbt will move on. Please delete "ANALYTICS"."CKO_DBT_AM"."pageviews_history", or rename it to be less ambiguous.
2020-11-05 18:55:56.869008 (MainThread):   Searched for: ANALYTICS.CKO_DBT_AM.PAGEVIEWS_HISTORY
2020-11-05 18:55:56.881009 (MainThread):   Found: "ANALYTICS"."CKO_DBT_AM"."pageviews_history"
2020-11-05 18:55:56.886010 (MainThread):   
2020-11-05 18:55:56.895009 (MainThread):   > in macro materialization_table_snowflake (macros\materializations\table.sql)
2020-11-05 18:55:56.899008 (MainThread):   > called by model pageviews_history (models\pageviews_history.sql)
2020-11-05 18:55:56.908011 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2020-11-05 18:55:56.914526 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD3C079AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD3C079280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD3C079760>]}
2020-11-05 18:55:56.916024 (MainThread): Flushing usage events
2020-11-05 18:58:48.177204 (MainThread): Running with dbt=0.18.1
2020-11-05 18:58:48.433293 (MainThread): Loading KWallet
2020-11-05 18:58:48.436292 (MainThread): Loading SecretService
2020-11-05 18:58:48.439292 (MainThread): Loading Windows
2020-11-05 18:58:48.623380 (MainThread): Loading chainer
2020-11-05 18:58:48.624392 (MainThread): Loading macOS
2020-11-05 18:58:49.469602 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 18:58:49.471603 (MainThread): Tracking: tracking
2020-11-05 18:58:49.471603 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C587613A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5875FC850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5875FCE80>]}
2020-11-05 18:58:49.527652 (MainThread): Partial parsing not enabled
2020-11-05 18:58:49.530653 (MainThread): Parsing macros\adapters.sql
2020-11-05 18:58:49.608179 (MainThread): Parsing macros\catalog.sql
2020-11-05 18:58:49.613680 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 18:58:49.638702 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 18:58:49.644686 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 18:58:49.655703 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 18:58:49.666698 (MainThread): Parsing macros\core.sql
2020-11-05 18:58:49.677689 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 18:58:49.796737 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 18:58:49.821748 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 18:58:49.824754 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 18:58:49.828768 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 18:58:49.834770 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 18:58:49.839770 (MainThread): Parsing macros\etc\query.sql
2020-11-05 18:58:49.842770 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 18:58:49.865771 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 18:58:49.904758 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 18:58:49.910295 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 18:58:49.927577 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 18:58:49.981580 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 18:58:50.052110 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 18:58:50.058095 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 18:58:50.104114 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 18:58:50.123137 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 18:58:50.136157 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 18:58:50.153142 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 18:58:50.161142 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 18:58:50.166160 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 18:58:50.171159 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 18:58:50.188144 (MainThread): Partial parsing not enabled
2020-11-05 18:58:50.285208 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:58:50.338223 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:58:50.364242 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:58:50.388241 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 18:58:50.414266 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 18:58:50.441272 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 18:58:50.470290 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:58:50.496276 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 18:58:51.023913 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 18:58:51.166471 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 18:58:51.170543 (MainThread): 
2020-11-05 18:58:51.171542 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 18:58:51.190542 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 18:58:51.227567 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 18:58:51.227567 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 18:58:51.228566 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 18:58:53.642759 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.42 seconds
2020-11-05 18:58:53.669775 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 18:58:54.389198 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 18:58:54.433236 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 18:58:54.434236 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 18:58:54.435221 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 18:58:56.980548 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 2.55 seconds
2020-11-05 18:58:57.021579 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 18:58:57.677985 (MainThread): Using snowflake connection "master".
2020-11-05 18:58:57.678986 (MainThread): On master: BEGIN
2020-11-05 18:58:57.678986 (MainThread): Opening a new connection, currently in state init
2020-11-05 18:58:59.351175 (MainThread): SQL status: SUCCESS 1 in 1.67 seconds
2020-11-05 18:58:59.352175 (MainThread): On master: COMMIT
2020-11-05 18:58:59.352175 (MainThread): Using snowflake connection "master".
2020-11-05 18:58:59.352175 (MainThread): On master: COMMIT
2020-11-05 18:58:59.590228 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2020-11-05 18:58:59.590228 (MainThread): On master: Close
2020-11-05 18:58:59.785277 (MainThread): 19:58:59 | Concurrency: 1 threads (target='dev')
2020-11-05 18:58:59.786277 (MainThread): 19:58:59 | 
2020-11-05 18:58:59.809295 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 18:58:59.813295 (Thread-1): 19:58:59 | 1 of 5 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 18:58:59.818295 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:58:59.819297 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 18:58:59.903810 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 18:58:59.905810 (Thread-1): finished collecting timing info
2020-11-05 18:59:00.043827 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 18:59:00.077832 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:59:00.078332 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 18:59:00.078332 (Thread-1): Opening a new connection, currently in state init
2020-11-05 18:59:00.972195 (Thread-1): SQL status: SUCCESS 1 in 0.89 seconds
2020-11-05 18:59:00.972195 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:59:00.973193 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 18:59:02.201386 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2020-11-05 18:59:02.206386 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 18:59:02.207389 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 18:59:02.208387 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 18:59:02.379086 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-11-05 18:59:02.471116 (Thread-1): finished collecting timing info
2020-11-05 18:59:02.473117 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 18:59:02.736122 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b24a2f33-19d0-4490-adc7-76b846fd04aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C587B7A940>]}
2020-11-05 18:59:02.742623 (Thread-1): 19:59:02 | 1 of 5 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 2.92s]
2020-11-05 18:59:02.745136 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 18:59:02.747138 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 18:59:02.752136 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 18:59:02.753136 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 18:59:02.815140 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 18:59:02.818139 (Thread-1): finished collecting timing info
2020-11-05 18:59:02.821141 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 18:59:02.822141 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 18:59:02.830153 (Thread-1): 19:59:02 | 2 of 5 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 18:59:02.833152 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:59:02.834155 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 18:59:02.881657 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 18:59:02.887160 (Thread-1): finished collecting timing info
2020-11-05 18:59:02.919164 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 18:59:02.930164 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:59:02.931666 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 18:59:02.932165 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:59:04.735465 (Thread-1): SQL status: SUCCESS 1 in 1.80 seconds
2020-11-05 18:59:04.736467 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:59:04.736467 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 18:59:08.435586 (Thread-1): SQL status: SUCCESS 1 in 3.70 seconds
2020-11-05 18:59:08.441086 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 18:59:08.443087 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 18:59:08.443587 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 18:59:08.610109 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-11-05 18:59:08.633112 (Thread-1): finished collecting timing info
2020-11-05 18:59:08.635611 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 18:59:08.897711 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b24a2f33-19d0-4490-adc7-76b846fd04aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C587BAEDC0>]}
2020-11-05 18:59:08.908211 (Thread-1): 19:59:08 | 2 of 5 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 6.06s]
2020-11-05 18:59:09.317262 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 18:59:09.317762 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 18:59:09.323262 (Thread-1): 19:59:09 | 3 of 5 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 18:59:09.324763 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:59:09.325763 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 18:59:09.359267 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 18:59:09.391271 (Thread-1): finished collecting timing info
2020-11-05 18:59:09.422276 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 18:59:09.427276 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:59:09.427776 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 18:59:09.428277 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:59:12.076243 (Thread-1): SQL status: SUCCESS 1 in 2.65 seconds
2020-11-05 18:59:12.076243 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:59:12.077241 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 18:59:13.398580 (Thread-1): SQL status: SUCCESS 1 in 1.32 seconds
2020-11-05 18:59:13.400581 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 18:59:13.400581 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 18:59:13.401581 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 18:59:13.546648 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-11-05 18:59:13.551650 (Thread-1): finished collecting timing info
2020-11-05 18:59:13.551650 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 18:59:13.761702 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b24a2f33-19d0-4490-adc7-76b846fd04aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C587B7D940>]}
2020-11-05 18:59:13.763703 (Thread-1): 19:59:13 | 3 of 5 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 4.44s]
2020-11-05 18:59:13.766704 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 18:59:13.767704 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 18:59:13.769703 (Thread-1): 19:59:13 | 4 of 5 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 18:59:13.770703 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:59:13.771704 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 18:59:13.790706 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 18:59:13.792705 (Thread-1): finished collecting timing info
2020-11-05 18:59:13.871726 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 18:59:13.928238 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:59:13.928740 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 18:59:13.928740 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:59:15.640958 (Thread-1): SQL status: SUCCESS 1 in 1.71 seconds
2020-11-05 18:59:15.641458 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:59:15.641458 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 18:59:16.150449 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2020-11-05 18:59:16.152450 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 18:59:16.152951 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 18:59:16.152951 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 18:59:16.297499 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 18:59:16.304999 (Thread-1): finished collecting timing info
2020-11-05 18:59:16.306002 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 18:59:16.538152 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b24a2f33-19d0-4490-adc7-76b846fd04aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C587B7D970>]}
2020-11-05 18:59:16.542151 (Thread-1): 19:59:16 | 4 of 5 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 2.77s]
2020-11-05 18:59:16.552151 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 18:59:16.553151 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 18:59:16.554151 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 18:59:16.554151 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 18:59:16.586161 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 18:59:16.589161 (Thread-1): finished collecting timing info
2020-11-05 18:59:16.593163 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 18:59:16.595171 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 18:59:16.596173 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 18:59:16.596173 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 18:59:16.645173 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-05 18:59:16.649174 (Thread-1): finished collecting timing info
2020-11-05 18:59:16.652174 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 18:59:16.653174 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-05 18:59:16.655175 (Thread-1): 19:59:16 | 5 of 5 START table model cko_dbt_am.pageviews_history................ [RUN]
2020-11-05 18:59:16.660174 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 18:59:16.660174 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-05 18:59:16.687687 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 18:59:16.689186 (Thread-1): finished collecting timing info
2020-11-05 18:59:16.711190 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 18:59:16.717690 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 18:59:16.718190 (Thread-1): On model.cko_dbt_am.pageviews_history: BEGIN
2020-11-05 18:59:16.719190 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 18:59:17.954073 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2020-11-05 18:59:17.955073 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 18:59:17.956073 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_history  as
      (/* Config line */



with  __dbt__CTE__pageviews_extract_ephemere as (
/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
),  __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM __dbt__CTE__pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"

where user_id in (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_ephemeral as (
-- Use the `ref` function to select from other models


with 
	pageviews_extract_ephemere as __dbt__CTE__pageviews_extract_ephemere)
	,users_extract_ephemere as __dbt__CTE__users_extract_Ephemere



SELECT 
	pageviews_extract_ephemere.*
	,users_extract_ephemere.Customer_postcode
FROM  pageviews_extract_ephemere
LEFT JOIN users_extract_ephemere on users_extract_ephemere.user_id=pageviews_extract_ephemere.user_id
),(Select * FROM "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_HISTORY") as history

insert into history
		Select * FROM __dbt__CTE__pageviews_history_ephemeral
      );
2020-11-05 18:59:18.182831 (Thread-1): Snowflake query id: 01981253-008d-946b-0000-6c5d0001a31e
2020-11-05 18:59:18.183830 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 41 at position 31 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
syntax error line 42 at position 28 unexpected '__dbt__CTE__users_extract_Ephemere'.
syntax error line 48 at position 24 unexpected '.'.
syntax error line 51 at position 1 unexpected ','.
2020-11-05 18:59:18.184831 (Thread-1): finished collecting timing info
2020-11-05 18:59:18.185832 (Thread-1): On model.cko_dbt_am.pageviews_history: ROLLBACK
2020-11-05 18:59:18.480837 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-05 18:59:18.807445 (Thread-1): Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 31 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
  syntax error line 42 at position 28 unexpected '__dbt__CTE__users_extract_Ephemere'.
  syntax error line 48 at position 24 unexpected '.'.
  syntax error line 51 at position 1 unexpected ','.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 41 at position 31 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
syntax error line 42 at position 28 unexpected '__dbt__CTE__users_extract_Ephemere'.
syntax error line 48 at position 24 unexpected '.'.
syntax error line 51 at position 1 unexpected ','.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\users\alexandre\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 31 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
  syntax error line 42 at position 28 unexpected '__dbt__CTE__users_extract_Ephemere'.
  syntax error line 48 at position 24 unexpected '.'.
  syntax error line 51 at position 1 unexpected ','.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
2020-11-05 18:59:18.834445 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b24a2f33-19d0-4490-adc7-76b846fd04aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C587D3F100>]}
2020-11-05 18:59:18.844447 (Thread-1): 19:59:18 | 5 of 5 ERROR creating table model cko_dbt_am.pageviews_history....... [ERROR in 2.17s]
2020-11-05 18:59:19.213536 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-05 18:59:19.221537 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 18:59:19.223037 (MainThread): Using snowflake connection "master".
2020-11-05 18:59:19.224538 (MainThread): On master: BEGIN
2020-11-05 18:59:19.225538 (MainThread): Opening a new connection, currently in state closed
2020-11-05 18:59:20.557703 (MainThread): SQL status: SUCCESS 1 in 1.33 seconds
2020-11-05 18:59:20.558703 (MainThread): On master: COMMIT
2020-11-05 18:59:20.559702 (MainThread): Using snowflake connection "master".
2020-11-05 18:59:20.559702 (MainThread): On master: COMMIT
2020-11-05 18:59:20.846978 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2020-11-05 18:59:20.848977 (MainThread): On master: Close
2020-11-05 18:59:21.050089 (MainThread): 19:59:21 | 
2020-11-05 18:59:21.052088 (MainThread): 19:59:21 | Finished running 4 table models, 1 view model in 29.88s.
2020-11-05 18:59:21.053088 (MainThread): Connection 'master' was properly closed.
2020-11-05 18:59:21.053088 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 18:59:21.054088 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 18:59:21.055089 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-05 18:59:21.160119 (MainThread): 
2020-11-05 18:59:21.161118 (MainThread): Completed with 1 error and 0 warnings:
2020-11-05 18:59:21.164118 (MainThread): 
2020-11-05 18:59:21.170118 (MainThread): Database Error in model pageviews_history (models\pageviews_history.sql)
2020-11-05 18:59:21.183118 (MainThread):   001003 (42000): SQL compilation error:
2020-11-05 18:59:21.186119 (MainThread):   syntax error line 41 at position 31 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
2020-11-05 18:59:21.196137 (MainThread):   syntax error line 42 at position 28 unexpected '__dbt__CTE__users_extract_Ephemere'.
2020-11-05 18:59:21.198138 (MainThread):   syntax error line 48 at position 24 unexpected '.'.
2020-11-05 18:59:21.201138 (MainThread):   syntax error line 51 at position 1 unexpected ','.
2020-11-05 18:59:21.204638 (MainThread):   compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
2020-11-05 18:59:21.215150 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2020-11-05 18:59:21.221151 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C587D1BAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C587D1B430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C587D0D070>]}
2020-11-05 18:59:21.222153 (MainThread): Flushing usage events
2020-11-05 19:01:23.737507 (MainThread): Running with dbt=0.18.1
2020-11-05 19:01:24.003585 (MainThread): Loading KWallet
2020-11-05 19:01:24.005586 (MainThread): Loading SecretService
2020-11-05 19:01:24.008569 (MainThread): Loading Windows
2020-11-05 19:01:24.197629 (MainThread): Loading chainer
2020-11-05 19:01:24.198630 (MainThread): Loading macOS
2020-11-05 19:01:24.961868 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 19:01:24.963851 (MainThread): Tracking: tracking
2020-11-05 19:01:24.963851 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6AAD94FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6AAD85700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6AAD85D90>]}
2020-11-05 19:01:25.013854 (MainThread): Partial parsing not enabled
2020-11-05 19:01:25.016856 (MainThread): Parsing macros\adapters.sql
2020-11-05 19:01:25.094872 (MainThread): Parsing macros\catalog.sql
2020-11-05 19:01:25.100873 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 19:01:25.126380 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 19:01:25.132381 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 19:01:25.142904 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 19:01:25.155904 (MainThread): Parsing macros\core.sql
2020-11-05 19:01:25.165905 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 19:01:25.291913 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 19:01:25.315914 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 19:01:25.318914 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 19:01:25.323421 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 19:01:25.329421 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 19:01:25.333922 (MainThread): Parsing macros\etc\query.sql
2020-11-05 19:01:25.336923 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 19:01:25.363931 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 19:01:25.400932 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 19:01:25.406933 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 19:01:25.424472 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 19:01:25.481965 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 19:01:25.549998 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 19:01:25.554982 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 19:01:25.602000 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 19:01:25.620985 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 19:01:25.635513 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 19:01:25.658018 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 19:01:25.667019 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 19:01:25.672019 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 19:01:25.682021 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 19:01:25.702021 (MainThread): Partial parsing not enabled
2020-11-05 19:01:25.812041 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:01:25.870048 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:01:25.901553 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:01:25.931557 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:01:25.962061 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:01:25.991565 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:01:26.037572 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:01:26.072075 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:01:26.645161 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 19:01:26.788184 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 19:01:26.791184 (MainThread): 
2020-11-05 19:01:26.793700 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:01:26.816206 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 19:01:26.851221 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 19:01:26.851221 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 19:01:26.851221 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 19:01:29.200924 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.35 seconds
2020-11-05 19:01:29.227941 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 19:01:29.674278 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:01:29.761289 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:01:29.761289 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 19:01:29.762290 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 19:01:31.838272 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 2.08 seconds
2020-11-05 19:01:31.875291 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 19:01:32.461722 (MainThread): Using snowflake connection "master".
2020-11-05 19:01:32.461722 (MainThread): On master: BEGIN
2020-11-05 19:01:32.462719 (MainThread): Opening a new connection, currently in state init
2020-11-05 19:01:34.165121 (MainThread): SQL status: SUCCESS 1 in 1.70 seconds
2020-11-05 19:01:34.166121 (MainThread): On master: COMMIT
2020-11-05 19:01:34.167120 (MainThread): Using snowflake connection "master".
2020-11-05 19:01:34.168122 (MainThread): On master: COMMIT
2020-11-05 19:01:34.770590 (MainThread): SQL status: SUCCESS 1 in 0.60 seconds
2020-11-05 19:01:34.771589 (MainThread): On master: Close
2020-11-05 19:01:35.250788 (MainThread): 20:01:35 | Concurrency: 1 threads (target='dev')
2020-11-05 19:01:35.252772 (MainThread): 20:01:35 | 
2020-11-05 19:01:35.284773 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:01:35.286775 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:01:35.287775 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:01:35.409834 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 19:01:35.413334 (Thread-1): finished collecting timing info
2020-11-05 19:01:35.415834 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:01:35.416834 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:01:35.424836 (Thread-1): 20:01:35 | 1 of 6 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 19:01:35.426846 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:01:35.427847 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:01:35.494867 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:01:35.497851 (Thread-1): finished collecting timing info
2020-11-05 19:01:35.717954 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:01:35.724937 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:01:35.725949 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 19:01:35.725949 (Thread-1): Opening a new connection, currently in state init
2020-11-05 19:01:37.783398 (Thread-1): SQL status: SUCCESS 1 in 2.06 seconds
2020-11-05 19:01:37.784400 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:01:37.785400 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 19:01:39.052365 (Thread-1): SQL status: SUCCESS 1 in 1.27 seconds
2020-11-05 19:01:39.057366 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:01:39.058365 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:01:39.059365 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:01:39.193400 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2020-11-05 19:01:39.292431 (Thread-1): finished collecting timing info
2020-11-05 19:01:39.294429 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 19:01:39.509968 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e240e24e-f23b-472a-91c6-4e9751f69780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6AB4855B0>]}
2020-11-05 19:01:39.516969 (Thread-1): 20:01:39 | 1 of 6 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 4.08s]
2020-11-05 19:01:39.519968 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:01:39.521468 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:01:39.529970 (Thread-1): 20:01:39 | 2 of 6 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 19:01:39.533470 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:01:39.534471 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 19:01:39.607980 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:01:39.612980 (Thread-1): finished collecting timing info
2020-11-05 19:01:39.645485 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:01:39.656487 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:01:39.656987 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 19:01:39.657486 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:01:41.236825 (Thread-1): SQL status: SUCCESS 1 in 1.58 seconds
2020-11-05 19:01:41.236825 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:01:41.237825 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 19:01:45.499778 (Thread-1): SQL status: SUCCESS 1 in 4.26 seconds
2020-11-05 19:01:45.504781 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:01:45.505779 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:01:45.506779 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:01:45.656276 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-11-05 19:01:45.668277 (Thread-1): finished collecting timing info
2020-11-05 19:01:45.670277 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 19:01:45.895329 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e240e24e-f23b-472a-91c6-4e9751f69780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6AB2E5C10>]}
2020-11-05 19:01:45.901313 (Thread-1): 20:01:45 | 2 of 6 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 6.36s]
2020-11-05 19:01:45.905313 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:01:45.906313 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 19:01:45.917314 (Thread-1): 20:01:45 | 3 of 6 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 19:01:45.920314 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:01:45.921315 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 19:01:45.973842 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:01:45.977843 (Thread-1): finished collecting timing info
2020-11-05 19:01:46.004845 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:01:46.012845 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:01:46.013846 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 19:01:46.013846 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:01:48.268565 (Thread-1): SQL status: SUCCESS 1 in 2.25 seconds
2020-11-05 19:01:48.269583 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:01:48.269583 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 19:01:49.710199 (Thread-1): SQL status: SUCCESS 1 in 1.44 seconds
2020-11-05 19:01:49.715200 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:01:49.716200 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:01:49.717199 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:01:49.852763 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 19:01:49.864763 (Thread-1): finished collecting timing info
2020-11-05 19:01:49.866762 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 19:01:50.314786 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e240e24e-f23b-472a-91c6-4e9751f69780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6AB31AAC0>]}
2020-11-05 19:01:50.321786 (Thread-1): 20:01:50 | 3 of 6 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 4.39s]
2020-11-05 19:01:50.324771 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 19:01:50.325770 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:01:50.328771 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:01:50.329772 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:01:50.399287 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 19:01:50.405788 (Thread-1): finished collecting timing info
2020-11-05 19:01:50.408789 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:01:50.409288 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:01:50.417801 (Thread-1): 20:01:50 | 4 of 6 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 19:01:50.419801 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:01:50.421802 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:01:50.475806 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:01:50.479803 (Thread-1): finished collecting timing info
2020-11-05 19:01:50.620882 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:01:50.626883 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:01:50.627882 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 19:01:50.627882 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:01:52.797926 (Thread-1): SQL status: SUCCESS 1 in 2.17 seconds
2020-11-05 19:01:52.797926 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:01:52.798943 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 19:01:53.296035 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2020-11-05 19:01:53.301037 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:01:53.302036 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:01:53.303034 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:01:53.444978 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 19:01:53.464506 (Thread-1): finished collecting timing info
2020-11-05 19:01:53.465506 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 19:01:53.699572 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e240e24e-f23b-472a-91c6-4e9751f69780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6AB49DBB0>]}
2020-11-05 19:01:53.706575 (Thread-1): 20:01:53 | 4 of 6 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 3.28s]
2020-11-05 19:01:53.709572 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:01:53.710572 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:01:53.717575 (Thread-1): 20:01:53 | 5 of 6 START table model cko_dbt_am.pageviews_history_ephemeral...... [RUN]
2020-11-05 19:01:53.724574 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:01:53.725575 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:01:53.804123 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-05 19:01:53.811105 (Thread-1): finished collecting timing info
2020-11-05 19:01:53.839107 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-05 19:01:53.857108 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:01:53.858110 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: BEGIN
2020-11-05 19:01:53.859109 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:01:55.895400 (Thread-1): SQL status: SUCCESS 1 in 2.04 seconds
2020-11-05 19:01:55.896399 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:01:55.896399 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history_ephemeral"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_history_ephemeral  as
      (-- Use the `ref` function to select from other models


with 
	 __dbt__CTE__pageviews_extract_ephemere as (
/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
),  __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM __dbt__CTE__pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"

where user_id in (SELECT user_id FROM active_user)
),pageviews_extract_ephemere as __dbt__CTE__pageviews_extract_ephemere)
	,users_extract_ephemere as __dbt__CTE__users_extract_Ephemere



SELECT 
	pageviews_extract_ephemere.*
	,users_extract_ephemere.Customer_postcode
FROM  pageviews_extract_ephemere
LEFT JOIN users_extract_ephemere on users_extract_ephemere.user_id=pageviews_extract_ephemere.user_id
      );
2020-11-05 19:01:56.126463 (Thread-1): Snowflake query id: 01981255-0022-6880-0000-6c5d0001a346
2020-11-05 19:01:56.126463 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 36 at position 32 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
syntax error line 37 at position 28 unexpected '__dbt__CTE__users_extract_Ephemere'.
syntax error line 43 at position 24 unexpected '.'.
syntax error line 45 at position 36 unexpected 'users_extract_ephemere'.
2020-11-05 19:01:56.126463 (Thread-1): finished collecting timing info
2020-11-05 19:01:56.127462 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: ROLLBACK
2020-11-05 19:01:56.386530 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: Close
2020-11-05 19:01:56.581086 (Thread-1): Database Error in model pageviews_history_ephemeral (models\pageviews_history_ephemeral.sql)
  001003 (42000): SQL compilation error:
  syntax error line 36 at position 32 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
  syntax error line 37 at position 28 unexpected '__dbt__CTE__users_extract_Ephemere'.
  syntax error line 43 at position 24 unexpected '.'.
  syntax error line 45 at position 36 unexpected 'users_extract_ephemere'.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history_ephemeral.sql
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 36 at position 32 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
syntax error line 37 at position 28 unexpected '__dbt__CTE__users_extract_Ephemere'.
syntax error line 43 at position 24 unexpected '.'.
syntax error line 45 at position 36 unexpected 'users_extract_ephemere'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\users\alexandre\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model pageviews_history_ephemeral (models\pageviews_history_ephemeral.sql)
  001003 (42000): SQL compilation error:
  syntax error line 36 at position 32 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
  syntax error line 37 at position 28 unexpected '__dbt__CTE__users_extract_Ephemere'.
  syntax error line 43 at position 24 unexpected '.'.
  syntax error line 45 at position 36 unexpected 'users_extract_ephemere'.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history_ephemeral.sql
2020-11-05 19:01:56.593596 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e240e24e-f23b-472a-91c6-4e9751f69780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6AB4A3A60>]}
2020-11-05 19:01:56.597597 (Thread-1): 20:01:56 | 5 of 6 ERROR creating table model cko_dbt_am.pageviews_history_ephemeral [ERROR in 2.87s]
2020-11-05 19:01:56.598595 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:01:56.601596 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-05 19:01:56.601596 (Thread-1): 20:01:56 | 6 of 6 SKIP relation cko_dbt_am.pageviews_history.................... [SKIP]
2020-11-05 19:01:56.609596 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-05 19:01:56.612597 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:01:56.612597 (MainThread): Using snowflake connection "master".
2020-11-05 19:01:56.613598 (MainThread): On master: BEGIN
2020-11-05 19:01:56.613598 (MainThread): Opening a new connection, currently in state closed
2020-11-05 19:01:57.970758 (MainThread): SQL status: SUCCESS 1 in 1.36 seconds
2020-11-05 19:01:57.970758 (MainThread): On master: COMMIT
2020-11-05 19:01:57.971759 (MainThread): Using snowflake connection "master".
2020-11-05 19:01:57.972761 (MainThread): On master: COMMIT
2020-11-05 19:01:58.249704 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2020-11-05 19:01:58.250704 (MainThread): On master: Close
2020-11-05 19:01:58.492697 (MainThread): 20:01:58 | 
2020-11-05 19:01:58.494181 (MainThread): 20:01:58 | Finished running 5 table models, 1 view model in 31.70s.
2020-11-05 19:01:58.502191 (MainThread): Connection 'master' was properly closed.
2020-11-05 19:01:58.502191 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 19:01:58.503193 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 19:01:58.503193 (MainThread): Connection 'model.cko_dbt_am.pageviews_history_ephemeral' was properly closed.
2020-11-05 19:01:58.625232 (MainThread): 
2020-11-05 19:01:58.626242 (MainThread): Completed with 1 error and 0 warnings:
2020-11-05 19:01:58.636231 (MainThread): 
2020-11-05 19:01:58.645232 (MainThread): Database Error in model pageviews_history_ephemeral (models\pageviews_history_ephemeral.sql)
2020-11-05 19:01:58.647233 (MainThread):   001003 (42000): SQL compilation error:
2020-11-05 19:01:58.654233 (MainThread):   syntax error line 36 at position 32 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
2020-11-05 19:01:58.663235 (MainThread):   syntax error line 37 at position 28 unexpected '__dbt__CTE__users_extract_Ephemere'.
2020-11-05 19:01:58.668234 (MainThread):   syntax error line 43 at position 24 unexpected '.'.
2020-11-05 19:01:58.671233 (MainThread):   syntax error line 45 at position 36 unexpected 'users_extract_ephemere'.
2020-11-05 19:01:58.674233 (MainThread):   compiled SQL at target\run\cko_dbt_am\models\pageviews_history_ephemeral.sql
2020-11-05 19:01:58.683250 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
2020-11-05 19:01:58.687250 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6AB417EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6AB3232B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6AB3231F0>]}
2020-11-05 19:01:58.688750 (MainThread): Flushing usage events
2020-11-05 19:04:21.113333 (MainThread): Running with dbt=0.18.1
2020-11-05 19:04:21.387420 (MainThread): Loading KWallet
2020-11-05 19:04:21.389420 (MainThread): Loading SecretService
2020-11-05 19:04:21.391420 (MainThread): Loading Windows
2020-11-05 19:04:21.580160 (MainThread): Loading chainer
2020-11-05 19:04:21.582162 (MainThread): Loading macOS
2020-11-05 19:04:22.555314 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 19:04:22.557313 (MainThread): Tracking: tracking
2020-11-05 19:04:22.557814 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229161B4970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002291619E910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002291619EF40>]}
2020-11-05 19:04:22.611321 (MainThread): Partial parsing not enabled
2020-11-05 19:04:22.614322 (MainThread): Parsing macros\adapters.sql
2020-11-05 19:04:22.694339 (MainThread): Parsing macros\catalog.sql
2020-11-05 19:04:22.701339 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 19:04:22.726358 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 19:04:22.735357 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 19:04:22.746357 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 19:04:22.757358 (MainThread): Parsing macros\core.sql
2020-11-05 19:04:22.767866 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 19:04:22.882440 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 19:04:22.906440 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 19:04:22.909440 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 19:04:22.914441 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 19:04:22.919441 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 19:04:22.924441 (MainThread): Parsing macros\etc\query.sql
2020-11-05 19:04:22.928443 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 19:04:22.957443 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 19:04:22.995477 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 19:04:23.000475 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 19:04:23.021461 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 19:04:23.091478 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 19:04:23.166990 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 19:04:23.172490 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 19:04:23.216518 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 19:04:23.234502 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 19:04:23.248504 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 19:04:23.268027 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 19:04:23.276535 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 19:04:23.280550 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 19:04:23.286534 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 19:04:23.304535 (MainThread): Partial parsing not enabled
2020-11-05 19:04:23.401587 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:04:23.452592 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:04:23.483606 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:04:23.508609 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:04:23.533609 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:04:23.560633 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:04:23.591644 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:04:23.617662 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:04:24.159335 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 19:04:24.304878 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 19:04:24.308880 (MainThread): 
2020-11-05 19:04:24.309880 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:04:24.328898 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 19:04:24.368390 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 19:04:24.368890 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 19:04:24.369390 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 19:04:27.010901 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.64 seconds
2020-11-05 19:04:27.039886 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 19:04:27.331909 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:04:27.383927 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:04:27.384927 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 19:04:27.384927 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 19:04:29.229803 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.84 seconds
2020-11-05 19:04:29.268834 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 19:04:29.505621 (MainThread): Using snowflake connection "master".
2020-11-05 19:04:29.506620 (MainThread): On master: BEGIN
2020-11-05 19:04:29.506620 (MainThread): Opening a new connection, currently in state init
2020-11-05 19:04:31.102112 (MainThread): SQL status: SUCCESS 1 in 1.60 seconds
2020-11-05 19:04:31.103112 (MainThread): On master: COMMIT
2020-11-05 19:04:31.104112 (MainThread): Using snowflake connection "master".
2020-11-05 19:04:31.105113 (MainThread): On master: COMMIT
2020-11-05 19:04:31.510850 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2020-11-05 19:04:31.511850 (MainThread): On master: Close
2020-11-05 19:04:31.719905 (MainThread): 20:04:31 | Concurrency: 1 threads (target='dev')
2020-11-05 19:04:31.721905 (MainThread): 20:04:31 | 
2020-11-05 19:04:31.798756 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:04:31.804757 (Thread-1): 20:04:31 | 1 of 5 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 19:04:31.807742 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:04:31.808742 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:04:31.963289 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:04:31.966788 (Thread-1): finished collecting timing info
2020-11-05 19:04:32.200863 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:04:32.213863 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:04:32.214863 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 19:04:32.214863 (Thread-1): Opening a new connection, currently in state init
2020-11-05 19:04:34.058512 (Thread-1): SQL status: SUCCESS 1 in 1.84 seconds
2020-11-05 19:04:34.059010 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:04:34.059512 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 19:04:35.706539 (Thread-1): SQL status: SUCCESS 1 in 1.65 seconds
2020-11-05 19:04:35.711541 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:04:35.713540 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:04:35.713540 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:04:35.850583 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 19:04:35.940612 (Thread-1): finished collecting timing info
2020-11-05 19:04:35.943614 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 19:04:36.561225 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a3507fe-bcb3-4609-ade8-56a4c5829c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002291671EDF0>]}
2020-11-05 19:04:36.565226 (Thread-1): 20:04:36 | 1 of 5 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 4.75s]
2020-11-05 19:04:36.567225 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:04:36.568225 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:04:36.569228 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:04:36.569228 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:04:36.594225 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 19:04:36.601226 (Thread-1): finished collecting timing info
2020-11-05 19:04:36.602228 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:04:36.603228 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:04:36.606227 (Thread-1): 20:04:36 | 2 of 5 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 19:04:36.621229 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:04:36.621229 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 19:04:36.655741 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:04:36.660242 (Thread-1): finished collecting timing info
2020-11-05 19:04:36.674744 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:04:36.681745 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:04:36.682245 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 19:04:36.682245 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:04:39.023033 (Thread-1): SQL status: SUCCESS 1 in 2.34 seconds
2020-11-05 19:04:39.024034 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:04:39.024034 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 19:04:42.904857 (Thread-1): SQL status: SUCCESS 1 in 3.88 seconds
2020-11-05 19:04:42.910856 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:04:42.911855 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:04:42.911855 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:04:43.142607 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-11-05 19:04:43.153609 (Thread-1): finished collecting timing info
2020-11-05 19:04:43.155622 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 19:04:43.372134 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a3507fe-bcb3-4609-ade8-56a4c5829c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229164CED60>]}
2020-11-05 19:04:43.379134 (Thread-1): 20:04:43 | 2 of 5 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 6.75s]
2020-11-05 19:04:43.382634 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:04:43.383634 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 19:04:43.394137 (Thread-1): 20:04:43 | 3 of 5 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 19:04:43.396637 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:04:43.397635 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 19:04:43.462644 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:04:43.466645 (Thread-1): finished collecting timing info
2020-11-05 19:04:43.503149 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:04:43.509151 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:04:43.510151 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 19:04:43.510651 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:04:45.448974 (Thread-1): SQL status: SUCCESS 1 in 1.94 seconds
2020-11-05 19:04:45.449973 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:04:45.449973 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 19:04:47.687970 (Thread-1): SQL status: SUCCESS 1 in 2.24 seconds
2020-11-05 19:04:47.692969 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:04:47.693970 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:04:47.693970 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:04:47.853241 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2020-11-05 19:04:47.866252 (Thread-1): finished collecting timing info
2020-11-05 19:04:47.867752 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 19:04:48.171349 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a3507fe-bcb3-4609-ade8-56a4c5829c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022916712160>]}
2020-11-05 19:04:48.178350 (Thread-1): 20:04:48 | 3 of 5 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 4.77s]
2020-11-05 19:04:48.193365 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 19:04:48.194364 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:04:48.201364 (Thread-1): 20:04:48 | 4 of 5 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 19:04:48.215364 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:04:48.216365 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:04:48.274894 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:04:48.280894 (Thread-1): finished collecting timing info
2020-11-05 19:04:48.425928 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:04:48.431429 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:04:48.432430 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 19:04:48.432930 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:04:50.551865 (Thread-1): SQL status: SUCCESS 1 in 2.12 seconds
2020-11-05 19:04:50.551865 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:04:50.552865 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 19:04:50.993996 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2020-11-05 19:04:50.996999 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:04:50.997997 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:04:50.997997 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:04:51.125022 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2020-11-05 19:04:51.134022 (Thread-1): finished collecting timing info
2020-11-05 19:04:51.135022 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 19:04:51.388367 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a3507fe-bcb3-4609-ade8-56a4c5829c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229168AD0A0>]}
2020-11-05 19:04:51.391366 (Thread-1): 20:04:51 | 4 of 5 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 3.17s]
2020-11-05 19:04:51.393366 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:04:51.394367 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:04:51.395366 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:04:51.395366 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:04:51.435368 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 19:04:51.437368 (Thread-1): finished collecting timing info
2020-11-05 19:04:51.439369 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:04:51.441368 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:04:51.442370 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:04:51.442370 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:04:51.487384 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-05 19:04:51.492384 (Thread-1): finished collecting timing info
2020-11-05 19:04:51.493884 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:04:51.495385 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-05 19:04:51.498393 (Thread-1): 20:04:51 | 5 of 5 START table model cko_dbt_am.pageviews_history................ [RUN]
2020-11-05 19:04:51.503386 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:04:51.503886 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-05 19:04:51.541891 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 19:04:51.544391 (Thread-1): finished collecting timing info
2020-11-05 19:04:51.559393 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 19:04:51.567894 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:04:51.568394 (Thread-1): On model.cko_dbt_am.pageviews_history: BEGIN
2020-11-05 19:04:51.568394 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:04:52.665848 (Thread-1): SQL status: SUCCESS 1 in 1.10 seconds
2020-11-05 19:04:52.666849 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:04:52.666849 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_history  as
      (/* Config line */



with  __dbt__CTE__pageviews_extract_ephemere as (
/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
),  __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM __dbt__CTE__pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"

where user_id in (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_ephemeral as (
-- Use the `ref` function to select from other models


with 
	pageviews_extract_ephemere as __dbt__CTE__pageviews_extract_ephemere
	,users_extract_ephemere as __dbt__CTE__users_extract_Ephemere



SELECT 
	pageviews_extract_ephemere.*
	,users_extract_ephemere.Customer_postcode
FROM  pageviews_extract_ephemere
LEFT JOIN users_extract_ephemere on users_extract.user_id=pageviews_extract_ephemere.user_id
),(Select * FROM "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_HISTORY") as history

insert into history
		Select * FROM __dbt__CTE__pageviews_history_ephemeral
      );
2020-11-05 19:04:52.826398 (Thread-1): Snowflake query id: 01981258-0000-83f5-0000-6c5d00014f9a
2020-11-05 19:04:52.827400 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 41 at position 31 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
syntax error line 42 at position 1 unexpected ','.
syntax error line 42 at position 28 unexpected '__dbt__CTE__users_extract_Ephemere'.
syntax error line 48 at position 24 unexpected '.'.
syntax error line 51 at position 1 unexpected ','.
2020-11-05 19:04:52.828399 (Thread-1): finished collecting timing info
2020-11-05 19:04:52.829398 (Thread-1): On model.cko_dbt_am.pageviews_history: ROLLBACK
2020-11-05 19:04:53.097362 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-05 19:04:53.313327 (Thread-1): Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 31 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
  syntax error line 42 at position 1 unexpected ','.
  syntax error line 42 at position 28 unexpected '__dbt__CTE__users_extract_Ephemere'.
  syntax error line 48 at position 24 unexpected '.'.
  syntax error line 51 at position 1 unexpected ','.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 41 at position 31 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
syntax error line 42 at position 1 unexpected ','.
syntax error line 42 at position 28 unexpected '__dbt__CTE__users_extract_Ephemere'.
syntax error line 48 at position 24 unexpected '.'.
syntax error line 51 at position 1 unexpected ','.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\users\alexandre\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 31 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
  syntax error line 42 at position 1 unexpected ','.
  syntax error line 42 at position 28 unexpected '__dbt__CTE__users_extract_Ephemere'.
  syntax error line 48 at position 24 unexpected '.'.
  syntax error line 51 at position 1 unexpected ','.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:04:53.335327 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a3507fe-bcb3-4609-ade8-56a4c5829c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229168AA400>]}
2020-11-05 19:04:53.342329 (Thread-1): 20:04:53 | 5 of 5 ERROR creating table model cko_dbt_am.pageviews_history....... [ERROR in 1.83s]
2020-11-05 19:04:53.345329 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-05 19:04:53.352329 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:04:53.353329 (MainThread): Using snowflake connection "master".
2020-11-05 19:04:53.354329 (MainThread): On master: BEGIN
2020-11-05 19:04:53.357329 (MainThread): Opening a new connection, currently in state closed
2020-11-05 19:04:55.300212 (MainThread): SQL status: SUCCESS 1 in 1.94 seconds
2020-11-05 19:04:55.301212 (MainThread): On master: COMMIT
2020-11-05 19:04:55.302212 (MainThread): Using snowflake connection "master".
2020-11-05 19:04:55.302713 (MainThread): On master: COMMIT
2020-11-05 19:04:55.705463 (MainThread): SQL status: SUCCESS 1 in 0.40 seconds
2020-11-05 19:04:55.705463 (MainThread): On master: Close
2020-11-05 19:04:55.976504 (MainThread): 20:04:55 | 
2020-11-05 19:04:55.977504 (MainThread): 20:04:55 | Finished running 4 table models, 1 view model in 31.67s.
2020-11-05 19:04:56.009747 (MainThread): Connection 'master' was properly closed.
2020-11-05 19:04:56.010747 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 19:04:56.011746 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 19:04:56.012247 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-05 19:04:56.255776 (MainThread): 
2020-11-05 19:04:56.297781 (MainThread): Completed with 1 error and 0 warnings:
2020-11-05 19:04:56.345286 (MainThread): 
2020-11-05 19:04:56.350287 (MainThread): Database Error in model pageviews_history (models\pageviews_history.sql)
2020-11-05 19:04:56.352288 (MainThread):   001003 (42000): SQL compilation error:
2020-11-05 19:04:56.355288 (MainThread):   syntax error line 41 at position 31 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
2020-11-05 19:04:56.358289 (MainThread):   syntax error line 42 at position 1 unexpected ','.
2020-11-05 19:04:56.360288 (MainThread):   syntax error line 42 at position 28 unexpected '__dbt__CTE__users_extract_Ephemere'.
2020-11-05 19:04:56.361790 (MainThread):   syntax error line 48 at position 24 unexpected '.'.
2020-11-05 19:04:56.363290 (MainThread):   syntax error line 51 at position 1 unexpected ','.
2020-11-05 19:04:56.364789 (MainThread):   compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:04:56.370791 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2020-11-05 19:04:56.372290 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229168BF4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022916858820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022916858040>]}
2020-11-05 19:04:56.373291 (MainThread): Flushing usage events
2020-11-05 19:08:53.217304 (MainThread): Running with dbt=0.18.1
2020-11-05 19:08:53.480402 (MainThread): Loading KWallet
2020-11-05 19:08:53.483402 (MainThread): Loading SecretService
2020-11-05 19:08:53.485402 (MainThread): Loading Windows
2020-11-05 19:08:53.673423 (MainThread): Loading chainer
2020-11-05 19:08:53.674423 (MainThread): Loading macOS
2020-11-05 19:08:55.670435 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 19:08:55.672935 (MainThread): Tracking: tracking
2020-11-05 19:08:55.673436 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195ED964CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195ED94E8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195ED94EEE0>]}
2020-11-05 19:08:55.745958 (MainThread): Partial parsing not enabled
2020-11-05 19:08:55.749958 (MainThread): Parsing macros\adapters.sql
2020-11-05 19:08:55.862991 (MainThread): Parsing macros\catalog.sql
2020-11-05 19:08:55.869991 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 19:08:55.908002 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 19:08:55.916990 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 19:08:55.933013 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 19:08:55.949013 (MainThread): Parsing macros\core.sql
2020-11-05 19:08:55.963014 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 19:08:56.125060 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 19:08:56.158063 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 19:08:56.162062 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 19:08:56.169062 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 19:08:56.176062 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 19:08:56.183063 (MainThread): Parsing macros\etc\query.sql
2020-11-05 19:08:56.187063 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 19:08:56.224073 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 19:08:56.278098 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 19:08:56.285098 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 19:08:56.310088 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 19:08:56.395120 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 19:08:56.558173 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 19:08:56.565181 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 19:08:56.629173 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 19:08:56.655693 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 19:08:56.675214 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 19:08:56.700203 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 19:08:56.711215 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 19:08:56.718204 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 19:08:56.726205 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 19:08:56.751737 (MainThread): Partial parsing not enabled
2020-11-05 19:08:56.882284 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:08:56.958330 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:08:56.995340 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:08:57.031334 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:08:57.067359 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:08:57.107362 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:08:57.152896 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:08:57.188414 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:08:57.749057 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 19:08:57.889596 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 19:08:57.892596 (MainThread): 
2020-11-05 19:08:57.894596 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:08:57.912597 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 19:08:57.949111 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 19:08:57.949610 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 19:08:57.949610 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 19:09:00.524690 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.58 seconds
2020-11-05 19:09:00.551709 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 19:09:00.996945 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:09:01.040947 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:09:01.041932 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 19:09:01.042931 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 19:09:02.888061 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.85 seconds
2020-11-05 19:09:02.931064 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 19:09:03.272650 (MainThread): Using snowflake connection "master".
2020-11-05 19:09:03.273648 (MainThread): On master: BEGIN
2020-11-05 19:09:03.274649 (MainThread): Opening a new connection, currently in state init
2020-11-05 19:09:05.183478 (MainThread): SQL status: SUCCESS 1 in 1.91 seconds
2020-11-05 19:09:05.184495 (MainThread): On master: COMMIT
2020-11-05 19:09:05.185495 (MainThread): Using snowflake connection "master".
2020-11-05 19:09:05.185495 (MainThread): On master: COMMIT
2020-11-05 19:09:05.528109 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2020-11-05 19:09:05.528109 (MainThread): On master: Close
2020-11-05 19:09:05.832422 (MainThread): 20:09:05 | Concurrency: 1 threads (target='dev')
2020-11-05 19:09:05.834421 (MainThread): 20:09:05 | 
2020-11-05 19:09:06.017474 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:09:06.024476 (Thread-1): 20:09:06 | 1 of 5 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 19:09:06.027478 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:09:06.028476 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:09:06.277006 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:09:06.289008 (Thread-1): finished collecting timing info
2020-11-05 19:09:06.564013 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:09:06.571514 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:09:06.572015 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 19:09:06.573015 (Thread-1): Opening a new connection, currently in state init
2020-11-05 19:09:30.659874 (Thread-1): SQL status: SUCCESS 1 in 24.09 seconds
2020-11-05 19:09:30.659874 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:09:30.660873 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 19:09:32.371407 (Thread-1): SQL status: SUCCESS 1 in 1.71 seconds
2020-11-05 19:09:32.376403 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:09:32.378393 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:09:32.378393 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:09:32.563472 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-11-05 19:09:32.646520 (Thread-1): finished collecting timing info
2020-11-05 19:09:32.648520 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 19:09:33.318458 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e141db1-922d-4be0-8bf6-6e3c753579cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195EDFDD1C0>]}
2020-11-05 19:09:33.324957 (Thread-1): 20:09:33 | 1 of 5 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 27.29s]
2020-11-05 19:09:33.328956 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:09:33.330456 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:09:33.333957 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:09:33.334958 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:09:33.408976 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 19:09:33.413975 (Thread-1): finished collecting timing info
2020-11-05 19:09:33.416977 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:09:33.417975 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:09:33.425989 (Thread-1): 20:09:33 | 2 of 5 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 19:09:33.441493 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:09:33.442492 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 19:09:33.505000 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:09:33.508499 (Thread-1): finished collecting timing info
2020-11-05 19:09:33.552006 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:09:33.562507 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:09:33.563007 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 19:09:33.563508 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:09:36.222268 (Thread-1): SQL status: SUCCESS 1 in 2.66 seconds
2020-11-05 19:09:36.223269 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:09:36.224268 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 19:09:39.785893 (Thread-1): SQL status: SUCCESS 1 in 3.56 seconds
2020-11-05 19:09:39.790894 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:09:39.791895 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:09:39.792894 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:09:40.289072 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2020-11-05 19:09:40.301072 (Thread-1): finished collecting timing info
2020-11-05 19:09:40.302071 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 19:09:40.614286 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e141db1-922d-4be0-8bf6-6e3c753579cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195EDECB3A0>]}
2020-11-05 19:09:40.620287 (Thread-1): 20:09:40 | 2 of 5 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 7.17s]
2020-11-05 19:09:40.623288 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:09:40.624288 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 19:09:40.631300 (Thread-1): 20:09:40 | 3 of 5 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 19:09:40.637800 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:09:40.638800 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 19:09:40.733336 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:09:40.738334 (Thread-1): finished collecting timing info
2020-11-05 19:09:40.778839 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:09:40.785339 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:09:40.785839 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 19:09:40.786340 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:09:42.721160 (Thread-1): SQL status: SUCCESS 1 in 1.93 seconds
2020-11-05 19:09:42.722177 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:09:42.722703 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 19:09:44.290820 (Thread-1): SQL status: SUCCESS 1 in 1.57 seconds
2020-11-05 19:09:44.295822 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:09:44.296821 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:09:44.297820 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:09:44.501879 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-11-05 19:09:44.512879 (Thread-1): finished collecting timing info
2020-11-05 19:09:44.514878 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 19:09:44.862529 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e141db1-922d-4be0-8bf6-6e3c753579cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195EE062BB0>]}
2020-11-05 19:09:44.868529 (Thread-1): 20:09:44 | 3 of 5 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 4.22s]
2020-11-05 19:09:44.879528 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 19:09:44.880527 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:09:44.904528 (Thread-1): 20:09:44 | 4 of 5 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 19:09:44.918531 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:09:44.919531 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:09:44.994562 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:09:44.998562 (Thread-1): finished collecting timing info
2020-11-05 19:09:45.139588 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:09:45.146091 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:09:45.146590 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 19:09:45.148592 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:09:47.284220 (Thread-1): SQL status: SUCCESS 1 in 2.14 seconds
2020-11-05 19:09:47.285204 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:09:47.286205 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 19:09:48.179816 (Thread-1): SQL status: SUCCESS 1 in 0.89 seconds
2020-11-05 19:09:48.184817 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:09:48.185835 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:09:48.186832 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:09:48.348461 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2020-11-05 19:09:48.366982 (Thread-1): finished collecting timing info
2020-11-05 19:09:48.368000 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 19:09:48.713687 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e141db1-922d-4be0-8bf6-6e3c753579cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195EE062BB0>]}
2020-11-05 19:09:48.719687 (Thread-1): 20:09:48 | 4 of 5 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 3.79s]
2020-11-05 19:09:48.722672 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:09:48.723671 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:09:48.725672 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:09:48.726690 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:09:48.793209 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 19:09:48.796208 (Thread-1): finished collecting timing info
2020-11-05 19:09:48.800210 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:09:48.805210 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:09:48.806210 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:09:48.807209 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:09:48.881239 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-05 19:09:48.885239 (Thread-1): finished collecting timing info
2020-11-05 19:09:48.887239 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:09:48.889240 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-05 19:09:48.895239 (Thread-1): 20:09:48 | 5 of 5 START table model cko_dbt_am.pageviews_history................ [RUN]
2020-11-05 19:09:48.898241 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:09:48.900240 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-05 19:09:48.968255 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 19:09:48.972257 (Thread-1): finished collecting timing info
2020-11-05 19:09:48.999259 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 19:09:49.014261 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:09:49.014761 (Thread-1): On model.cko_dbt_am.pageviews_history: BEGIN
2020-11-05 19:09:49.015261 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:09:51.005865 (Thread-1): SQL status: SUCCESS 1 in 1.99 seconds
2020-11-05 19:09:51.006867 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:09:51.006867 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_history  as
      (/* Config line */



with  __dbt__CTE__pageviews_extract_ephemere as (
/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
),  __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM __dbt__CTE__pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"

where user_id in (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_ephemeral as (
-- Use the `ref` function to select from other models


with 
	pageviews as __dbt__CTE__pageviews_extract_ephemere
	,users as __dbt__CTE__users_extract_Ephemere



SELECT 
	pageviews.*
	,u.[Customer_postcode]
FROM  pageviews
LEFT OUTER JOIN (SELECT * FROM users) u on u.]user_id]=pageviews.[user_id]
),(Select * FROM "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_HISTORY") as history

insert into history
		Select * FROM __dbt__CTE__pageviews_history_ephemeral
      );
2020-11-05 19:09:51.246199 (Thread-1): Snowflake query id: 0198125d-0056-667f-0000-6c5d0001a36a
2020-11-05 19:09:51.247182 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 41 at position 14 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
syntax error line 42 at position 1 unexpected ','.
syntax error line 42 at position 11 unexpected '__dbt__CTE__users_extract_Ephemere'.
syntax error line 48 at position 3 unexpected '.'.
syntax error line 50 at position 38 unexpected 'u'.
syntax error line 50 at position 43 unexpected 'u'.
2020-11-05 19:09:51.248200 (Thread-1): finished collecting timing info
2020-11-05 19:09:51.249200 (Thread-1): On model.cko_dbt_am.pageviews_history: ROLLBACK
2020-11-05 19:09:51.524186 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-05 19:09:51.907886 (Thread-1): Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 14 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
  syntax error line 42 at position 1 unexpected ','.
  syntax error line 42 at position 11 unexpected '__dbt__CTE__users_extract_Ephemere'.
  syntax error line 48 at position 3 unexpected '.'.
  syntax error line 50 at position 38 unexpected 'u'.
  syntax error line 50 at position 43 unexpected 'u'.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 41 at position 14 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
syntax error line 42 at position 1 unexpected ','.
syntax error line 42 at position 11 unexpected '__dbt__CTE__users_extract_Ephemere'.
syntax error line 48 at position 3 unexpected '.'.
syntax error line 50 at position 38 unexpected 'u'.
syntax error line 50 at position 43 unexpected 'u'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\users\alexandre\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 14 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
  syntax error line 42 at position 1 unexpected ','.
  syntax error line 42 at position 11 unexpected '__dbt__CTE__users_extract_Ephemere'.
  syntax error line 48 at position 3 unexpected '.'.
  syntax error line 50 at position 38 unexpected 'u'.
  syntax error line 50 at position 43 unexpected 'u'.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:09:51.930914 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e141db1-922d-4be0-8bf6-6e3c753579cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195EE063A90>]}
2020-11-05 19:09:51.937426 (Thread-1): 20:09:51 | 5 of 5 ERROR creating table model cko_dbt_am.pageviews_history....... [ERROR in 3.03s]
2020-11-05 19:09:51.941423 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-05 19:09:51.947425 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:09:51.952427 (MainThread): Using snowflake connection "master".
2020-11-05 19:09:51.953424 (MainThread): On master: BEGIN
2020-11-05 19:09:51.954424 (MainThread): Opening a new connection, currently in state closed
2020-11-05 19:09:54.155783 (MainThread): SQL status: SUCCESS 1 in 2.20 seconds
2020-11-05 19:09:54.156782 (MainThread): On master: COMMIT
2020-11-05 19:09:54.157783 (MainThread): Using snowflake connection "master".
2020-11-05 19:09:54.158781 (MainThread): On master: COMMIT
2020-11-05 19:09:54.533824 (MainThread): SQL status: SUCCESS 1 in 0.38 seconds
2020-11-05 19:09:54.534823 (MainThread): On master: Close
2020-11-05 19:09:54.865697 (MainThread): 20:09:54 | 
2020-11-05 19:09:54.866697 (MainThread): 20:09:54 | Finished running 4 table models, 1 view model in 56.97s.
2020-11-05 19:09:54.880208 (MainThread): Connection 'master' was properly closed.
2020-11-05 19:09:54.881209 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 19:09:54.881709 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 19:09:54.883710 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-05 19:09:55.004725 (MainThread): 
2020-11-05 19:09:55.014226 (MainThread): Completed with 1 error and 0 warnings:
2020-11-05 19:09:55.024728 (MainThread): 
2020-11-05 19:09:55.040229 (MainThread): Database Error in model pageviews_history (models\pageviews_history.sql)
2020-11-05 19:09:55.048229 (MainThread):   001003 (42000): SQL compilation error:
2020-11-05 19:09:55.055232 (MainThread):   syntax error line 41 at position 14 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
2020-11-05 19:09:55.060236 (MainThread):   syntax error line 42 at position 1 unexpected ','.
2020-11-05 19:09:55.070734 (MainThread):   syntax error line 42 at position 11 unexpected '__dbt__CTE__users_extract_Ephemere'.
2020-11-05 19:09:55.076235 (MainThread):   syntax error line 48 at position 3 unexpected '.'.
2020-11-05 19:09:55.086238 (MainThread):   syntax error line 50 at position 38 unexpected 'u'.
2020-11-05 19:09:55.089738 (MainThread):   syntax error line 50 at position 43 unexpected 'u'.
2020-11-05 19:09:55.097737 (MainThread):   compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:09:55.106237 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2020-11-05 19:09:55.116740 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195EE076C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195EE076FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195EE076910>]}
2020-11-05 19:09:55.121241 (MainThread): Flushing usage events
2020-11-05 19:16:17.202635 (MainThread): Running with dbt=0.18.1
2020-11-05 19:16:17.986663 (MainThread): Loading KWallet
2020-11-05 19:16:17.994162 (MainThread): Loading SecretService
2020-11-05 19:16:18.000665 (MainThread): Loading Windows
2020-11-05 19:16:18.490226 (MainThread): Loading chainer
2020-11-05 19:16:18.493227 (MainThread): Loading macOS
2020-11-05 19:16:19.534858 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 19:16:19.536859 (MainThread): Tracking: tracking
2020-11-05 19:16:19.536859 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE0373A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE035B7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE035BE80>]}
2020-11-05 19:16:19.595366 (MainThread): Partial parsing not enabled
2020-11-05 19:16:19.598866 (MainThread): Parsing macros\adapters.sql
2020-11-05 19:16:19.696879 (MainThread): Parsing macros\catalog.sql
2020-11-05 19:16:19.702880 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 19:16:19.736384 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 19:16:19.742885 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 19:16:19.758387 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 19:16:19.770389 (MainThread): Parsing macros\core.sql
2020-11-05 19:16:19.782889 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 19:16:19.928909 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 19:16:19.960412 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 19:16:19.963913 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 19:16:19.969913 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 19:16:19.975915 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 19:16:19.982915 (MainThread): Parsing macros\etc\query.sql
2020-11-05 19:16:19.986416 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 19:16:20.013919 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 19:16:20.054924 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 19:16:20.061425 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 19:16:20.082428 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 19:16:20.141434 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 19:16:20.212463 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 19:16:20.217480 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 19:16:20.262483 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 19:16:20.280484 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 19:16:20.294006 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 19:16:20.310528 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 19:16:20.318512 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 19:16:20.323530 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 19:16:20.329513 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 19:16:20.347515 (MainThread): Partial parsing not enabled
2020-11-05 19:16:20.438578 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:16:20.490580 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:16:20.515625 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:16:20.541612 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:16:20.567612 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:16:20.594637 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:16:20.622645 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:16:20.648632 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:16:21.179827 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 19:16:21.316900 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 19:16:21.320891 (MainThread): 
2020-11-05 19:16:21.321892 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:16:21.339892 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 19:16:21.373911 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 19:16:21.373911 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 19:16:21.374911 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 19:16:23.532916 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.16 seconds
2020-11-05 19:16:23.560919 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 19:16:23.871599 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:16:23.917109 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:16:23.918110 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 19:16:23.919110 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 19:16:25.661391 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.74 seconds
2020-11-05 19:16:25.699409 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 19:16:25.936521 (MainThread): Using snowflake connection "master".
2020-11-05 19:16:25.937522 (MainThread): On master: BEGIN
2020-11-05 19:16:25.938521 (MainThread): Opening a new connection, currently in state init
2020-11-05 19:16:27.820333 (MainThread): SQL status: SUCCESS 1 in 1.88 seconds
2020-11-05 19:16:27.821333 (MainThread): On master: COMMIT
2020-11-05 19:16:27.821833 (MainThread): Using snowflake connection "master".
2020-11-05 19:16:27.822333 (MainThread): On master: COMMIT
2020-11-05 19:16:28.077648 (MainThread): unclosed <socket.socket fd=1640, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.5.101', 65468), raddr=('168.63.27.166', 443)>
2020-11-05 19:16:28.080649 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2020-11-05 19:16:28.080649 (MainThread): On master: Close
2020-11-05 19:16:29.449386 (MainThread): 20:16:29 | Concurrency: 1 threads (target='dev')
2020-11-05 19:16:29.451369 (MainThread): 20:16:29 | 
2020-11-05 19:16:29.481373 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:16:29.489376 (Thread-1): 20:16:29 | 1 of 5 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 19:16:29.494372 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:16:29.495374 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:16:29.637278 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:16:29.640278 (Thread-1): finished collecting timing info
2020-11-05 19:16:29.855365 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:16:29.863349 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:16:29.863349 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 19:16:29.864350 (Thread-1): Opening a new connection, currently in state init
2020-11-05 19:16:31.378872 (Thread-1): SQL status: SUCCESS 1 in 1.51 seconds
2020-11-05 19:16:31.379871 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:16:31.380871 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 19:16:32.881624 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2020-11-05 19:16:32.886608 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:16:32.887608 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:16:32.888609 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:16:33.063101 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-11-05 19:16:33.147122 (Thread-1): finished collecting timing info
2020-11-05 19:16:33.149133 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 19:16:33.347281 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '620d19de-3c1f-448c-b4e6-8f63e84006b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE0A160A0>]}
2020-11-05 19:16:33.353309 (Thread-1): 20:16:33 | 1 of 5 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 3.85s]
2020-11-05 19:16:33.357292 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:16:33.358292 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:16:33.360310 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:16:33.361309 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:16:33.407295 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 19:16:33.410295 (Thread-1): finished collecting timing info
2020-11-05 19:16:33.413297 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:16:33.414297 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:16:33.422297 (Thread-1): 20:16:33 | 2 of 5 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 19:16:33.424297 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:16:33.425296 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 19:16:33.473340 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:16:33.477324 (Thread-1): finished collecting timing info
2020-11-05 19:16:33.503326 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:16:33.513327 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:16:33.514329 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 19:16:33.515328 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:16:36.391001 (Thread-1): SQL status: SUCCESS 1 in 2.88 seconds
2020-11-05 19:16:36.392002 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:16:36.392002 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 19:16:40.274723 (Thread-1): SQL status: SUCCESS 1 in 3.88 seconds
2020-11-05 19:16:40.279724 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:16:40.280724 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:16:40.280724 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:16:40.572846 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2020-11-05 19:16:40.584846 (Thread-1): finished collecting timing info
2020-11-05 19:16:40.585849 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 19:16:40.817451 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '620d19de-3c1f-448c-b4e6-8f63e84006b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE08FFAF0>]}
2020-11-05 19:16:40.824452 (Thread-1): 20:16:40 | 2 of 5 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 7.39s]
2020-11-05 19:16:40.827964 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:16:40.828963 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 19:16:40.836970 (Thread-1): 20:16:40 | 3 of 5 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 19:16:40.842966 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:16:40.843965 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 19:16:40.903974 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:16:40.908969 (Thread-1): finished collecting timing info
2020-11-05 19:16:40.957493 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:16:40.964994 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:16:40.965994 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 19:16:40.966494 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:16:42.803893 (Thread-1): SQL status: SUCCESS 1 in 1.84 seconds
2020-11-05 19:16:42.804894 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:16:42.804894 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 19:16:44.729943 (Thread-1): SQL status: SUCCESS 1 in 1.92 seconds
2020-11-05 19:16:44.734944 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:16:44.734944 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:16:44.735944 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:16:44.931903 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-11-05 19:16:44.943904 (Thread-1): finished collecting timing info
2020-11-05 19:16:44.944905 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 19:16:45.155974 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '620d19de-3c1f-448c-b4e6-8f63e84006b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE08FFE20>]}
2020-11-05 19:16:45.162974 (Thread-1): 20:16:45 | 3 of 5 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 4.31s]
2020-11-05 19:16:45.166488 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 19:16:45.167488 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:16:45.174992 (Thread-1): 20:16:45 | 4 of 5 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 19:16:45.181003 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:16:45.182003 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:16:45.246007 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:16:45.251007 (Thread-1): finished collecting timing info
2020-11-05 19:16:45.354031 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:16:45.360530 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:16:45.361030 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 19:16:45.361531 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:16:46.733654 (Thread-1): SQL status: SUCCESS 1 in 1.37 seconds
2020-11-05 19:16:46.733654 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:16:46.734655 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 19:16:47.227422 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2020-11-05 19:16:47.232408 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:16:47.233408 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:16:47.234426 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:16:47.393721 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2020-11-05 19:16:47.411721 (Thread-1): finished collecting timing info
2020-11-05 19:16:47.413722 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 19:16:47.622724 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '620d19de-3c1f-448c-b4e6-8f63e84006b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE0A69D90>]}
2020-11-05 19:16:47.628724 (Thread-1): 20:16:47 | 4 of 5 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 2.44s]
2020-11-05 19:16:47.631706 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:16:47.632707 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:16:47.636709 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:16:47.636709 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:16:47.705235 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 19:16:47.709234 (Thread-1): finished collecting timing info
2020-11-05 19:16:47.712233 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:16:47.714233 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:16:47.715236 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:16:47.716234 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:16:47.791274 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-05 19:16:47.794273 (Thread-1): finished collecting timing info
2020-11-05 19:16:47.797276 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:16:47.799275 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-05 19:16:47.805275 (Thread-1): 20:16:47 | 5 of 5 START table model cko_dbt_am.pageviews_history................ [RUN]
2020-11-05 19:16:47.808274 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:16:47.810276 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-05 19:16:47.874321 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 19:16:47.877806 (Thread-1): finished collecting timing info
2020-11-05 19:16:47.906319 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 19:16:47.920321 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:16:47.921320 (Thread-1): On model.cko_dbt_am.pageviews_history: BEGIN
2020-11-05 19:16:47.922320 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:16:49.971731 (Thread-1): SQL status: SUCCESS 1 in 2.05 seconds
2020-11-05 19:16:49.972733 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:16:49.973731 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_history  as
      (/* Config line */



with  __dbt__CTE__pageviews_extract_ephemere as (
/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
),  __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM __dbt__CTE__pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"

where user_id in (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_ephemeral as (
-- Use the `ref` function to select from other models


with 
	pageviews as __dbt__CTE__pageviews_extract_ephemere
	,users as __dbt__CTE__users_extract_Ephemere



SELECT 
	[pageviews].*
	,[u].[Customer_postcode]
FROM  pageviews
LEFT OUTER JOIN (SELECT * FROM users) u on u.[user_id]=pageviews.[user_id]
),(Select * FROM "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_HISTORY") as history

insert into history
		Select * FROM __dbt__CTE__pageviews_history_ephemeral
      );
2020-11-05 19:16:50.199671 (Thread-1): Snowflake query id: 01981264-0049-acba-0000-6c5d0001b02a
2020-11-05 19:16:50.200673 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 41 at position 14 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
syntax error line 42 at position 1 unexpected ','.
syntax error line 42 at position 11 unexpected '__dbt__CTE__users_extract_Ephemere'.
syntax error line 48 at position 2 unexpected '['.
syntax error line 50 at position 17 unexpected 'SELECT'.
syntax error line 51 at position 1 unexpected ','.
2020-11-05 19:16:50.201671 (Thread-1): finished collecting timing info
2020-11-05 19:16:50.202672 (Thread-1): On model.cko_dbt_am.pageviews_history: ROLLBACK
2020-11-05 19:16:50.456766 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-05 19:16:50.668833 (Thread-1): Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 14 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
  syntax error line 42 at position 1 unexpected ','.
  syntax error line 42 at position 11 unexpected '__dbt__CTE__users_extract_Ephemere'.
  syntax error line 48 at position 2 unexpected '['.
  syntax error line 50 at position 17 unexpected 'SELECT'.
  syntax error line 51 at position 1 unexpected ','.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 41 at position 14 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
syntax error line 42 at position 1 unexpected ','.
syntax error line 42 at position 11 unexpected '__dbt__CTE__users_extract_Ephemere'.
syntax error line 48 at position 2 unexpected '['.
syntax error line 50 at position 17 unexpected 'SELECT'.
syntax error line 51 at position 1 unexpected ','.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\users\alexandre\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 41 at position 14 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
  syntax error line 42 at position 1 unexpected ','.
  syntax error line 42 at position 11 unexpected '__dbt__CTE__users_extract_Ephemere'.
  syntax error line 48 at position 2 unexpected '['.
  syntax error line 50 at position 17 unexpected 'SELECT'.
  syntax error line 51 at position 1 unexpected ','.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:16:50.693336 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '620d19de-3c1f-448c-b4e6-8f63e84006b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE08D7EE0>]}
2020-11-05 19:16:50.700836 (Thread-1): 20:16:50 | 5 of 5 ERROR creating table model cko_dbt_am.pageviews_history....... [ERROR in 2.89s]
2020-11-05 19:16:50.705336 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-05 19:16:50.711839 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:16:50.713337 (MainThread): Using snowflake connection "master".
2020-11-05 19:16:50.714337 (MainThread): On master: BEGIN
2020-11-05 19:16:50.714838 (MainThread): Opening a new connection, currently in state closed
2020-11-05 19:16:52.134093 (MainThread): SQL status: SUCCESS 1 in 1.42 seconds
2020-11-05 19:16:52.135094 (MainThread): On master: COMMIT
2020-11-05 19:16:52.135094 (MainThread): Using snowflake connection "master".
2020-11-05 19:16:52.135094 (MainThread): On master: COMMIT
2020-11-05 19:16:52.405170 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2020-11-05 19:16:52.406169 (MainThread): On master: Close
2020-11-05 19:16:52.587221 (MainThread): 20:16:52 | 
2020-11-05 19:16:52.588222 (MainThread): 20:16:52 | Finished running 4 table models, 1 view model in 31.27s.
2020-11-05 19:16:52.594221 (MainThread): Connection 'master' was properly closed.
2020-11-05 19:16:52.594221 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 19:16:52.595221 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 19:16:52.595221 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-05 19:16:52.648224 (MainThread): 
2020-11-05 19:16:52.652224 (MainThread): Completed with 1 error and 0 warnings:
2020-11-05 19:16:52.655223 (MainThread): 
2020-11-05 19:16:52.658226 (MainThread): Database Error in model pageviews_history (models\pageviews_history.sql)
2020-11-05 19:16:52.663224 (MainThread):   001003 (42000): SQL compilation error:
2020-11-05 19:16:52.668226 (MainThread):   syntax error line 41 at position 14 unexpected '__dbt__CTE__pageviews_extract_ephemere'.
2020-11-05 19:16:52.675234 (MainThread):   syntax error line 42 at position 1 unexpected ','.
2020-11-05 19:16:52.677735 (MainThread):   syntax error line 42 at position 11 unexpected '__dbt__CTE__users_extract_Ephemere'.
2020-11-05 19:16:52.680235 (MainThread):   syntax error line 48 at position 2 unexpected '['.
2020-11-05 19:16:52.682735 (MainThread):   syntax error line 50 at position 17 unexpected 'SELECT'.
2020-11-05 19:16:52.686236 (MainThread):   syntax error line 51 at position 1 unexpected ','.
2020-11-05 19:16:52.691736 (MainThread):   compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:16:52.697737 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2020-11-05 19:16:52.708738 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE09061C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE09062E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE0A8CEE0>]}
2020-11-05 19:16:52.709739 (MainThread): Flushing usage events
2020-11-05 19:19:45.791522 (MainThread): Running with dbt=0.18.1
2020-11-05 19:19:46.712687 (MainThread): Loading KWallet
2020-11-05 19:19:46.720188 (MainThread): Loading SecretService
2020-11-05 19:19:46.726688 (MainThread): Loading Windows
2020-11-05 19:19:47.142241 (MainThread): Loading chainer
2020-11-05 19:19:47.144241 (MainThread): Loading macOS
2020-11-05 19:19:48.115013 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 19:19:48.117013 (MainThread): Tracking: tracking
2020-11-05 19:19:48.117513 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213368C4670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213368AD7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213368ADE50>]}
2020-11-05 19:19:48.175021 (MainThread): Partial parsing not enabled
2020-11-05 19:19:48.179021 (MainThread): Parsing macros\adapters.sql
2020-11-05 19:19:48.267032 (MainThread): Parsing macros\catalog.sql
2020-11-05 19:19:48.273033 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 19:19:48.302037 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 19:19:48.308538 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 19:19:48.320040 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 19:19:48.334041 (MainThread): Parsing macros\core.sql
2020-11-05 19:19:48.347543 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 19:19:48.467564 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 19:19:48.492564 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 19:19:48.495564 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 19:19:48.500566 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 19:19:48.505566 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 19:19:48.510565 (MainThread): Parsing macros\etc\query.sql
2020-11-05 19:19:48.514566 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 19:19:48.538073 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 19:19:48.574581 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 19:19:48.579581 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 19:19:48.597599 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 19:19:48.651643 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 19:19:48.721647 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 19:19:48.726648 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 19:19:48.771662 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 19:19:48.790663 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 19:19:48.804681 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 19:19:48.821665 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 19:19:48.829682 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 19:19:48.834204 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 19:19:48.839689 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 19:19:48.857710 (MainThread): Partial parsing not enabled
2020-11-05 19:19:49.047286 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:19:49.200857 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:19:49.270894 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:19:49.342424 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:19:49.418965 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:19:49.493991 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:19:49.629022 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:19:49.710060 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:19:51.198088 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 19:19:51.441620 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 19:19:51.455622 (MainThread): 
2020-11-05 19:19:51.458622 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:19:51.485126 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 19:19:51.536632 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 19:19:51.537132 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 19:19:51.537132 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 19:19:53.704277 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.17 seconds
2020-11-05 19:19:53.730817 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 19:19:54.028809 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:19:54.072812 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:19:54.073828 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 19:19:54.074828 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 19:19:55.884632 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.81 seconds
2020-11-05 19:19:55.925146 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 19:19:56.165464 (MainThread): Using snowflake connection "master".
2020-11-05 19:19:56.166464 (MainThread): On master: BEGIN
2020-11-05 19:19:56.166464 (MainThread): Opening a new connection, currently in state init
2020-11-05 19:19:57.676869 (MainThread): SQL status: SUCCESS 1 in 1.51 seconds
2020-11-05 19:19:57.677886 (MainThread): On master: COMMIT
2020-11-05 19:19:57.678886 (MainThread): Using snowflake connection "master".
2020-11-05 19:19:57.679886 (MainThread): On master: COMMIT
2020-11-05 19:19:57.941793 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2020-11-05 19:19:57.942793 (MainThread): On master: Close
2020-11-05 19:19:58.126077 (MainThread): 20:19:58 | Concurrency: 1 threads (target='dev')
2020-11-05 19:19:58.128061 (MainThread): 20:19:58 | 
2020-11-05 19:19:58.159573 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:19:58.166588 (Thread-1): 20:19:58 | 1 of 5 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 19:19:58.169575 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:19:58.169575 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:19:58.304636 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:19:58.308619 (Thread-1): finished collecting timing info
2020-11-05 19:19:58.518692 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:19:58.527192 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:19:58.527692 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 19:19:58.528193 (Thread-1): Opening a new connection, currently in state init
2020-11-05 19:20:00.137172 (Thread-1): SQL status: SUCCESS 1 in 1.61 seconds
2020-11-05 19:20:00.137701 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:20:00.138711 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 19:20:01.193272 (Thread-1): SQL status: SUCCESS 1 in 1.05 seconds
2020-11-05 19:20:01.198290 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:20:01.199289 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:20:01.199289 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:20:01.316527 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2020-11-05 19:20:01.394066 (Thread-1): finished collecting timing info
2020-11-05 19:20:01.395067 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 19:20:01.643119 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74b1ec51-ae59-4e6d-9fcb-8566a2ab727d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021336E1F580>]}
2020-11-05 19:20:01.648657 (Thread-1): 20:20:01 | 1 of 5 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 3.47s]
2020-11-05 19:20:01.651657 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:20:01.653641 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:20:01.655642 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:20:01.656643 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:20:01.706644 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 19:20:01.710645 (Thread-1): finished collecting timing info
2020-11-05 19:20:01.713646 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:20:01.714646 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:20:01.721647 (Thread-1): 20:20:01 | 2 of 5 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 19:20:01.732157 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:20:01.732656 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 19:20:01.788672 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:20:01.792672 (Thread-1): finished collecting timing info
2020-11-05 19:20:01.819677 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:20:01.828686 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:20:01.829686 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 19:20:01.830187 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:20:03.819693 (Thread-1): SQL status: SUCCESS 1 in 1.99 seconds
2020-11-05 19:20:03.820694 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:20:03.820694 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 19:20:07.013742 (Thread-1): SQL status: SUCCESS 1 in 3.19 seconds
2020-11-05 19:20:07.021242 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:20:07.022241 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:20:07.022742 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:20:07.216102 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-11-05 19:20:07.238606 (Thread-1): finished collecting timing info
2020-11-05 19:20:07.240106 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 19:20:07.484637 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74b1ec51-ae59-4e6d-9fcb-8566a2ab727d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021336F35B50>]}
2020-11-05 19:20:07.498138 (Thread-1): 20:20:07 | 2 of 5 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 5.75s]
2020-11-05 19:20:07.573647 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:20:07.574648 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 19:20:07.584149 (Thread-1): 20:20:07 | 3 of 5 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 19:20:07.656750 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:20:07.657749 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 19:20:07.709255 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:20:07.712255 (Thread-1): finished collecting timing info
2020-11-05 19:20:07.727257 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:20:07.731257 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:20:07.731758 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 19:20:07.732757 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:20:08.792363 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2020-11-05 19:20:08.792864 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:20:08.792864 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 19:20:10.302498 (Thread-1): SQL status: SUCCESS 1 in 1.51 seconds
2020-11-05 19:20:10.304497 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:20:10.305497 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:20:10.305497 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:20:10.783484 (Thread-1): SQL status: SUCCESS 1 in 0.48 seconds
2020-11-05 19:20:10.796486 (Thread-1): finished collecting timing info
2020-11-05 19:20:10.797486 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 19:20:11.002481 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74b1ec51-ae59-4e6d-9fcb-8566a2ab727d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021336DC4F40>]}
2020-11-05 19:20:11.008481 (Thread-1): 20:20:11 | 3 of 5 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 3.35s]
2020-11-05 19:20:11.012466 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 19:20:11.013466 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:20:11.020481 (Thread-1): 20:20:11 | 4 of 5 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 19:20:11.027981 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:20:11.028981 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:20:11.085012 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:20:11.092996 (Thread-1): finished collecting timing info
2020-11-05 19:20:11.236050 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:20:11.242052 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:20:11.243052 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 19:20:11.244051 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:20:12.998895 (Thread-1): SQL status: SUCCESS 1 in 1.75 seconds
2020-11-05 19:20:12.999894 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:20:13.000894 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 19:20:13.572122 (Thread-1): SQL status: SUCCESS 1 in 0.57 seconds
2020-11-05 19:20:13.577122 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:20:13.578122 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:20:13.578122 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:20:13.721297 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 19:20:13.739824 (Thread-1): finished collecting timing info
2020-11-05 19:20:13.740836 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 19:20:13.963955 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74b1ec51-ae59-4e6d-9fcb-8566a2ab727d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021336E1FDF0>]}
2020-11-05 19:20:13.971971 (Thread-1): 20:20:13 | 4 of 5 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 2.94s]
2020-11-05 19:20:13.974955 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:20:13.975955 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:20:13.977955 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:20:13.977955 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:20:14.051982 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 19:20:14.060984 (Thread-1): finished collecting timing info
2020-11-05 19:20:14.063983 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:20:14.065983 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:20:14.067985 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:20:14.069983 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:20:14.149052 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-05 19:20:14.153036 (Thread-1): finished collecting timing info
2020-11-05 19:20:14.155036 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:20:14.157037 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-05 19:20:14.164038 (Thread-1): 20:20:14 | 5 of 5 START table model cko_dbt_am.pageviews_history................ [RUN]
2020-11-05 19:20:14.166038 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:20:14.167038 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-05 19:20:14.242079 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 19:20:14.246079 (Thread-1): finished collecting timing info
2020-11-05 19:20:14.274097 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 19:20:14.289097 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:20:14.290098 (Thread-1): On model.cko_dbt_am.pageviews_history: BEGIN
2020-11-05 19:20:14.290098 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:20:15.978454 (Thread-1): SQL status: SUCCESS 1 in 1.69 seconds
2020-11-05 19:20:15.978952 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:20:15.979452 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_history  as
      (/* Config line */



with  __dbt__CTE__pageviews_extract_ephemere as (
/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
),  __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM __dbt__CTE__pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"

where user_id in (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_ephemeral as (
-- Use the `ref` function to select from other models


with 
	pageviews as (SELECT * FROM __dbt__CTE__pageviews_extract_ephemere)
	,users as (SELECT * FROM __dbt__CTE__users_extract_Ephemere)



SELECT 
	[pageviews].*
	,[users].[Customer_postcode]
FROM  pageviews
LEFT OUTER JOIN users on users.[user_id]=pageviews.[user_id]
),(Select * FROM "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_HISTORY") as history

insert into history
		Select * FROM __dbt__CTE__pageviews_history_ephemeral
      );
2020-11-05 19:20:16.160292 (Thread-1): Snowflake query id: 01981268-009a-3c07-0000-6c5d0001b052
2020-11-05 19:20:16.161293 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 47 at position 1 unexpected '['.
syntax error line 48 at position 2 unexpected '['.
syntax error line 50 at position 22 unexpected 'on'.
syntax error line 51 at position 1 unexpected ','.
2020-11-05 19:20:16.162292 (Thread-1): finished collecting timing info
2020-11-05 19:20:16.164291 (Thread-1): On model.cko_dbt_am.pageviews_history: ROLLBACK
2020-11-05 19:20:16.438874 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-05 19:20:16.653616 (Thread-1): Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 47 at position 1 unexpected '['.
  syntax error line 48 at position 2 unexpected '['.
  syntax error line 50 at position 22 unexpected 'on'.
  syntax error line 51 at position 1 unexpected ','.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 47 at position 1 unexpected '['.
syntax error line 48 at position 2 unexpected '['.
syntax error line 50 at position 22 unexpected 'on'.
syntax error line 51 at position 1 unexpected ','.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\users\alexandre\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 47 at position 1 unexpected '['.
  syntax error line 48 at position 2 unexpected '['.
  syntax error line 50 at position 22 unexpected 'on'.
  syntax error line 51 at position 1 unexpected ','.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:20:16.676619 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74b1ec51-ae59-4e6d-9fcb-8566a2ab727d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021336F40FA0>]}
2020-11-05 19:20:16.683630 (Thread-1): 20:20:16 | 5 of 5 ERROR creating table model cko_dbt_am.pageviews_history....... [ERROR in 2.51s]
2020-11-05 19:20:16.687630 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-05 19:20:16.693632 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:20:16.696142 (MainThread): Using snowflake connection "master".
2020-11-05 19:20:16.697143 (MainThread): On master: BEGIN
2020-11-05 19:20:16.697143 (MainThread): Opening a new connection, currently in state closed
2020-11-05 19:20:18.284022 (MainThread): SQL status: SUCCESS 1 in 1.59 seconds
2020-11-05 19:20:18.285024 (MainThread): On master: COMMIT
2020-11-05 19:20:18.286023 (MainThread): Using snowflake connection "master".
2020-11-05 19:20:18.286522 (MainThread): On master: COMMIT
2020-11-05 19:20:18.570094 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2020-11-05 19:20:18.571093 (MainThread): On master: Close
2020-11-05 19:20:18.807175 (MainThread): 20:20:18 | 
2020-11-05 19:20:18.811175 (MainThread): 20:20:18 | Finished running 4 table models, 1 view model in 27.35s.
2020-11-05 19:20:18.820174 (MainThread): Connection 'master' was properly closed.
2020-11-05 19:20:18.821175 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 19:20:18.822173 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 19:20:18.823174 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-05 19:20:18.929711 (MainThread): 
2020-11-05 19:20:18.938711 (MainThread): Completed with 1 error and 0 warnings:
2020-11-05 19:20:18.943712 (MainThread): 
2020-11-05 19:20:18.954713 (MainThread): Database Error in model pageviews_history (models\pageviews_history.sql)
2020-11-05 19:20:18.963215 (MainThread):   001003 (42000): SQL compilation error:
2020-11-05 19:20:18.972217 (MainThread):   syntax error line 47 at position 1 unexpected '['.
2020-11-05 19:20:18.975717 (MainThread):   syntax error line 48 at position 2 unexpected '['.
2020-11-05 19:20:18.979717 (MainThread):   syntax error line 50 at position 22 unexpected 'on'.
2020-11-05 19:20:18.989219 (MainThread):   syntax error line 51 at position 1 unexpected ','.
2020-11-05 19:20:18.996219 (MainThread):   compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:20:19.004724 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2020-11-05 19:20:19.016722 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021336FBCCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021336FBCD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021336FBC4F0>]}
2020-11-05 19:20:19.021722 (MainThread): Flushing usage events
2020-11-05 19:20:57.258493 (MainThread): Running with dbt=0.18.1
2020-11-05 19:20:57.604614 (MainThread): Loading KWallet
2020-11-05 19:20:57.608614 (MainThread): Loading SecretService
2020-11-05 19:20:57.611616 (MainThread): Loading Windows
2020-11-05 19:20:57.873709 (MainThread): Loading chainer
2020-11-05 19:20:57.875709 (MainThread): Loading macOS
2020-11-05 19:20:58.924290 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 19:20:58.927292 (MainThread): Tracking: tracking
2020-11-05 19:20:58.927292 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC8834DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC88216A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC8821E50>]}
2020-11-05 19:20:58.996331 (MainThread): Partial parsing not enabled
2020-11-05 19:20:59.001332 (MainThread): Parsing macros\adapters.sql
2020-11-05 19:20:59.109353 (MainThread): Parsing macros\catalog.sql
2020-11-05 19:20:59.116354 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 19:20:59.153372 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 19:20:59.161380 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 19:20:59.177368 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 19:20:59.192369 (MainThread): Parsing macros\core.sql
2020-11-05 19:20:59.208383 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 19:20:59.368461 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 19:20:59.402463 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 19:20:59.406463 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 19:20:59.412463 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 19:20:59.420464 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 19:20:59.426465 (MainThread): Parsing macros\etc\query.sql
2020-11-05 19:20:59.431465 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 19:20:59.465501 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 19:20:59.512492 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 19:20:59.518493 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 19:20:59.535503 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 19:20:59.591539 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 19:20:59.663553 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 19:20:59.668553 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 19:20:59.713567 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 19:20:59.732557 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 19:20:59.746564 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 19:20:59.763582 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 19:20:59.771584 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 19:20:59.775572 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 19:20:59.782574 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 19:20:59.801575 (MainThread): Partial parsing not enabled
2020-11-05 19:20:59.893184 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:20:59.946697 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:20:59.971715 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:20:59.996716 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:21:00.034708 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:21:00.077727 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:21:00.110729 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:21:00.136730 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:21:00.963161 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 19:21:01.360343 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 19:21:01.368346 (MainThread): 
2020-11-05 19:21:01.374345 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:21:01.424347 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 19:21:01.514374 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 19:21:01.515375 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 19:21:01.516374 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 19:21:03.692999 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.18 seconds
2020-11-05 19:21:03.720000 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 19:21:04.025441 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:21:04.070468 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:21:04.073467 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 19:21:04.073467 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 19:21:06.370126 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 2.30 seconds
2020-11-05 19:21:06.411631 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 19:21:06.653161 (MainThread): Using snowflake connection "master".
2020-11-05 19:21:06.654162 (MainThread): On master: BEGIN
2020-11-05 19:21:06.654661 (MainThread): Opening a new connection, currently in state init
2020-11-05 19:21:08.311337 (MainThread): SQL status: SUCCESS 1 in 1.66 seconds
2020-11-05 19:21:08.312335 (MainThread): On master: COMMIT
2020-11-05 19:21:08.312335 (MainThread): Using snowflake connection "master".
2020-11-05 19:21:08.312335 (MainThread): On master: COMMIT
2020-11-05 19:21:08.874059 (MainThread): SQL status: SUCCESS 1 in 0.56 seconds
2020-11-05 19:21:08.875060 (MainThread): On master: Close
2020-11-05 19:21:09.128239 (MainThread): 20:21:09 | Concurrency: 1 threads (target='dev')
2020-11-05 19:21:09.130221 (MainThread): 20:21:09 | 
2020-11-05 19:21:09.161735 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:21:09.169265 (Thread-1): 20:21:09 | 1 of 5 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 19:21:09.173247 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:21:09.174248 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:21:09.310308 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:21:09.313311 (Thread-1): finished collecting timing info
2020-11-05 19:21:09.540364 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:21:09.547866 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:21:09.548366 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 19:21:09.549366 (Thread-1): Opening a new connection, currently in state init
2020-11-05 19:21:11.888818 (Thread-1): SQL status: SUCCESS 1 in 2.34 seconds
2020-11-05 19:21:11.889831 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:21:11.889831 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 19:21:12.956293 (Thread-1): SQL status: SUCCESS 1 in 1.07 seconds
2020-11-05 19:21:12.961311 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:21:12.961311 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:21:12.962312 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:21:13.116519 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-11-05 19:21:13.193579 (Thread-1): finished collecting timing info
2020-11-05 19:21:13.194588 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 19:21:13.413139 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5d61c5f-5db9-43ac-ab50-329fa66e96d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC8D9BFA0>]}
2020-11-05 19:21:13.419138 (Thread-1): 20:21:13 | 1 of 5 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 4.24s]
2020-11-05 19:21:13.422977 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:21:13.423978 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:21:13.425995 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:21:13.427335 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:21:13.478892 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 19:21:13.483377 (Thread-1): finished collecting timing info
2020-11-05 19:21:13.485877 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:21:13.486877 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:21:13.493878 (Thread-1): 20:21:13 | 2 of 5 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 19:21:13.496391 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:21:13.499393 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 19:21:13.545393 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:21:13.549392 (Thread-1): finished collecting timing info
2020-11-05 19:21:13.576394 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:21:13.586907 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:21:13.587406 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 19:21:13.587908 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:21:15.517267 (Thread-1): SQL status: SUCCESS 1 in 1.93 seconds
2020-11-05 19:21:15.517267 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:21:15.518268 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 19:21:19.246542 (Thread-1): SQL status: SUCCESS 1 in 3.73 seconds
2020-11-05 19:21:19.251542 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:21:19.252542 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:21:19.252542 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:21:19.386282 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2020-11-05 19:21:19.398778 (Thread-1): finished collecting timing info
2020-11-05 19:21:19.400279 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 19:21:19.608371 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5d61c5f-5db9-43ac-ab50-329fa66e96d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC8D9B0D0>]}
2020-11-05 19:21:19.615370 (Thread-1): 20:21:19 | 2 of 5 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 6.11s]
2020-11-05 19:21:19.618370 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:21:19.621370 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 19:21:19.627373 (Thread-1): 20:21:19 | 3 of 5 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 19:21:19.632370 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:21:19.633370 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 19:21:19.688375 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:21:19.697887 (Thread-1): finished collecting timing info
2020-11-05 19:21:19.726392 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:21:19.732893 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:21:19.733391 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 19:21:19.733892 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:21:21.484881 (Thread-1): SQL status: SUCCESS 1 in 1.75 seconds
2020-11-05 19:21:21.485898 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:21:21.486398 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 19:21:22.916833 (Thread-1): SQL status: SUCCESS 1 in 1.43 seconds
2020-11-05 19:21:22.920833 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:21:22.921833 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:21:22.922832 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:21:23.098928 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-11-05 19:21:23.110929 (Thread-1): finished collecting timing info
2020-11-05 19:21:23.111928 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 19:21:23.339007 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5d61c5f-5db9-43ac-ab50-329fa66e96d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC8D9D940>]}
2020-11-05 19:21:23.346009 (Thread-1): 20:21:23 | 3 of 5 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 3.71s]
2020-11-05 19:21:23.349007 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 19:21:23.352008 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:21:23.358012 (Thread-1): 20:21:23 | 4 of 5 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 19:21:23.367008 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:21:23.368010 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:21:23.436037 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:21:23.445038 (Thread-1): finished collecting timing info
2020-11-05 19:21:23.598110 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:21:23.604112 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:21:23.604612 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 19:21:23.605111 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:21:25.276543 (Thread-1): SQL status: SUCCESS 1 in 1.67 seconds
2020-11-05 19:21:25.276543 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:21:25.276543 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 19:21:25.823018 (Thread-1): SQL status: SUCCESS 1 in 0.55 seconds
2020-11-05 19:21:25.828031 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:21:25.829031 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:21:25.829031 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:21:25.972501 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 19:21:25.990501 (Thread-1): finished collecting timing info
2020-11-05 19:21:25.991501 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 19:21:26.186521 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5d61c5f-5db9-43ac-ab50-329fa66e96d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC8D9D970>]}
2020-11-05 19:21:26.192511 (Thread-1): 20:21:26 | 4 of 5 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 2.82s]
2020-11-05 19:21:26.195504 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:21:26.197504 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:21:26.199507 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:21:26.199507 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:21:26.273532 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 19:21:26.278531 (Thread-1): finished collecting timing info
2020-11-05 19:21:26.280532 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:21:26.283531 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:21:26.285532 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:21:26.286531 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:21:26.357577 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-05 19:21:26.361561 (Thread-1): finished collecting timing info
2020-11-05 19:21:26.363563 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:21:26.366561 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-05 19:21:26.373563 (Thread-1): 20:21:26 | 5 of 5 START table model cko_dbt_am.pageviews_history................ [RUN]
2020-11-05 19:21:26.383563 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:21:26.384564 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-05 19:21:26.455604 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 19:21:26.458588 (Thread-1): finished collecting timing info
2020-11-05 19:21:26.486590 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 19:21:26.501591 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:21:26.502100 (Thread-1): On model.cko_dbt_am.pageviews_history: BEGIN
2020-11-05 19:21:26.502602 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:21:28.616498 (Thread-1): SQL status: SUCCESS 1 in 2.11 seconds
2020-11-05 19:21:28.617497 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:21:28.618498 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_history  as
      (/* Config line */



with  __dbt__CTE__pageviews_extract_ephemere as (
/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
),  __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM __dbt__CTE__pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"

where user_id in (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_ephemeral as (
-- Use the `ref` function to select from other models


with 
	pageviews as (SELECT * FROM __dbt__CTE__pageviews_extract_ephemere)
	,users as (SELECT * FROM __dbt__CTE__users_extract_Ephemere)



SELECT 
	pageviews.*
	,users.customer_postcode
FROM  pageviews
LEFT OUTER JOIN users on users.user_id=pageviews.user_id
),(Select * FROM "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_HISTORY") as history

insert into history
		Select * FROM __dbt__CTE__pageviews_history_ephemeral
      );
2020-11-05 19:21:28.799478 (Thread-1): Snowflake query id: 01981269-0072-b479-0000-6c5d0001a3a2
2020-11-05 19:21:28.799478 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 51 at position 2 unexpected '('.
syntax error line 51 at position 3 unexpected 'Select'.
syntax error line 55 at position 7 unexpected ';'.
2020-11-05 19:21:28.800479 (Thread-1): finished collecting timing info
2020-11-05 19:21:28.800479 (Thread-1): On model.cko_dbt_am.pageviews_history: ROLLBACK
2020-11-05 19:21:29.062143 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-05 19:21:29.281426 (Thread-1): Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 51 at position 2 unexpected '('.
  syntax error line 51 at position 3 unexpected 'Select'.
  syntax error line 55 at position 7 unexpected ';'.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 51 at position 2 unexpected '('.
syntax error line 51 at position 3 unexpected 'Select'.
syntax error line 55 at position 7 unexpected ';'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\users\alexandre\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 51 at position 2 unexpected '('.
  syntax error line 51 at position 3 unexpected 'Select'.
  syntax error line 55 at position 7 unexpected ';'.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:21:29.303428 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5d61c5f-5db9-43ac-ab50-329fa66e96d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC8EA43A0>]}
2020-11-05 19:21:29.309411 (Thread-1): 20:21:29 | 5 of 5 ERROR creating table model cko_dbt_am.pageviews_history....... [ERROR in 2.92s]
2020-11-05 19:21:29.313410 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-05 19:21:29.319413 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:21:29.325412 (MainThread): Using snowflake connection "master".
2020-11-05 19:21:29.325412 (MainThread): On master: BEGIN
2020-11-05 19:21:29.326431 (MainThread): Opening a new connection, currently in state closed
2020-11-05 19:21:30.901730 (MainThread): SQL status: SUCCESS 1 in 1.58 seconds
2020-11-05 19:21:30.902729 (MainThread): On master: COMMIT
2020-11-05 19:21:30.903731 (MainThread): Using snowflake connection "master".
2020-11-05 19:21:30.904230 (MainThread): On master: COMMIT
2020-11-05 19:21:31.226188 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2020-11-05 19:21:31.227188 (MainThread): On master: Close
2020-11-05 19:21:31.571468 (MainThread): 20:21:31 | 
2020-11-05 19:21:31.573469 (MainThread): 20:21:31 | Finished running 4 table models, 1 view model in 30.20s.
2020-11-05 19:21:31.575452 (MainThread): Connection 'master' was properly closed.
2020-11-05 19:21:31.577452 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 19:21:31.578453 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 19:21:31.579452 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-05 19:21:31.676491 (MainThread): 
2020-11-05 19:21:31.683494 (MainThread): Completed with 1 error and 0 warnings:
2020-11-05 19:21:31.685510 (MainThread): 
2020-11-05 19:21:31.688491 (MainThread): Database Error in model pageviews_history (models\pageviews_history.sql)
2020-11-05 19:21:31.691493 (MainThread):   001003 (42000): SQL compilation error:
2020-11-05 19:21:31.700515 (MainThread):   syntax error line 51 at position 2 unexpected '('.
2020-11-05 19:21:31.702011 (MainThread):   syntax error line 51 at position 3 unexpected 'Select'.
2020-11-05 19:21:31.707012 (MainThread):   syntax error line 55 at position 7 unexpected ';'.
2020-11-05 19:21:31.712512 (MainThread):   compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:21:31.717524 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2020-11-05 19:21:31.720524 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC8F31BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC8F319A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBC8F31D90>]}
2020-11-05 19:21:31.733526 (MainThread): Flushing usage events
2020-11-05 19:22:44.122825 (MainThread): Running with dbt=0.18.1
2020-11-05 19:22:44.457867 (MainThread): Loading KWallet
2020-11-05 19:22:44.461367 (MainThread): Loading SecretService
2020-11-05 19:22:44.463867 (MainThread): Loading Windows
2020-11-05 19:22:44.667406 (MainThread): Loading chainer
2020-11-05 19:22:44.669404 (MainThread): Loading macOS
2020-11-05 19:22:45.487808 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 19:22:45.490817 (MainThread): Tracking: tracking
2020-11-05 19:22:45.490817 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1F684C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1F66A7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1F66AE20>]}
2020-11-05 19:22:45.545840 (MainThread): Partial parsing not enabled
2020-11-05 19:22:45.549858 (MainThread): Parsing macros\adapters.sql
2020-11-05 19:22:45.632474 (MainThread): Parsing macros\catalog.sql
2020-11-05 19:22:45.639473 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 19:22:45.667474 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 19:22:45.674476 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 19:22:45.686476 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 19:22:45.698499 (MainThread): Parsing macros\core.sql
2020-11-05 19:22:45.709019 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 19:22:45.826040 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 19:22:45.851042 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 19:22:45.854025 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 19:22:45.859025 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 19:22:45.865025 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 19:22:45.870025 (MainThread): Parsing macros\etc\query.sql
2020-11-05 19:22:45.874025 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 19:22:45.900036 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 19:22:45.939046 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 19:22:45.945046 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 19:22:45.965047 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 19:22:46.021093 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 19:22:46.094606 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 19:22:46.101607 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 19:22:46.147146 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 19:22:46.166145 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 19:22:46.181131 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 19:22:46.200672 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 19:22:46.208184 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 19:22:46.213186 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 19:22:46.219168 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 19:22:46.237170 (MainThread): Partial parsing not enabled
2020-11-05 19:22:46.332201 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:22:46.386205 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:22:46.414220 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:22:46.452223 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:22:46.485223 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:22:46.518240 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:22:46.553243 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:22:46.586245 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:22:47.250887 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 19:22:47.396983 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 19:22:47.399983 (MainThread): 
2020-11-05 19:22:47.402483 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:22:47.420821 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 19:22:47.462821 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 19:22:47.462821 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 19:22:47.462821 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 19:22:50.508970 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 3.05 seconds
2020-11-05 19:22:50.538971 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 19:22:51.254947 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:22:51.300955 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:22:51.301956 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 19:22:51.302956 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 19:22:53.530394 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 2.23 seconds
2020-11-05 19:22:53.567395 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 19:22:54.003462 (MainThread): Using snowflake connection "master".
2020-11-05 19:22:54.004464 (MainThread): On master: BEGIN
2020-11-05 19:22:54.005463 (MainThread): Opening a new connection, currently in state init
2020-11-05 19:22:55.679486 (MainThread): SQL status: SUCCESS 1 in 1.67 seconds
2020-11-05 19:22:55.680486 (MainThread): On master: COMMIT
2020-11-05 19:22:55.681485 (MainThread): Using snowflake connection "master".
2020-11-05 19:22:55.682487 (MainThread): On master: COMMIT
2020-11-05 19:22:55.964337 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2020-11-05 19:22:55.965338 (MainThread): On master: Close
2020-11-05 19:22:56.173357 (MainThread): 20:22:56 | Concurrency: 1 threads (target='dev')
2020-11-05 19:22:56.174348 (MainThread): 20:22:56 | 
2020-11-05 19:22:56.210156 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:22:56.217139 (Thread-1): 20:22:56 | 1 of 5 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 19:22:56.223139 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:22:56.224140 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:22:56.358366 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:22:56.362350 (Thread-1): finished collecting timing info
2020-11-05 19:22:56.581607 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:22:56.590103 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:22:56.591102 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 19:22:56.591601 (Thread-1): Opening a new connection, currently in state init
2020-11-05 19:22:58.336541 (Thread-1): SQL status: SUCCESS 1 in 1.74 seconds
2020-11-05 19:22:58.337542 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:22:58.338541 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 19:22:59.843679 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2020-11-05 19:22:59.848681 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:22:59.849681 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:22:59.850180 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:22:59.994233 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 19:23:00.096263 (Thread-1): finished collecting timing info
2020-11-05 19:23:00.097264 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 19:23:00.345322 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04acecae-8ccc-4e37-86ce-23c7669a1250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1FBE9D60>]}
2020-11-05 19:23:00.352834 (Thread-1): 20:23:00 | 1 of 5 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 4.12s]
2020-11-05 19:23:00.411849 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:23:00.412850 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:23:00.415851 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:23:00.419850 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:23:00.472369 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 19:23:00.477869 (Thread-1): finished collecting timing info
2020-11-05 19:23:00.480371 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:23:00.481371 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:23:00.488872 (Thread-1): 20:23:00 | 2 of 5 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 19:23:00.499373 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:23:00.505374 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 19:23:00.556881 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:23:00.563881 (Thread-1): finished collecting timing info
2020-11-05 19:23:00.590384 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:23:00.601385 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:23:00.602386 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 19:23:00.602885 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:23:02.259677 (Thread-1): SQL status: SUCCESS 1 in 1.66 seconds
2020-11-05 19:23:02.260695 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:23:02.260695 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 19:23:05.399340 (Thread-1): SQL status: SUCCESS 1 in 3.14 seconds
2020-11-05 19:23:05.404341 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:23:05.405324 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:23:05.405324 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:23:05.531155 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2020-11-05 19:23:05.542156 (Thread-1): finished collecting timing info
2020-11-05 19:23:05.543656 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 19:23:05.852022 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04acecae-8ccc-4e37-86ce-23c7669a1250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1FCF3E20>]}
2020-11-05 19:23:05.858021 (Thread-1): 20:23:05 | 2 of 5 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 5.35s]
2020-11-05 19:23:05.861006 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:23:05.863005 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 19:23:05.869006 (Thread-1): 20:23:05 | 3 of 5 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 19:23:05.876007 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:23:05.877006 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 19:23:05.924025 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:23:05.927009 (Thread-1): finished collecting timing info
2020-11-05 19:23:05.955034 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:23:05.963036 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:23:05.963036 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 19:23:05.964036 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:23:07.720298 (Thread-1): SQL status: SUCCESS 1 in 1.76 seconds
2020-11-05 19:23:07.721298 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:23:07.722296 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 19:23:09.779469 (Thread-1): SQL status: SUCCESS 1 in 2.06 seconds
2020-11-05 19:23:09.784474 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:23:09.785458 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:23:09.786459 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:23:09.927160 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 19:23:09.940161 (Thread-1): finished collecting timing info
2020-11-05 19:23:09.942161 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 19:23:10.177713 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04acecae-8ccc-4e37-86ce-23c7669a1250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1FB84AC0>]}
2020-11-05 19:23:10.183713 (Thread-1): 20:23:10 | 3 of 5 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 4.30s]
2020-11-05 19:23:10.187042 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 19:23:10.189052 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:23:10.195054 (Thread-1): 20:23:10 | 4 of 5 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 19:23:10.200051 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:23:10.202053 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:23:10.273583 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:23:10.277583 (Thread-1): finished collecting timing info
2020-11-05 19:23:10.433655 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:23:10.441638 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:23:10.441638 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 19:23:10.442639 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:23:12.176328 (Thread-1): SQL status: SUCCESS 1 in 1.73 seconds
2020-11-05 19:23:12.177330 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:23:12.177330 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 19:23:13.138418 (Thread-1): SQL status: SUCCESS 1 in 0.96 seconds
2020-11-05 19:23:13.143419 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:23:13.144418 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:23:13.144418 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:23:13.316729 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-11-05 19:23:13.334747 (Thread-1): finished collecting timing info
2020-11-05 19:23:13.336749 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 19:23:13.561910 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04acecae-8ccc-4e37-86ce-23c7669a1250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1FBE9B80>]}
2020-11-05 19:23:13.569909 (Thread-1): 20:23:13 | 4 of 5 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 3.36s]
2020-11-05 19:23:13.573367 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:23:13.574367 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:23:13.576385 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:23:13.577368 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:23:13.656395 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 19:23:13.659397 (Thread-1): finished collecting timing info
2020-11-05 19:23:13.662397 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:23:13.664398 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:23:13.666399 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:23:13.667398 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:23:13.730436 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-05 19:23:13.734437 (Thread-1): finished collecting timing info
2020-11-05 19:23:13.736436 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:23:13.739436 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-05 19:23:13.746437 (Thread-1): 20:23:13 | 5 of 5 START table model cko_dbt_am.pageviews_history................ [RUN]
2020-11-05 19:23:13.750438 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:23:13.751438 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-05 19:23:13.819481 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 19:23:13.823465 (Thread-1): finished collecting timing info
2020-11-05 19:23:13.849483 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 19:23:13.863468 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:23:13.864468 (Thread-1): On model.cko_dbt_am.pageviews_history: BEGIN
2020-11-05 19:23:13.864468 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:23:15.858341 (Thread-1): SQL status: SUCCESS 1 in 1.99 seconds
2020-11-05 19:23:15.858341 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:23:15.859341 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_history  as
      (/* Config line */



with  __dbt__CTE__pageviews_extract_ephemere as (
/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
),  __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM __dbt__CTE__pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"

where user_id in (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_ephemeral as (
-- Use the `ref` function to select from other models



SELECT 
	pageviews.*
	,users.customer_postcode
FROM  __dbt__CTE__pageviews_extract_ephemere
LEFT OUTER JOIN __dbt__CTE__users_extract_Ephemere on users.user_id=pageviews.user_id
),(Select * FROM "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_HISTORY") as history

insert into history
		Select * FROM __dbt__CTE__pageviews_history_ephemeral
      );
2020-11-05 19:23:16.079390 (Thread-1): Snowflake query id: 0198126b-0099-d5d9-0000-6c5d00014ffa
2020-11-05 19:23:16.079390 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 46 at position 2 unexpected '('.
syntax error line 46 at position 3 unexpected 'Select'.
syntax error line 50 at position 7 unexpected ';'.
2020-11-05 19:23:16.080390 (Thread-1): finished collecting timing info
2020-11-05 19:23:16.080390 (Thread-1): On model.cko_dbt_am.pageviews_history: ROLLBACK
2020-11-05 19:23:16.336466 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-05 19:23:16.526469 (Thread-1): Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 46 at position 2 unexpected '('.
  syntax error line 46 at position 3 unexpected 'Select'.
  syntax error line 50 at position 7 unexpected ';'.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 46 at position 2 unexpected '('.
syntax error line 46 at position 3 unexpected 'Select'.
syntax error line 50 at position 7 unexpected ';'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\users\alexandre\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 46 at position 2 unexpected '('.
  syntax error line 46 at position 3 unexpected 'Select'.
  syntax error line 50 at position 7 unexpected ';'.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:23:16.534469 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04acecae-8ccc-4e37-86ce-23c7669a1250', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1FD268E0>]}
2020-11-05 19:23:16.537470 (Thread-1): 20:23:16 | 5 of 5 ERROR creating table model cko_dbt_am.pageviews_history....... [ERROR in 2.79s]
2020-11-05 19:23:16.538470 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-05 19:23:16.542472 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:23:16.543471 (MainThread): Using snowflake connection "master".
2020-11-05 19:23:16.543471 (MainThread): On master: BEGIN
2020-11-05 19:23:16.543471 (MainThread): Opening a new connection, currently in state closed
2020-11-05 19:23:18.521525 (MainThread): SQL status: SUCCESS 1 in 1.98 seconds
2020-11-05 19:23:18.523025 (MainThread): On master: COMMIT
2020-11-05 19:23:18.524025 (MainThread): Using snowflake connection "master".
2020-11-05 19:23:18.524524 (MainThread): On master: COMMIT
2020-11-05 19:23:18.787596 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2020-11-05 19:23:18.788597 (MainThread): On master: Close
2020-11-05 19:23:19.035683 (MainThread): 20:23:19 | 
2020-11-05 19:23:19.036683 (MainThread): 20:23:19 | Finished running 4 table models, 1 view model in 31.63s.
2020-11-05 19:23:19.045697 (MainThread): Connection 'master' was properly closed.
2020-11-05 19:23:19.046697 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 19:23:19.047696 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 19:23:19.047696 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-05 19:23:19.160718 (MainThread): 
2020-11-05 19:23:19.168718 (MainThread): Completed with 1 error and 0 warnings:
2020-11-05 19:23:19.177221 (MainThread): 
2020-11-05 19:23:19.181720 (MainThread): Database Error in model pageviews_history (models\pageviews_history.sql)
2020-11-05 19:23:19.187720 (MainThread):   001003 (42000): SQL compilation error:
2020-11-05 19:23:19.195221 (MainThread):   syntax error line 46 at position 2 unexpected '('.
2020-11-05 19:23:19.204723 (MainThread):   syntax error line 46 at position 3 unexpected 'Select'.
2020-11-05 19:23:19.211224 (MainThread):   syntax error line 50 at position 7 unexpected ';'.
2020-11-05 19:23:19.221724 (MainThread):   compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:23:19.230226 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2020-11-05 19:23:19.240227 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1FD7A7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1FD7A310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1FD7A1C0>]}
2020-11-05 19:23:19.241227 (MainThread): Flushing usage events
2020-11-05 19:24:22.652697 (MainThread): Running with dbt=0.18.1
2020-11-05 19:24:23.328784 (MainThread): Loading KWallet
2020-11-05 19:24:23.333284 (MainThread): Loading SecretService
2020-11-05 19:24:23.339285 (MainThread): Loading Windows
2020-11-05 19:24:23.637842 (MainThread): Loading chainer
2020-11-05 19:24:23.639842 (MainThread): Loading macOS
2020-11-05 19:24:25.274965 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 19:24:25.278965 (MainThread): Tracking: tracking
2020-11-05 19:24:25.279949 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002398279BAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002398279B670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002398279BD00>]}
2020-11-05 19:24:25.428005 (MainThread): Partial parsing not enabled
2020-11-05 19:24:25.438517 (MainThread): Parsing macros\adapters.sql
2020-11-05 19:24:25.659137 (MainThread): Parsing macros\catalog.sql
2020-11-05 19:24:25.674137 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 19:24:25.748653 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 19:24:25.765163 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 19:24:25.799182 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 19:24:25.829166 (MainThread): Parsing macros\core.sql
2020-11-05 19:24:25.862207 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 19:24:26.200318 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 19:24:26.320329 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 19:24:26.329345 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 19:24:26.344357 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 19:24:26.360366 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 19:24:26.373370 (MainThread): Parsing macros\etc\query.sql
2020-11-05 19:24:26.382371 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 19:24:26.458397 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 19:24:26.565425 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 19:24:26.581428 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 19:24:26.632414 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 19:24:26.966010 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 19:24:27.240369 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 19:24:27.254368 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 19:24:27.421415 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 19:24:27.483435 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 19:24:27.527444 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 19:24:27.583463 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 19:24:27.607498 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 19:24:27.621499 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 19:24:27.640500 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 19:24:27.697516 (MainThread): Partial parsing not enabled
2020-11-05 19:24:27.990524 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:24:28.204550 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:24:28.299063 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:24:28.384092 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:24:28.471146 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:24:28.564184 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:24:28.722199 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:24:28.820724 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:24:30.579882 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 19:24:31.008019 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 19:24:31.017019 (MainThread): 
2020-11-05 19:24:31.020549 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:24:31.078000 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 19:24:31.178023 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 19:24:31.179023 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 19:24:31.180023 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 19:24:33.384475 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.20 seconds
2020-11-05 19:24:33.415477 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 19:24:33.648985 (ThreadPoolExecutor-0_0): unclosed <socket.socket fd=1200, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.5.101', 49271), raddr=('168.63.27.166', 443)>
2020-11-05 19:24:33.732032 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:24:33.775538 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:24:33.775538 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 19:24:33.776540 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 19:24:35.626764 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.85 seconds
2020-11-05 19:24:35.645774 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 19:24:35.863832 (MainThread): Using snowflake connection "master".
2020-11-05 19:24:35.863832 (MainThread): On master: BEGIN
2020-11-05 19:24:35.863832 (MainThread): Opening a new connection, currently in state init
2020-11-05 19:24:36.886551 (MainThread): SQL status: SUCCESS 1 in 1.02 seconds
2020-11-05 19:24:36.886551 (MainThread): On master: COMMIT
2020-11-05 19:24:36.886551 (MainThread): Using snowflake connection "master".
2020-11-05 19:24:36.886551 (MainThread): On master: COMMIT
2020-11-05 19:24:37.133958 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2020-11-05 19:24:37.133958 (MainThread): On master: Close
2020-11-05 19:24:37.363469 (MainThread): 20:24:37 | Concurrency: 1 threads (target='dev')
2020-11-05 19:24:37.366454 (MainThread): 20:24:37 | 
2020-11-05 19:24:37.406471 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:24:37.414466 (Thread-1): 20:24:37 | 1 of 5 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 19:24:37.423468 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:24:37.424467 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:24:37.570539 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:24:37.574544 (Thread-1): finished collecting timing info
2020-11-05 19:24:37.810947 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:24:37.829948 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:24:37.831948 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 19:24:37.831948 (Thread-1): Opening a new connection, currently in state init
2020-11-05 19:24:39.744719 (Thread-1): SQL status: SUCCESS 1 in 1.91 seconds
2020-11-05 19:24:39.744719 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:24:39.745718 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 19:24:40.743786 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2020-11-05 19:24:40.750787 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:24:40.750787 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:24:40.751787 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:24:40.878110 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2020-11-05 19:24:40.962658 (Thread-1): finished collecting timing info
2020-11-05 19:24:40.964642 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 19:24:41.161719 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fbb1660-3dbe-45ef-a133-fb1848e49617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023982D17370>]}
2020-11-05 19:24:41.172734 (Thread-1): 20:24:41 | 1 of 5 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 3.74s]
2020-11-05 19:24:41.175730 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:24:41.176719 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:24:41.178718 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:24:41.180720 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:24:41.229276 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 19:24:41.234260 (Thread-1): finished collecting timing info
2020-11-05 19:24:41.236261 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:24:41.237260 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:24:41.244262 (Thread-1): 20:24:41 | 2 of 5 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 19:24:41.247262 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:24:41.252261 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 19:24:41.302265 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:24:41.306777 (Thread-1): finished collecting timing info
2020-11-05 19:24:41.337292 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:24:41.348293 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:24:41.349293 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 19:24:41.349293 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:24:43.007887 (Thread-1): SQL status: SUCCESS 1 in 1.66 seconds
2020-11-05 19:24:43.008889 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:24:43.009887 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 19:24:46.027994 (Thread-1): SQL status: SUCCESS 1 in 3.02 seconds
2020-11-05 19:24:46.033012 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:24:46.034011 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:24:46.034995 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:24:46.166854 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2020-11-05 19:24:46.180858 (Thread-1): finished collecting timing info
2020-11-05 19:24:46.181855 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 19:24:46.362578 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fbb1660-3dbe-45ef-a133-fb1848e49617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023982DDDFA0>]}
2020-11-05 19:24:46.370593 (Thread-1): 20:24:46 | 2 of 5 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 5.12s]
2020-11-05 19:24:46.374579 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:24:46.375579 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 19:24:46.384594 (Thread-1): 20:24:46 | 3 of 5 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 19:24:46.387092 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:24:46.388094 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 19:24:46.434608 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:24:46.439610 (Thread-1): finished collecting timing info
2020-11-05 19:24:46.467611 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:24:46.474612 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:24:46.474612 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 19:24:46.475611 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:24:48.295043 (Thread-1): SQL status: SUCCESS 1 in 1.82 seconds
2020-11-05 19:24:48.296044 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:24:48.296544 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 19:24:49.694947 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2020-11-05 19:24:49.700447 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:24:49.701447 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:24:49.701946 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:24:49.843553 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 19:24:49.855539 (Thread-1): finished collecting timing info
2020-11-05 19:24:49.857051 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 19:24:50.070109 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fbb1660-3dbe-45ef-a133-fb1848e49617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023982E2D670>]}
2020-11-05 19:24:50.077108 (Thread-1): 20:24:50 | 3 of 5 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 3.68s]
2020-11-05 19:24:50.085109 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 19:24:50.086112 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:24:50.093111 (Thread-1): 20:24:50 | 4 of 5 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 19:24:50.108110 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:24:50.109112 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:24:50.220634 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:24:50.231137 (Thread-1): finished collecting timing info
2020-11-05 19:24:50.464671 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:24:50.471672 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:24:50.472672 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 19:24:50.473673 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:24:51.996652 (Thread-1): SQL status: SUCCESS 1 in 1.52 seconds
2020-11-05 19:24:51.996652 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:24:51.996652 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 19:24:52.472838 (Thread-1): SQL status: SUCCESS 1 in 0.48 seconds
2020-11-05 19:24:52.474837 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:24:52.475337 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:24:52.475337 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:24:52.598016 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2020-11-05 19:24:52.606005 (Thread-1): finished collecting timing info
2020-11-05 19:24:52.607006 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 19:24:52.843467 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fbb1660-3dbe-45ef-a133-fb1848e49617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023982D3CAF0>]}
2020-11-05 19:24:52.850483 (Thread-1): 20:24:52 | 4 of 5 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 2.74s]
2020-11-05 19:24:52.853466 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:24:52.854468 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:24:52.857468 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:24:52.858469 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:24:52.928021 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 19:24:52.932038 (Thread-1): finished collecting timing info
2020-11-05 19:24:52.935022 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:24:52.937020 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:24:52.939021 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:24:52.941022 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:24:53.013660 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-05 19:24:53.018644 (Thread-1): finished collecting timing info
2020-11-05 19:24:53.021660 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:24:53.023644 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-05 19:24:53.035645 (Thread-1): 20:24:53 | 5 of 5 START table model cko_dbt_am.pageviews_history................ [RUN]
2020-11-05 19:24:53.038644 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:24:53.039646 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-05 19:24:53.127173 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 19:24:53.138173 (Thread-1): finished collecting timing info
2020-11-05 19:24:53.195695 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 19:24:53.248201 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:24:53.248702 (Thread-1): On model.cko_dbt_am.pageviews_history: BEGIN
2020-11-05 19:24:53.249702 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:24:55.136634 (Thread-1): SQL status: SUCCESS 1 in 1.89 seconds
2020-11-05 19:24:55.137634 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:24:55.137634 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_history  as
      (with __dbt__CTE__pageviews_extract_ephemere as (
/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
),  __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM __dbt__CTE__pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"

where user_id in (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_ephemeral as (
-- Use the `ref` function to select from other models



SELECT 
	pageviews.*
	,users.customer_postcode
FROM  __dbt__CTE__pageviews_extract_ephemere
LEFT OUTER JOIN __dbt__CTE__users_extract_Ephemere on users.user_id=pageviews.user_id
)/* Config line */





insert into (Select * FROM "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_HISTORY")
		Select * FROM __dbt__CTE__pageviews_history_ephemeral
      );
2020-11-05 19:24:55.492672 (Thread-1): Snowflake query id: 0198126c-0058-44d7-0000-6c5d0001c012
2020-11-05 19:24:55.492672 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 48 at position 0 unexpected 'insert'.
syntax error line 49 at position 2 unexpected 'Select'.
2020-11-05 19:24:55.493671 (Thread-1): finished collecting timing info
2020-11-05 19:24:55.494673 (Thread-1): On model.cko_dbt_am.pageviews_history: ROLLBACK
2020-11-05 19:24:55.709719 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-05 19:24:55.909300 (Thread-1): Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 48 at position 0 unexpected 'insert'.
  syntax error line 49 at position 2 unexpected 'Select'.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 48 at position 0 unexpected 'insert'.
syntax error line 49 at position 2 unexpected 'Select'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\users\alexandre\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 48 at position 0 unexpected 'insert'.
  syntax error line 49 at position 2 unexpected 'Select'.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:24:55.934314 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fbb1660-3dbe-45ef-a133-fb1848e49617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023982E3DDF0>]}
2020-11-05 19:24:55.940311 (Thread-1): 20:24:55 | 5 of 5 ERROR creating table model cko_dbt_am.pageviews_history....... [ERROR in 2.90s]
2020-11-05 19:24:55.944311 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-05 19:24:55.957315 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:24:55.958314 (MainThread): Using snowflake connection "master".
2020-11-05 19:24:55.958314 (MainThread): On master: BEGIN
2020-11-05 19:24:55.959313 (MainThread): Opening a new connection, currently in state closed
2020-11-05 19:24:57.539507 (MainThread): SQL status: SUCCESS 1 in 1.58 seconds
2020-11-05 19:24:57.542508 (MainThread): On master: COMMIT
2020-11-05 19:24:57.542508 (MainThread): Using snowflake connection "master".
2020-11-05 19:24:57.543507 (MainThread): On master: COMMIT
2020-11-05 19:24:57.798148 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2020-11-05 19:24:57.799148 (MainThread): On master: Close
2020-11-05 19:24:58.012982 (MainThread): 20:24:58 | 
2020-11-05 19:24:58.013992 (MainThread): 20:24:58 | Finished running 4 table models, 1 view model in 26.99s.
2020-11-05 19:24:58.019477 (MainThread): Connection 'master' was properly closed.
2020-11-05 19:24:58.020476 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 19:24:58.020476 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 19:24:58.021477 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-05 19:24:58.136520 (MainThread): 
2020-11-05 19:24:58.138520 (MainThread): Completed with 1 error and 0 warnings:
2020-11-05 19:24:58.146522 (MainThread): 
2020-11-05 19:24:58.149521 (MainThread): Database Error in model pageviews_history (models\pageviews_history.sql)
2020-11-05 19:24:58.156521 (MainThread):   001003 (42000): SQL compilation error:
2020-11-05 19:24:58.163522 (MainThread):   syntax error line 48 at position 0 unexpected 'insert'.
2020-11-05 19:24:58.170522 (MainThread):   syntax error line 49 at position 2 unexpected 'Select'.
2020-11-05 19:24:58.174523 (MainThread):   compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:24:58.182523 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2020-11-05 19:24:58.186524 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023982E5E7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023982E5EF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023982E5ED90>]}
2020-11-05 19:24:58.188524 (MainThread): Flushing usage events
2020-11-05 19:29:01.184121 (MainThread): Running with dbt=0.18.1
2020-11-05 19:29:01.897316 (MainThread): Loading KWallet
2020-11-05 19:29:01.904817 (MainThread): Loading SecretService
2020-11-05 19:29:01.911819 (MainThread): Loading Windows
2020-11-05 19:29:02.441984 (MainThread): Loading chainer
2020-11-05 19:29:02.445001 (MainThread): Loading macOS
2020-11-05 19:29:04.511282 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 19:29:04.517280 (MainThread): Tracking: tracking
2020-11-05 19:29:04.517280 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018999D35A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018999D257C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018999D25DF0>]}
2020-11-05 19:29:04.657353 (MainThread): Partial parsing not enabled
2020-11-05 19:29:04.666354 (MainThread): Parsing macros\adapters.sql
2020-11-05 19:29:04.916413 (MainThread): Parsing macros\catalog.sql
2020-11-05 19:29:04.924402 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 19:29:04.961423 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 19:29:04.970440 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 19:29:04.987428 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 19:29:05.004443 (MainThread): Parsing macros\core.sql
2020-11-05 19:29:05.019431 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 19:29:05.265530 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 19:29:05.335518 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 19:29:05.344519 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 19:29:05.358030 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 19:29:05.374541 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 19:29:05.387558 (MainThread): Parsing macros\etc\query.sql
2020-11-05 19:29:05.396561 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 19:29:05.465596 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 19:29:05.583623 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 19:29:05.598624 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 19:29:05.648651 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 19:29:05.807689 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 19:29:06.120267 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 19:29:06.137269 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 19:29:06.321794 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 19:29:06.379802 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 19:29:06.421876 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 19:29:06.473883 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 19:29:06.495918 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 19:29:06.513919 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 19:29:06.529421 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 19:29:06.587013 (MainThread): Partial parsing not enabled
2020-11-05 19:29:06.906609 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:29:06.989620 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:29:07.026125 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:29:07.063129 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:29:07.105135 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:29:07.153140 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:29:07.202647 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:29:07.244653 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:29:07.932283 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 19:29:08.089802 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 19:29:08.096303 (MainThread): 
2020-11-05 19:29:08.098304 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:29:08.122807 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 19:29:08.163811 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 19:29:08.163811 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 19:29:08.164311 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 19:29:09.412280 (ThreadPoolExecutor-0_0): unclosed <socket.socket fd=1356, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.5.101', 49428), raddr=('168.63.27.166', 443)>
2020-11-05 19:29:09.415280 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.25 seconds
2020-11-05 19:29:09.442281 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 19:29:11.246197 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:29:11.295712 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:29:11.296712 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 19:29:11.297212 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 19:29:12.777885 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.48 seconds
2020-11-05 19:29:12.814394 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 19:29:13.176049 (MainThread): Using snowflake connection "master".
2020-11-05 19:29:13.177065 (MainThread): On master: BEGIN
2020-11-05 19:29:13.177565 (MainThread): Opening a new connection, currently in state init
2020-11-05 19:29:14.977589 (MainThread): SQL status: SUCCESS 1 in 1.80 seconds
2020-11-05 19:29:14.978086 (MainThread): On master: COMMIT
2020-11-05 19:29:14.979086 (MainThread): Using snowflake connection "master".
2020-11-05 19:29:14.979586 (MainThread): On master: COMMIT
2020-11-05 19:29:15.402269 (MainThread): SQL status: SUCCESS 1 in 0.42 seconds
2020-11-05 19:29:15.403269 (MainThread): On master: Close
2020-11-05 19:29:15.647742 (MainThread): 20:29:15 | Concurrency: 1 threads (target='dev')
2020-11-05 19:29:15.649725 (MainThread): 20:29:15 | 
2020-11-05 19:29:15.683751 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:29:15.691264 (Thread-1): 20:29:15 | 1 of 6 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 19:29:15.694264 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:29:15.695265 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:29:15.826317 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:29:15.830317 (Thread-1): finished collecting timing info
2020-11-05 19:29:16.042416 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:29:16.050400 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:29:16.051399 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 19:29:16.051399 (Thread-1): Opening a new connection, currently in state init
2020-11-05 19:29:17.602435 (Thread-1): SQL status: SUCCESS 1 in 1.55 seconds
2020-11-05 19:29:17.603436 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:29:17.604437 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 19:29:18.595198 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2020-11-05 19:29:18.600212 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:29:18.601210 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:29:18.602211 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:29:18.744490 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 19:29:18.825533 (Thread-1): finished collecting timing info
2020-11-05 19:29:18.827534 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 19:29:19.066037 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85c71bd5-98b6-4f51-80b2-162ccf235d9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001899A294DF0>]}
2020-11-05 19:29:19.072023 (Thread-1): 20:29:19 | 1 of 6 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 3.37s]
2020-11-05 19:29:19.079024 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:29:19.080042 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:29:19.091065 (Thread-1): 20:29:19 | 2 of 6 START table model cko_dbt_am.pageviews_extract_ephemere....... [RUN]
2020-11-05 19:29:19.094050 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:29:19.095050 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:29:19.144064 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 19:29:19.150063 (Thread-1): finished collecting timing info
2020-11-05 19:29:19.177069 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 19:29:19.185577 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:29:19.186077 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: BEGIN
2020-11-05 19:29:19.186578 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:29:20.836647 (Thread-1): SQL status: SUCCESS 1 in 1.65 seconds
2020-11-05 19:29:20.837664 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:29:20.838164 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract_ephemere"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract_ephemere  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
      );
2020-11-05 19:29:22.578883 (Thread-1): SQL status: SUCCESS 1 in 1.74 seconds
2020-11-05 19:29:22.583884 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 19:29:22.584884 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:29:22.584884 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 19:29:22.810967 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-11-05 19:29:22.822968 (Thread-1): finished collecting timing info
2020-11-05 19:29:22.824968 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: Close
2020-11-05 19:29:23.030074 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85c71bd5-98b6-4f51-80b2-162ccf235d9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001899A3D9A00>]}
2020-11-05 19:29:23.037076 (Thread-1): 20:29:23 | 2 of 6 OK created table model cko_dbt_am.pageviews_extract_ephemere.. [SUCCESS 1 in 3.94s]
2020-11-05 19:29:23.040075 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:29:23.042075 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:29:23.052589 (Thread-1): 20:29:23 | 3 of 6 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 19:29:23.069102 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:29:23.070104 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 19:29:23.128107 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:29:23.134105 (Thread-1): finished collecting timing info
2020-11-05 19:29:23.160621 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:29:23.170621 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:29:23.171622 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 19:29:23.172122 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:29:24.597515 (Thread-1): SQL status: SUCCESS 1 in 1.43 seconds
2020-11-05 19:29:24.598014 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:29:24.598515 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 19:29:27.745386 (Thread-1): SQL status: SUCCESS 1 in 3.15 seconds
2020-11-05 19:29:27.752385 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:29:27.753385 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:29:27.755386 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:29:28.057429 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2020-11-05 19:29:28.073932 (Thread-1): finished collecting timing info
2020-11-05 19:29:28.075432 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 19:29:28.493941 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85c71bd5-98b6-4f51-80b2-162ccf235d9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001899A294850>]}
2020-11-05 19:29:28.508943 (Thread-1): 20:29:28 | 3 of 6 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 5.42s]
2020-11-05 19:29:28.579463 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:29:28.580463 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 19:29:28.611967 (Thread-1): 20:29:28 | 4 of 6 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 19:29:28.631469 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:29:28.632469 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 19:29:28.875501 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:29:28.880502 (Thread-1): finished collecting timing info
2020-11-05 19:29:29.033520 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:29:29.054523 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:29:29.055026 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 19:29:29.056025 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:29:30.407568 (Thread-1): SQL status: SUCCESS 1 in 1.35 seconds
2020-11-05 19:29:30.409566 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:29:30.410568 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 19:29:32.200462 (Thread-1): SQL status: SUCCESS 1 in 1.79 seconds
2020-11-05 19:29:32.206962 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:29:32.207964 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:29:32.207964 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:29:32.365483 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2020-11-05 19:29:32.370492 (Thread-1): finished collecting timing info
2020-11-05 19:29:32.371492 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 19:29:32.584538 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85c71bd5-98b6-4f51-80b2-162ccf235d9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001899A294160>]}
2020-11-05 19:29:32.587539 (Thread-1): 20:29:32 | 4 of 6 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 3.96s]
2020-11-05 19:29:32.590539 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 19:29:32.591539 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:29:32.593539 (Thread-1): 20:29:32 | 5 of 6 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 19:29:32.595540 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:29:32.595540 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:29:32.619541 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:29:32.620541 (Thread-1): finished collecting timing info
2020-11-05 19:29:32.685562 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:29:32.688563 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:29:32.688563 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 19:29:32.688563 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:29:34.723164 (Thread-1): SQL status: SUCCESS 1 in 2.03 seconds
2020-11-05 19:29:34.724181 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:29:34.724181 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 19:29:35.174489 (Thread-1): SQL status: SUCCESS 1 in 0.45 seconds
2020-11-05 19:29:35.181489 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:29:35.182489 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:29:35.183491 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:29:35.322700 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 19:29:35.351701 (Thread-1): finished collecting timing info
2020-11-05 19:29:35.352701 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 19:29:35.555193 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85c71bd5-98b6-4f51-80b2-162ccf235d9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001899A2942E0>]}
2020-11-05 19:29:35.561176 (Thread-1): 20:29:35 | 5 of 6 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 2.96s]
2020-11-05 19:29:35.570163 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:29:35.572164 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:29:35.574181 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:29:35.575166 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:29:35.668708 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 19:29:35.677710 (Thread-1): finished collecting timing info
2020-11-05 19:29:35.679708 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:29:35.682707 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:29:35.685709 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:29:35.685709 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:29:35.841756 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-05 19:29:35.850259 (Thread-1): finished collecting timing info
2020-11-05 19:29:35.852759 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:29:35.855759 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-05 19:29:35.866259 (Thread-1): 20:29:35 | 6 of 6 START table model cko_dbt_am.pageviews_history................ [RUN]
2020-11-05 19:29:35.875263 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:29:35.876762 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-05 19:29:35.942779 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 19:29:35.954779 (Thread-1): finished collecting timing info
2020-11-05 19:29:35.989786 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 19:29:36.003784 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:29:36.004786 (Thread-1): On model.cko_dbt_am.pageviews_history: BEGIN
2020-11-05 19:29:36.004786 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:29:38.033629 (Thread-1): SQL status: SUCCESS 1 in 2.03 seconds
2020-11-05 19:29:38.034630 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:29:38.035130 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_history  as
      (with __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM analytics.cko_dbt_am.pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"

where user_id in (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_ephemeral as (
-- Use the `ref` function to select from other models



SELECT 
	pageviews.*
	,users.customer_postcode
FROM  analytics.cko_dbt_am.pageviews_extract_ephemere
LEFT OUTER JOIN __dbt__CTE__users_extract_Ephemere on users.user_id=pageviews.user_id
)/* Config line */





insert into (Select * FROM "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_HISTORY")
		Select * FROM __dbt__CTE__pageviews_history_ephemeral
      );
2020-11-05 19:29:38.568748 (Thread-1): Snowflake query id: 01981271-0070-2c0c-0000-6c5d0001989a
2020-11-05 19:29:38.569748 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 29 at position 0 unexpected 'insert'.
syntax error line 30 at position 2 unexpected 'Select'.
2020-11-05 19:29:38.570749 (Thread-1): finished collecting timing info
2020-11-05 19:29:38.572248 (Thread-1): On model.cko_dbt_am.pageviews_history: ROLLBACK
2020-11-05 19:29:38.816379 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-05 19:29:39.632664 (Thread-1): Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 0 unexpected 'insert'.
  syntax error line 30 at position 2 unexpected 'Select'.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 29 at position 0 unexpected 'insert'.
syntax error line 30 at position 2 unexpected 'Select'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\users\alexandre\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 0 unexpected 'insert'.
  syntax error line 30 at position 2 unexpected 'Select'.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:29:39.659663 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85c71bd5-98b6-4f51-80b2-162ccf235d9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001899A44ED30>]}
2020-11-05 19:29:39.673177 (Thread-1): 20:29:39 | 6 of 6 ERROR creating table model cko_dbt_am.pageviews_history....... [ERROR in 3.79s]
2020-11-05 19:29:39.681677 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-05 19:29:39.687690 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:29:39.688690 (MainThread): Using snowflake connection "master".
2020-11-05 19:29:39.689706 (MainThread): On master: BEGIN
2020-11-05 19:29:39.690691 (MainThread): Opening a new connection, currently in state closed
2020-11-05 19:29:42.174249 (MainThread): SQL status: SUCCESS 1 in 2.48 seconds
2020-11-05 19:29:42.174249 (MainThread): On master: COMMIT
2020-11-05 19:29:42.175249 (MainThread): Using snowflake connection "master".
2020-11-05 19:29:42.176248 (MainThread): On master: COMMIT
2020-11-05 19:29:42.863138 (MainThread): SQL status: SUCCESS 1 in 0.69 seconds
2020-11-05 19:29:42.864139 (MainThread): On master: Close
2020-11-05 19:29:46.890111 (MainThread): 20:29:46 | 
2020-11-05 19:29:46.903111 (MainThread): 20:29:46 | Finished running 5 table models, 1 view model in 38.79s.
2020-11-05 19:29:46.907622 (MainThread): Connection 'master' was properly closed.
2020-11-05 19:29:46.908622 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 19:29:46.909123 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 19:29:46.909623 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-05 19:29:47.140629 (MainThread): 
2020-11-05 19:29:47.257181 (MainThread): Completed with 1 error and 0 warnings:
2020-11-05 19:29:47.264684 (MainThread): 
2020-11-05 19:29:47.271684 (MainThread): Database Error in model pageviews_history (models\pageviews_history.sql)
2020-11-05 19:29:47.276685 (MainThread):   001003 (42000): SQL compilation error:
2020-11-05 19:29:47.280186 (MainThread):   syntax error line 29 at position 0 unexpected 'insert'.
2020-11-05 19:29:47.282185 (MainThread):   syntax error line 30 at position 2 unexpected 'Select'.
2020-11-05 19:29:47.287187 (MainThread):   compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:29:47.289696 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
2020-11-05 19:29:47.294688 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001899A2BD5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001899A2BDC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001899A2BD190>]}
2020-11-05 19:29:47.295687 (MainThread): Flushing usage events
2020-11-05 19:31:34.104215 (MainThread): Running with dbt=0.18.1
2020-11-05 19:31:34.509769 (MainThread): Loading KWallet
2020-11-05 19:31:34.512768 (MainThread): Loading SecretService
2020-11-05 19:31:34.514768 (MainThread): Loading Windows
2020-11-05 19:31:34.736812 (MainThread): Loading chainer
2020-11-05 19:31:34.738813 (MainThread): Loading macOS
2020-11-05 19:31:35.940913 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 19:31:35.944913 (MainThread): Tracking: tracking
2020-11-05 19:31:35.945914 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A2E93820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A2E7A700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A2E7AD90>]}
2020-11-05 19:31:36.012923 (MainThread): Partial parsing not enabled
2020-11-05 19:31:36.018424 (MainThread): Parsing macros\adapters.sql
2020-11-05 19:31:36.197945 (MainThread): Parsing macros\catalog.sql
2020-11-05 19:31:36.205946 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 19:31:36.276955 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 19:31:36.284456 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 19:31:36.298458 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 19:31:36.368966 (MainThread): Parsing macros\core.sql
2020-11-05 19:31:36.381469 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 19:31:36.588995 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 19:31:36.624207 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 19:31:36.634457 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 19:31:36.644681 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 19:31:36.650680 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 19:31:36.656681 (MainThread): Parsing macros\etc\query.sql
2020-11-05 19:31:36.666102 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 19:31:36.697704 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 19:31:36.742241 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 19:31:36.754154 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 19:31:36.785157 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 19:31:36.896679 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 19:31:37.030701 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 19:31:37.036702 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 19:31:37.100709 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 19:31:37.120712 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 19:31:37.166718 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 19:31:37.185221 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 19:31:37.200722 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 19:31:37.219226 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 19:31:37.232227 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 19:31:37.281233 (MainThread): Partial parsing not enabled
2020-11-05 19:31:37.478257 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:31:37.577271 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:31:37.620776 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:31:37.652281 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:31:37.686785 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:31:37.741292 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:31:37.790298 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:31:37.827802 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:31:38.827929 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 19:31:39.211978 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 19:31:39.240982 (MainThread): 
2020-11-05 19:31:39.260485 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:31:39.315992 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 19:31:39.354996 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 19:31:39.355496 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 19:31:39.355496 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 19:31:40.853188 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.50 seconds
2020-11-05 19:31:40.865189 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 19:31:41.086717 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:31:41.108219 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:31:41.108219 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 19:31:41.108720 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 19:31:42.246378 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.14 seconds
2020-11-05 19:31:42.260879 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 19:31:42.523413 (MainThread): Using snowflake connection "master".
2020-11-05 19:31:42.523913 (MainThread): On master: BEGIN
2020-11-05 19:31:42.523913 (MainThread): Opening a new connection, currently in state init
2020-11-05 19:31:43.836592 (MainThread): SQL status: SUCCESS 1 in 1.31 seconds
2020-11-05 19:31:43.836592 (MainThread): On master: COMMIT
2020-11-05 19:31:43.836592 (MainThread): Using snowflake connection "master".
2020-11-05 19:31:43.837592 (MainThread): On master: COMMIT
2020-11-05 19:31:44.091663 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2020-11-05 19:31:44.092663 (MainThread): On master: Close
2020-11-05 19:31:44.262690 (MainThread): 20:31:44 | Concurrency: 1 threads (target='dev')
2020-11-05 19:31:44.264190 (MainThread): 20:31:44 | 
2020-11-05 19:31:44.283700 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:31:44.285700 (Thread-1): 20:31:44 | 1 of 6 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 19:31:44.286699 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:31:44.287706 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:31:44.340703 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:31:44.342704 (Thread-1): finished collecting timing info
2020-11-05 19:31:44.432719 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:31:44.436219 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:31:44.436219 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 19:31:44.436719 (Thread-1): Opening a new connection, currently in state init
2020-11-05 19:31:46.025972 (Thread-1): SQL status: SUCCESS 1 in 1.59 seconds
2020-11-05 19:31:46.026973 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:31:46.027472 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 19:31:47.236729 (Thread-1): SQL status: SUCCESS 1 in 1.21 seconds
2020-11-05 19:31:47.238730 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:31:47.239730 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:31:47.239730 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:31:47.371789 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2020-11-05 19:31:47.414792 (Thread-1): finished collecting timing info
2020-11-05 19:31:47.415792 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 19:31:47.715893 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaf84b8b-c93f-40ab-974e-3d8d8447fd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A33FCE80>]}
2020-11-05 19:31:47.719895 (Thread-1): 20:31:47 | 1 of 6 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 3.43s]
2020-11-05 19:31:47.723894 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:31:47.724894 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:31:47.727895 (Thread-1): 20:31:47 | 2 of 6 START table model cko_dbt_am.pageviews_extract_ephemere....... [RUN]
2020-11-05 19:31:47.729895 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:31:47.729895 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:31:47.760917 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 19:31:47.766918 (Thread-1): finished collecting timing info
2020-11-05 19:31:47.779917 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 19:31:47.783917 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:31:47.784918 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: BEGIN
2020-11-05 19:31:47.784918 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:31:48.663525 (Thread-1): SQL status: SUCCESS 1 in 0.88 seconds
2020-11-05 19:31:48.664542 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:31:48.664542 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract_ephemere"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract_ephemere  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
      );
2020-11-05 19:31:50.346302 (Thread-1): SQL status: SUCCESS 1 in 1.68 seconds
2020-11-05 19:31:50.351304 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 19:31:50.352302 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:31:50.353303 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 19:31:50.484372 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2020-11-05 19:31:50.498385 (Thread-1): finished collecting timing info
2020-11-05 19:31:50.500385 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: Close
2020-11-05 19:31:50.795504 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaf84b8b-c93f-40ab-974e-3d8d8447fd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A3521F70>]}
2020-11-05 19:31:50.802505 (Thread-1): 20:31:50 | 2 of 6 OK created table model cko_dbt_am.pageviews_extract_ephemere.. [SUCCESS 1 in 3.07s]
2020-11-05 19:31:50.824505 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:31:50.825505 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:31:50.838507 (Thread-1): 20:31:50 | 3 of 6 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 19:31:50.842505 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:31:50.843506 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 19:31:50.910023 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:31:50.916024 (Thread-1): finished collecting timing info
2020-11-05 19:31:50.958029 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:31:50.970530 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:31:50.971531 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 19:31:50.973531 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:31:52.752661 (Thread-1): SQL status: SUCCESS 1 in 1.78 seconds
2020-11-05 19:31:52.754160 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:31:52.755160 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 19:31:55.843375 (Thread-1): SQL status: SUCCESS 1 in 3.09 seconds
2020-11-05 19:31:55.850376 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:31:55.851375 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:31:55.852378 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:31:55.991050 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 19:31:56.008551 (Thread-1): finished collecting timing info
2020-11-05 19:31:56.011052 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 19:31:56.244190 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaf84b8b-c93f-40ab-974e-3d8d8447fd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A3521F40>]}
2020-11-05 19:31:56.252195 (Thread-1): 20:31:56 | 3 of 6 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 5.40s]
2020-11-05 19:31:56.261203 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:31:56.262204 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 19:31:56.275718 (Thread-1): 20:31:56 | 4 of 6 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 19:31:56.278719 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:31:56.278719 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 19:31:56.329736 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:31:56.335722 (Thread-1): finished collecting timing info
2020-11-05 19:31:56.363734 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:31:56.374747 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:31:56.375747 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 19:31:56.376746 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:31:58.568658 (Thread-1): unclosed <socket.socket fd=712, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.5.101', 49642), raddr=('168.63.27.166', 443)>
2020-11-05 19:31:58.571659 (Thread-1): SQL status: SUCCESS 1 in 2.19 seconds
2020-11-05 19:31:58.571659 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:31:58.572659 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 19:32:03.653238 (Thread-1): SQL status: SUCCESS 1 in 5.08 seconds
2020-11-05 19:32:03.655239 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:32:03.655739 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:32:03.656238 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:32:03.855086 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-11-05 19:32:03.864086 (Thread-1): finished collecting timing info
2020-11-05 19:32:03.865087 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 19:32:04.103617 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaf84b8b-c93f-40ab-974e-3d8d8447fd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A359FD90>]}
2020-11-05 19:32:04.106118 (Thread-1): 20:32:04 | 4 of 6 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 7.83s]
2020-11-05 19:32:04.121619 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 19:32:04.122118 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:32:04.124619 (Thread-1): 20:32:04 | 5 of 6 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 19:32:04.126619 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:32:04.126619 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:32:04.149622 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:32:04.151122 (Thread-1): finished collecting timing info
2020-11-05 19:32:04.215631 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:32:04.218631 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:32:04.218631 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 19:32:04.222131 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:32:05.221994 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2020-11-05 19:32:05.222494 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:32:05.222995 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 19:32:05.735059 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2020-11-05 19:32:05.738060 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:32:05.738060 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:32:05.738559 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:32:05.861576 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2020-11-05 19:32:05.871575 (Thread-1): finished collecting timing info
2020-11-05 19:32:05.872076 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 19:32:06.076602 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaf84b8b-c93f-40ab-974e-3d8d8447fd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A35A3940>]}
2020-11-05 19:32:06.080102 (Thread-1): 20:32:06 | 5 of 6 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 1.95s]
2020-11-05 19:32:06.105106 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:32:06.106107 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:32:06.107107 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:32:06.107607 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:32:06.136609 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 19:32:06.138610 (Thread-1): finished collecting timing info
2020-11-05 19:32:06.139610 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:32:06.142110 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:32:06.142610 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:32:06.142610 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:32:06.188116 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-05 19:32:06.190117 (Thread-1): finished collecting timing info
2020-11-05 19:32:06.197617 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:32:06.198617 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-05 19:32:06.201118 (Thread-1): 20:32:06 | 6 of 6 START table model cko_dbt_am.pageviews_history................ [RUN]
2020-11-05 19:32:06.209619 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:32:06.213119 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-05 19:32:06.254624 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 19:32:06.257124 (Thread-1): finished collecting timing info
2020-11-05 19:32:06.300631 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 19:32:06.377640 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:32:06.378140 (Thread-1): On model.cko_dbt_am.pageviews_history: BEGIN
2020-11-05 19:32:06.378140 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:32:07.436274 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2020-11-05 19:32:07.437273 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:32:07.437273 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_history  as
      (with __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM analytics.cko_dbt_am.pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"

where user_id in (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_ephemeral as (
-- Use the `ref` function to select from other models



SELECT 
	pageviews.*
	,users.customer_postcode
FROM  analytics.cko_dbt_am.pageviews_extract_ephemere
LEFT OUTER JOIN __dbt__CTE__users_extract_Ephemere on users.user_id=pageviews.user_id
)/* Config line */





insert into "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_HISTORY"
		Select * FROM __dbt__CTE__pageviews_history_ephemeral
      );
2020-11-05 19:32:07.601344 (Thread-1): Snowflake query id: 01981274-00d2-23ce-0000-6c5d000198fe
2020-11-05 19:32:07.601845 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 29 at position 0 unexpected 'insert'.
2020-11-05 19:32:07.602345 (Thread-1): finished collecting timing info
2020-11-05 19:32:07.602845 (Thread-1): On model.cko_dbt_am.pageviews_history: ROLLBACK
2020-11-05 19:32:07.851036 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-05 19:32:08.047865 (Thread-1): Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 0 unexpected 'insert'.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 29 at position 0 unexpected 'insert'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 67, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\users\alexandre\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 0 unexpected 'insert'.
  compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:32:08.063365 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aaf84b8b-c93f-40ab-974e-3d8d8447fd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A353F6A0>]}
2020-11-05 19:32:08.065865 (Thread-1): 20:32:08 | 6 of 6 ERROR creating table model cko_dbt_am.pageviews_history....... [ERROR in 1.85s]
2020-11-05 19:32:08.101370 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-05 19:32:08.103370 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:32:08.103871 (MainThread): Using snowflake connection "master".
2020-11-05 19:32:08.104369 (MainThread): On master: BEGIN
2020-11-05 19:32:08.104369 (MainThread): Opening a new connection, currently in state closed
2020-11-05 19:32:11.664608 (MainThread): SQL status: SUCCESS 1 in 3.56 seconds
2020-11-05 19:32:11.665109 (MainThread): On master: COMMIT
2020-11-05 19:32:11.665608 (MainThread): Using snowflake connection "master".
2020-11-05 19:32:11.666108 (MainThread): On master: COMMIT
2020-11-05 19:32:11.933143 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2020-11-05 19:32:11.933642 (MainThread): On master: Close
2020-11-05 19:32:12.130705 (MainThread): 20:32:12 | 
2020-11-05 19:32:12.131706 (MainThread): 20:32:12 | Finished running 5 table models, 1 view model in 32.87s.
2020-11-05 19:32:12.134205 (MainThread): Connection 'master' was properly closed.
2020-11-05 19:32:12.134705 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 19:32:12.134705 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 19:32:12.135206 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-05 19:32:12.178229 (MainThread): 
2020-11-05 19:32:12.179218 (MainThread): Completed with 1 error and 0 warnings:
2020-11-05 19:32:12.181216 (MainThread): 
2020-11-05 19:32:12.183216 (MainThread): Database Error in model pageviews_history (models\pageviews_history.sql)
2020-11-05 19:32:12.184229 (MainThread):   001003 (42000): SQL compilation error:
2020-11-05 19:32:12.186218 (MainThread):   syntax error line 29 at position 0 unexpected 'insert'.
2020-11-05 19:32:12.188217 (MainThread):   compiled SQL at target\run\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:32:12.192223 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
2020-11-05 19:32:12.195218 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A34005E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A3511D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A2F12160>]}
2020-11-05 19:32:12.196219 (MainThread): Flushing usage events
2020-11-05 19:42:36.242924 (MainThread): Running with dbt=0.18.1
2020-11-05 19:42:36.608594 (MainThread): Loading KWallet
2020-11-05 19:42:36.612599 (MainThread): Loading SecretService
2020-11-05 19:42:36.615599 (MainThread): Loading Windows
2020-11-05 19:42:36.822731 (MainThread): Loading chainer
2020-11-05 19:42:36.824648 (MainThread): Loading macOS
2020-11-05 19:42:37.784453 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 19:42:37.787454 (MainThread): Tracking: tracking
2020-11-05 19:42:37.788454 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58CE64F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58CE50940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58CE50F10>]}
2020-11-05 19:42:37.841493 (MainThread): Partial parsing not enabled
2020-11-05 19:42:37.846323 (MainThread): Parsing macros\adapters.sql
2020-11-05 19:42:37.936348 (MainThread): Parsing macros\catalog.sql
2020-11-05 19:42:37.944350 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 19:42:37.976782 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 19:42:37.983790 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 19:42:37.996295 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 19:42:38.010304 (MainThread): Parsing macros\core.sql
2020-11-05 19:42:38.022304 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 19:42:38.143385 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 19:42:38.172393 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 19:42:38.176236 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 19:42:38.182578 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 19:42:38.189453 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 19:42:38.194460 (MainThread): Parsing macros\etc\query.sql
2020-11-05 19:42:38.198886 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 19:42:38.226394 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 19:42:38.270396 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 19:42:38.277048 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 19:42:38.298161 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 19:42:38.365677 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 19:42:38.442895 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 19:42:38.447900 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 19:42:38.505102 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 19:42:38.528632 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 19:42:38.547615 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 19:42:38.570408 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 19:42:38.580417 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 19:42:38.586418 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 19:42:38.591415 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 19:42:38.610931 (MainThread): Partial parsing not enabled
2020-11-05 19:42:38.730952 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:42:38.784955 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:42:38.811969 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:42:38.838970 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:42:38.864973 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:42:38.892977 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:42:38.925024 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:42:38.956010 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:42:39.558230 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 19:42:39.732270 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 19:42:39.736270 (MainThread): 
2020-11-05 19:42:39.738270 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:42:39.762272 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 19:42:39.803031 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 19:42:39.803531 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 19:42:39.804032 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 19:42:42.712366 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.91 seconds
2020-11-05 19:42:42.756879 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 19:42:43.015412 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:42:43.036915 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:42:43.037415 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 19:42:43.037415 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 19:42:43.893052 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 0.86 seconds
2020-11-05 19:42:43.909060 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 19:42:44.116631 (MainThread): Using snowflake connection "master".
2020-11-05 19:42:44.116631 (MainThread): On master: BEGIN
2020-11-05 19:42:44.117131 (MainThread): Opening a new connection, currently in state init
2020-11-05 19:42:45.890504 (MainThread): SQL status: SUCCESS 1 in 1.77 seconds
2020-11-05 19:42:45.891507 (MainThread): On master: COMMIT
2020-11-05 19:42:45.944030 (MainThread): Using snowflake connection "master".
2020-11-05 19:42:45.945032 (MainThread): On master: COMMIT
2020-11-05 19:42:46.211870 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2020-11-05 19:42:46.212870 (MainThread): On master: Close
2020-11-05 19:42:46.453980 (MainThread): 20:42:46 | Concurrency: 1 threads (target='dev')
2020-11-05 19:42:46.460979 (MainThread): 20:42:46 | 
2020-11-05 19:42:46.540501 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:42:46.550501 (Thread-1): 20:42:46 | 1 of 6 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 19:42:46.554505 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:42:46.555503 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:42:46.774030 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:42:46.779031 (Thread-1): finished collecting timing info
2020-11-05 19:42:47.106073 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:42:47.114073 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:42:47.114574 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 19:42:47.115074 (Thread-1): Opening a new connection, currently in state init
2020-11-05 19:42:48.543522 (Thread-1): SQL status: SUCCESS 1 in 1.43 seconds
2020-11-05 19:42:48.544521 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:42:48.544521 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 19:42:58.318483 (Thread-1): SQL status: SUCCESS 1 in 9.77 seconds
2020-11-05 19:42:58.324985 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:42:58.326484 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:42:58.326983 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:42:58.486026 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2020-11-05 19:42:58.933112 (Thread-1): finished collecting timing info
2020-11-05 19:42:58.936095 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 19:42:59.187627 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afd4464-3664-4dfc-b49b-8100d19a90cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58D3C7D90>]}
2020-11-05 19:42:59.194128 (Thread-1): 20:42:59 | 1 of 6 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 12.63s]
2020-11-05 19:42:59.200629 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:42:59.201630 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:42:59.209631 (Thread-1): 20:42:59 | 2 of 6 START table model cko_dbt_am.pageviews_extract_ephemere....... [RUN]
2020-11-05 19:42:59.222631 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:42:59.223632 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:42:59.389154 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 19:42:59.395655 (Thread-1): finished collecting timing info
2020-11-05 19:42:59.444161 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 19:42:59.453662 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:42:59.454662 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: BEGIN
2020-11-05 19:42:59.455161 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:43:00.805553 (Thread-1): SQL status: SUCCESS 1 in 1.35 seconds
2020-11-05 19:43:00.806560 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:43:00.812553 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract_ephemere"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract_ephemere  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
      );
2020-11-05 19:43:02.649023 (Thread-1): SQL status: SUCCESS 1 in 1.84 seconds
2020-11-05 19:43:02.651024 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 19:43:02.651524 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:43:02.652022 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 19:43:02.785610 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2020-11-05 19:43:02.791109 (Thread-1): finished collecting timing info
2020-11-05 19:43:02.791610 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: Close
2020-11-05 19:43:02.993636 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afd4464-3664-4dfc-b49b-8100d19a90cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58D4D6220>]}
2020-11-05 19:43:02.996637 (Thread-1): 20:43:02 | 2 of 6 OK created table model cko_dbt_am.pageviews_extract_ephemere.. [SUCCESS 1 in 3.77s]
2020-11-05 19:43:03.031640 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:43:03.032141 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:43:03.034641 (Thread-1): 20:43:03 | 3 of 6 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 19:43:03.104150 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:43:03.104150 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 19:43:03.161657 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:43:03.210163 (Thread-1): finished collecting timing info
2020-11-05 19:43:03.231168 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:43:03.237666 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:43:03.237666 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 19:43:03.238166 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:43:04.513652 (Thread-1): SQL status: SUCCESS 1 in 1.27 seconds
2020-11-05 19:43:04.514153 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:43:04.514153 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 19:43:08.567392 (Thread-1): SQL status: SUCCESS 1 in 4.05 seconds
2020-11-05 19:43:08.587393 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:43:08.588393 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:43:08.594393 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:43:08.744422 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-11-05 19:43:08.769923 (Thread-1): finished collecting timing info
2020-11-05 19:43:08.771423 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 19:43:09.038504 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afd4464-3664-4dfc-b49b-8100d19a90cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58D3CEAF0>]}
2020-11-05 19:43:09.050507 (Thread-1): 20:43:09 | 3 of 6 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 5.93s]
2020-11-05 19:43:09.209027 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:43:09.210027 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 19:43:09.220528 (Thread-1): 20:43:09 | 4 of 6 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 19:43:09.251031 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:43:09.252032 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 19:43:09.450057 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:43:09.457557 (Thread-1): finished collecting timing info
2020-11-05 19:43:09.573072 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:43:09.708089 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:43:09.716591 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 19:43:09.717589 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:43:12.709109 (Thread-1): SQL status: SUCCESS 1 in 2.99 seconds
2020-11-05 19:43:12.710109 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:43:12.711109 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 19:43:14.972065 (Thread-1): SQL status: SUCCESS 1 in 2.26 seconds
2020-11-05 19:43:14.975067 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:43:14.975067 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:43:14.975067 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:43:15.218110 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2020-11-05 19:43:15.225611 (Thread-1): finished collecting timing info
2020-11-05 19:43:15.226111 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 19:43:15.558168 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afd4464-3664-4dfc-b49b-8100d19a90cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58D3C7D30>]}
2020-11-05 19:43:15.561178 (Thread-1): 20:43:15 | 4 of 6 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 6.32s]
2020-11-05 19:43:15.563177 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 19:43:15.563177 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:43:15.565180 (Thread-1): 20:43:15 | 5 of 6 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 19:43:15.570176 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:43:15.571178 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:43:15.597179 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:43:15.599180 (Thread-1): finished collecting timing info
2020-11-05 19:43:15.662693 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:43:15.665694 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:43:15.665694 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 19:43:15.666194 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:43:16.880562 (Thread-1): SQL status: SUCCESS 1 in 1.21 seconds
2020-11-05 19:43:16.881061 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:43:16.881061 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 19:43:17.369761 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2020-11-05 19:43:17.374778 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:43:17.375779 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:43:17.376778 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:43:17.494730 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2020-11-05 19:43:17.514716 (Thread-1): finished collecting timing info
2020-11-05 19:43:17.515716 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 19:43:17.764972 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afd4464-3664-4dfc-b49b-8100d19a90cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58D55CB20>]}
2020-11-05 19:43:17.771972 (Thread-1): 20:43:17 | 5 of 6 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 2.20s]
2020-11-05 19:43:17.775972 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:43:17.777483 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:43:17.780484 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:43:17.781484 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:43:17.836001 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 19:43:17.840001 (Thread-1): finished collecting timing info
2020-11-05 19:43:17.843002 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:43:17.845000 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:43:17.847001 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:43:17.848018 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:43:17.927046 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-05 19:43:17.931044 (Thread-1): finished collecting timing info
2020-11-05 19:43:17.934047 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:43:17.936047 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-05 19:43:17.943046 (Thread-1): 20:43:17 | 6 of 6 START Incremental model cko_dbt_am.pageviews_history.......... [RUN]
2020-11-05 19:43:17.947047 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:43:17.948048 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-05 19:43:18.006090 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 19:43:18.011075 (Thread-1): finished collecting timing info
2020-11-05 19:43:18.028092 (Thread-1): finished collecting timing info
2020-11-05 19:43:18.031092 (Thread-1): Compilation Error in model pageviews_history (models\pageviews_history.sql)
  No materialization 'Incremental' was found for adapter snowflake! (searched types 'default' and 'snowflake')
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 222, in execute
    missing_materialization(model, self.adapter.type())
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\exceptions.py", line 611, in missing_materialization
    raise_compiler_error(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model pageviews_history (models\pageviews_history.sql)
  No materialization 'Incremental' was found for adapter snowflake! (searched types 'default' and 'snowflake')
2020-11-05 19:43:18.039752 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afd4464-3664-4dfc-b49b-8100d19a90cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58D5075B0>]}
2020-11-05 19:43:18.045753 (Thread-1): 20:43:18 | 6 of 6 ERROR creating Incremental model cko_dbt_am.pageviews_history. [ERROR in 0.09s]
2020-11-05 19:43:18.048754 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-05 19:43:18.052754 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:43:18.054772 (MainThread): Using snowflake connection "master".
2020-11-05 19:43:18.054772 (MainThread): On master: BEGIN
2020-11-05 19:43:18.055769 (MainThread): Opening a new connection, currently in state closed
2020-11-05 19:43:20.269562 (MainThread): SQL status: SUCCESS 1 in 2.21 seconds
2020-11-05 19:43:20.270562 (MainThread): On master: COMMIT
2020-11-05 19:43:20.270562 (MainThread): Using snowflake connection "master".
2020-11-05 19:43:20.270562 (MainThread): On master: COMMIT
2020-11-05 19:43:20.547396 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2020-11-05 19:43:20.548397 (MainThread): On master: Close
2020-11-05 19:43:20.750974 (MainThread): 20:43:20 | 
2020-11-05 19:43:20.763974 (MainThread): 20:43:20 | Finished running 4 table models, 1 view model, 1 Incremental model in 41.01s.
2020-11-05 19:43:20.764974 (MainThread): Connection 'master' was properly closed.
2020-11-05 19:43:20.765975 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 19:43:20.765975 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 19:43:20.766975 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-05 19:43:21.100529 (MainThread): 
2020-11-05 19:43:21.114530 (MainThread): Completed with 1 error and 0 warnings:
2020-11-05 19:43:21.128533 (MainThread): 
2020-11-05 19:43:21.131031 (MainThread): Compilation Error in model pageviews_history (models\pageviews_history.sql)
2020-11-05 19:43:21.135533 (MainThread):   No materialization 'Incremental' was found for adapter snowflake! (searched types 'default' and 'snowflake')
2020-11-05 19:43:21.144033 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
2020-11-05 19:43:21.148535 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58D3B4160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58D3B4E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58D364C10>]}
2020-11-05 19:43:21.150034 (MainThread): Flushing usage events
2020-11-05 19:43:49.467298 (MainThread): Running with dbt=0.18.1
2020-11-05 19:43:50.033887 (MainThread): Loading KWallet
2020-11-05 19:43:50.036388 (MainThread): Loading SecretService
2020-11-05 19:43:50.044889 (MainThread): Loading Windows
2020-11-05 19:43:50.277410 (MainThread): Loading chainer
2020-11-05 19:43:50.278411 (MainThread): Loading macOS
2020-11-05 19:43:52.012865 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 19:43:52.015365 (MainThread): Tracking: tracking
2020-11-05 19:43:52.015865 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7F09648E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7F094E880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7F094EEB0>]}
2020-11-05 19:43:52.107877 (MainThread): Partial parsing not enabled
2020-11-05 19:43:52.118879 (MainThread): Parsing macros\adapters.sql
2020-11-05 19:43:52.259896 (MainThread): Parsing macros\catalog.sql
2020-11-05 19:43:52.279899 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 19:43:52.314403 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 19:43:52.320403 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 19:43:52.333412 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 19:43:52.354414 (MainThread): Parsing macros\core.sql
2020-11-05 19:43:52.413426 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 19:43:52.625481 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 19:43:52.671484 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 19:43:52.680484 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 19:43:52.689486 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 19:43:52.703485 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 19:43:52.710496 (MainThread): Parsing macros\etc\query.sql
2020-11-05 19:43:52.721505 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 19:43:52.760506 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 19:43:52.815021 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 19:43:52.821529 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 19:43:52.843532 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 19:43:53.016565 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 19:43:53.134580 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 19:43:53.142581 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 19:43:53.219591 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 19:43:53.240093 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 19:43:53.255096 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 19:43:53.272603 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 19:43:53.282606 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 19:43:53.287604 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 19:43:53.292607 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 19:43:53.312608 (MainThread): Partial parsing not enabled
2020-11-05 19:43:53.440629 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:43:53.534655 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:43:53.570166 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:43:53.598397 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:43:53.624399 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:43:53.653400 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:43:53.684789 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:43:53.711778 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:43:54.332968 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 19:43:54.520914 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 19:43:54.524915 (MainThread): 
2020-11-05 19:43:54.525916 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:43:54.549918 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 19:43:54.669947 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 19:43:54.669947 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 19:43:54.670447 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 19:43:56.195046 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.52 seconds
2020-11-05 19:43:56.225565 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 19:43:56.519006 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:43:56.562043 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:43:56.563041 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 19:43:56.563041 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 19:43:58.665020 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 2.10 seconds
2020-11-05 19:43:58.711022 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 19:43:58.946305 (MainThread): Using snowflake connection "master".
2020-11-05 19:43:58.947305 (MainThread): On master: BEGIN
2020-11-05 19:43:58.947305 (MainThread): Opening a new connection, currently in state init
2020-11-05 19:44:01.021741 (MainThread): SQL status: SUCCESS 1 in 2.07 seconds
2020-11-05 19:44:01.022739 (MainThread): On master: COMMIT
2020-11-05 19:44:01.023740 (MainThread): Using snowflake connection "master".
2020-11-05 19:44:01.024740 (MainThread): On master: COMMIT
2020-11-05 19:44:01.260779 (MainThread): SQL status: SUCCESS 1 in 0.24 seconds
2020-11-05 19:44:01.261780 (MainThread): On master: Close
2020-11-05 19:44:01.467804 (MainThread): 20:44:01 | Concurrency: 1 threads (target='dev')
2020-11-05 19:44:01.470804 (MainThread): 20:44:01 | 
2020-11-05 19:44:01.503804 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:44:01.509821 (Thread-1): 20:44:01 | 1 of 6 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 19:44:01.514807 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:44:01.517808 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:44:01.743381 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:44:01.758394 (Thread-1): finished collecting timing info
2020-11-05 19:44:02.124486 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:44:02.134487 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:44:02.135489 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 19:44:02.135989 (Thread-1): Opening a new connection, currently in state init
2020-11-05 19:44:03.632791 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2020-11-05 19:44:03.632791 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:44:03.632791 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 19:44:05.074479 (Thread-1): SQL status: SUCCESS 1 in 1.44 seconds
2020-11-05 19:44:05.079480 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:44:05.080479 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:44:05.080980 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:44:05.219614 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 19:44:05.300652 (Thread-1): finished collecting timing info
2020-11-05 19:44:05.301652 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 19:44:05.875505 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4f9b618-1c39-41a1-934a-59ac014666f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7F0ED3A60>]}
2020-11-05 19:44:05.882506 (Thread-1): 20:44:05 | 1 of 6 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 4.36s]
2020-11-05 19:44:05.886518 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:44:05.887517 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:44:05.895517 (Thread-1): 20:44:05 | 2 of 6 START table model cko_dbt_am.pageviews_extract_ephemere....... [RUN]
2020-11-05 19:44:05.898518 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:44:05.899522 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:44:05.953536 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 19:44:05.957521 (Thread-1): finished collecting timing info
2020-11-05 19:44:05.985536 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 19:44:05.999547 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:44:05.999547 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: BEGIN
2020-11-05 19:44:06.000547 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:44:07.807402 (Thread-1): SQL status: SUCCESS 1 in 1.81 seconds
2020-11-05 19:44:07.807900 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:44:07.808399 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract_ephemere"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract_ephemere  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
      );
2020-11-05 19:44:09.285322 (Thread-1): SQL status: SUCCESS 1 in 1.48 seconds
2020-11-05 19:44:09.290307 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 19:44:09.291306 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:44:09.292306 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 19:44:09.437624 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 19:44:09.449625 (Thread-1): finished collecting timing info
2020-11-05 19:44:09.450640 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: Close
2020-11-05 19:44:09.665292 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4f9b618-1c39-41a1-934a-59ac014666f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7F0FD6760>]}
2020-11-05 19:44:09.672276 (Thread-1): 20:44:09 | 2 of 6 OK created table model cko_dbt_am.pageviews_extract_ephemere.. [SUCCESS 1 in 3.77s]
2020-11-05 19:44:09.674276 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:44:09.676277 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:44:09.684278 (Thread-1): 20:44:09 | 3 of 6 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 19:44:09.689276 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:44:09.690277 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 19:44:09.735331 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:44:09.739314 (Thread-1): finished collecting timing info
2020-11-05 19:44:09.767318 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:44:09.778317 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:44:09.778317 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 19:44:09.779317 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:44:11.603906 (Thread-1): SQL status: SUCCESS 1 in 1.82 seconds
2020-11-05 19:44:11.604922 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:44:11.605422 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 19:44:14.746465 (Thread-1): SQL status: SUCCESS 1 in 3.14 seconds
2020-11-05 19:44:14.750482 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:44:14.751483 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:44:14.752483 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:44:14.896221 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 19:44:14.908713 (Thread-1): finished collecting timing info
2020-11-05 19:44:14.910214 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 19:44:15.135157 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4f9b618-1c39-41a1-934a-59ac014666f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7F0ED9AC0>]}
2020-11-05 19:44:15.142176 (Thread-1): 20:44:15 | 3 of 6 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 5.45s]
2020-11-05 19:44:15.144450 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:44:15.146458 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 19:44:15.154461 (Thread-1): 20:44:15 | 4 of 6 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 19:44:15.158459 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:44:15.159459 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 19:44:15.206993 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:44:15.211477 (Thread-1): finished collecting timing info
2020-11-05 19:44:15.239490 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:44:15.245491 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:44:15.246493 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 19:44:15.247492 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:44:17.225209 (Thread-1): SQL status: SUCCESS 1 in 1.98 seconds
2020-11-05 19:44:17.226209 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:44:17.226710 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 19:44:18.534059 (Thread-1): SQL status: SUCCESS 1 in 1.31 seconds
2020-11-05 19:44:18.539060 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:44:18.539560 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:44:18.540573 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:44:18.679602 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 19:44:18.691604 (Thread-1): finished collecting timing info
2020-11-05 19:44:18.693604 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 19:44:18.786647 (Thread-1): unclosed <socket.socket fd=1608, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.5.101', 50054), raddr=('168.63.27.166', 443)>
2020-11-05 19:44:20.201907 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4f9b618-1c39-41a1-934a-59ac014666f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7F105F1C0>]}
2020-11-05 19:44:20.205408 (Thread-1): 20:44:20 | 4 of 6 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 5.04s]
2020-11-05 19:44:20.208408 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 19:44:20.208907 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:44:20.215409 (Thread-1): 20:44:20 | 5 of 6 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 19:44:20.220409 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:44:20.220909 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:44:20.250914 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:44:20.252913 (Thread-1): finished collecting timing info
2020-11-05 19:44:20.331925 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:44:20.335424 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:44:20.335925 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 19:44:20.336424 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:44:21.839123 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2020-11-05 19:44:21.840141 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:44:21.840141 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 19:44:22.330622 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2020-11-05 19:44:22.335622 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:44:22.336623 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:44:22.336623 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:44:22.464529 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2020-11-05 19:44:22.483514 (Thread-1): finished collecting timing info
2020-11-05 19:44:22.485515 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 19:44:22.680653 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4f9b618-1c39-41a1-934a-59ac014666f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7F1072490>]}
2020-11-05 19:44:22.686652 (Thread-1): 20:44:22 | 5 of 6 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 2.46s]
2020-11-05 19:44:22.689637 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:44:22.690636 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:44:22.694636 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:44:22.695637 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:44:22.751169 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 19:44:22.755169 (Thread-1): finished collecting timing info
2020-11-05 19:44:22.759171 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:44:22.761169 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:44:22.763171 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:44:22.764171 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:44:22.831222 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-05 19:44:22.834207 (Thread-1): finished collecting timing info
2020-11-05 19:44:22.837208 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:44:22.839207 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-05 19:44:22.845207 (Thread-1): 20:44:22 | 6 of 6 START incremental model cko_dbt_am.pageviews_history.......... [RUN]
2020-11-05 19:44:22.848209 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:44:22.849208 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-05 19:44:22.915068 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 19:44:22.919053 (Thread-1): finished collecting timing info
2020-11-05 19:44:23.170608 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:44:23.171107 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    

      create or replace temporary table analytics.cko_dbt_am.pageviews_history__dbt_tmp  as
      (with __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM analytics.cko_dbt_am.pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"

where user_id in (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_ephemeral as (
-- Use the `ref` function to select from other models



SELECT 
	pageviews.*
	,users.customer_postcode
FROM  analytics.cko_dbt_am.pageviews_extract_ephemere
LEFT OUTER JOIN __dbt__CTE__users_extract_Ephemere on users.user_id=pageviews.user_id
)/* Config line */





 
		Select * FROM __dbt__CTE__pageviews_history_ephemeral
      );
2020-11-05 19:44:23.171606 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:44:25.030923 (Thread-1): Snowflake query id: 01981280-00b4-fb14-0000-6c5d0001a476
2020-11-05 19:44:25.031923 (Thread-1): Snowflake error: 002001 (02000): SQL compilation error:
Object 'PAGEVIEWS' does not exist or not authorized.
2020-11-05 19:44:25.032924 (Thread-1): finished collecting timing info
2020-11-05 19:44:25.033923 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-05 19:44:25.234034 (Thread-1): Database Error in model pageviews_history (models\pageviews_history.sql)
  002001 (02000): SQL compilation error:
  Object 'PAGEVIEWS' does not exist or not authorized.
  compiled SQL at target\compiled\cko_dbt_am\models\pageviews_history.sql
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002001 (02000): SQL compilation error:
Object 'PAGEVIEWS' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\users\alexandre\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model pageviews_history (models\pageviews_history.sql)
  002001 (02000): SQL compilation error:
  Object 'PAGEVIEWS' does not exist or not authorized.
  compiled SQL at target\compiled\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:44:25.263392 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4f9b618-1c39-41a1-934a-59ac014666f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7F0FD2730>]}
2020-11-05 19:44:25.269893 (Thread-1): 20:44:25 | 6 of 6 ERROR creating incremental model cko_dbt_am.pageviews_history. [ERROR in 2.42s]
2020-11-05 19:44:25.273394 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-05 19:44:25.278406 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:44:25.280406 (MainThread): Using snowflake connection "master".
2020-11-05 19:44:25.280406 (MainThread): On master: BEGIN
2020-11-05 19:44:25.281407 (MainThread): Opening a new connection, currently in state closed
2020-11-05 19:44:26.992557 (MainThread): SQL status: SUCCESS 1 in 1.71 seconds
2020-11-05 19:44:26.993559 (MainThread): On master: COMMIT
2020-11-05 19:44:26.994557 (MainThread): Using snowflake connection "master".
2020-11-05 19:44:26.994557 (MainThread): On master: COMMIT
2020-11-05 19:44:27.246687 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2020-11-05 19:44:27.247688 (MainThread): On master: Close
2020-11-05 19:44:27.442231 (MainThread): 20:44:27 | 
2020-11-05 19:44:27.476744 (MainThread): 20:44:27 | Finished running 4 table models, 1 view model, 1 incremental model in 32.92s.
2020-11-05 19:44:27.483744 (MainThread): Connection 'master' was properly closed.
2020-11-05 19:44:27.484245 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 19:44:27.485245 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 19:44:27.485745 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-05 19:44:27.617279 (MainThread): 
2020-11-05 19:44:27.622282 (MainThread): Completed with 1 error and 0 warnings:
2020-11-05 19:44:27.631791 (MainThread): 
2020-11-05 19:44:27.637282 (MainThread): Database Error in model pageviews_history (models\pageviews_history.sql)
2020-11-05 19:44:27.639788 (MainThread):   002001 (02000): SQL compilation error:
2020-11-05 19:44:27.648283 (MainThread):   Object 'PAGEVIEWS' does not exist or not authorized.
2020-11-05 19:44:27.650782 (MainThread):   compiled SQL at target\compiled\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:44:27.653283 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
2020-11-05 19:44:27.656784 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7F1020A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7F1020C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7F1020070>]}
2020-11-05 19:44:27.658786 (MainThread): Flushing usage events
2020-11-05 19:45:52.115293 (MainThread): Running with dbt=0.18.1
2020-11-05 19:45:52.837080 (MainThread): Loading KWallet
2020-11-05 19:45:52.843602 (MainThread): Loading SecretService
2020-11-05 19:45:52.849604 (MainThread): Loading Windows
2020-11-05 19:45:53.381311 (MainThread): Loading chainer
2020-11-05 19:45:53.384312 (MainThread): Loading macOS
2020-11-05 19:45:55.417432 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 19:45:55.420432 (MainThread): Tracking: tracking
2020-11-05 19:45:55.420932 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235EC9D48E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235EC9C1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235EC9C1E80>]}
2020-11-05 19:45:55.503441 (MainThread): Partial parsing not enabled
2020-11-05 19:45:55.506942 (MainThread): Parsing macros\adapters.sql
2020-11-05 19:45:55.602454 (MainThread): Parsing macros\catalog.sql
2020-11-05 19:45:55.608954 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 19:45:55.638459 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 19:45:55.644459 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 19:45:55.655960 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 19:45:55.669962 (MainThread): Parsing macros\core.sql
2020-11-05 19:45:55.681965 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 19:45:55.805979 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 19:45:55.830983 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 19:45:55.834483 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 19:45:55.839484 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 19:45:55.845485 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 19:45:55.849985 (MainThread): Parsing macros\etc\query.sql
2020-11-05 19:45:55.853486 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 19:45:55.881990 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 19:45:55.925495 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 19:45:55.931996 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 19:45:55.957999 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 19:45:56.025508 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 19:45:56.099018 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 19:45:56.104518 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 19:45:56.156024 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 19:45:56.174527 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 19:45:56.190529 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 19:45:56.208531 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 19:45:56.218032 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 19:45:56.223033 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 19:45:56.229034 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 19:45:56.248538 (MainThread): Partial parsing not enabled
2020-11-05 19:45:56.355049 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:45:56.409056 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:45:56.438560 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:45:56.464564 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:45:56.490067 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:45:56.517074 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:45:56.547076 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:45:56.574094 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:45:57.095932 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 19:45:57.235287 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 19:45:57.239288 (MainThread): 
2020-11-05 19:45:57.240287 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:45:57.261797 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 19:45:57.294321 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 19:45:57.295321 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 19:45:57.295321 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 19:45:59.589575 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.29 seconds
2020-11-05 19:45:59.603575 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 19:45:59.892382 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:45:59.941398 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:45:59.941898 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 19:45:59.942898 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 19:46:01.601491 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.66 seconds
2020-11-05 19:46:01.638504 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 19:46:01.925977 (MainThread): Using snowflake connection "master".
2020-11-05 19:46:01.926994 (MainThread): On master: BEGIN
2020-11-05 19:46:01.926994 (MainThread): Opening a new connection, currently in state init
2020-11-05 19:46:03.457958 (MainThread): SQL status: SUCCESS 1 in 1.53 seconds
2020-11-05 19:46:03.458959 (MainThread): On master: COMMIT
2020-11-05 19:46:03.459959 (MainThread): Using snowflake connection "master".
2020-11-05 19:46:03.460958 (MainThread): On master: COMMIT
2020-11-05 19:46:03.717762 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2020-11-05 19:46:03.718761 (MainThread): On master: Close
2020-11-05 19:46:03.961076 (MainThread): 20:46:03 | Concurrency: 1 threads (target='dev')
2020-11-05 19:46:03.963060 (MainThread): 20:46:03 | 
2020-11-05 19:46:03.996284 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:46:04.003284 (Thread-1): 20:46:04 | 1 of 6 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 19:46:04.005272 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:46:04.006271 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:46:04.145357 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:46:04.149342 (Thread-1): finished collecting timing info
2020-11-05 19:46:04.364422 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:46:04.371438 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:46:04.372439 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 19:46:04.372439 (Thread-1): Opening a new connection, currently in state init
2020-11-05 19:46:05.961199 (Thread-1): SQL status: SUCCESS 1 in 1.59 seconds
2020-11-05 19:46:05.961199 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:46:05.962216 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 19:46:06.965841 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2020-11-05 19:46:06.969840 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:46:06.970839 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:46:06.971839 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:46:07.100598 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2020-11-05 19:46:07.181126 (Thread-1): finished collecting timing info
2020-11-05 19:46:07.182125 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 19:46:07.419715 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0deab105-fcac-403a-9567-4610070c768f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235ECF3DD30>]}
2020-11-05 19:46:07.425716 (Thread-1): 20:46:07 | 1 of 6 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 3.41s]
2020-11-05 19:46:07.428699 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:46:07.429700 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:46:07.439702 (Thread-1): 20:46:07 | 2 of 6 START table model cko_dbt_am.pageviews_extract_ephemere....... [RUN]
2020-11-05 19:46:07.443712 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:46:07.444711 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:46:07.490742 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 19:46:07.494726 (Thread-1): finished collecting timing info
2020-11-05 19:46:07.520728 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 19:46:07.530729 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:46:07.530729 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: BEGIN
2020-11-05 19:46:07.531728 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:46:09.518310 (Thread-1): SQL status: SUCCESS 1 in 1.99 seconds
2020-11-05 19:46:09.519328 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:46:09.519328 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract_ephemere"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract_ephemere  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
      );
2020-11-05 19:46:11.025166 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2020-11-05 19:46:11.030167 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 19:46:11.031166 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:46:11.031166 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 19:46:11.183213 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-11-05 19:46:11.194724 (Thread-1): finished collecting timing info
2020-11-05 19:46:11.196223 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: Close
2020-11-05 19:46:11.410322 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0deab105-fcac-403a-9567-4610070c768f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235ED07CA90>]}
2020-11-05 19:46:11.417322 (Thread-1): 20:46:11 | 2 of 6 OK created table model cko_dbt_am.pageviews_extract_ephemere.. [SUCCESS 1 in 3.97s]
2020-11-05 19:46:11.420321 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:46:11.422323 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:46:11.428323 (Thread-1): 20:46:11 | 3 of 6 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 19:46:11.443326 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:46:11.444325 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 19:46:11.503338 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:46:11.510840 (Thread-1): finished collecting timing info
2020-11-05 19:46:11.545344 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:46:11.555845 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:46:11.556846 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 19:46:11.557345 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:46:13.123126 (Thread-1): SQL status: SUCCESS 1 in 1.57 seconds
2020-11-05 19:46:13.123126 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:46:13.123126 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 19:46:16.164270 (Thread-1): SQL status: SUCCESS 1 in 3.04 seconds
2020-11-05 19:46:16.171270 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:46:16.172270 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:46:16.172270 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:46:16.310322 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 19:46:16.323338 (Thread-1): finished collecting timing info
2020-11-05 19:46:16.325338 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 19:46:16.732421 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0deab105-fcac-403a-9567-4610070c768f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235ED078100>]}
2020-11-05 19:46:16.738444 (Thread-1): 20:46:16 | 3 of 6 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 5.29s]
2020-11-05 19:46:16.741429 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:46:16.742428 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 19:46:16.749429 (Thread-1): 20:46:16 | 4 of 6 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 19:46:16.757429 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:46:16.758429 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 19:46:16.801447 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:46:16.806439 (Thread-1): finished collecting timing info
2020-11-05 19:46:16.834447 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:46:16.841460 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:46:16.842460 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 19:46:16.842460 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:46:18.616962 (Thread-1): SQL status: SUCCESS 1 in 1.77 seconds
2020-11-05 19:46:18.617461 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:46:18.617961 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 19:46:20.014573 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2020-11-05 19:46:20.019574 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:46:20.020573 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:46:20.020573 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:46:20.184599 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2020-11-05 19:46:20.196600 (Thread-1): finished collecting timing info
2020-11-05 19:46:20.197599 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 19:46:20.572119 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0deab105-fcac-403a-9567-4610070c768f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235ECF3D670>]}
2020-11-05 19:46:20.580118 (Thread-1): 20:46:20 | 4 of 6 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 3.82s]
2020-11-05 19:46:20.583118 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 19:46:20.586125 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:46:20.593119 (Thread-1): 20:46:20 | 5 of 6 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 19:46:20.596119 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:46:20.597118 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:46:20.663149 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:46:20.669149 (Thread-1): finished collecting timing info
2020-11-05 19:46:20.824177 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:46:20.831178 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:46:20.831677 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 19:46:20.832179 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:46:22.585896 (Thread-1): SQL status: SUCCESS 1 in 1.75 seconds
2020-11-05 19:46:22.586895 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:46:22.586895 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 19:46:23.096380 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2020-11-05 19:46:23.098380 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:46:23.098380 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:46:23.098380 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:46:23.215841 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2020-11-05 19:46:23.223851 (Thread-1): finished collecting timing info
2020-11-05 19:46:23.224351 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 19:46:23.481416 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0deab105-fcac-403a-9567-4610070c768f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235ECF3D550>]}
2020-11-05 19:46:23.484416 (Thread-1): 20:46:23 | 5 of 6 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 2.89s]
2020-11-05 19:46:23.485415 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:46:23.486416 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:46:23.487416 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:46:23.487416 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:46:23.511427 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 19:46:23.514417 (Thread-1): finished collecting timing info
2020-11-05 19:46:23.515419 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:46:23.517419 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:46:23.518427 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:46:23.518927 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:46:23.546937 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-05 19:46:23.547937 (Thread-1): finished collecting timing info
2020-11-05 19:46:23.548938 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:46:23.549937 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-05 19:46:23.551937 (Thread-1): 20:46:23 | 6 of 6 START incremental model cko_dbt_am.pageviews_history.......... [RUN]
2020-11-05 19:46:23.573938 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:46:23.574941 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-05 19:46:23.621950 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 19:46:23.625451 (Thread-1): finished collecting timing info
2020-11-05 19:46:23.707961 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:46:23.707961 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    

      create or replace temporary table analytics.cko_dbt_am.pageviews_history__dbt_tmp  as
      (with __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM analytics.cko_dbt_am.pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"

where user_id in (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_ephemeral as (
-- Use the `ref` function to select from other models



SELECT 
	pageviews.*
	,users.customer_postcode
FROM  analytics.cko_dbt_am.pageviews_extract_ephemere pageviews
LEFT OUTER JOIN __dbt__CTE__users_extract_Ephemere on users.user_id=pageviews.user_id
)/* Config line */





 
		Select * FROM __dbt__CTE__pageviews_history_ephemeral
      );
2020-11-05 19:46:23.708462 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:46:24.658390 (Thread-1): Snowflake query id: 01981282-0097-5d5f-0000-6c5d0001a492
2020-11-05 19:46:24.658390 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 22 at position 54
invalid identifier 'USERS.USER_ID'
2020-11-05 19:46:24.658890 (Thread-1): finished collecting timing info
2020-11-05 19:46:24.659390 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-05 19:46:24.809304 (Thread-1): Database Error in model pageviews_history (models\pageviews_history.sql)
  000904 (42000): SQL compilation error: error line 22 at position 54
  invalid identifier 'USERS.USER_ID'
  compiled SQL at target\compiled\cko_dbt_am\models\pageviews_history.sql
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 22 at position 54
invalid identifier 'USERS.USER_ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\users\alexandre\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model pageviews_history (models\pageviews_history.sql)
  000904 (42000): SQL compilation error: error line 22 at position 54
  invalid identifier 'USERS.USER_ID'
  compiled SQL at target\compiled\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:46:24.818302 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0deab105-fcac-403a-9567-4610070c768f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235ED04EFA0>]}
2020-11-05 19:46:24.821304 (Thread-1): 20:46:24 | 6 of 6 ERROR creating incremental model cko_dbt_am.pageviews_history. [ERROR in 1.24s]
2020-11-05 19:46:24.825304 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-05 19:46:24.828305 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:46:24.829305 (MainThread): Using snowflake connection "master".
2020-11-05 19:46:24.829305 (MainThread): On master: BEGIN
2020-11-05 19:46:24.829305 (MainThread): Opening a new connection, currently in state closed
2020-11-05 19:46:25.995425 (MainThread): SQL status: SUCCESS 1 in 1.17 seconds
2020-11-05 19:46:25.995923 (MainThread): On master: COMMIT
2020-11-05 19:46:25.997924 (MainThread): Using snowflake connection "master".
2020-11-05 19:46:25.998425 (MainThread): On master: COMMIT
2020-11-05 19:46:26.426108 (MainThread): SQL status: SUCCESS 1 in 0.43 seconds
2020-11-05 19:46:26.427108 (MainThread): On master: Close
2020-11-05 19:46:26.640179 (MainThread): 20:46:26 | 
2020-11-05 19:46:26.646178 (MainThread): 20:46:26 | Finished running 4 table models, 1 view model, 1 incremental model in 29.40s.
2020-11-05 19:46:26.653180 (MainThread): Connection 'master' was properly closed.
2020-11-05 19:46:26.654179 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 19:46:26.654179 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 19:46:26.655179 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-05 19:46:26.787211 (MainThread): 
2020-11-05 19:46:26.798225 (MainThread): Completed with 1 error and 0 warnings:
2020-11-05 19:46:26.801224 (MainThread): 
2020-11-05 19:46:26.805724 (MainThread): Database Error in model pageviews_history (models\pageviews_history.sql)
2020-11-05 19:46:26.817225 (MainThread):   000904 (42000): SQL compilation error: error line 22 at position 54
2020-11-05 19:46:26.821228 (MainThread):   invalid identifier 'USERS.USER_ID'
2020-11-05 19:46:26.829727 (MainThread):   compiled SQL at target\compiled\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:46:26.834227 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
2020-11-05 19:46:26.845231 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235ED083850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235ED083A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235ECF49130>]}
2020-11-05 19:46:26.852731 (MainThread): Flushing usage events
2020-11-05 19:48:56.836365 (MainThread): Running with dbt=0.18.1
2020-11-05 19:48:57.196475 (MainThread): Loading KWallet
2020-11-05 19:48:57.199473 (MainThread): Loading SecretService
2020-11-05 19:48:57.202474 (MainThread): Loading Windows
2020-11-05 19:48:57.466557 (MainThread): Loading chainer
2020-11-05 19:48:57.468573 (MainThread): Loading macOS
2020-11-05 19:48:58.726004 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 19:48:58.731004 (MainThread): Tracking: tracking
2020-11-05 19:48:58.732005 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF027D38E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF027BD880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF027BDEB0>]}
2020-11-05 19:48:58.872078 (MainThread): Partial parsing not enabled
2020-11-05 19:48:58.882080 (MainThread): Parsing macros\adapters.sql
2020-11-05 19:48:59.108204 (MainThread): Parsing macros\catalog.sql
2020-11-05 19:48:59.123189 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 19:48:59.198257 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 19:48:59.214241 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 19:48:59.248244 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 19:48:59.279235 (MainThread): Parsing macros\core.sql
2020-11-05 19:48:59.308220 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 19:48:59.637344 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 19:48:59.706396 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 19:48:59.714396 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 19:48:59.727380 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 19:48:59.744381 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 19:48:59.758424 (MainThread): Parsing macros\etc\query.sql
2020-11-05 19:48:59.766926 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 19:48:59.835434 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 19:48:59.950489 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 19:48:59.966535 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 19:49:00.017541 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 19:49:00.189580 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 19:49:00.394686 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 19:49:00.408687 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 19:49:00.597727 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 19:49:00.661730 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 19:49:00.711267 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 19:49:00.761273 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 19:49:00.784276 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 19:49:00.796762 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 19:49:00.811764 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 19:49:00.861807 (MainThread): Partial parsing not enabled
2020-11-05 19:49:01.128851 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:49:01.271955 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:49:01.343455 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:49:01.413986 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:49:01.486015 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:49:01.563551 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:49:01.657580 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:49:01.730598 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:49:03.155221 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 19:49:03.551347 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 19:49:03.561348 (MainThread): 
2020-11-05 19:49:03.563348 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:49:03.629368 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 19:49:03.719411 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 19:49:03.720411 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 19:49:03.720411 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 19:49:05.852469 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.13 seconds
2020-11-05 19:49:05.878981 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 19:49:06.647103 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:49:06.707622 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:49:06.708122 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 19:49:06.708624 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 19:49:08.300889 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.59 seconds
2020-11-05 19:49:08.338893 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 19:49:08.755583 (MainThread): Using snowflake connection "master".
2020-11-05 19:49:08.756083 (MainThread): On master: BEGIN
2020-11-05 19:49:08.756083 (MainThread): Opening a new connection, currently in state init
2020-11-05 19:49:10.959942 (MainThread): SQL status: SUCCESS 1 in 2.20 seconds
2020-11-05 19:49:10.960942 (MainThread): On master: COMMIT
2020-11-05 19:49:10.961442 (MainThread): Using snowflake connection "master".
2020-11-05 19:49:10.961942 (MainThread): On master: COMMIT
2020-11-05 19:49:11.193017 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2020-11-05 19:49:11.194018 (MainThread): On master: Close
2020-11-05 19:49:11.408101 (MainThread): 20:49:11 | Concurrency: 1 threads (target='dev')
2020-11-05 19:49:11.409101 (MainThread): 20:49:11 | 
2020-11-05 19:49:11.465131 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:49:11.474129 (Thread-1): 20:49:11 | 1 of 6 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 19:49:11.482130 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:49:11.483131 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:49:11.638205 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:49:11.641707 (Thread-1): finished collecting timing info
2020-11-05 19:49:11.891238 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:49:11.900740 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:49:11.901740 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 19:49:11.902241 (Thread-1): Opening a new connection, currently in state init
2020-11-05 19:49:13.182882 (Thread-1): SQL status: SUCCESS 1 in 1.28 seconds
2020-11-05 19:49:13.183900 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:49:13.183900 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 19:49:14.140317 (Thread-1): SQL status: SUCCESS 1 in 0.96 seconds
2020-11-05 19:49:14.145335 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:49:14.146319 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:49:14.146319 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:49:14.295102 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-11-05 19:49:14.375117 (Thread-1): finished collecting timing info
2020-11-05 19:49:14.376617 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 19:49:14.579180 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca41972a-2dee-4ad8-976e-2363f514e570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF02D40C40>]}
2020-11-05 19:49:14.585701 (Thread-1): 20:49:14 | 1 of 6 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 3.10s]
2020-11-05 19:49:14.588685 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:49:14.589686 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:49:14.600687 (Thread-1): 20:49:14 | 2 of 6 START table model cko_dbt_am.pageviews_extract_ephemere....... [RUN]
2020-11-05 19:49:14.606686 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:49:14.607706 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:49:14.653705 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 19:49:14.657689 (Thread-1): finished collecting timing info
2020-11-05 19:49:14.685717 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 19:49:14.693717 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:49:14.694717 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: BEGIN
2020-11-05 19:49:14.694717 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:49:16.459100 (Thread-1): SQL status: SUCCESS 1 in 1.76 seconds
2020-11-05 19:49:16.459100 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:49:16.460117 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract_ephemere"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract_ephemere  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
      );
2020-11-05 19:49:18.249623 (Thread-1): SQL status: SUCCESS 1 in 1.79 seconds
2020-11-05 19:49:18.254649 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 19:49:18.255650 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:49:18.256150 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 19:49:18.387267 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2020-11-05 19:49:18.398266 (Thread-1): finished collecting timing info
2020-11-05 19:49:18.399268 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: Close
2020-11-05 19:49:18.615110 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca41972a-2dee-4ad8-976e-2363f514e570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF02E71C40>]}
2020-11-05 19:49:18.621109 (Thread-1): 20:49:18 | 2 of 6 OK created table model cko_dbt_am.pageviews_extract_ephemere.. [SUCCESS 1 in 4.01s]
2020-11-05 19:49:18.624471 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:49:18.626478 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:49:18.634480 (Thread-1): 20:49:18 | 3 of 6 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 19:49:18.637479 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:49:18.638482 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 19:49:18.690539 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:49:18.695523 (Thread-1): finished collecting timing info
2020-11-05 19:49:18.722526 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:49:18.731523 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:49:18.732525 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 19:49:18.733525 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:49:20.236652 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2020-11-05 19:49:20.237670 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:49:20.237670 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 19:49:23.386501 (Thread-1): SQL status: SUCCESS 1 in 3.15 seconds
2020-11-05 19:49:23.391500 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:49:23.392500 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:49:23.393500 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:49:23.531552 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 19:49:23.543565 (Thread-1): finished collecting timing info
2020-11-05 19:49:23.544565 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 19:49:23.770636 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca41972a-2dee-4ad8-976e-2363f514e570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF02E77940>]}
2020-11-05 19:49:23.776637 (Thread-1): 20:49:23 | 3 of 6 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 5.13s]
2020-11-05 19:49:23.783637 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:49:23.784637 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 19:49:23.791638 (Thread-1): 20:49:23 | 4 of 6 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 19:49:23.793638 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:49:23.795638 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 19:49:23.857668 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:49:23.862668 (Thread-1): finished collecting timing info
2020-11-05 19:49:23.891671 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:49:23.898670 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:49:23.899671 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 19:49:23.900671 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:49:25.503503 (Thread-1): SQL status: SUCCESS 1 in 1.60 seconds
2020-11-05 19:49:25.504504 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:49:25.504504 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 19:49:26.869624 (Thread-1): SQL status: SUCCESS 1 in 1.36 seconds
2020-11-05 19:49:26.874625 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:49:26.875624 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:49:26.876624 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:49:27.013905 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 19:49:27.024904 (Thread-1): finished collecting timing info
2020-11-05 19:49:27.026905 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 19:49:27.237858 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca41972a-2dee-4ad8-976e-2363f514e570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF02D22C10>]}
2020-11-05 19:49:27.243841 (Thread-1): 20:49:27 | 4 of 6 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 3.44s]
2020-11-05 19:49:27.246842 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 19:49:27.248844 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:49:27.256858 (Thread-1): 20:49:27 | 5 of 6 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 19:49:27.264358 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:49:27.265357 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:49:27.317883 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:49:27.320902 (Thread-1): finished collecting timing info
2020-11-05 19:49:27.454969 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:49:27.462455 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:49:27.462954 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 19:49:27.463455 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:49:29.384529 (Thread-1): SQL status: SUCCESS 1 in 1.92 seconds
2020-11-05 19:49:29.385530 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:49:29.386529 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 19:49:29.816889 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2020-11-05 19:49:29.821390 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:49:29.822390 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:49:29.822890 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:49:29.979186 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2020-11-05 19:49:29.999188 (Thread-1): finished collecting timing info
2020-11-05 19:49:30.000188 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 19:49:30.215694 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca41972a-2dee-4ad8-976e-2363f514e570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF02EC4250>]}
2020-11-05 19:49:30.222193 (Thread-1): 20:49:30 | 5 of 6 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 2.95s]
2020-11-05 19:49:30.225559 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:49:30.229059 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:49:30.231069 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:49:30.231069 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:49:30.290090 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 19:49:30.293073 (Thread-1): finished collecting timing info
2020-11-05 19:49:30.296075 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:49:30.298073 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:49:30.299075 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:49:30.300076 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:49:30.365116 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-05 19:49:30.369099 (Thread-1): finished collecting timing info
2020-11-05 19:49:30.372101 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:49:30.374100 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-05 19:49:30.380101 (Thread-1): 20:49:30 | 6 of 6 START incremental model cko_dbt_am.pageviews_history.......... [RUN]
2020-11-05 19:49:30.383101 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:49:30.384102 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-05 19:49:30.443142 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 19:49:30.447141 (Thread-1): finished collecting timing info
2020-11-05 19:49:30.642264 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:49:30.643264 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    

      create or replace temporary table analytics.cko_dbt_am.pageviews_history__dbt_tmp  as
      (with __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM analytics.cko_dbt_am.pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"

where user_id in (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_ephemeral as (
-- Use the `ref` function to select from other models



SELECT 
	pageviews.*
	,users.customer_postcode
FROM  analytics.cko_dbt_am.pageviews_extract_ephemere pageviews
LEFT OUTER JOIN __dbt__CTE__users_extract_Ephemere users  on users.user_id=pageviews.user_id
)/* Config line */





 
		Select * FROM __dbt__CTE__pageviews_history_ephemeral
      );
2020-11-05 19:49:30.644265 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:49:32.249693 (Thread-1): Snowflake query id: 01981285-0026-96f9-0000-6c5d00019982
2020-11-05 19:49:32.250692 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 20 at position 2
invalid identifier 'USERS.CUSTOMER_POSTCODE'
2020-11-05 19:49:32.250692 (Thread-1): finished collecting timing info
2020-11-05 19:49:32.252692 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-05 19:49:32.382411 (Thread-1): Database Error in model pageviews_history (models\pageviews_history.sql)
  000904 (42000): SQL compilation error: error line 20 at position 2
  invalid identifier 'USERS.CUSTOMER_POSTCODE'
  compiled SQL at target\compiled\cko_dbt_am\models\pageviews_history.sql
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 20 at position 2
invalid identifier 'USERS.CUSTOMER_POSTCODE'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\users\alexandre\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model pageviews_history (models\pageviews_history.sql)
  000904 (42000): SQL compilation error: error line 20 at position 2
  invalid identifier 'USERS.CUSTOMER_POSTCODE'
  compiled SQL at target\compiled\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:49:32.404407 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca41972a-2dee-4ad8-976e-2363f514e570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF02EDD940>]}
2020-11-05 19:49:32.411407 (Thread-1): 20:49:32 | 6 of 6 ERROR creating incremental model cko_dbt_am.pageviews_history. [ERROR in 2.02s]
2020-11-05 19:49:32.414391 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-05 19:49:32.419392 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:49:32.420392 (MainThread): Using snowflake connection "master".
2020-11-05 19:49:32.421392 (MainThread): On master: BEGIN
2020-11-05 19:49:32.422394 (MainThread): Opening a new connection, currently in state closed
2020-11-05 19:49:34.081571 (MainThread): SQL status: SUCCESS 1 in 1.66 seconds
2020-11-05 19:49:34.082571 (MainThread): On master: COMMIT
2020-11-05 19:49:34.083071 (MainThread): Using snowflake connection "master".
2020-11-05 19:49:34.083571 (MainThread): On master: COMMIT
2020-11-05 19:49:34.354436 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2020-11-05 19:49:34.354436 (MainThread): On master: Close
2020-11-05 19:49:34.576756 (MainThread): 20:49:34 | 
2020-11-05 19:49:34.578740 (MainThread): 20:49:34 | Finished running 4 table models, 1 view model, 1 incremental model in 31.01s.
2020-11-05 19:49:34.587254 (MainThread): Connection 'master' was properly closed.
2020-11-05 19:49:34.587754 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 19:49:34.588254 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 19:49:34.588754 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-05 19:49:34.703293 (MainThread): 
2020-11-05 19:49:34.706294 (MainThread): Completed with 1 error and 0 warnings:
2020-11-05 19:49:34.712295 (MainThread): 
2020-11-05 19:49:34.715294 (MainThread): Database Error in model pageviews_history (models\pageviews_history.sql)
2020-11-05 19:49:34.722295 (MainThread):   000904 (42000): SQL compilation error: error line 20 at position 2
2020-11-05 19:49:34.725296 (MainThread):   invalid identifier 'USERS.CUSTOMER_POSTCODE'
2020-11-05 19:49:34.728294 (MainThread):   compiled SQL at target\compiled\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:49:34.731295 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
2020-11-05 19:49:34.741295 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF02E826D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF02ED8F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF02ED8C40>]}
2020-11-05 19:49:34.743297 (MainThread): Flushing usage events
2020-11-05 19:51:33.990147 (MainThread): Running with dbt=0.18.1
2020-11-05 19:51:34.782765 (MainThread): Loading KWallet
2020-11-05 19:51:34.796774 (MainThread): Loading SecretService
2020-11-05 19:51:34.799774 (MainThread): Loading Windows
2020-11-05 19:51:35.104818 (MainThread): Loading chainer
2020-11-05 19:51:35.110818 (MainThread): Loading macOS
2020-11-05 19:51:36.653406 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 19:51:36.655906 (MainThread): Tracking: tracking
2020-11-05 19:51:36.655906 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CDA35AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CDA35640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CDA35D00>]}
2020-11-05 19:51:36.895437 (MainThread): Partial parsing not enabled
2020-11-05 19:51:36.924942 (MainThread): Parsing macros\adapters.sql
2020-11-05 19:51:37.080960 (MainThread): Parsing macros\catalog.sql
2020-11-05 19:51:37.120966 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 19:51:37.165471 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 19:51:37.172473 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 19:51:37.192475 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 19:51:37.238481 (MainThread): Parsing macros\core.sql
2020-11-05 19:51:37.284487 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 19:51:37.454009 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 19:51:37.481512 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 19:51:37.487013 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 19:51:37.492514 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 19:51:37.499514 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 19:51:37.507515 (MainThread): Parsing macros\etc\query.sql
2020-11-05 19:51:37.515515 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 19:51:37.552021 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 19:51:37.792551 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 19:51:37.800051 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 19:51:38.004208 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 19:51:38.209734 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 19:51:38.373756 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 19:51:38.379256 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 19:51:38.542777 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 19:51:38.586283 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 19:51:38.641289 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 19:51:38.710798 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 19:51:38.728800 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 19:51:38.735801 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 19:51:38.741802 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 19:51:38.803809 (MainThread): Partial parsing not enabled
2020-11-05 19:51:38.949828 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:51:39.015336 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:51:39.042840 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:51:39.068343 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:51:39.093347 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:51:39.124851 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:51:39.154370 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:51:39.180374 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:51:39.862539 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 19:51:40.010068 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 19:51:40.013067 (MainThread): 
2020-11-05 19:51:40.015067 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:51:40.036069 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 19:51:40.070073 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 19:51:40.071074 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 19:51:40.071074 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 19:51:43.008348 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.94 seconds
2020-11-05 19:51:43.026851 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 19:51:43.303786 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:51:43.322787 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 19:51:43.322787 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 19:51:43.323787 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 19:51:44.353086 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.03 seconds
2020-11-05 19:51:44.391073 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 19:51:44.600753 (MainThread): Using snowflake connection "master".
2020-11-05 19:51:44.601754 (MainThread): On master: BEGIN
2020-11-05 19:51:44.602754 (MainThread): Opening a new connection, currently in state init
2020-11-05 19:51:46.348336 (MainThread): SQL status: SUCCESS 1 in 1.75 seconds
2020-11-05 19:51:46.349338 (MainThread): On master: COMMIT
2020-11-05 19:51:46.350335 (MainThread): Using snowflake connection "master".
2020-11-05 19:51:46.350335 (MainThread): On master: COMMIT
2020-11-05 19:51:46.669842 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2020-11-05 19:51:46.670841 (MainThread): On master: Close
2020-11-05 19:51:46.881975 (MainThread): 20:51:46 | Concurrency: 1 threads (target='dev')
2020-11-05 19:51:46.907479 (MainThread): 20:51:46 | 
2020-11-05 19:51:46.998488 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:51:47.005492 (Thread-1): 20:51:47 | 1 of 6 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 19:51:47.009992 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:51:47.012992 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:51:47.141507 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:51:47.153509 (Thread-1): finished collecting timing info
2020-11-05 19:51:47.281525 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 19:51:47.293526 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:51:47.293526 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 19:51:47.294026 (Thread-1): Opening a new connection, currently in state init
2020-11-05 19:51:48.500624 (Thread-1): SQL status: SUCCESS 1 in 1.21 seconds
2020-11-05 19:51:48.500624 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:51:48.501124 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 19:51:49.586485 (Thread-1): SQL status: SUCCESS 1 in 1.09 seconds
2020-11-05 19:51:49.594485 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:51:49.594989 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 19:51:49.595485 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 19:51:49.732807 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 19:51:49.764325 (Thread-1): finished collecting timing info
2020-11-05 19:51:49.765320 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 19:51:49.963153 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '847cd13d-d01c-42d7-ae3d-ed873852c17c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CDFC7280>]}
2020-11-05 19:51:49.970154 (Thread-1): 20:51:49 | 1 of 6 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 2.95s]
2020-11-05 19:51:49.974155 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 19:51:49.975154 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:51:49.981155 (Thread-1): 20:51:49 | 2 of 6 START table model cko_dbt_am.pageviews_extract_ephemere....... [RUN]
2020-11-05 19:51:49.986155 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:51:49.987156 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:51:50.047169 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 19:51:50.062172 (Thread-1): finished collecting timing info
2020-11-05 19:51:50.123679 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 19:51:50.132181 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:51:50.132682 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: BEGIN
2020-11-05 19:51:50.133681 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:51:51.985681 (Thread-1): SQL status: SUCCESS 1 in 1.85 seconds
2020-11-05 19:51:51.986182 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:51:51.986681 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract_ephemere"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract_ephemere  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
      );
2020-11-05 19:51:53.408864 (Thread-1): SQL status: SUCCESS 1 in 1.42 seconds
2020-11-05 19:51:53.409864 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 19:51:53.410871 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 19:51:53.410871 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 19:51:53.553896 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 19:51:53.559897 (Thread-1): finished collecting timing info
2020-11-05 19:51:53.560897 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: Close
2020-11-05 19:51:53.764934 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '847cd13d-d01c-42d7-ae3d-ed873852c17c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CDFB2040>]}
2020-11-05 19:51:53.767935 (Thread-1): 20:51:53 | 2 of 6 OK created table model cko_dbt_am.pageviews_extract_ephemere.. [SUCCESS 1 in 3.78s]
2020-11-05 19:51:53.784935 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 19:51:53.787937 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:51:53.790937 (Thread-1): 20:51:53 | 3 of 6 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 19:51:53.797449 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:51:53.797948 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 19:51:53.815961 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:51:53.817959 (Thread-1): finished collecting timing info
2020-11-05 19:51:53.831962 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 19:51:53.835961 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:51:53.835961 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 19:51:53.838960 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:51:55.073624 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2020-11-05 19:51:55.074642 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:51:55.075142 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 19:51:58.659875 (Thread-1): SQL status: SUCCESS 1 in 3.58 seconds
2020-11-05 19:51:58.664891 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:51:58.665892 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 19:51:58.666892 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 19:51:58.836729 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-11-05 19:51:58.847730 (Thread-1): finished collecting timing info
2020-11-05 19:51:58.849730 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 19:51:59.104647 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '847cd13d-d01c-42d7-ae3d-ed873852c17c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CDFBE880>]}
2020-11-05 19:51:59.111648 (Thread-1): 20:51:59 | 3 of 6 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 5.31s]
2020-11-05 19:51:59.113940 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 19:51:59.114948 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 19:51:59.123949 (Thread-1): 20:51:59 | 4 of 6 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 19:51:59.127951 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:51:59.128948 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 19:51:59.172952 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:51:59.176951 (Thread-1): finished collecting timing info
2020-11-05 19:51:59.205478 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 19:51:59.212476 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:51:59.212476 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 19:51:59.213478 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:52:00.987624 (Thread-1): SQL status: SUCCESS 1 in 1.77 seconds
2020-11-05 19:52:00.988624 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:52:00.989624 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 19:52:02.375190 (Thread-1): SQL status: SUCCESS 1 in 1.39 seconds
2020-11-05 19:52:02.380204 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:52:02.381203 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 19:52:02.381203 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 19:52:02.505245 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2020-11-05 19:52:02.517245 (Thread-1): finished collecting timing info
2020-11-05 19:52:02.518245 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 19:52:02.791467 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '847cd13d-d01c-42d7-ae3d-ed873852c17c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CDF4DDC0>]}
2020-11-05 19:52:02.798468 (Thread-1): 20:52:02 | 4 of 6 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 3.66s]
2020-11-05 19:52:02.802468 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 19:52:02.804467 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:52:02.810467 (Thread-1): 20:52:02 | 5 of 6 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 19:52:02.818468 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:52:02.820469 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:52:02.893486 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:52:02.898987 (Thread-1): finished collecting timing info
2020-11-05 19:52:03.087012 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 19:52:03.093512 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:52:03.094012 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 19:52:03.094512 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:52:04.591255 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2020-11-05 19:52:04.591754 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:52:04.592255 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 19:52:05.328999 (Thread-1): SQL status: SUCCESS 1 in 0.74 seconds
2020-11-05 19:52:05.334496 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:52:05.335496 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 19:52:05.335997 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 19:52:05.532457 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-11-05 19:52:05.551002 (Thread-1): finished collecting timing info
2020-11-05 19:52:05.552012 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 19:52:05.773024 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '847cd13d-d01c-42d7-ae3d-ed873852c17c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CDF4D0D0>]}
2020-11-05 19:52:05.779023 (Thread-1): 20:52:05 | 5 of 6 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 2.95s]
2020-11-05 19:52:05.785024 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 19:52:05.786023 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:52:05.788023 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 19:52:05.789025 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:52:05.847038 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 19:52:05.850538 (Thread-1): finished collecting timing info
2020-11-05 19:52:05.852539 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 19:52:05.854550 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:52:05.856552 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 19:52:05.857551 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:52:05.926556 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-05 19:52:05.930554 (Thread-1): finished collecting timing info
2020-11-05 19:52:05.932554 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 19:52:05.934554 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-05 19:52:05.941567 (Thread-1): 20:52:05 | 6 of 6 START incremental model cko_dbt_am.pageviews_history.......... [RUN]
2020-11-05 19:52:05.944070 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:52:05.946068 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-05 19:52:06.002583 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 19:52:06.006585 (Thread-1): finished collecting timing info
2020-11-05 19:52:06.209655 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 19:52:06.210657 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    

      create or replace temporary table analytics.cko_dbt_am.pageviews_history__dbt_tmp  as
      (with __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM analytics.cko_dbt_am.pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"

where user_id in (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_ephemeral as (
-- Use the `ref` function to select from other models



SELECT 
	pageviews.*
	,customer_postcode
FROM  analytics.cko_dbt_am.pageviews_extract_ephemere pageviews
LEFT OUTER JOIN __dbt__CTE__users_extract_Ephemere users  on users.user_id=pageviews.user_id
)/* Config line */





 
		Select * FROM __dbt__CTE__pageviews_history_ephemeral
      );
2020-11-05 19:52:06.212641 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 19:52:08.212376 (Thread-1): Snowflake query id: 01981288-0072-038b-0000-6c5d0001c0e6
2020-11-05 19:52:08.212376 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 20 at position 2
invalid identifier 'CUSTOMER_POSTCODE'
2020-11-05 19:52:08.212376 (Thread-1): finished collecting timing info
2020-11-05 19:52:08.213375 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-05 19:52:08.337685 (Thread-1): Database Error in model pageviews_history (models\pageviews_history.sql)
  000904 (42000): SQL compilation error: error line 20 at position 2
  invalid identifier 'CUSTOMER_POSTCODE'
  compiled SQL at target\compiled\cko_dbt_am\models\pageviews_history.sql
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 20 at position 2
invalid identifier 'CUSTOMER_POSTCODE'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\users\alexandre\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model pageviews_history (models\pageviews_history.sql)
  000904 (42000): SQL compilation error: error line 20 at position 2
  invalid identifier 'CUSTOMER_POSTCODE'
  compiled SQL at target\compiled\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:52:08.359684 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '847cd13d-d01c-42d7-ae3d-ed873852c17c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CDFAE160>]}
2020-11-05 19:52:08.366669 (Thread-1): 20:52:08 | 6 of 6 ERROR creating incremental model cko_dbt_am.pageviews_history. [ERROR in 2.42s]
2020-11-05 19:52:08.369550 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-05 19:52:08.377060 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 19:52:08.378064 (MainThread): Using snowflake connection "master".
2020-11-05 19:52:08.379062 (MainThread): On master: BEGIN
2020-11-05 19:52:08.379562 (MainThread): Opening a new connection, currently in state closed
2020-11-05 19:52:10.167411 (MainThread): SQL status: SUCCESS 1 in 1.79 seconds
2020-11-05 19:52:10.168428 (MainThread): On master: COMMIT
2020-11-05 19:52:10.169428 (MainThread): Using snowflake connection "master".
2020-11-05 19:52:10.169428 (MainThread): On master: COMMIT
2020-11-05 19:52:10.421291 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2020-11-05 19:52:10.422291 (MainThread): On master: Close
2020-11-05 19:52:10.648753 (MainThread): 20:52:10 | 
2020-11-05 19:52:10.650738 (MainThread): 20:52:10 | Finished running 4 table models, 1 view model, 1 incremental model in 30.63s.
2020-11-05 19:52:10.656739 (MainThread): Connection 'master' was properly closed.
2020-11-05 19:52:10.657736 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 19:52:10.658737 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 19:52:10.659736 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-05 19:52:10.777282 (MainThread): 
2020-11-05 19:52:10.779283 (MainThread): Completed with 1 error and 0 warnings:
2020-11-05 19:52:10.788296 (MainThread): 
2020-11-05 19:52:10.791296 (MainThread): Database Error in model pageviews_history (models\pageviews_history.sql)
2020-11-05 19:52:10.793797 (MainThread):   000904 (42000): SQL compilation error: error line 20 at position 2
2020-11-05 19:52:10.805312 (MainThread):   invalid identifier 'CUSTOMER_POSTCODE'
2020-11-05 19:52:10.807308 (MainThread):   compiled SQL at target\compiled\cko_dbt_am\models\pageviews_history.sql
2020-11-05 19:52:10.811309 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
2020-11-05 19:52:10.819309 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CDFB69A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CDFC71C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CDFC7520>]}
2020-11-05 19:52:10.821310 (MainThread): Flushing usage events
2020-11-05 20:00:08.882571 (MainThread): Running with dbt=0.18.1
2020-11-05 20:00:09.582592 (MainThread): Loading KWallet
2020-11-05 20:00:09.589578 (MainThread): Loading SecretService
2020-11-05 20:00:09.595578 (MainThread): Loading Windows
2020-11-05 20:00:10.179781 (MainThread): Loading chainer
2020-11-05 20:00:10.182781 (MainThread): Loading macOS
2020-11-05 20:00:12.319509 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 20:00:12.324509 (MainThread): Tracking: tracking
2020-11-05 20:00:12.325509 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2FC163A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2FC154880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2FC154E80>]}
2020-11-05 20:00:12.504596 (MainThread): Partial parsing not enabled
2020-11-05 20:00:12.513596 (MainThread): Parsing macros\adapters.sql
2020-11-05 20:00:12.737712 (MainThread): Parsing macros\catalog.sql
2020-11-05 20:00:12.752735 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 20:00:12.825739 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 20:00:12.841766 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 20:00:12.872789 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 20:00:12.904792 (MainThread): Parsing macros\core.sql
2020-11-05 20:00:12.936288 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 20:00:13.262934 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 20:00:13.336972 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 20:00:13.345972 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 20:00:13.359983 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 20:00:13.378498 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 20:00:13.392009 (MainThread): Parsing macros\etc\query.sql
2020-11-05 20:00:13.408010 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 20:00:13.484529 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 20:00:13.595080 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 20:00:13.611066 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 20:00:13.666068 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 20:00:13.825191 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 20:00:14.031272 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 20:00:14.045272 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 20:00:14.177295 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 20:00:14.262310 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 20:00:14.308339 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 20:00:14.365340 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 20:00:14.387884 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 20:00:14.399868 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 20:00:14.414408 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 20:00:14.465396 (MainThread): Partial parsing not enabled
2020-11-05 20:00:14.725484 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 20:00:14.871578 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 20:00:14.953579 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 20:00:15.028620 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 20:00:15.101584 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 20:00:15.185119 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 20:00:15.290143 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 20:00:15.364176 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 20:00:16.799655 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 20:00:17.241813 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 20:00:17.257813 (MainThread): 
2020-11-05 20:00:17.263814 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 20:00:17.338878 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 20:00:17.436907 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 20:00:17.437407 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 20:00:17.437907 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 20:00:19.611660 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.17 seconds
2020-11-05 20:00:19.621661 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 20:00:19.885218 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 20:00:19.901721 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 20:00:19.902220 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 20:00:19.902721 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 20:00:21.088959 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.19 seconds
2020-11-05 20:00:21.102467 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 20:00:21.601171 (MainThread): Using snowflake connection "master".
2020-11-05 20:00:21.602182 (MainThread): On master: BEGIN
2020-11-05 20:00:21.602682 (MainThread): Opening a new connection, currently in state init
2020-11-05 20:00:23.301356 (MainThread): SQL status: SUCCESS 1 in 1.70 seconds
2020-11-05 20:00:23.301356 (MainThread): On master: COMMIT
2020-11-05 20:00:23.301356 (MainThread): Using snowflake connection "master".
2020-11-05 20:00:23.302357 (MainThread): On master: COMMIT
2020-11-05 20:00:23.643762 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2020-11-05 20:00:23.644780 (MainThread): On master: Close
2020-11-05 20:00:23.928563 (MainThread): 21:00:23 | Concurrency: 1 threads (target='dev')
2020-11-05 20:00:23.930546 (MainThread): 21:00:23 | 
2020-11-05 20:00:23.966859 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 20:00:23.973858 (Thread-1): 21:00:23 | 1 of 6 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 20:00:23.975843 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 20:00:23.977843 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 20:00:24.118914 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 20:00:24.121898 (Thread-1): finished collecting timing info
2020-11-05 20:00:24.329987 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 20:00:24.336972 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 20:00:24.337972 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 20:00:24.338972 (Thread-1): Opening a new connection, currently in state init
2020-11-05 20:00:25.990716 (Thread-1): SQL status: SUCCESS 1 in 1.65 seconds
2020-11-05 20:00:25.991717 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 20:00:25.992716 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 20:00:29.037900 (Thread-1): SQL status: SUCCESS 1 in 3.05 seconds
2020-11-05 20:00:29.042901 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 20:00:29.043900 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 20:00:29.043900 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 20:00:29.185745 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 20:00:29.264278 (Thread-1): finished collecting timing info
2020-11-05 20:00:29.265289 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 20:00:34.335127 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '641446a6-4b9b-4f4a-a852-75ce7b0a4982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2FC6CDF70>]}
2020-11-05 20:00:34.342128 (Thread-1): 21:00:34 | 1 of 6 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 10.36s]
2020-11-05 20:00:34.345128 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 20:00:34.346128 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 20:00:34.354131 (Thread-1): 21:00:34 | 2 of 6 START table model cko_dbt_am.pageviews_extract_ephemere....... [RUN]
2020-11-05 20:00:34.358142 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 20:00:34.359642 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 20:00:34.434157 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 20:00:34.438158 (Thread-1): finished collecting timing info
2020-11-05 20:00:34.471672 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 20:00:34.480173 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 20:00:34.481174 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: BEGIN
2020-11-05 20:00:34.481674 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 20:00:37.098259 (Thread-1): SQL status: SUCCESS 1 in 2.62 seconds
2020-11-05 20:00:37.099261 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 20:00:37.100262 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract_ephemere"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract_ephemere  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
      );
2020-11-05 20:00:39.047250 (Thread-1): SQL status: SUCCESS 1 in 1.95 seconds
2020-11-05 20:00:39.053251 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 20:00:39.054252 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 20:00:39.054252 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 20:00:39.194520 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 20:00:39.207521 (Thread-1): finished collecting timing info
2020-11-05 20:00:39.208521 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: Close
2020-11-05 20:00:39.453620 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '641446a6-4b9b-4f4a-a852-75ce7b0a4982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2FC800CA0>]}
2020-11-05 20:00:39.461622 (Thread-1): 21:00:39 | 2 of 6 OK created table model cko_dbt_am.pageviews_extract_ephemere.. [SUCCESS 1 in 5.09s]
2020-11-05 20:00:39.467620 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 20:00:39.468621 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 20:00:39.476622 (Thread-1): 21:00:39 | 3 of 6 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 20:00:39.482135 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 20:00:39.488636 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 20:00:39.540652 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 20:00:39.553651 (Thread-1): finished collecting timing info
2020-11-05 20:00:39.584669 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 20:00:39.595171 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 20:00:39.596170 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 20:00:39.596673 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 20:00:41.459853 (Thread-1): SQL status: SUCCESS 1 in 1.86 seconds
2020-11-05 20:00:41.460854 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 20:00:41.460854 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 20:00:45.585230 (Thread-1): SQL status: SUCCESS 1 in 4.12 seconds
2020-11-05 20:00:45.590230 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 20:00:45.591742 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 20:00:45.592243 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 20:00:45.731428 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 20:00:45.743428 (Thread-1): finished collecting timing info
2020-11-05 20:00:45.744429 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 20:00:45.943382 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '641446a6-4b9b-4f4a-a852-75ce7b0a4982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2FC663100>]}
2020-11-05 20:00:45.950384 (Thread-1): 21:00:45 | 3 of 6 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 6.46s]
2020-11-05 20:00:45.953384 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 20:00:45.954383 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 20:00:45.963384 (Thread-1): 21:00:45 | 4 of 6 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 20:00:45.966385 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 20:00:45.967384 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 20:00:46.015929 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 20:00:46.018913 (Thread-1): finished collecting timing info
2020-11-05 20:00:46.046917 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 20:00:46.052915 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 20:00:46.053917 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 20:00:46.054914 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 20:00:47.746496 (Thread-1): SQL status: SUCCESS 1 in 1.69 seconds
2020-11-05 20:00:47.747496 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 20:00:47.747496 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 20:00:50.545944 (Thread-1): SQL status: SUCCESS 1 in 2.80 seconds
2020-11-05 20:00:50.550957 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 20:00:50.551956 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 20:00:50.551956 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 20:00:50.784037 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-11-05 20:00:50.797040 (Thread-1): finished collecting timing info
2020-11-05 20:00:50.798041 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 20:00:51.220215 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '641446a6-4b9b-4f4a-a852-75ce7b0a4982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2FC663970>]}
2020-11-05 20:00:51.227215 (Thread-1): 21:00:51 | 4 of 6 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 5.25s]
2020-11-05 20:00:51.230214 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 20:00:51.232215 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 20:00:51.238225 (Thread-1): 21:00:51 | 5 of 6 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 20:00:51.247227 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 20:00:51.248228 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 20:00:51.309242 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 20:00:51.313243 (Thread-1): finished collecting timing info
2020-11-05 20:00:51.535282 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 20:00:51.547783 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 20:00:51.548283 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 20:00:51.549283 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 20:00:53.411524 (Thread-1): SQL status: SUCCESS 1 in 1.86 seconds
2020-11-05 20:00:53.412525 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 20:00:53.412525 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 20:00:54.078617 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2020-11-05 20:00:54.082633 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 20:00:54.083618 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 20:00:54.084634 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 20:00:54.221591 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-05 20:00:54.240609 (Thread-1): finished collecting timing info
2020-11-05 20:00:54.241609 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 20:00:54.543613 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '641446a6-4b9b-4f4a-a852-75ce7b0a4982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2FC6CD9A0>]}
2020-11-05 20:00:54.549600 (Thread-1): 21:00:54 | 5 of 6 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 3.30s]
2020-11-05 20:00:54.552599 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 20:00:54.555599 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 20:00:54.557599 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 20:00:54.558599 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 20:00:54.622136 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 20:00:54.626137 (Thread-1): finished collecting timing info
2020-11-05 20:00:54.628137 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 20:00:54.630136 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 20:00:54.632136 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 20:00:54.633138 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 20:00:54.698655 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-05 20:00:54.702655 (Thread-1): finished collecting timing info
2020-11-05 20:00:54.705155 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 20:00:54.707656 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-05 20:00:54.719156 (Thread-1): 21:00:54 | 6 of 6 START incremental model cko_dbt_am.pageviews_history.......... [RUN]
2020-11-05 20:00:54.722158 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 20:00:54.724158 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-05 20:00:54.833672 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 20:00:54.839172 (Thread-1): finished collecting timing info
2020-11-05 20:00:55.075701 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 20:00:55.076202 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    

      create or replace temporary table analytics.cko_dbt_am.pageviews_history__dbt_tmp  as
      (with __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM analytics.cko_dbt_am.pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."USERS_EXTRACT"

where user_id in (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_ephemeral as (
-- Use the `ref` function to select from other models



SELECT 
	pageviews.*
	,customer_postcode
FROM  analytics.cko_dbt_am.pageviews_extract_ephemere pageviews
LEFT OUTER JOIN __dbt__CTE__users_extract_Ephemere users  on users.user_id=pageviews.user_id
)/* Config line */





 
		Select * FROM __dbt__CTE__pageviews_history_ephemeral
      );
2020-11-05 20:00:55.076702 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 20:00:57.137707 (Thread-1): Snowflake query id: 01981290-008f-9536-0000-6c5d0001a4e6
2020-11-05 20:00:57.138706 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 6
invalid identifier 'USER_ID'
2020-11-05 20:00:57.139707 (Thread-1): finished collecting timing info
2020-11-05 20:00:57.140707 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-05 20:00:57.291894 (Thread-1): Database Error in model pageviews_history (models\pageviews_history.sql)
  000904 (42000): SQL compilation error: error line 12 at position 6
  invalid identifier 'USER_ID'
  compiled SQL at target\compiled\cko_dbt_am\models\pageviews_history.sql
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 12 at position 6
invalid identifier 'USER_ID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\users\alexandre\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model pageviews_history (models\pageviews_history.sql)
  000904 (42000): SQL compilation error: error line 12 at position 6
  invalid identifier 'USER_ID'
  compiled SQL at target\compiled\cko_dbt_am\models\pageviews_history.sql
2020-11-05 20:00:57.314401 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '641446a6-4b9b-4f4a-a852-75ce7b0a4982', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2FC871460>]}
2020-11-05 20:00:57.320402 (Thread-1): 21:00:57 | 6 of 6 ERROR creating incremental model cko_dbt_am.pageviews_history. [ERROR in 2.59s]
2020-11-05 20:00:57.323405 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-05 20:00:57.329402 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 20:00:57.335401 (MainThread): Using snowflake connection "master".
2020-11-05 20:00:57.336403 (MainThread): On master: BEGIN
2020-11-05 20:00:57.337402 (MainThread): Opening a new connection, currently in state closed
2020-11-05 20:00:59.127864 (MainThread): SQL status: SUCCESS 1 in 1.79 seconds
2020-11-05 20:00:59.127864 (MainThread): On master: COMMIT
2020-11-05 20:00:59.128864 (MainThread): Using snowflake connection "master".
2020-11-05 20:00:59.129864 (MainThread): On master: COMMIT
2020-11-05 20:00:59.379624 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2020-11-05 20:00:59.380642 (MainThread): On master: Close
2020-11-05 20:00:59.581188 (MainThread): 21:00:59 | 
2020-11-05 20:00:59.583173 (MainThread): 21:00:59 | Finished running 4 table models, 1 view model, 1 incremental model in 42.32s.
2020-11-05 20:00:59.592173 (MainThread): Connection 'master' was properly closed.
2020-11-05 20:00:59.593175 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 20:00:59.593175 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 20:00:59.594173 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-05 20:00:59.709226 (MainThread): 
2020-11-05 20:00:59.711227 (MainThread): Completed with 1 error and 0 warnings:
2020-11-05 20:00:59.720227 (MainThread): 
2020-11-05 20:00:59.728227 (MainThread): Database Error in model pageviews_history (models\pageviews_history.sql)
2020-11-05 20:00:59.735230 (MainThread):   000904 (42000): SQL compilation error: error line 12 at position 6
2020-11-05 20:00:59.746740 (MainThread):   invalid identifier 'USER_ID'
2020-11-05 20:00:59.767265 (MainThread):   compiled SQL at target\compiled\cko_dbt_am\models\pageviews_history.sql
2020-11-05 20:00:59.770267 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
2020-11-05 20:00:59.777268 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2FC6CDF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2FC6CFD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2FC6CFDC0>]}
2020-11-05 20:00:59.779269 (MainThread): Flushing usage events
2020-11-05 20:11:04.909633 (MainThread): Running with dbt=0.18.1
2020-11-05 20:11:05.163718 (MainThread): Loading KWallet
2020-11-05 20:11:05.166718 (MainThread): Loading SecretService
2020-11-05 20:11:05.168718 (MainThread): Loading Windows
2020-11-05 20:11:05.354785 (MainThread): Loading chainer
2020-11-05 20:11:05.356785 (MainThread): Loading macOS
2020-11-05 20:11:06.474224 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 20:11:06.479222 (MainThread): Tracking: tracking
2020-11-05 20:11:06.480223 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028663BA4E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028663B8D7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028663B8DE20>]}
2020-11-05 20:11:06.618252 (MainThread): Partial parsing not enabled
2020-11-05 20:11:06.627252 (MainThread): Parsing macros\adapters.sql
2020-11-05 20:11:06.849356 (MainThread): Parsing macros\catalog.sql
2020-11-05 20:11:06.864355 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 20:11:06.947871 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 20:11:06.963394 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 20:11:06.995380 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 20:11:07.026381 (MainThread): Parsing macros\core.sql
2020-11-05 20:11:07.056432 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 20:11:07.376540 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 20:11:07.446056 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 20:11:07.458560 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 20:11:07.473553 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 20:11:07.488569 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 20:11:07.502554 (MainThread): Parsing macros\etc\query.sql
2020-11-05 20:11:07.511554 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 20:11:07.581580 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 20:11:07.688640 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 20:11:07.704643 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 20:11:07.754676 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 20:11:07.921732 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 20:11:08.128800 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 20:11:08.142812 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 20:11:08.275877 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 20:11:08.327880 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 20:11:08.367920 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 20:11:08.418908 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 20:11:08.440421 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 20:11:08.451959 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 20:11:08.467960 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 20:11:08.518947 (MainThread): Partial parsing not enabled
2020-11-05 20:11:08.778081 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 20:11:08.929107 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 20:11:08.999133 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 20:11:09.071174 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 20:11:09.143222 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 20:11:09.218231 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 20:11:09.302286 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 20:11:09.376313 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 20:11:10.871899 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 20:11:11.283328 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 20:11:11.294721 (MainThread): 
2020-11-05 20:11:11.297232 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 20:11:11.358258 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 20:11:11.452312 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 20:11:11.453312 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 20:11:11.454313 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 20:11:13.528055 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.07 seconds
2020-11-05 20:11:13.555074 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 20:11:13.923797 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 20:11:13.979801 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 20:11:13.980801 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 20:11:13.981800 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 20:11:15.534539 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.55 seconds
2020-11-05 20:11:15.554539 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 20:11:15.727087 (MainThread): Using snowflake connection "master".
2020-11-05 20:11:15.727087 (MainThread): On master: BEGIN
2020-11-05 20:11:15.727587 (MainThread): Opening a new connection, currently in state init
2020-11-05 20:11:16.898320 (MainThread): SQL status: SUCCESS 1 in 1.17 seconds
2020-11-05 20:11:16.899338 (MainThread): On master: COMMIT
2020-11-05 20:11:16.900337 (MainThread): Using snowflake connection "master".
2020-11-05 20:11:16.900337 (MainThread): On master: COMMIT
2020-11-05 20:11:17.209580 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2020-11-05 20:11:17.210579 (MainThread): On master: Close
2020-11-05 20:11:17.726181 (MainThread): 21:11:17 | Concurrency: 1 threads (target='dev')
2020-11-05 20:11:17.727182 (MainThread): 21:11:17 | 
2020-11-05 20:11:17.759795 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 20:11:17.767810 (Thread-1): 21:11:17 | 1 of 6 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 20:11:17.769794 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 20:11:17.771796 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 20:11:17.905853 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 20:11:17.909853 (Thread-1): finished collecting timing info
2020-11-05 20:11:18.118948 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 20:11:18.125932 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 20:11:18.126933 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 20:11:18.127934 (Thread-1): Opening a new connection, currently in state init
2020-11-05 20:11:19.897594 (Thread-1): SQL status: SUCCESS 1 in 1.77 seconds
2020-11-05 20:11:19.898095 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 20:11:19.899094 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 20:11:21.933324 (Thread-1): SQL status: SUCCESS 1 in 2.03 seconds
2020-11-05 20:11:21.938309 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 20:11:21.939326 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 20:11:21.939326 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 20:11:22.092440 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-11-05 20:11:22.169476 (Thread-1): finished collecting timing info
2020-11-05 20:11:22.170475 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 20:11:22.376727 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ed567e7-178f-4c81-a80d-45eb5f5e1a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002866410ACA0>]}
2020-11-05 20:11:22.383712 (Thread-1): 21:11:22 | 1 of 6 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 4.61s]
2020-11-05 20:11:22.386711 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 20:11:22.387713 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 20:11:22.398714 (Thread-1): 21:11:22 | 2 of 6 START table model cko_dbt_am.pageviews_extract_ephemere....... [RUN]
2020-11-05 20:11:22.401713 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 20:11:22.402714 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 20:11:22.451724 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 20:11:22.455224 (Thread-1): finished collecting timing info
2020-11-05 20:11:22.489739 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 20:11:22.497738 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 20:11:22.498738 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: BEGIN
2020-11-05 20:11:22.499738 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 20:11:24.379406 (Thread-1): SQL status: SUCCESS 1 in 1.88 seconds
2020-11-05 20:11:24.380406 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 20:11:24.381407 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract_ephemere"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract_ephemere  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
      );
2020-11-05 20:11:26.138592 (Thread-1): SQL status: SUCCESS 1 in 1.76 seconds
2020-11-05 20:11:26.143610 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 20:11:26.144592 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 20:11:26.144592 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 20:11:26.314894 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-11-05 20:11:26.325893 (Thread-1): finished collecting timing info
2020-11-05 20:11:26.327894 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: Close
2020-11-05 20:11:26.537877 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ed567e7-178f-4c81-a80d-45eb5f5e1a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028664248820>]}
2020-11-05 20:11:26.545895 (Thread-1): 21:11:26 | 2 of 6 OK created table model cko_dbt_am.pageviews_extract_ephemere.. [SUCCESS 1 in 4.14s]
2020-11-05 20:11:26.548877 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 20:11:26.549877 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 20:11:26.555877 (Thread-1): 21:11:26 | 3 of 6 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 20:11:26.563878 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 20:11:26.564896 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 20:11:26.609922 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 20:11:26.613905 (Thread-1): finished collecting timing info
2020-11-05 20:11:26.642910 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 20:11:26.653911 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 20:11:26.653911 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 20:11:26.654909 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 20:11:28.623046 (Thread-1): SQL status: SUCCESS 1 in 1.97 seconds
2020-11-05 20:11:28.624046 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 20:11:28.625046 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 20:11:32.450871 (Thread-1): SQL status: SUCCESS 1 in 3.83 seconds
2020-11-05 20:11:32.455874 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 20:11:32.456873 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 20:11:32.456873 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 20:11:32.847043 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2020-11-05 20:11:32.858042 (Thread-1): finished collecting timing info
2020-11-05 20:11:32.860043 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 20:11:33.065640 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ed567e7-178f-4c81-a80d-45eb5f5e1a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286642486D0>]}
2020-11-05 20:11:33.072640 (Thread-1): 21:11:33 | 3 of 6 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 6.50s]
2020-11-05 20:11:33.075641 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 20:11:33.076640 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 20:11:33.088154 (Thread-1): 21:11:33 | 4 of 6 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 20:11:33.092155 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 20:11:33.093155 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 20:11:33.149662 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 20:11:33.153663 (Thread-1): finished collecting timing info
2020-11-05 20:11:33.181666 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 20:11:33.188167 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 20:11:33.188667 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 20:11:33.189168 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 20:11:35.134311 (Thread-1): SQL status: SUCCESS 1 in 1.95 seconds
2020-11-05 20:11:35.135312 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 20:11:35.136312 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 20:11:37.334363 (Thread-1): SQL status: SUCCESS 1 in 2.20 seconds
2020-11-05 20:11:37.339363 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 20:11:37.340363 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 20:11:37.340363 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 20:11:37.487473 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-11-05 20:11:37.498473 (Thread-1): finished collecting timing info
2020-11-05 20:11:37.500473 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 20:11:37.746383 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ed567e7-178f-4c81-a80d-45eb5f5e1a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286642327C0>]}
2020-11-05 20:11:37.752399 (Thread-1): 21:11:37 | 4 of 6 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 4.66s]
2020-11-05 20:11:37.755383 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 20:11:37.756384 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 20:11:37.763385 (Thread-1): 21:11:37 | 5 of 6 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 20:11:37.770385 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 20:11:37.771385 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 20:11:37.826426 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 20:11:37.830427 (Thread-1): finished collecting timing info
2020-11-05 20:11:37.972487 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 20:11:37.978470 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 20:11:37.978470 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 20:11:37.979471 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 20:11:39.544583 (Thread-1): SQL status: SUCCESS 1 in 1.57 seconds
2020-11-05 20:11:39.545584 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 20:11:39.546083 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 20:11:40.010397 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2020-11-05 20:11:40.015399 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 20:11:40.016399 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 20:11:40.017400 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 20:11:40.193074 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-11-05 20:11:40.211075 (Thread-1): finished collecting timing info
2020-11-05 20:11:40.213060 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 20:11:40.419198 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ed567e7-178f-4c81-a80d-45eb5f5e1a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286642B1D00>]}
2020-11-05 20:11:40.425200 (Thread-1): 21:11:40 | 5 of 6 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 2.65s]
2020-11-05 20:11:40.432198 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 20:11:40.433198 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 20:11:40.435199 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 20:11:40.436197 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 20:11:40.501230 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 20:11:40.505231 (Thread-1): finished collecting timing info
2020-11-05 20:11:40.507233 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 20:11:40.509232 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 20:11:40.512232 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 20:11:40.513232 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 20:11:40.580269 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-05 20:11:40.583269 (Thread-1): finished collecting timing info
2020-11-05 20:11:40.586269 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 20:11:40.588269 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-05 20:11:40.594270 (Thread-1): 21:11:40 | 6 of 6 START incremental model cko_dbt_am.pageviews_history.......... [RUN]
2020-11-05 20:11:40.597269 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 20:11:40.600273 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-05 20:11:40.654328 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 20:11:40.659323 (Thread-1): finished collecting timing info
2020-11-05 20:11:40.860558 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 20:11:40.861558 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    

      create or replace temporary table analytics.cko_dbt_am.pageviews_history__dbt_tmp  as
      (with __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM analytics.cko_dbt_am.pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."USERS_EXTRACT"

where id in (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_ephemeral as (
-- Use the `ref` function to select from other models



SELECT 
	pageviews.*
	,customer_postcode
FROM  analytics.cko_dbt_am.pageviews_extract_ephemere pageviews
LEFT OUTER JOIN __dbt__CTE__users_extract_Ephemere users  on users.id=pageviews.user_id
)/* Config line */





 
		Select * FROM __dbt__CTE__pageviews_history_ephemeral
      );
2020-11-05 20:11:40.861558 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 20:11:42.918529 (Thread-1): Snowflake query id: 0198129b-0004-205a-0000-6c5d0001a4fa
2020-11-05 20:11:42.919527 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 20 at position 2
invalid identifier 'CUSTOMER_POSTCODE'
2020-11-05 20:11:42.920528 (Thread-1): finished collecting timing info
2020-11-05 20:11:42.921527 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-05 20:11:43.052572 (Thread-1): Database Error in model pageviews_history (models\pageviews_history.sql)
  000904 (42000): SQL compilation error: error line 20 at position 2
  invalid identifier 'CUSTOMER_POSTCODE'
  compiled SQL at target\compiled\cko_dbt_am\models\pageviews_history.sql
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 20 at position 2
invalid identifier 'CUSTOMER_POSTCODE'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\users\alexandre\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model pageviews_history (models\pageviews_history.sql)
  000904 (42000): SQL compilation error: error line 20 at position 2
  invalid identifier 'CUSTOMER_POSTCODE'
  compiled SQL at target\compiled\cko_dbt_am\models\pageviews_history.sql
2020-11-05 20:11:43.075573 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ed567e7-178f-4c81-a80d-45eb5f5e1a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286642950A0>]}
2020-11-05 20:11:43.082592 (Thread-1): 21:11:43 | 6 of 6 ERROR creating incremental model cko_dbt_am.pageviews_history. [ERROR in 2.48s]
2020-11-05 20:11:43.086847 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-05 20:11:43.092363 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 20:11:43.093348 (MainThread): Using snowflake connection "master".
2020-11-05 20:11:43.093847 (MainThread): On master: BEGIN
2020-11-05 20:11:43.094847 (MainThread): Opening a new connection, currently in state closed
2020-11-05 20:11:44.648157 (MainThread): SQL status: SUCCESS 1 in 1.55 seconds
2020-11-05 20:11:44.649157 (MainThread): On master: COMMIT
2020-11-05 20:11:44.650157 (MainThread): Using snowflake connection "master".
2020-11-05 20:11:44.650157 (MainThread): On master: COMMIT
2020-11-05 20:11:44.896519 (MainThread): SQL status: SUCCESS 1 in 0.25 seconds
2020-11-05 20:11:44.897520 (MainThread): On master: Close
2020-11-05 20:11:45.222532 (MainThread): 21:11:45 | 
2020-11-05 20:11:45.223531 (MainThread): 21:11:45 | Finished running 4 table models, 1 view model, 1 incremental model in 33.93s.
2020-11-05 20:11:45.230531 (MainThread): Connection 'master' was properly closed.
2020-11-05 20:11:45.230531 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 20:11:45.231532 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 20:11:45.232533 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-05 20:11:45.344060 (MainThread): 
2020-11-05 20:11:45.346061 (MainThread): Completed with 1 error and 0 warnings:
2020-11-05 20:11:45.353061 (MainThread): 
2020-11-05 20:11:45.355062 (MainThread): Database Error in model pageviews_history (models\pageviews_history.sql)
2020-11-05 20:11:45.362061 (MainThread):   000904 (42000): SQL compilation error: error line 20 at position 2
2020-11-05 20:11:45.366061 (MainThread):   invalid identifier 'CUSTOMER_POSTCODE'
2020-11-05 20:11:45.368061 (MainThread):   compiled SQL at target\compiled\cko_dbt_am\models\pageviews_history.sql
2020-11-05 20:11:45.371061 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
2020-11-05 20:11:45.374062 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028664290910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028664290C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028664290D30>]}
2020-11-05 20:11:45.381063 (MainThread): Flushing usage events
2020-11-05 20:16:51.278313 (MainThread): Running with dbt=0.18.1
2020-11-05 20:16:51.640360 (MainThread): Loading KWallet
2020-11-05 20:16:51.642860 (MainThread): Loading SecretService
2020-11-05 20:16:51.645360 (MainThread): Loading Windows
2020-11-05 20:16:51.860887 (MainThread): Loading chainer
2020-11-05 20:16:51.862388 (MainThread): Loading macOS
2020-11-05 20:16:52.734009 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 20:16:52.736026 (MainThread): Tracking: tracking
2020-11-05 20:16:52.736026 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B580DC4970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B580DAF910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B580DAFF40>]}
2020-11-05 20:16:52.784029 (MainThread): Partial parsing not enabled
2020-11-05 20:16:52.787552 (MainThread): Parsing macros\adapters.sql
2020-11-05 20:16:52.865077 (MainThread): Parsing macros\catalog.sql
2020-11-05 20:16:52.870077 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 20:16:52.896101 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 20:16:52.901586 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 20:16:52.913092 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 20:16:52.924075 (MainThread): Parsing macros\core.sql
2020-11-05 20:16:52.935076 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 20:16:53.044127 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 20:16:53.067128 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 20:16:53.070129 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 20:16:53.075130 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 20:16:53.080130 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 20:16:53.084129 (MainThread): Parsing macros\etc\query.sql
2020-11-05 20:16:53.088154 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 20:16:53.111174 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 20:16:53.147177 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 20:16:53.153161 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 20:16:53.170179 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 20:16:53.231196 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 20:16:53.305243 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 20:16:53.310243 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 20:16:53.354247 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 20:16:53.372231 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 20:16:53.386737 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 20:16:53.405260 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 20:16:53.414245 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 20:16:53.418245 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 20:16:53.424246 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 20:16:53.443264 (MainThread): Partial parsing not enabled
2020-11-05 20:16:53.531295 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 20:16:53.579298 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 20:16:53.605328 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 20:16:53.629329 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 20:16:53.655330 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 20:16:53.681315 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 20:16:53.711344 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 20:16:53.738362 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 20:16:54.263546 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 20:16:54.400076 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 20:16:54.402075 (MainThread): 
2020-11-05 20:16:54.402576 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 20:16:54.421584 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 20:16:54.462587 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 20:16:54.463585 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 20:16:54.463585 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 20:16:55.627628 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.16 seconds
2020-11-05 20:16:55.654141 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 20:16:55.982282 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 20:16:56.025300 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 20:16:56.025300 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 20:16:56.026300 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 20:16:57.593166 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.57 seconds
2020-11-05 20:16:57.632706 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 20:16:58.175120 (MainThread): Using snowflake connection "master".
2020-11-05 20:16:58.176122 (MainThread): On master: BEGIN
2020-11-05 20:16:58.177120 (MainThread): Opening a new connection, currently in state init
2020-11-05 20:16:59.777525 (MainThread): SQL status: SUCCESS 1 in 1.60 seconds
2020-11-05 20:16:59.778526 (MainThread): On master: COMMIT
2020-11-05 20:16:59.779526 (MainThread): Using snowflake connection "master".
2020-11-05 20:16:59.779526 (MainThread): On master: COMMIT
2020-11-05 20:17:00.082067 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2020-11-05 20:17:00.083067 (MainThread): On master: Close
2020-11-05 20:17:00.322995 (MainThread): 21:17:00 | Concurrency: 1 threads (target='dev')
2020-11-05 20:17:00.324995 (MainThread): 21:17:00 | 
2020-11-05 20:17:00.351997 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 20:17:00.357997 (Thread-1): 21:17:00 | 1 of 6 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 20:17:00.361015 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 20:17:00.361997 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 20:17:00.507082 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 20:17:00.510567 (Thread-1): finished collecting timing info
2020-11-05 20:17:00.725164 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 20:17:00.732164 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 20:17:00.733164 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 20:17:00.733164 (Thread-1): Opening a new connection, currently in state init
2020-11-05 20:17:02.491528 (Thread-1): SQL status: SUCCESS 1 in 1.76 seconds
2020-11-05 20:17:02.492529 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 20:17:02.492529 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 20:17:04.163419 (Thread-1): SQL status: SUCCESS 1 in 1.67 seconds
2020-11-05 20:17:04.168422 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 20:17:04.169421 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 20:17:04.169421 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 20:17:04.295118 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2020-11-05 20:17:04.374157 (Thread-1): finished collecting timing info
2020-11-05 20:17:04.376157 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 20:17:04.675692 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cf9c501-5326-4136-9d26-c9f2b805962a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B58143D490>]}
2020-11-05 20:17:04.681692 (Thread-1): 21:17:04 | 1 of 6 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 4.31s]
2020-11-05 20:17:04.684692 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 20:17:04.685709 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 20:17:04.692692 (Thread-1): 21:17:04 | 2 of 6 START table model cko_dbt_am.pageviews_extract_ephemere....... [RUN]
2020-11-05 20:17:04.708705 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 20:17:04.709205 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 20:17:04.767222 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 20:17:04.771221 (Thread-1): finished collecting timing info
2020-11-05 20:17:04.798224 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 20:17:04.806237 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 20:17:04.807237 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: BEGIN
2020-11-05 20:17:04.807736 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 20:17:06.770382 (Thread-1): SQL status: SUCCESS 1 in 1.96 seconds
2020-11-05 20:17:06.771383 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 20:17:06.772381 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract_ephemere"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract_ephemere  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
      );
2020-11-05 20:17:08.884282 (Thread-1): SQL status: SUCCESS 1 in 2.11 seconds
2020-11-05 20:17:08.889294 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 20:17:08.890294 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 20:17:08.890794 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 20:17:09.037829 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-11-05 20:17:09.049331 (Thread-1): finished collecting timing info
2020-11-05 20:17:09.050831 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: Close
2020-11-05 20:17:09.347428 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cf9c501-5326-4136-9d26-c9f2b805962a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B581461910>]}
2020-11-05 20:17:09.354428 (Thread-1): 21:17:09 | 2 of 6 OK created table model cko_dbt_am.pageviews_extract_ephemere.. [SUCCESS 1 in 4.64s]
2020-11-05 20:17:09.357428 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 20:17:09.358427 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 20:17:09.368430 (Thread-1): 21:17:09 | 3 of 6 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 20:17:09.371429 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 20:17:09.372428 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 20:17:09.426949 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 20:17:09.431949 (Thread-1): finished collecting timing info
2020-11-05 20:17:09.461452 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 20:17:09.473953 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 20:17:09.474954 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 20:17:09.475454 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 20:17:10.723889 (Thread-1): SQL status: SUCCESS 1 in 1.25 seconds
2020-11-05 20:17:10.724889 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 20:17:10.724889 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 20:17:15.181948 (Thread-1): SQL status: SUCCESS 1 in 4.46 seconds
2020-11-05 20:17:15.186447 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 20:17:15.187448 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 20:17:15.187949 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 20:17:15.317012 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2020-11-05 20:17:15.327996 (Thread-1): finished collecting timing info
2020-11-05 20:17:15.330013 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 20:17:15.526578 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cf9c501-5326-4136-9d26-c9f2b805962a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B58132F1F0>]}
2020-11-05 20:17:15.534578 (Thread-1): 21:17:15 | 3 of 6 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 6.16s]
2020-11-05 20:17:15.537154 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 20:17:15.539162 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 20:17:15.545179 (Thread-1): 21:17:15 | 4 of 6 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 20:17:15.551164 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 20:17:15.552164 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 20:17:15.601678 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 20:17:15.606678 (Thread-1): finished collecting timing info
2020-11-05 20:17:15.634191 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 20:17:15.641191 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 20:17:15.642192 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 20:17:15.642192 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 20:17:17.238428 (Thread-1): SQL status: SUCCESS 1 in 1.60 seconds
2020-11-05 20:17:17.239427 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 20:17:17.239427 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as Customer_postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 20:17:19.670532 (Thread-1): SQL status: SUCCESS 1 in 2.43 seconds
2020-11-05 20:17:19.675550 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 20:17:19.676050 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 20:17:19.677050 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 20:17:19.804873 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2020-11-05 20:17:19.815890 (Thread-1): finished collecting timing info
2020-11-05 20:17:19.816890 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 20:17:20.046711 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cf9c501-5326-4136-9d26-c9f2b805962a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B581466F70>]}
2020-11-05 20:17:20.053712 (Thread-1): 21:17:20 | 4 of 6 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 4.50s]
2020-11-05 20:17:20.056695 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 20:17:20.057696 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 20:17:20.064710 (Thread-1): 21:17:20 | 5 of 6 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 20:17:20.072714 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 20:17:20.073710 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 20:17:20.133241 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 20:17:20.136224 (Thread-1): finished collecting timing info
2020-11-05 20:17:20.274295 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 20:17:20.280290 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 20:17:20.281289 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 20:17:20.281289 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 20:17:22.043238 (Thread-1): SQL status: SUCCESS 1 in 1.76 seconds
2020-11-05 20:17:22.044239 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 20:17:22.045237 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 20:17:22.636268 (Thread-1): unclosed <socket.socket fd=1140, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.5.101', 50770), raddr=('168.63.27.166', 443)>
2020-11-05 20:17:22.638268 (Thread-1): SQL status: SUCCESS 1 in 0.59 seconds
2020-11-05 20:17:22.643269 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 20:17:22.644269 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 20:17:22.645267 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 20:17:23.986595 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2020-11-05 20:17:23.996595 (Thread-1): finished collecting timing info
2020-11-05 20:17:23.997596 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 20:17:24.676916 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cf9c501-5326-4136-9d26-c9f2b805962a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5814BFA30>]}
2020-11-05 20:17:24.683916 (Thread-1): 21:17:24 | 5 of 6 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 4.60s]
2020-11-05 20:17:24.687915 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 20:17:24.688916 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 20:17:24.690917 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 20:17:24.691916 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 20:17:24.753919 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 20:17:24.778932 (Thread-1): finished collecting timing info
2020-11-05 20:17:24.781431 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 20:17:24.784432 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 20:17:24.786932 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 20:17:24.787935 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 20:17:24.860943 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-05 20:17:24.864943 (Thread-1): finished collecting timing info
2020-11-05 20:17:24.867944 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 20:17:24.869943 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-05 20:17:24.876445 (Thread-1): 21:17:24 | 6 of 6 START incremental model cko_dbt_am.pageviews_history.......... [RUN]
2020-11-05 20:17:24.879946 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 20:17:24.884945 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-05 20:17:24.944953 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 20:17:24.952954 (Thread-1): finished collecting timing info
2020-11-05 20:17:25.170988 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 20:17:25.171488 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    

      create or replace temporary table analytics.cko_dbt_am.pageviews_history__dbt_tmp  as
      (with __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM analytics.cko_dbt_am.pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."USERS_EXTRACT"

where id in (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_ephemeral as (
-- Use the `ref` function to select from other models



SELECT 
	pageviews.*
	,customer_postcode
FROM  analytics.cko_dbt_am.pageviews_extract_ephemere pageviews
LEFT OUTER JOIN __dbt__CTE__users_extract_Ephemere users  on users.id=pageviews.user_id
)/* Config line */

 
		Select * FROM __dbt__CTE__pageviews_history_ephemeral
      );
2020-11-05 20:17:25.171988 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 20:17:28.427580 (Thread-1): SQL status: SUCCESS 1 in 3.25 seconds
2020-11-05 20:17:28.498613 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 20:17:28.511614 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history__dbt_tmp
2020-11-05 20:17:28.748879 (Thread-1): SQL status: SUCCESS 5 in 0.24 seconds
2020-11-05 20:17:28.764904 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 20:17:28.765904 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history
2020-11-05 20:17:28.950937 (Thread-1): SQL status: SUCCESS 4 in 0.18 seconds
2020-11-05 20:17:28.965950 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 20:17:28.966950 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history
2020-11-05 20:17:29.180548 (Thread-1): SQL status: SUCCESS 4 in 0.21 seconds
2020-11-05 20:17:29.266575 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 20:17:29.273574 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 20:17:29.274574 (Thread-1): On model.cko_dbt_am.pageviews_history: BEGIN
2020-11-05 20:17:29.448062 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-11-05 20:17:29.448562 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 20:17:29.449062 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */


        insert into analytics.cko_dbt_am.pageviews_history ("USER_ID", "PAGEVIEW_DATE_HOUR", "COUNT_PAGEVIEWS", "COUNT_DISCTINT_PAGEVIEWS")
        (
            select "USER_ID", "PAGEVIEW_DATE_HOUR", "COUNT_PAGEVIEWS", "COUNT_DISCTINT_PAGEVIEWS"
            from analytics.cko_dbt_am.pageviews_history__dbt_tmp
        );
2020-11-05 20:17:30.136038 (Thread-1): SQL status: SUCCESS 2581 in 0.69 seconds
2020-11-05 20:17:30.141039 (Thread-1): On model.cko_dbt_am.pageviews_history: COMMIT
2020-11-05 20:17:30.142067 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 20:17:30.142566 (Thread-1): On model.cko_dbt_am.pageviews_history: COMMIT
2020-11-05 20:17:30.602145 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2020-11-05 20:17:30.621146 (Thread-1): finished collecting timing info
2020-11-05 20:17:30.622147 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-05 20:17:30.920535 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cf9c501-5326-4136-9d26-c9f2b805962a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B581452B80>]}
2020-11-05 20:17:30.926517 (Thread-1): 21:17:30 | 6 of 6 OK created incremental model cko_dbt_am.pageviews_history..... [SUCCESS 2581 in 6.04s]
2020-11-05 20:17:30.929526 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-05 20:17:30.937253 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 20:17:30.941237 (MainThread): Using snowflake connection "master".
2020-11-05 20:17:30.942749 (MainThread): On master: BEGIN
2020-11-05 20:17:30.943252 (MainThread): Opening a new connection, currently in state closed
2020-11-05 20:17:33.077152 (MainThread): SQL status: SUCCESS 1 in 2.13 seconds
2020-11-05 20:17:33.078152 (MainThread): On master: COMMIT
2020-11-05 20:17:33.079169 (MainThread): Using snowflake connection "master".
2020-11-05 20:17:33.079169 (MainThread): On master: COMMIT
2020-11-05 20:17:33.300418 (MainThread): SQL status: SUCCESS 1 in 0.22 seconds
2020-11-05 20:17:33.301418 (MainThread): On master: Close
2020-11-05 20:17:33.497797 (MainThread): 21:17:33 | 
2020-11-05 20:17:33.498809 (MainThread): 21:17:33 | Finished running 4 table models, 1 view model, 1 incremental model in 39.09s.
2020-11-05 20:17:33.509800 (MainThread): Connection 'master' was properly closed.
2020-11-05 20:17:33.510803 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 20:17:33.511804 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 20:17:33.511804 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-05 20:17:33.624855 (MainThread): 
2020-11-05 20:17:33.626856 (MainThread): Completed successfully
2020-11-05 20:17:33.633856 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2020-11-05 20:17:33.636855 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5813294C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B581329910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5813297F0>]}
2020-11-05 20:17:33.637855 (MainThread): Flushing usage events
2020-11-05 20:21:58.579063 (MainThread): Running with dbt=0.18.1
2020-11-05 20:21:59.258214 (MainThread): Loading KWallet
2020-11-05 20:21:59.263713 (MainThread): Loading SecretService
2020-11-05 20:21:59.267714 (MainThread): Loading Windows
2020-11-05 20:21:59.585864 (MainThread): Loading chainer
2020-11-05 20:21:59.587864 (MainThread): Loading macOS
2020-11-05 20:22:00.687636 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-05 20:22:00.690636 (MainThread): Tracking: tracking
2020-11-05 20:22:00.690636 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3DE6F59D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3DE6E56D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3DE6E5D60>]}
2020-11-05 20:22:00.761149 (MainThread): Partial parsing not enabled
2020-11-05 20:22:00.765356 (MainThread): Parsing macros\adapters.sql
2020-11-05 20:22:00.872898 (MainThread): Parsing macros\catalog.sql
2020-11-05 20:22:00.880899 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-05 20:22:00.924890 (MainThread): Parsing macros\materializations\merge.sql
2020-11-05 20:22:00.933890 (MainThread): Parsing macros\materializations\table.sql
2020-11-05 20:22:00.949897 (MainThread): Parsing macros\materializations\view.sql
2020-11-05 20:22:00.967901 (MainThread): Parsing macros\core.sql
2020-11-05 20:22:00.983402 (MainThread): Parsing macros\adapters\common.sql
2020-11-05 20:22:01.155446 (MainThread): Parsing macros\etc\datetime.sql
2020-11-05 20:22:01.181446 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-05 20:22:01.184446 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-05 20:22:01.188952 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-05 20:22:01.194953 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-05 20:22:01.201455 (MainThread): Parsing macros\etc\query.sql
2020-11-05 20:22:01.204474 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-05 20:22:01.228481 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-05 20:22:01.266484 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-05 20:22:01.271483 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-05 20:22:01.289491 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-05 20:22:01.346510 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-05 20:22:01.422548 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-05 20:22:01.427537 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-05 20:22:01.477539 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-05 20:22:01.496546 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-05 20:22:01.510572 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-05 20:22:01.528563 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-05 20:22:01.536563 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-05 20:22:01.541564 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-05 20:22:01.546564 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-05 20:22:01.567565 (MainThread): Partial parsing not enabled
2020-11-05 20:22:01.658595 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 20:22:01.709612 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 20:22:01.735613 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 20:22:01.761614 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 20:22:01.787616 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 20:22:01.817650 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 20:22:01.847652 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 20:22:01.875643 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 20:22:02.450978 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-05 20:22:02.593019 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-05 20:22:02.605019 (MainThread): 
2020-11-05 20:22:02.606019 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 20:22:02.633021 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-05 20:22:02.667035 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-05 20:22:02.667035 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-05 20:22:02.667035 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-05 20:22:04.651072 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.98 seconds
2020-11-05 20:22:04.679077 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-05 20:22:05.054556 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 20:22:05.096540 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-05 20:22:05.096540 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-05 20:22:05.097540 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-05 20:22:06.771486 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.67 seconds
2020-11-05 20:22:06.811503 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-05 20:22:07.040793 (MainThread): Using snowflake connection "master".
2020-11-05 20:22:07.041792 (MainThread): On master: BEGIN
2020-11-05 20:22:07.041792 (MainThread): Opening a new connection, currently in state init
2020-11-05 20:22:08.891375 (MainThread): SQL status: SUCCESS 1 in 1.85 seconds
2020-11-05 20:22:08.892375 (MainThread): On master: COMMIT
2020-11-05 20:22:08.893376 (MainThread): Using snowflake connection "master".
2020-11-05 20:22:08.893376 (MainThread): On master: COMMIT
2020-11-05 20:22:09.212345 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2020-11-05 20:22:09.213345 (MainThread): On master: Close
2020-11-05 20:22:09.443935 (MainThread): 21:22:09 | Concurrency: 1 threads (target='dev')
2020-11-05 20:22:09.445935 (MainThread): 21:22:09 | 
2020-11-05 20:22:09.484938 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 20:22:09.493937 (Thread-1): 21:22:09 | 1 of 6 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-05 20:22:09.502940 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 20:22:09.503940 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-05 20:22:09.664970 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 20:22:09.668469 (Thread-1): finished collecting timing info
2020-11-05 20:22:09.945505 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-05 20:22:09.966508 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 20:22:09.967509 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-05 20:22:09.968008 (Thread-1): Opening a new connection, currently in state init
2020-11-05 20:22:17.449368 (Thread-1): SQL status: SUCCESS 1 in 7.48 seconds
2020-11-05 20:22:17.450386 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 20:22:17.450386 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-05 20:22:18.566937 (Thread-1): SQL status: SUCCESS 1 in 1.12 seconds
2020-11-05 20:22:18.571937 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 20:22:18.572936 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-05 20:22:18.572936 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-05 20:22:18.730531 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2020-11-05 20:22:18.807558 (Thread-1): finished collecting timing info
2020-11-05 20:22:18.809558 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-05 20:22:19.034867 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8c19fd5-3011-493f-a7eb-f6f538a6fc08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3DEC63EE0>]}
2020-11-05 20:22:19.041369 (Thread-1): 21:22:19 | 1 of 6 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 9.53s]
2020-11-05 20:22:19.043971 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-05 20:22:19.046982 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 20:22:19.052984 (Thread-1): 21:22:19 | 2 of 6 START table model cko_dbt_am.pageviews_extract_ephemere....... [RUN]
2020-11-05 20:22:19.059984 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 20:22:19.062984 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 20:22:19.122987 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 20:22:19.126987 (Thread-1): finished collecting timing info
2020-11-05 20:22:19.155012 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-05 20:22:19.165012 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 20:22:19.166012 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: BEGIN
2020-11-05 20:22:19.166012 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 20:22:21.021992 (Thread-1): SQL status: SUCCESS 1 in 1.86 seconds
2020-11-05 20:22:21.023010 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 20:22:21.023510 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract_ephemere"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract_ephemere  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
      );
2020-11-05 20:22:22.671554 (Thread-1): SQL status: SUCCESS 1 in 1.65 seconds
2020-11-05 20:22:22.676555 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 20:22:22.677554 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-05 20:22:22.677554 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-05 20:22:22.886913 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-11-05 20:22:22.897915 (Thread-1): finished collecting timing info
2020-11-05 20:22:22.899916 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: Close
2020-11-05 20:22:23.097398 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8c19fd5-3011-493f-a7eb-f6f538a6fc08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3DED65040>]}
2020-11-05 20:22:23.104398 (Thread-1): 21:22:23 | 2 of 6 OK created table model cko_dbt_am.pageviews_extract_ephemere.. [SUCCESS 1 in 4.04s]
2020-11-05 20:22:23.107398 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-05 20:22:23.108397 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-05 20:22:23.117400 (Thread-1): 21:22:23 | 3 of 6 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-05 20:22:23.120399 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 20:22:23.121399 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-05 20:22:23.179428 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 20:22:23.186428 (Thread-1): finished collecting timing info
2020-11-05 20:22:23.215430 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-05 20:22:23.224430 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 20:22:23.225432 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-05 20:22:23.226430 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 20:22:24.990750 (Thread-1): SQL status: SUCCESS 1 in 1.76 seconds
2020-11-05 20:22:24.991751 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 20:22:24.991751 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-05 20:22:28.637675 (Thread-1): SQL status: SUCCESS 1 in 3.64 seconds
2020-11-05 20:22:28.643676 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 20:22:28.644676 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-05 20:22:28.645674 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-05 20:22:28.812745 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-11-05 20:22:28.824747 (Thread-1): finished collecting timing info
2020-11-05 20:22:28.826745 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-05 20:22:29.052842 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8c19fd5-3011-493f-a7eb-f6f538a6fc08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3DEBF3FD0>]}
2020-11-05 20:22:29.059353 (Thread-1): 21:22:29 | 3 of 6 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 5.93s]
2020-11-05 20:22:29.067355 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-05 20:22:29.073865 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-05 20:22:29.080870 (Thread-1): 21:22:29 | 4 of 6 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-05 20:22:29.090868 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 20:22:29.091867 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-05 20:22:29.143870 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 20:22:29.148869 (Thread-1): finished collecting timing info
2020-11-05 20:22:29.176884 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-05 20:22:29.183385 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 20:22:29.184384 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-05 20:22:29.184885 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 20:22:30.818429 (Thread-1): SQL status: SUCCESS 1 in 1.63 seconds
2020-11-05 20:22:30.819412 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 20:22:30.820414 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as Customer_postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-05 20:22:32.222040 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2020-11-05 20:22:32.227041 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 20:22:32.228040 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-05 20:22:32.229041 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-05 20:22:32.397121 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-11-05 20:22:32.409123 (Thread-1): finished collecting timing info
2020-11-05 20:22:32.410121 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-05 20:22:32.630790 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8c19fd5-3011-493f-a7eb-f6f538a6fc08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3DED9EFD0>]}
2020-11-05 20:22:32.637792 (Thread-1): 21:22:32 | 4 of 6 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 3.54s]
2020-11-05 20:22:32.641801 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-05 20:22:32.643302 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 20:22:32.650804 (Thread-1): 21:22:32 | 5 of 6 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-05 20:22:32.655303 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 20:22:32.656304 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-05 20:22:32.734313 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 20:22:32.742315 (Thread-1): finished collecting timing info
2020-11-05 20:22:32.904543 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-05 20:22:32.915543 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 20:22:32.916043 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-05 20:22:32.917043 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 20:22:34.774422 (Thread-1): unclosed <socket.socket fd=1656, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.5.101', 50872), raddr=('168.63.27.166', 443)>
2020-11-05 20:22:34.777422 (Thread-1): SQL status: SUCCESS 1 in 1.86 seconds
2020-11-05 20:22:34.777422 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 20:22:34.778421 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-05 20:22:36.524634 (Thread-1): SQL status: SUCCESS 1 in 1.75 seconds
2020-11-05 20:22:36.531634 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 20:22:36.532633 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-05 20:22:36.532633 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-05 20:22:36.680097 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-11-05 20:22:36.698098 (Thread-1): finished collecting timing info
2020-11-05 20:22:36.699099 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-05 20:22:36.892219 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8c19fd5-3011-493f-a7eb-f6f538a6fc08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3DEDA5F70>]}
2020-11-05 20:22:36.898204 (Thread-1): 21:22:36 | 5 of 6 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 4.24s]
2020-11-05 20:22:36.902204 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-05 20:22:36.903204 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 20:22:36.905205 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-05 20:22:36.906206 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-05 20:22:36.968258 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-05 20:22:36.972242 (Thread-1): finished collecting timing info
2020-11-05 20:22:36.975242 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-05 20:22:36.978243 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 20:22:36.980244 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-05 20:22:36.980244 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 20:22:37.051798 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-05 20:22:37.055773 (Thread-1): finished collecting timing info
2020-11-05 20:22:37.058273 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-05 20:22:37.060273 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-05 20:22:37.066274 (Thread-1): 21:22:37 | 6 of 6 START incremental model cko_dbt_am.pageviews_history.......... [RUN]
2020-11-05 20:22:37.069290 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 20:22:37.073285 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-05 20:22:37.134305 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 20:22:37.138289 (Thread-1): finished collecting timing info
2020-11-05 20:22:37.346362 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 20:22:37.346362 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    

      create or replace temporary table analytics.cko_dbt_am.pageviews_history__dbt_tmp  as
      (with __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM analytics.cko_dbt_am.pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."USERS_EXTRACT"

where id in (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_ephemeral as (
-- Use the `ref` function to select from other models



SELECT 
	pageviews.*
	,customer_postcode
FROM  analytics.cko_dbt_am.pageviews_extract_ephemere pageviews
LEFT OUTER JOIN __dbt__CTE__users_extract_Ephemere users  on users.id=pageviews.user_id
)/* Config line */

 
		Select * FROM __dbt__CTE__pageviews_history_ephemeral
      );
2020-11-05 20:22:37.347363 (Thread-1): Opening a new connection, currently in state closed
2020-11-05 20:22:40.419423 (Thread-1): SQL status: SUCCESS 1 in 3.07 seconds
2020-11-05 20:22:40.475459 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 20:22:40.475958 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history__dbt_tmp
2020-11-05 20:22:40.655053 (Thread-1): SQL status: SUCCESS 5 in 0.18 seconds
2020-11-05 20:22:40.672079 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 20:22:40.672580 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history
2020-11-05 20:22:40.811924 (Thread-1): SQL status: SUCCESS 4 in 0.14 seconds
2020-11-05 20:22:40.826941 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 20:22:40.827936 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history
2020-11-05 20:22:40.980932 (Thread-1): SQL status: SUCCESS 4 in 0.15 seconds
2020-11-05 20:22:41.065957 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-05 20:22:41.072968 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 20:22:41.073469 (Thread-1): On model.cko_dbt_am.pageviews_history: BEGIN
2020-11-05 20:22:41.253290 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-11-05 20:22:41.253290 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 20:22:41.254290 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */


        insert into analytics.cko_dbt_am.pageviews_history ("USER_ID", "PAGEVIEW_DATE_HOUR", "COUNT_PAGEVIEWS", "COUNT_DISCTINT_PAGEVIEWS")
        (
            select "USER_ID", "PAGEVIEW_DATE_HOUR", "COUNT_PAGEVIEWS", "COUNT_DISCTINT_PAGEVIEWS"
            from analytics.cko_dbt_am.pageviews_history__dbt_tmp
        );
2020-11-05 20:22:41.991348 (Thread-1): SQL status: SUCCESS 2558 in 0.74 seconds
2020-11-05 20:22:41.995348 (Thread-1): On model.cko_dbt_am.pageviews_history: COMMIT
2020-11-05 20:22:41.996348 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-05 20:22:41.997348 (Thread-1): On model.cko_dbt_am.pageviews_history: COMMIT
2020-11-05 20:22:42.597574 (Thread-1): SQL status: SUCCESS 1 in 0.60 seconds
2020-11-05 20:22:42.620575 (Thread-1): finished collecting timing info
2020-11-05 20:22:42.621575 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-05 20:22:42.856656 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8c19fd5-3011-493f-a7eb-f6f538a6fc08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3DEE00040>]}
2020-11-05 20:22:42.864655 (Thread-1): 21:22:42 | 6 of 6 OK created incremental model cko_dbt_am.pageviews_history..... [SUCCESS 2558 in 5.79s]
2020-11-05 20:22:42.867657 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-05 20:22:42.874169 (MainThread): Acquiring new snowflake connection "master".
2020-11-05 20:22:42.875670 (MainThread): Using snowflake connection "master".
2020-11-05 20:22:42.876171 (MainThread): On master: BEGIN
2020-11-05 20:22:42.876670 (MainThread): Opening a new connection, currently in state closed
2020-11-05 20:22:44.940968 (MainThread): SQL status: SUCCESS 1 in 2.06 seconds
2020-11-05 20:22:44.941969 (MainThread): On master: COMMIT
2020-11-05 20:22:44.942969 (MainThread): Using snowflake connection "master".
2020-11-05 20:22:44.942969 (MainThread): On master: COMMIT
2020-11-05 20:22:45.308075 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2020-11-05 20:22:45.309075 (MainThread): On master: Close
2020-11-05 20:22:45.667670 (MainThread): 21:22:45 | 
2020-11-05 20:22:45.669669 (MainThread): 21:22:45 | Finished running 4 table models, 1 view model, 1 incremental model in 43.06s.
2020-11-05 20:22:45.688670 (MainThread): Connection 'master' was properly closed.
2020-11-05 20:22:45.689672 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-05 20:22:45.690671 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-05 20:22:45.691672 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-05 20:22:45.814195 (MainThread): 
2020-11-05 20:22:45.816196 (MainThread): Completed successfully
2020-11-05 20:22:45.822196 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2020-11-05 20:22:45.828706 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3DEC5CE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3DEC5CA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3DEC5CA30>]}
2020-11-05 20:22:45.830709 (MainThread): Flushing usage events
2020-11-06 07:54:16.986574 (MainThread): Running with dbt=0.18.1
2020-11-06 07:54:17.421721 (MainThread): Loading KWallet
2020-11-06 07:54:17.423721 (MainThread): Loading SecretService
2020-11-06 07:54:17.426720 (MainThread): Loading Windows
2020-11-06 07:54:17.640342 (MainThread): Loading chainer
2020-11-06 07:54:17.641904 (MainThread): Loading macOS
2020-11-06 07:54:18.699341 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-06 07:54:18.702620 (MainThread): Tracking: tracking
2020-11-06 07:54:18.704116 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9ED854A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9ED8447C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9ED844DF0>]}
2020-11-06 07:54:18.759638 (MainThread): Partial parsing not enabled
2020-11-06 07:54:18.765638 (MainThread): Parsing macros\adapters.sql
2020-11-06 07:54:18.874040 (MainThread): Parsing macros\catalog.sql
2020-11-06 07:54:18.880164 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-06 07:54:18.906996 (MainThread): Parsing macros\materializations\merge.sql
2020-11-06 07:54:18.913639 (MainThread): Parsing macros\materializations\table.sql
2020-11-06 07:54:18.951657 (MainThread): Parsing macros\materializations\view.sql
2020-11-06 07:54:19.008660 (MainThread): Parsing macros\core.sql
2020-11-06 07:54:19.030169 (MainThread): Parsing macros\adapters\common.sql
2020-11-06 07:54:19.219840 (MainThread): Parsing macros\etc\datetime.sql
2020-11-06 07:54:19.245389 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-06 07:54:19.248763 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-06 07:54:19.254965 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-06 07:54:19.260971 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-06 07:54:19.267972 (MainThread): Parsing macros\etc\query.sql
2020-11-06 07:54:19.270972 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-06 07:54:19.300979 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-06 07:54:19.343489 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-06 07:54:19.351490 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-06 07:54:19.374999 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-06 07:54:19.439541 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-06 07:54:19.514552 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-06 07:54:19.521029 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-06 07:54:19.570769 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-06 07:54:19.591886 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-06 07:54:19.606205 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-06 07:54:19.623718 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-06 07:54:19.631719 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-06 07:54:19.635719 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-06 07:54:19.640719 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-06 07:54:19.659721 (MainThread): Partial parsing not enabled
2020-11-06 07:54:19.757743 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-06 07:54:19.812257 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-06 07:54:19.840011 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 07:54:19.869556 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 07:54:19.900031 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 07:54:19.927123 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 07:54:19.957035 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 07:54:19.983039 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-06 07:54:20.710819 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-06 07:54:20.895304 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-06 07:54:20.898305 (MainThread): 
2020-11-06 07:54:20.899805 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 07:54:20.923308 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-06 07:54:20.960317 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-06 07:54:20.960317 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-06 07:54:20.961318 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-06 07:54:23.934858 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.97 seconds
2020-11-06 07:54:23.965357 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-06 07:54:24.319712 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 07:54:24.370742 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 07:54:24.371742 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-06 07:54:24.371742 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-06 07:54:27.549532 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 3.18 seconds
2020-11-06 07:54:27.563534 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-06 07:54:27.771566 (MainThread): Using snowflake connection "master".
2020-11-06 07:54:27.772567 (MainThread): On master: BEGIN
2020-11-06 07:54:27.772567 (MainThread): Opening a new connection, currently in state init
2020-11-06 07:54:28.941263 (MainThread): SQL status: SUCCESS 1 in 1.17 seconds
2020-11-06 07:54:28.941263 (MainThread): On master: COMMIT
2020-11-06 07:54:28.942263 (MainThread): Using snowflake connection "master".
2020-11-06 07:54:28.942263 (MainThread): On master: COMMIT
2020-11-06 07:54:29.174299 (MainThread): SQL status: SUCCESS 1 in 0.23 seconds
2020-11-06 07:54:29.174299 (MainThread): On master: Close
2020-11-06 07:54:29.397956 (MainThread): 08:54:29 | Concurrency: 1 threads (target='dev')
2020-11-06 07:54:29.422471 (MainThread): 08:54:29 | 
2020-11-06 07:54:29.487475 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-06 07:54:29.490476 (Thread-1): 08:54:29 | 1 of 6 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-06 07:54:29.491476 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-06 07:54:29.491476 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-06 07:54:29.546492 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-06 07:54:29.548492 (Thread-1): finished collecting timing info
2020-11-06 07:54:29.638517 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-06 07:54:29.642516 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-06 07:54:29.642516 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-06 07:54:29.642516 (Thread-1): Opening a new connection, currently in state init
2020-11-06 07:54:31.691563 (Thread-1): SQL status: SUCCESS 1 in 2.05 seconds
2020-11-06 07:54:31.691563 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-06 07:54:31.691563 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-06 07:54:33.144680 (Thread-1): SQL status: SUCCESS 1 in 1.45 seconds
2020-11-06 07:54:33.148663 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-06 07:54:33.149680 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-06 07:54:33.150680 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-06 07:54:33.340288 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-11-06 07:54:33.427803 (Thread-1): finished collecting timing info
2020-11-06 07:54:33.428803 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-06 07:54:33.665631 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06283bd9-33bd-44a8-98a4-2ccf2c4fe631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EDDC6DF0>]}
2020-11-06 07:54:33.673615 (Thread-1): 08:54:33 | 1 of 6 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 4.17s]
2020-11-06 07:54:33.677643 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-06 07:54:33.679645 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 07:54:33.691646 (Thread-1): 08:54:33 | 2 of 6 START table model cko_dbt_am.pageviews_extract_ephemere....... [RUN]
2020-11-06 07:54:33.695657 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 07:54:33.696657 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 07:54:33.760660 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-06 07:54:33.765662 (Thread-1): finished collecting timing info
2020-11-06 07:54:33.810691 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-06 07:54:33.821692 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 07:54:33.822693 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: BEGIN
2020-11-06 07:54:33.822693 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 07:54:36.725645 (Thread-1): SQL status: SUCCESS 1 in 2.90 seconds
2020-11-06 07:54:36.726642 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 07:54:36.727142 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract_ephemere"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract_ephemere  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
      );
2020-11-06 07:54:39.088008 (Thread-1): SQL status: SUCCESS 1 in 2.36 seconds
2020-11-06 07:54:39.093025 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-06 07:54:39.094026 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 07:54:39.095024 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-06 07:54:39.282616 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-11-06 07:54:39.294600 (Thread-1): finished collecting timing info
2020-11-06 07:54:39.296616 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: Close
2020-11-06 07:54:39.580588 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06283bd9-33bd-44a8-98a4-2ccf2c4fe631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EDEF39D0>]}
2020-11-06 07:54:39.586588 (Thread-1): 08:54:39 | 2 of 6 OK created table model cko_dbt_am.pageviews_extract_ephemere.. [SUCCESS 1 in 5.88s]
2020-11-06 07:54:39.591589 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 07:54:39.593591 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-06 07:54:39.602590 (Thread-1): 08:54:39 | 3 of 6 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-06 07:54:39.609590 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 07:54:39.610591 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-06 07:54:39.677105 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-06 07:54:39.681605 (Thread-1): finished collecting timing info
2020-11-06 07:54:39.726613 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-06 07:54:39.737613 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 07:54:39.738614 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-06 07:54:39.739113 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 07:54:41.804558 (Thread-1): SQL status: SUCCESS 1 in 2.07 seconds
2020-11-06 07:54:41.805556 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 07:54:41.805556 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-06 07:54:46.049404 (Thread-1): SQL status: SUCCESS 1 in 4.24 seconds
2020-11-06 07:54:46.055406 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-06 07:54:46.056404 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 07:54:46.056404 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-06 07:54:46.306990 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2020-11-06 07:54:46.319503 (Thread-1): finished collecting timing info
2020-11-06 07:54:46.321503 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-06 07:54:46.548576 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06283bd9-33bd-44a8-98a4-2ccf2c4fe631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EDDDE820>]}
2020-11-06 07:54:46.555578 (Thread-1): 08:54:46 | 3 of 6 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 6.94s]
2020-11-06 07:54:46.560604 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-06 07:54:46.561578 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-06 07:54:46.569577 (Thread-1): 08:54:46 | 4 of 6 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-06 07:54:46.574577 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 07:54:46.575578 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-06 07:54:46.636607 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-06 07:54:46.640607 (Thread-1): finished collecting timing info
2020-11-06 07:54:46.672608 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-06 07:54:46.680609 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 07:54:46.681608 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-06 07:54:46.682608 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 07:54:48.442821 (Thread-1): SQL status: SUCCESS 1 in 1.76 seconds
2020-11-06 07:54:48.443319 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 07:54:48.443819 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as Customer_postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."CUSTOMER"
      );
2020-11-06 07:54:52.059723 (Thread-1): SQL status: SUCCESS 1 in 3.61 seconds
2020-11-06 07:54:52.064723 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-06 07:54:52.064723 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 07:54:52.065723 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-06 07:54:52.208482 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-06 07:54:52.220997 (Thread-1): finished collecting timing info
2020-11-06 07:54:52.223013 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-06 07:54:52.446559 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06283bd9-33bd-44a8-98a4-2ccf2c4fe631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EDDC48E0>]}
2020-11-06 07:54:52.454560 (Thread-1): 08:54:52 | 4 of 6 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 5.87s]
2020-11-06 07:54:52.457818 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-06 07:54:52.459825 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-06 07:54:52.468833 (Thread-1): 08:54:52 | 5 of 6 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-06 07:54:52.475827 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-06 07:54:52.476827 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-06 07:54:52.550371 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-06 07:54:52.561355 (Thread-1): finished collecting timing info
2020-11-06 07:54:52.732432 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-06 07:54:52.740416 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-06 07:54:52.740416 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-06 07:54:52.741416 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 07:54:54.629077 (Thread-1): SQL status: SUCCESS 1 in 1.89 seconds
2020-11-06 07:54:54.630096 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-06 07:54:54.631077 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-06 07:54:55.576465 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2020-11-06 07:54:55.605969 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-06 07:54:55.606970 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-06 07:54:55.607969 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-06 07:54:55.821250 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-11-06 07:54:55.849255 (Thread-1): finished collecting timing info
2020-11-06 07:54:55.851254 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-06 07:54:56.374820 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06283bd9-33bd-44a8-98a4-2ccf2c4fe631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EDDC4040>]}
2020-11-06 07:54:56.378321 (Thread-1): 08:54:56 | 5 of 6 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 3.90s]
2020-11-06 07:54:56.481403 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-06 07:54:56.481904 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-06 07:54:56.487408 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-06 07:54:56.488403 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-06 07:54:56.520908 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-06 07:54:56.540910 (Thread-1): finished collecting timing info
2020-11-06 07:54:56.542411 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-06 07:54:56.546912 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 07:54:56.547912 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 07:54:56.548411 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 07:54:56.589417 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-06 07:54:56.591417 (Thread-1): finished collecting timing info
2020-11-06 07:54:56.592918 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 07:54:56.594918 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-06 07:54:56.598918 (Thread-1): 08:54:56 | 6 of 6 START incremental model cko_dbt_am.pageviews_history.......... [RUN]
2020-11-06 07:54:56.604918 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 07:54:56.605420 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-06 07:54:56.652427 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-06 07:54:56.672428 (Thread-1): finished collecting timing info
2020-11-06 07:54:56.805448 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-06 07:54:56.815447 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 07:54:56.816447 (Thread-1): On model.cko_dbt_am.pageviews_history: BEGIN
2020-11-06 07:54:56.818447 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 07:54:57.981867 (Thread-1): unclosed <socket.socket fd=1680, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.5.101', 51320), raddr=('168.63.27.166', 443)>
2020-11-06 07:55:00.047720 (Thread-1): SQL status: SUCCESS 1 in 3.23 seconds
2020-11-06 07:55:00.048221 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 07:55:00.048721 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_history  as
      (with __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM analytics.cko_dbt_am.pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."USERS_EXTRACT"

where id in (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_ephemeral as (
-- Use the `ref` function to select from other models



SELECT 
	pageviews.*
	,customer_postcode
FROM  analytics.cko_dbt_am.pageviews_extract_ephemere pageviews
LEFT OUTER JOIN __dbt__CTE__users_extract_Ephemere users  on users.id=pageviews.user_id
)/* Config line */

 
		Select * FROM __dbt__CTE__pageviews_history_ephemeral
      );
2020-11-06 07:55:01.753973 (Thread-1): SQL status: SUCCESS 1 in 1.71 seconds
2020-11-06 07:55:01.755975 (Thread-1): On model.cko_dbt_am.pageviews_history: COMMIT
2020-11-06 07:55:01.756975 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 07:55:01.756975 (Thread-1): On model.cko_dbt_am.pageviews_history: COMMIT
2020-11-06 07:55:01.886893 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2020-11-06 07:55:01.894896 (Thread-1): finished collecting timing info
2020-11-06 07:55:01.894896 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-06 07:55:02.093778 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06283bd9-33bd-44a8-98a4-2ccf2c4fe631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EDF00100>]}
2020-11-06 07:55:02.096795 (Thread-1): 08:55:02 | 6 of 6 OK created incremental model cko_dbt_am.pageviews_history..... [SUCCESS 1 in 5.49s]
2020-11-06 07:55:02.097787 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-06 07:55:02.099779 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 07:55:02.101781 (MainThread): Using snowflake connection "master".
2020-11-06 07:55:02.101781 (MainThread): On master: BEGIN
2020-11-06 07:55:02.102780 (MainThread): Opening a new connection, currently in state closed
2020-11-06 07:55:04.815949 (MainThread): SQL status: SUCCESS 1 in 2.71 seconds
2020-11-06 07:55:04.816950 (MainThread): On master: COMMIT
2020-11-06 07:55:04.816950 (MainThread): Using snowflake connection "master".
2020-11-06 07:55:04.816950 (MainThread): On master: COMMIT
2020-11-06 07:55:05.222534 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2020-11-06 07:55:05.223533 (MainThread): On master: Close
2020-11-06 07:55:05.487072 (MainThread): 08:55:05 | 
2020-11-06 07:55:05.490070 (MainThread): 08:55:05 | Finished running 4 table models, 1 view model, 1 incremental model in 44.59s.
2020-11-06 07:55:05.497072 (MainThread): Connection 'master' was properly closed.
2020-11-06 07:55:05.498071 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-06 07:55:05.499071 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-06 07:55:05.503074 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-06 07:55:05.687603 (MainThread): 
2020-11-06 07:55:05.693103 (MainThread): Completed successfully
2020-11-06 07:55:05.705104 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2020-11-06 07:55:05.712104 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EDF597C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EDF594C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9EDF59F70>]}
2020-11-06 07:55:05.713606 (MainThread): Flushing usage events
2020-11-06 07:57:59.523573 (MainThread): Running with dbt=0.18.1
2020-11-06 07:57:59.960128 (MainThread): Loading KWallet
2020-11-06 07:57:59.965637 (MainThread): Loading SecretService
2020-11-06 07:57:59.967635 (MainThread): Loading Windows
2020-11-06 07:58:00.418993 (MainThread): Loading chainer
2020-11-06 07:58:00.421494 (MainThread): Loading macOS
2020-11-06 07:58:01.954505 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-06 07:58:01.962007 (MainThread): Tracking: tracking
2020-11-06 07:58:01.963506 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6A3059D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6A2F5640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6A2F5D60>]}
2020-11-06 07:58:02.055518 (MainThread): Partial parsing not enabled
2020-11-06 07:58:02.061519 (MainThread): Parsing macros\adapters.sql
2020-11-06 07:58:02.206673 (MainThread): Parsing macros\catalog.sql
2020-11-06 07:58:02.218682 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-06 07:58:02.262685 (MainThread): Parsing macros\materializations\merge.sql
2020-11-06 07:58:02.283689 (MainThread): Parsing macros\materializations\table.sql
2020-11-06 07:58:02.308696 (MainThread): Parsing macros\materializations\view.sql
2020-11-06 07:58:02.331703 (MainThread): Parsing macros\core.sql
2020-11-06 07:58:02.347704 (MainThread): Parsing macros\adapters\common.sql
2020-11-06 07:58:02.543752 (MainThread): Parsing macros\etc\datetime.sql
2020-11-06 07:58:02.601264 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-06 07:58:02.610766 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-06 07:58:02.617230 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-06 07:58:02.624795 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-06 07:58:02.630298 (MainThread): Parsing macros\etc\query.sql
2020-11-06 07:58:02.634359 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-06 07:58:02.660575 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-06 07:58:02.705584 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-06 07:58:02.711629 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-06 07:58:02.732627 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-06 07:58:02.792143 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-06 07:58:02.915165 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-06 07:58:02.923173 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-06 07:58:02.993183 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-06 07:58:03.015185 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-06 07:58:03.045488 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-06 07:58:03.064454 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-06 07:58:03.072962 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-06 07:58:03.077468 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-06 07:58:03.082468 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-06 07:58:03.131470 (MainThread): Partial parsing not enabled
2020-11-06 07:58:03.281515 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-06 07:58:03.350518 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-06 07:58:03.378535 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 07:58:03.404890 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 07:58:03.431892 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 07:58:03.461900 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 07:58:03.492408 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 07:58:03.520410 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-06 07:58:04.230566 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-06 07:58:04.376310 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-06 07:58:04.380543 (MainThread): 
2020-11-06 07:58:04.381543 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 07:58:04.403561 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-06 07:58:04.437359 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-06 07:58:04.438382 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-06 07:58:04.438382 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-06 07:58:05.842035 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.40 seconds
2020-11-06 07:58:05.853042 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-06 07:58:06.081156 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 07:58:06.096675 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 07:58:06.097189 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-06 07:58:06.097189 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-06 07:58:07.940023 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.84 seconds
2020-11-06 07:58:07.978009 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-06 07:58:08.171080 (MainThread): Using snowflake connection "master".
2020-11-06 07:58:08.172098 (MainThread): On master: BEGIN
2020-11-06 07:58:08.172098 (MainThread): Opening a new connection, currently in state init
2020-11-06 07:58:09.650299 (MainThread): SQL status: SUCCESS 1 in 1.48 seconds
2020-11-06 07:58:09.651299 (MainThread): On master: COMMIT
2020-11-06 07:58:09.652300 (MainThread): Using snowflake connection "master".
2020-11-06 07:58:09.653300 (MainThread): On master: COMMIT
2020-11-06 07:58:10.122834 (MainThread): SQL status: SUCCESS 1 in 0.47 seconds
2020-11-06 07:58:10.123834 (MainThread): On master: Close
2020-11-06 07:58:10.309997 (MainThread): 08:58:10 | Concurrency: 1 threads (target='dev')
2020-11-06 07:58:10.311980 (MainThread): 08:58:10 | 
2020-11-06 07:58:10.394495 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-06 07:58:10.403993 (Thread-1): 08:58:10 | 1 of 6 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-06 07:58:10.407997 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-06 07:58:10.409010 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-06 07:58:10.580538 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-06 07:58:10.587039 (Thread-1): finished collecting timing info
2020-11-06 07:58:10.832068 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-06 07:58:10.841071 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-06 07:58:10.841570 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-06 07:58:10.842072 (Thread-1): Opening a new connection, currently in state init
2020-11-06 07:58:12.063224 (Thread-1): SQL status: SUCCESS 1 in 1.22 seconds
2020-11-06 07:58:12.063224 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-06 07:58:12.063724 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-06 07:58:13.082203 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2020-11-06 07:58:13.087204 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-06 07:58:13.088203 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-06 07:58:13.088203 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-06 07:58:13.232072 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-06 07:58:13.315099 (Thread-1): finished collecting timing info
2020-11-06 07:58:13.316098 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-06 07:58:13.528262 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b588d09-7c4b-4e85-8736-84746da15253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6A876700>]}
2020-11-06 07:58:13.535262 (Thread-1): 08:58:13 | 1 of 6 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 3.12s]
2020-11-06 07:58:13.537026 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-06 07:58:13.540036 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 07:58:13.549035 (Thread-1): 08:58:13 | 2 of 6 START table model cko_dbt_am.pageviews_extract_ephemere....... [RUN]
2020-11-06 07:58:13.553048 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 07:58:13.554038 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 07:58:13.609070 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-06 07:58:13.613054 (Thread-1): finished collecting timing info
2020-11-06 07:58:13.644068 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-06 07:58:13.654067 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 07:58:13.654067 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: BEGIN
2020-11-06 07:58:13.655066 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 07:58:15.310612 (Thread-1): SQL status: SUCCESS 1 in 1.66 seconds
2020-11-06 07:58:15.311613 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 07:58:15.311613 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract_ephemere"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract_ephemere  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
      );
2020-11-06 07:58:16.726782 (Thread-1): SQL status: SUCCESS 1 in 1.41 seconds
2020-11-06 07:58:16.732782 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-06 07:58:16.733782 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 07:58:16.734781 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-06 07:58:16.867825 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2020-11-06 07:58:16.881840 (Thread-1): finished collecting timing info
2020-11-06 07:58:16.882838 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: Close
2020-11-06 07:58:17.137394 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b588d09-7c4b-4e85-8736-84746da15253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6A877AF0>]}
2020-11-06 07:58:17.148396 (Thread-1): 08:58:17 | 2 of 6 OK created table model cko_dbt_am.pageviews_extract_ephemere.. [SUCCESS 1 in 3.58s]
2020-11-06 07:58:17.198909 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 07:58:17.200411 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-06 07:58:17.210421 (Thread-1): 08:58:17 | 3 of 6 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-06 07:58:17.214422 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 07:58:17.215422 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-06 07:58:17.314438 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-06 07:58:17.343444 (Thread-1): finished collecting timing info
2020-11-06 07:58:17.385448 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-06 07:58:17.397450 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 07:58:17.398450 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-06 07:58:17.399451 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 07:58:19.225457 (Thread-1): SQL status: SUCCESS 1 in 1.83 seconds
2020-11-06 07:58:19.226455 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 07:58:19.227455 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1000"."ORDERS") pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-06 08:23:06.763177 (MainThread): Running with dbt=0.18.1
2020-11-06 08:23:07.544971 (MainThread): Loading KWallet
2020-11-06 08:23:07.551987 (MainThread): Loading SecretService
2020-11-06 08:23:07.558989 (MainThread): Loading Windows
2020-11-06 08:23:08.162177 (MainThread): Loading chainer
2020-11-06 08:23:08.166179 (MainThread): Loading macOS
2020-11-06 08:23:10.719628 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-06 08:23:10.727453 (MainThread): Tracking: tracking
2020-11-06 08:23:10.728453 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DFC3A39A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DFC3938B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DFC393EE0>]}
2020-11-06 08:23:10.878506 (MainThread): Partial parsing not enabled
2020-11-06 08:23:10.889327 (MainThread): Parsing macros\adapters.sql
2020-11-06 08:23:11.151503 (MainThread): Parsing macros\catalog.sql
2020-11-06 08:23:11.168373 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-06 08:23:11.248156 (MainThread): Parsing macros\materializations\merge.sql
2020-11-06 08:23:11.267166 (MainThread): Parsing macros\materializations\table.sql
2020-11-06 08:23:11.301187 (MainThread): Parsing macros\materializations\view.sql
2020-11-06 08:23:11.354026 (MainThread): Parsing macros\core.sql
2020-11-06 08:23:11.384043 (MainThread): Parsing macros\adapters\common.sql
2020-11-06 08:23:11.790643 (MainThread): Parsing macros\etc\datetime.sql
2020-11-06 08:23:11.899038 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-06 08:23:11.911077 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-06 08:23:11.927087 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-06 08:23:11.952086 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-06 08:23:11.970087 (MainThread): Parsing macros\etc\query.sql
2020-11-06 08:23:11.992089 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-06 08:23:12.125633 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-06 08:23:12.289652 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-06 08:23:12.318624 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-06 08:23:12.391139 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-06 08:23:12.553678 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-06 08:23:12.677701 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-06 08:23:12.685280 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-06 08:23:12.755004 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-06 08:23:12.782024 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-06 08:23:12.802534 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-06 08:23:12.827738 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-06 08:23:12.838758 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-06 08:23:12.844757 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-06 08:23:12.853745 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-06 08:23:12.878759 (MainThread): Partial parsing not enabled
2020-11-06 08:23:13.033311 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-06 08:23:13.111320 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-06 08:23:13.157321 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:23:13.196842 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:23:13.239070 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:23:13.317470 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:23:13.380473 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 08:23:13.460495 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-06 08:23:14.251101 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-06 08:23:14.448625 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-06 08:23:14.451625 (MainThread): 
2020-11-06 08:23:14.452625 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 08:23:14.480629 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-06 08:23:14.519634 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-06 08:23:14.520134 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-06 08:23:14.520134 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-06 08:23:16.462359 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.94 seconds
2020-11-06 08:23:16.507364 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-06 08:23:16.954130 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 08:23:17.068648 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 08:23:17.069647 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-06 08:23:17.070147 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-06 08:23:19.445148 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 2.38 seconds
2020-11-06 08:23:19.459648 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-06 08:23:19.652174 (MainThread): Using snowflake connection "master".
2020-11-06 08:23:19.652674 (MainThread): On master: BEGIN
2020-11-06 08:23:19.652674 (MainThread): Opening a new connection, currently in state init
2020-11-06 08:23:21.229976 (MainThread): SQL status: SUCCESS 1 in 1.58 seconds
2020-11-06 08:23:21.231476 (MainThread): On master: COMMIT
2020-11-06 08:23:21.245478 (MainThread): Using snowflake connection "master".
2020-11-06 08:23:21.260980 (MainThread): On master: COMMIT
2020-11-06 08:23:21.626064 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2020-11-06 08:23:21.628063 (MainThread): On master: Close
2020-11-06 08:23:21.982140 (MainThread): 09:23:21 | Concurrency: 1 threads (target='dev')
2020-11-06 08:23:22.112154 (MainThread): 09:23:22 | 
2020-11-06 08:23:22.224668 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-06 08:23:22.229169 (Thread-1): 09:23:22 | 1 of 6 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-06 08:23:22.233669 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-06 08:23:22.234670 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-06 08:23:22.321681 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-06 08:23:22.324546 (Thread-1): finished collecting timing info
2020-11-06 08:23:22.441076 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-06 08:23:22.445760 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-06 08:23:22.446759 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-06 08:23:22.446759 (Thread-1): Opening a new connection, currently in state init
2020-11-06 08:23:24.051929 (Thread-1): SQL status: SUCCESS 1 in 1.60 seconds
2020-11-06 08:23:24.051929 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-06 08:23:24.052929 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-06 08:23:26.185657 (Thread-1): SQL status: SUCCESS 1 in 2.13 seconds
2020-11-06 08:23:26.193658 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-06 08:23:26.194658 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-06 08:23:26.194658 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-06 08:23:26.348883 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-11-06 08:23:26.433416 (Thread-1): finished collecting timing info
2020-11-06 08:23:26.434915 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-06 08:23:26.652376 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2b5a33-736f-4856-ab47-0b48fe1cd32e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DFC91FC10>]}
2020-11-06 08:23:26.662379 (Thread-1): 09:23:26 | 1 of 6 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 4.42s]
2020-11-06 08:23:26.801400 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-06 08:23:26.802901 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 08:23:26.811903 (Thread-1): 09:23:26 | 2 of 6 START table model cko_dbt_am.pageviews_extract_ephemere....... [RUN]
2020-11-06 08:23:26.883911 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:23:26.884913 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 08:23:26.968921 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-06 08:23:26.989925 (Thread-1): finished collecting timing info
2020-11-06 08:23:27.156947 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-06 08:23:27.175447 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:23:27.178951 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: BEGIN
2020-11-06 08:23:27.179448 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 08:23:29.105377 (Thread-1): SQL status: SUCCESS 1 in 1.93 seconds
2020-11-06 08:23:29.106376 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:23:29.106878 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract_ephemere"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract_ephemere  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
      );
2020-11-06 08:23:32.030451 (Thread-1): SQL status: SUCCESS 1 in 2.92 seconds
2020-11-06 08:23:32.035953 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-06 08:23:32.036952 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:23:32.037452 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-06 08:23:32.421001 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2020-11-06 08:23:32.428501 (Thread-1): finished collecting timing info
2020-11-06 08:23:32.429000 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: Close
2020-11-06 08:23:32.754042 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c2b5a33-736f-4856-ab47-0b48fe1cd32e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DFCA2C880>]}
2020-11-06 08:23:32.756542 (Thread-1): 09:23:32 | 2 of 6 OK created table model cko_dbt_am.pageviews_extract_ephemere.. [SUCCESS 1 in 5.88s]
2020-11-06 08:23:32.783546 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 08:23:32.784546 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-06 08:23:32.787047 (Thread-1): 09:23:32 | 3 of 6 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-06 08:23:32.788546 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:23:32.789048 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-06 08:23:32.807048 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-06 08:23:32.810049 (Thread-1): finished collecting timing info
2020-11-06 08:23:32.821051 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-06 08:23:32.826054 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:23:32.826551 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-06 08:23:32.826551 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 08:23:34.891575 (Thread-1): SQL status: SUCCESS 1 in 2.07 seconds
2020-11-06 08:23:34.892574 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:23:34.893076 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1000"."ORDERS"
    WHERE Year(DATEADD(year,25,O_orderdate))>2019



    ) pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-06 08:35:21.268061 (MainThread): Running with dbt=0.18.1
2020-11-06 08:35:21.608044 (MainThread): Loading KWallet
2020-11-06 08:35:21.611051 (MainThread): Loading SecretService
2020-11-06 08:35:21.613669 (MainThread): Loading Windows
2020-11-06 08:35:21.830538 (MainThread): Loading chainer
2020-11-06 08:35:21.833555 (MainThread): Loading macOS
2020-11-06 08:35:22.750460 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-06 08:35:22.753467 (MainThread): Tracking: tracking
2020-11-06 08:35:22.753467 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD8CE3CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD8CCF8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD8CCFEE0>]}
2020-11-06 08:35:22.809376 (MainThread): Partial parsing not enabled
2020-11-06 08:35:22.813389 (MainThread): Parsing macros\adapters.sql
2020-11-06 08:35:22.894598 (MainThread): Parsing macros\catalog.sql
2020-11-06 08:35:22.900616 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-06 08:35:22.928288 (MainThread): Parsing macros\materializations\merge.sql
2020-11-06 08:35:22.934635 (MainThread): Parsing macros\materializations\table.sql
2020-11-06 08:35:22.947643 (MainThread): Parsing macros\materializations\view.sql
2020-11-06 08:35:22.962266 (MainThread): Parsing macros\core.sql
2020-11-06 08:35:22.973796 (MainThread): Parsing macros\adapters\common.sql
2020-11-06 08:35:23.102490 (MainThread): Parsing macros\etc\datetime.sql
2020-11-06 08:35:23.129494 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-06 08:35:23.133492 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-06 08:35:23.140492 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-06 08:35:23.146492 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-06 08:35:23.151493 (MainThread): Parsing macros\etc\query.sql
2020-11-06 08:35:23.155986 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-06 08:35:23.181871 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-06 08:35:23.221879 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-06 08:35:23.227897 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-06 08:35:23.245892 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-06 08:35:23.308912 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-06 08:35:23.377931 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-06 08:35:23.383932 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-06 08:35:23.431318 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-06 08:35:23.450228 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-06 08:35:23.465255 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-06 08:35:23.482767 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-06 08:35:23.491752 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-06 08:35:23.496752 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-06 08:35:23.501752 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-06 08:35:23.520752 (MainThread): Partial parsing not enabled
2020-11-06 08:35:23.614789 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-06 08:35:23.672837 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-06 08:35:23.700839 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:35:23.728396 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:35:23.755907 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:35:23.796917 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:35:23.830919 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 08:35:23.858943 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-06 08:35:24.470104 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-06 08:35:24.606422 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-06 08:35:24.609421 (MainThread): 
2020-11-06 08:35:24.610427 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 08:35:24.629436 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-06 08:35:24.663539 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-06 08:35:24.663539 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-06 08:35:24.664039 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-06 08:35:27.377234 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.71 seconds
2020-11-06 08:35:27.452742 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-06 08:35:28.305882 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 08:35:28.331653 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 08:35:28.332154 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-06 08:35:28.332653 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-06 08:35:30.274894 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.94 seconds
2020-11-06 08:35:30.321401 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-06 08:35:30.578933 (MainThread): Using snowflake connection "master".
2020-11-06 08:35:30.580433 (MainThread): On master: BEGIN
2020-11-06 08:35:30.580933 (MainThread): Opening a new connection, currently in state init
2020-11-06 08:35:32.045627 (MainThread): SQL status: SUCCESS 1 in 1.46 seconds
2020-11-06 08:35:32.046127 (MainThread): On master: COMMIT
2020-11-06 08:35:32.046127 (MainThread): Using snowflake connection "master".
2020-11-06 08:35:32.046626 (MainThread): On master: COMMIT
2020-11-06 08:35:32.332212 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2020-11-06 08:35:32.332713 (MainThread): On master: Close
2020-11-06 08:35:33.496777 (MainThread): 09:35:33 | Concurrency: 1 threads (target='dev')
2020-11-06 08:35:33.496777 (MainThread): 09:35:33 | 
2020-11-06 08:35:33.519780 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-06 08:35:33.528781 (Thread-1): 09:35:33 | 1 of 6 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-06 08:35:33.530780 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-06 08:35:33.532290 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-06 08:35:33.872367 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-06 08:35:33.884867 (Thread-1): finished collecting timing info
2020-11-06 08:35:34.374429 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-06 08:35:34.382931 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-06 08:35:34.383931 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-06 08:35:34.384432 (Thread-1): Opening a new connection, currently in state init
2020-11-06 08:35:36.426188 (Thread-1): SQL status: SUCCESS 1 in 2.04 seconds
2020-11-06 08:35:36.427188 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-06 08:35:36.428188 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-06 08:35:37.515097 (Thread-1): SQL status: SUCCESS 1 in 1.09 seconds
2020-11-06 08:35:37.521082 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-06 08:35:37.522083 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-06 08:35:37.522083 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-06 08:35:37.711103 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-11-06 08:35:37.796118 (Thread-1): finished collecting timing info
2020-11-06 08:35:37.798132 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-06 08:35:38.027221 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ba2b890-fe08-48b9-a30b-d53db07fdb83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD925AFD0>]}
2020-11-06 08:35:38.034223 (Thread-1): 09:35:38 | 1 of 6 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 4.50s]
2020-11-06 08:35:38.062225 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-06 08:35:38.063224 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 08:35:38.070224 (Thread-1): 09:35:38 | 2 of 6 START table model cko_dbt_am.pageviews_extract_ephemere....... [RUN]
2020-11-06 08:35:38.086236 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:35:38.086737 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 08:35:38.142269 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-06 08:35:38.146251 (Thread-1): finished collecting timing info
2020-11-06 08:35:38.182770 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-06 08:35:38.196270 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:35:38.196270 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: BEGIN
2020-11-06 08:35:38.197281 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 08:35:40.249668 (Thread-1): SQL status: SUCCESS 1 in 2.05 seconds
2020-11-06 08:35:40.250668 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:35:40.250668 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract_ephemere"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract_ephemere  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
      );
2020-11-06 08:35:43.315104 (Thread-1): SQL status: SUCCESS 1 in 3.06 seconds
2020-11-06 08:35:43.320089 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-06 08:35:43.321090 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:35:43.322090 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-06 08:35:43.657682 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2020-11-06 08:35:43.670196 (Thread-1): finished collecting timing info
2020-11-06 08:35:43.671695 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: Close
2020-11-06 08:35:44.412027 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ba2b890-fe08-48b9-a30b-d53db07fdb83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD9368070>]}
2020-11-06 08:35:44.418012 (Thread-1): 09:35:44 | 2 of 6 OK created table model cko_dbt_am.pageviews_extract_ephemere.. [SUCCESS 1 in 6.33s]
2020-11-06 08:35:44.421113 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 08:35:44.422121 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-06 08:35:44.429137 (Thread-1): 09:35:44 | 3 of 6 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-06 08:35:44.435123 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:35:44.436122 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-06 08:35:44.483650 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-06 08:35:44.488650 (Thread-1): finished collecting timing info
2020-11-06 08:35:44.520653 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-06 08:35:44.541652 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:35:44.546652 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-06 08:35:44.546652 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 08:35:46.225514 (Thread-1): SQL status: SUCCESS 1 in 1.68 seconds
2020-11-06 08:35:46.225514 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:35:46.226514 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1000"."ORDERS"
    WHERE  DATEADD(year,25,O_orderdate)>DATEADD(month,-6,current_Date()) and DATEADD(year,25,O_orderdate)<DATEADD(month,1,current_Date())


    ) pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-06 08:36:03.021492 (Thread-1): SQL status: SUCCESS 1 in 16.79 seconds
2020-11-06 08:36:03.026992 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-06 08:36:03.027992 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:36:03.028993 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-06 08:36:03.541056 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2020-11-06 08:36:03.547557 (Thread-1): finished collecting timing info
2020-11-06 08:36:03.548558 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-06 08:36:04.552246 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ba2b890-fe08-48b9-a30b-d53db07fdb83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD91F6550>]}
2020-11-06 08:36:04.556245 (Thread-1): 09:36:04 | 3 of 6 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 20.12s]
2020-11-06 08:36:04.565254 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-06 08:36:04.565753 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-06 08:36:04.569254 (Thread-1): 09:36:04 | 4 of 6 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-06 08:36:04.571254 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 08:36:04.571754 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-06 08:36:04.596758 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-06 08:36:04.599906 (Thread-1): finished collecting timing info
2020-11-06 08:36:04.616411 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-06 08:36:04.621409 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 08:36:04.622909 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-06 08:36:04.623410 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 08:36:07.927067 (Thread-1): SQL status: SUCCESS 1 in 3.30 seconds
2020-11-06 08:36:07.928069 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 08:36:07.928069 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as Customer_postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1000"."CUSTOMER"
      );
2020-11-06 08:36:25.447528 (Thread-1): SQL status: SUCCESS 1 in 17.52 seconds
2020-11-06 08:36:25.450527 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-06 08:36:25.451028 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 08:36:25.451028 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-06 08:36:25.581048 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2020-11-06 08:36:25.586048 (Thread-1): finished collecting timing info
2020-11-06 08:36:25.586048 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-06 08:36:26.099166 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ba2b890-fe08-48b9-a30b-d53db07fdb83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD925A220>]}
2020-11-06 08:36:26.102165 (Thread-1): 09:36:26 | 4 of 6 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 21.53s]
2020-11-06 08:36:26.103166 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-06 08:36:26.104166 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-06 08:36:26.106168 (Thread-1): 09:36:26 | 5 of 6 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-06 08:36:26.108165 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-06 08:36:26.108165 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-06 08:36:26.129167 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-06 08:36:26.134169 (Thread-1): finished collecting timing info
2020-11-06 08:36:26.202192 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-06 08:36:26.207188 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-06 08:36:26.208191 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-06 08:36:26.209190 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 08:36:27.795797 (Thread-1): SQL status: SUCCESS 1 in 1.59 seconds
2020-11-06 08:36:27.796797 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-06 08:36:27.796797 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-06 08:36:28.552110 (Thread-1): SQL status: SUCCESS 1 in 0.76 seconds
2020-11-06 08:36:28.558111 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-06 08:36:28.559111 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-06 08:36:28.560111 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-06 08:36:28.751177 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-11-06 08:36:28.773191 (Thread-1): finished collecting timing info
2020-11-06 08:36:28.775191 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-06 08:36:29.146957 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ba2b890-fe08-48b9-a30b-d53db07fdb83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD93EED00>]}
2020-11-06 08:36:29.154458 (Thread-1): 09:36:29 | 5 of 6 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 3.04s]
2020-11-06 08:36:29.157459 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-06 08:36:29.158459 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-06 08:36:29.161459 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-06 08:36:29.162459 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-06 08:36:29.229966 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-06 08:36:29.237468 (Thread-1): finished collecting timing info
2020-11-06 08:36:29.240968 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-06 08:36:29.244468 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 08:36:29.246470 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:36:29.247470 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 08:36:29.346983 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-06 08:36:29.352482 (Thread-1): finished collecting timing info
2020-11-06 08:36:29.354981 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 08:36:29.358482 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-06 08:36:29.365483 (Thread-1): 09:36:29 | 6 of 6 START incremental model cko_dbt_am.pageviews_history.......... [RUN]
2020-11-06 08:36:29.369990 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:36:29.370986 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-06 08:36:29.475498 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-06 08:36:29.480998 (Thread-1): finished collecting timing info
2020-11-06 08:36:29.703527 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:36:29.704526 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    

      create or replace temporary table analytics.cko_dbt_am.pageviews_history__dbt_tmp  as
      (with __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM analytics.cko_dbt_am.pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."USERS_EXTRACT"

where id in (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_ephemeral as (
-- Use the `ref` function to select from other models



SELECT 
	pageviews.*
	,customer_postcode
FROM  analytics.cko_dbt_am.pageviews_extract_ephemere pageviews
LEFT OUTER JOIN __dbt__CTE__users_extract_Ephemere users  on users.id=pageviews.user_id
)/* Config line */

 
		Select * FROM __dbt__CTE__pageviews_history_ephemeral


	and PAGEVIEW_DATE_HOUR > (select max(PAGEVIEW_DATE_HOUR) from analytics.cko_dbt_am.pageviews_history)

      );
2020-11-06 08:36:29.705026 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 08:36:31.562277 (Thread-1): Snowflake query id: 01981584-00b1-822e-0000-6c5d0001e1fa
2020-11-06 08:36:31.562277 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 29 at position 1 unexpected 'and'.
syntax error line 29 at position 58 unexpected 'from'.
2020-11-06 08:36:31.562277 (Thread-1): finished collecting timing info
2020-11-06 08:36:31.563278 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-06 08:36:31.762286 (Thread-1): Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 1 unexpected 'and'.
  syntax error line 29 at position 58 unexpected 'from'.
  compiled SQL at target\compiled\cko_dbt_am\models\pageviews_history.sql
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 29 at position 1 unexpected 'and'.
syntax error line 29 at position 58 unexpected 'from'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\users\alexandre\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model pageviews_history (models\pageviews_history.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 1 unexpected 'and'.
  syntax error line 29 at position 58 unexpected 'from'.
  compiled SQL at target\compiled\cko_dbt_am\models\pageviews_history.sql
2020-11-06 08:36:31.793984 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ba2b890-fe08-48b9-a30b-d53db07fdb83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD9401370>]}
2020-11-06 08:36:31.799984 (Thread-1): 09:36:31 | 6 of 6 ERROR creating incremental model cko_dbt_am.pageviews_history. [ERROR in 2.42s]
2020-11-06 08:36:31.803968 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-06 08:36:31.809981 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 08:36:31.811483 (MainThread): Using snowflake connection "master".
2020-11-06 08:36:31.811983 (MainThread): On master: BEGIN
2020-11-06 08:36:31.812982 (MainThread): Opening a new connection, currently in state closed
2020-11-06 08:36:33.346383 (MainThread): SQL status: SUCCESS 1 in 1.53 seconds
2020-11-06 08:36:33.347384 (MainThread): On master: COMMIT
2020-11-06 08:36:33.348384 (MainThread): Using snowflake connection "master".
2020-11-06 08:36:33.348384 (MainThread): On master: COMMIT
2020-11-06 08:36:33.673219 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2020-11-06 08:36:33.674218 (MainThread): On master: Close
2020-11-06 08:36:34.464505 (MainThread): 09:36:34 | 
2020-11-06 08:36:34.466505 (MainThread): 09:36:34 | Finished running 4 table models, 1 view model, 1 incremental model in 69.85s.
2020-11-06 08:36:34.473506 (MainThread): Connection 'master' was properly closed.
2020-11-06 08:36:34.474506 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-06 08:36:34.474506 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-06 08:36:34.475507 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-06 08:36:34.622033 (MainThread): 
2020-11-06 08:36:34.624035 (MainThread): Completed with 1 error and 0 warnings:
2020-11-06 08:36:34.649538 (MainThread): 
2020-11-06 08:36:34.657539 (MainThread): Database Error in model pageviews_history (models\pageviews_history.sql)
2020-11-06 08:36:34.672541 (MainThread):   001003 (42000): SQL compilation error:
2020-11-06 08:36:34.677040 (MainThread):   syntax error line 29 at position 1 unexpected 'and'.
2020-11-06 08:36:34.685543 (MainThread):   syntax error line 29 at position 58 unexpected 'from'.
2020-11-06 08:36:34.690043 (MainThread):   compiled SQL at target\compiled\cko_dbt_am\models\pageviews_history.sql
2020-11-06 08:36:34.695042 (MainThread): 
Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
2020-11-06 08:36:34.704545 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD939EFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD939E550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CD939E220>]}
2020-11-06 08:36:34.705545 (MainThread): Flushing usage events
2020-11-06 08:37:50.341461 (MainThread): Running with dbt=0.18.1
2020-11-06 08:37:50.807020 (MainThread): Loading KWallet
2020-11-06 08:37:50.810020 (MainThread): Loading SecretService
2020-11-06 08:37:50.813521 (MainThread): Loading Windows
2020-11-06 08:37:51.111059 (MainThread): Loading chainer
2020-11-06 08:37:51.114059 (MainThread): Loading macOS
2020-11-06 08:37:52.272740 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-06 08:37:52.274722 (MainThread): Tracking: tracking
2020-11-06 08:37:52.274722 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FDF4A3D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FDF494850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FDF494E20>]}
2020-11-06 08:37:52.328739 (MainThread): Partial parsing not enabled
2020-11-06 08:37:52.332739 (MainThread): Parsing macros\adapters.sql
2020-11-06 08:37:52.414783 (MainThread): Parsing macros\catalog.sql
2020-11-06 08:37:52.420284 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-06 08:37:52.446789 (MainThread): Parsing macros\materializations\merge.sql
2020-11-06 08:37:52.451789 (MainThread): Parsing macros\materializations\table.sql
2020-11-06 08:37:52.462789 (MainThread): Parsing macros\materializations\view.sql
2020-11-06 08:37:52.474789 (MainThread): Parsing macros\core.sql
2020-11-06 08:37:52.486791 (MainThread): Parsing macros\adapters\common.sql
2020-11-06 08:37:52.622828 (MainThread): Parsing macros\etc\datetime.sql
2020-11-06 08:37:52.646831 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-06 08:37:52.652829 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-06 08:37:52.661830 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-06 08:37:52.667831 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-06 08:37:52.672832 (MainThread): Parsing macros\etc\query.sql
2020-11-06 08:37:52.676831 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-06 08:37:52.700833 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-06 08:37:52.738848 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-06 08:37:52.743848 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-06 08:37:52.760865 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-06 08:37:52.816391 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-06 08:37:52.883884 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-06 08:37:52.888885 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-06 08:37:52.936918 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-06 08:37:52.953935 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-06 08:37:52.967920 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-06 08:37:52.983937 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-06 08:37:52.990937 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-06 08:37:52.994937 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-06 08:37:52.999921 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-06 08:37:53.024954 (MainThread): Partial parsing not enabled
2020-11-06 08:37:53.125973 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-06 08:37:53.176975 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-06 08:37:53.202978 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:37:53.229995 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:37:53.255012 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:37:53.291014 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:37:53.320037 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 08:37:53.346046 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-06 08:37:53.972628 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-06 08:37:54.162151 (MainThread): Found 8 models, 4 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-06 08:37:54.168152 (MainThread): 
2020-11-06 08:37:54.171653 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 08:37:54.198657 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-06 08:37:54.252163 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-06 08:37:54.252662 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-06 08:37:54.252662 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-06 08:37:55.974380 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.72 seconds
2020-11-06 08:37:56.003382 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-06 08:37:56.358994 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 08:37:56.407007 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 08:37:56.408007 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-06 08:37:56.408507 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-06 08:37:58.446353 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 2.04 seconds
2020-11-06 08:37:58.461353 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-06 08:37:58.675973 (MainThread): Using snowflake connection "master".
2020-11-06 08:37:58.676974 (MainThread): On master: BEGIN
2020-11-06 08:37:58.676974 (MainThread): Opening a new connection, currently in state init
2020-11-06 08:38:00.808343 (MainThread): SQL status: SUCCESS 1 in 2.13 seconds
2020-11-06 08:38:00.809344 (MainThread): On master: COMMIT
2020-11-06 08:38:00.810344 (MainThread): Using snowflake connection "master".
2020-11-06 08:38:00.810844 (MainThread): On master: COMMIT
2020-11-06 08:38:01.148903 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2020-11-06 08:38:01.149903 (MainThread): On master: Close
2020-11-06 08:38:01.359230 (MainThread): 09:38:01 | Concurrency: 1 threads (target='dev')
2020-11-06 08:38:01.360212 (MainThread): 09:38:01 | 
2020-11-06 08:38:01.400216 (Thread-1): Began running node model.cko_dbt_am.my_first_dbt_model
2020-11-06 08:38:01.414225 (Thread-1): 09:38:01 | 1 of 6 START table model cko_dbt_am.my_first_dbt_model............... [RUN]
2020-11-06 08:38:01.418226 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-06 08:38:01.421738 (Thread-1): Compiling model.cko_dbt_am.my_first_dbt_model
2020-11-06 08:38:01.628833 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-06 08:38:01.635833 (Thread-1): finished collecting timing info
2020-11-06 08:38:02.054386 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_first_dbt_model"
2020-11-06 08:38:02.067387 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-06 08:38:02.068387 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: BEGIN
2020-11-06 08:38:02.068887 (Thread-1): Opening a new connection, currently in state init
2020-11-06 08:38:03.389110 (Thread-1): SQL status: SUCCESS 1 in 1.32 seconds
2020-11-06 08:38:03.390110 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-06 08:38:03.390110 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_first_dbt_model"} */


      create or replace transient table analytics.cko_dbt_am.my_first_dbt_model  as
      (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
      );
2020-11-06 08:38:04.518950 (Thread-1): SQL status: SUCCESS 1 in 1.13 seconds
2020-11-06 08:38:04.524953 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-06 08:38:04.525953 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_first_dbt_model".
2020-11-06 08:38:04.526951 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: COMMIT
2020-11-06 08:38:04.667097 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-06 08:38:04.852286 (Thread-1): finished collecting timing info
2020-11-06 08:38:04.853787 (Thread-1): On model.cko_dbt_am.my_first_dbt_model: Close
2020-11-06 08:38:05.134331 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e86d250-c8df-4548-aef5-90f47729fbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FDFA16250>]}
2020-11-06 08:38:05.141332 (Thread-1): 09:38:05 | 1 of 6 OK created table model cko_dbt_am.my_first_dbt_model.......... [SUCCESS 1 in 3.72s]
2020-11-06 08:38:05.143331 (Thread-1): Finished running node model.cko_dbt_am.my_first_dbt_model
2020-11-06 08:38:05.145333 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 08:38:05.151332 (Thread-1): 09:38:05 | 2 of 6 START table model cko_dbt_am.pageviews_extract_ephemere....... [RUN]
2020-11-06 08:38:05.161332 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:38:05.162333 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 08:38:05.221350 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-06 08:38:05.227850 (Thread-1): finished collecting timing info
2020-11-06 08:38:05.264365 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-06 08:38:05.295367 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:38:05.296365 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: BEGIN
2020-11-06 08:38:05.298366 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 08:38:07.265928 (Thread-1): SQL status: SUCCESS 1 in 1.97 seconds
2020-11-06 08:38:07.266929 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:38:07.267930 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract_ephemere"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract_ephemere  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
      );
2020-11-06 08:38:13.337017 (Thread-1): SQL status: SUCCESS 1 in 6.07 seconds
2020-11-06 08:38:13.343019 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-06 08:38:13.345019 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:38:13.346020 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-06 08:38:13.541155 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-11-06 08:38:13.554156 (Thread-1): finished collecting timing info
2020-11-06 08:38:13.556156 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: Close
2020-11-06 08:38:13.908880 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e86d250-c8df-4548-aef5-90f47729fbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FDFB27E20>]}
2020-11-06 08:38:13.915881 (Thread-1): 09:38:13 | 2 of 6 OK created table model cko_dbt_am.pageviews_extract_ephemere.. [SUCCESS 1 in 8.75s]
2020-11-06 08:38:13.918897 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 08:38:13.921880 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-06 08:38:13.927880 (Thread-1): 09:38:13 | 3 of 6 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-06 08:38:13.930882 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:38:13.931881 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-06 08:38:13.978917 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-06 08:38:13.981917 (Thread-1): finished collecting timing info
2020-11-06 08:38:14.014921 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-06 08:38:14.056432 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:38:14.056932 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-06 08:38:14.057433 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 08:38:16.180555 (Thread-1): SQL status: SUCCESS 1 in 2.12 seconds
2020-11-06 08:38:16.180555 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:38:16.181555 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        O_CustKEY as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1000"."ORDERS"
    WHERE  DATEADD(year,25,O_orderdate)>DATEADD(month,-1,current_Date()) and DATEADD(year,25,O_orderdate)<DATEADD(month,1,current_Date())


    ) pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-06 08:38:25.489777 (Thread-1): SQL status: SUCCESS 1 in 9.31 seconds
2020-11-06 08:38:25.494276 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-06 08:38:25.495277 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:38:25.495778 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-06 08:38:25.644297 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-11-06 08:38:25.656299 (Thread-1): finished collecting timing info
2020-11-06 08:38:25.657799 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-06 08:38:25.998296 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e86d250-c8df-4548-aef5-90f47729fbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FDFB27550>]}
2020-11-06 08:38:26.005299 (Thread-1): 09:38:26 | 3 of 6 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 12.07s]
2020-11-06 08:38:26.313837 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-06 08:38:26.314337 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-06 08:38:26.319337 (Thread-1): 09:38:26 | 4 of 6 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-06 08:38:26.358842 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 08:38:26.359343 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-06 08:38:26.382845 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-06 08:38:26.384346 (Thread-1): finished collecting timing info
2020-11-06 08:38:26.420849 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-06 08:38:26.423849 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 08:38:26.424349 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-06 08:38:26.424850 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 08:38:27.993049 (Thread-1): SQL status: SUCCESS 1 in 1.57 seconds
2020-11-06 08:38:27.993049 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 08:38:27.993550 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as Customer_postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1000"."CUSTOMER"
      );
2020-11-06 08:38:38.605725 (Thread-1): SQL status: SUCCESS 1 in 10.61 seconds
2020-11-06 08:38:38.610726 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-06 08:38:38.611726 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 08:38:38.612726 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-06 08:38:38.785785 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-11-06 08:38:38.798782 (Thread-1): finished collecting timing info
2020-11-06 08:38:38.799786 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-06 08:38:39.051368 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e86d250-c8df-4548-aef5-90f47729fbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FDFB235B0>]}
2020-11-06 08:38:39.058369 (Thread-1): 09:38:39 | 4 of 6 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 12.69s]
2020-11-06 08:38:39.089883 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-06 08:38:39.091885 (Thread-1): Began running node model.cko_dbt_am.my_second_dbt_model
2020-11-06 08:38:39.100887 (Thread-1): 09:38:39 | 5 of 6 START view model cko_dbt_am.my_second_dbt_model............... [RUN]
2020-11-06 08:38:39.103885 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-06 08:38:39.104887 (Thread-1): Compiling model.cko_dbt_am.my_second_dbt_model
2020-11-06 08:38:39.169902 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-06 08:38:39.174402 (Thread-1): finished collecting timing info
2020-11-06 08:38:39.341425 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.my_second_dbt_model"
2020-11-06 08:38:39.348426 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-06 08:38:39.349426 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: BEGIN
2020-11-06 08:38:39.349927 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 08:38:40.665867 (Thread-1): SQL status: SUCCESS 1 in 1.32 seconds
2020-11-06 08:38:40.666867 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-06 08:38:40.667385 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.my_second_dbt_model"} */

  create or replace  view analytics.cko_dbt_am.my_second_dbt_model  as (
    -- Use the `ref` function to select from other models

select *
from analytics.cko_dbt_am.my_first_dbt_model
where id = 1
  );
2020-11-06 08:38:41.108559 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2020-11-06 08:38:41.113558 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-06 08:38:41.114559 (Thread-1): Using snowflake connection "model.cko_dbt_am.my_second_dbt_model".
2020-11-06 08:38:41.114559 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: COMMIT
2020-11-06 08:38:41.280758 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-11-06 08:38:41.302758 (Thread-1): finished collecting timing info
2020-11-06 08:38:41.304759 (Thread-1): On model.cko_dbt_am.my_second_dbt_model: Close
2020-11-06 08:38:41.492778 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e86d250-c8df-4548-aef5-90f47729fbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FDFBBCD60>]}
2020-11-06 08:38:41.499778 (Thread-1): 09:38:41 | 5 of 6 OK created view model cko_dbt_am.my_second_dbt_model.......... [SUCCESS 1 in 2.39s]
2020-11-06 08:38:41.510780 (Thread-1): Finished running node model.cko_dbt_am.my_second_dbt_model
2020-11-06 08:38:41.511780 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-06 08:38:41.513781 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-06 08:38:41.514780 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-06 08:38:41.595799 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-06 08:38:41.604801 (Thread-1): finished collecting timing info
2020-11-06 08:38:41.607301 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-06 08:38:41.610300 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 08:38:41.611801 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:38:41.612801 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 08:38:41.698311 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-06 08:38:41.701811 (Thread-1): finished collecting timing info
2020-11-06 08:38:41.704812 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 08:38:41.706812 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-06 08:38:41.714314 (Thread-1): 09:38:41 | 6 of 6 START incremental model cko_dbt_am.pageviews_history.......... [RUN]
2020-11-06 08:38:41.724814 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:38:41.725815 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-06 08:38:41.905839 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-06 08:38:41.910839 (Thread-1): finished collecting timing info
2020-11-06 08:38:42.410902 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:38:42.411402 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    

      create or replace temporary table analytics.cko_dbt_am.pageviews_history__dbt_tmp  as
      (with __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM analytics.cko_dbt_am.pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."USERS_EXTRACT"

where id in (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_ephemeral as (
-- Use the `ref` function to select from other models



SELECT 
	pageviews.*
	,customer_postcode
FROM  analytics.cko_dbt_am.pageviews_extract_ephemere pageviews
LEFT OUTER JOIN __dbt__CTE__users_extract_Ephemere users  on users.id=pageviews.user_id
)/* Config line */

 
		Select * FROM __dbt__CTE__pageviews_history_ephemeral


	WHERE PAGEVIEW_DATE_HOUR > (select max(PAGEVIEW_DATE_HOUR) from analytics.cko_dbt_am.pageviews_history)

      );
2020-11-06 08:38:42.411903 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 08:38:56.125806 (Thread-1): SQL status: SUCCESS 1 in 13.71 seconds
2020-11-06 08:38:56.184342 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:38:56.185344 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history__dbt_tmp
2020-11-06 08:38:56.422079 (Thread-1): SQL status: SUCCESS 5 in 0.24 seconds
2020-11-06 08:38:56.440096 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:38:56.440096 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history
2020-11-06 08:38:56.795964 (Thread-1): SQL status: SUCCESS 5 in 0.35 seconds
2020-11-06 08:38:56.811982 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:38:56.812982 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history
2020-11-06 08:38:57.001781 (Thread-1): SQL status: SUCCESS 5 in 0.19 seconds
2020-11-06 08:38:57.099294 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-06 08:38:57.107294 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:38:57.107294 (Thread-1): On model.cko_dbt_am.pageviews_history: BEGIN
2020-11-06 08:38:57.271472 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2020-11-06 08:38:57.272499 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:38:57.273499 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */


        insert into analytics.cko_dbt_am.pageviews_history ("USER_ID", "PAGEVIEW_DATE_HOUR", "COUNT_PAGEVIEWS", "COUNT_DISCTINT_PAGEVIEWS", "CUSTOMER_POSTCODE")
        (
            select "USER_ID", "PAGEVIEW_DATE_HOUR", "COUNT_PAGEVIEWS", "COUNT_DISCTINT_PAGEVIEWS", "CUSTOMER_POSTCODE"
            from analytics.cko_dbt_am.pageviews_history__dbt_tmp
        );
2020-11-06 08:39:01.558928 (Thread-1): SQL status: SUCCESS 300133 in 4.29 seconds
2020-11-06 08:39:01.564928 (Thread-1): On model.cko_dbt_am.pageviews_history: COMMIT
2020-11-06 08:39:01.565928 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:39:01.565928 (Thread-1): On model.cko_dbt_am.pageviews_history: COMMIT
2020-11-06 08:39:01.971423 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2020-11-06 08:39:01.993425 (Thread-1): finished collecting timing info
2020-11-06 08:39:01.995425 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-06 08:39:02.256438 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e86d250-c8df-4548-aef5-90f47729fbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FDFA19D00>]}
2020-11-06 08:39:02.263421 (Thread-1): 09:39:02 | 6 of 6 OK created incremental model cko_dbt_am.pageviews_history..... [SUCCESS 300133 in 20.53s]
2020-11-06 08:39:02.266422 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-06 08:39:02.271440 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 08:39:02.273439 (MainThread): Using snowflake connection "master".
2020-11-06 08:39:02.273439 (MainThread): On master: BEGIN
2020-11-06 08:39:02.274438 (MainThread): Opening a new connection, currently in state closed
2020-11-06 08:39:04.137888 (MainThread): SQL status: SUCCESS 1 in 1.86 seconds
2020-11-06 08:39:04.138885 (MainThread): On master: COMMIT
2020-11-06 08:39:04.139397 (MainThread): Using snowflake connection "master".
2020-11-06 08:39:04.139896 (MainThread): On master: COMMIT
2020-11-06 08:39:04.410981 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2020-11-06 08:39:04.411983 (MainThread): On master: Close
2020-11-06 08:39:04.636266 (MainThread): 09:39:04 | 
2020-11-06 08:39:04.639777 (MainThread): 09:39:04 | Finished running 4 table models, 1 view model, 1 incremental model in 70.46s.
2020-11-06 08:39:04.651279 (MainThread): Connection 'master' was properly closed.
2020-11-06 08:39:04.651779 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-06 08:39:04.652278 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-06 08:39:04.652780 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-06 08:39:04.784296 (MainThread): 
2020-11-06 08:39:04.808300 (MainThread): Completed successfully
2020-11-06 08:39:04.824302 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2020-11-06 08:39:04.826804 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FDFB5F7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FDFB8C2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FDFB8C9D0>]}
2020-11-06 08:39:04.828304 (MainThread): Flushing usage events
2020-11-06 08:44:30.413920 (MainThread): Running with dbt=0.18.1
2020-11-06 08:44:31.235989 (MainThread): Loading KWallet
2020-11-06 08:44:31.244490 (MainThread): Loading SecretService
2020-11-06 08:44:31.251492 (MainThread): Loading Windows
2020-11-06 08:44:31.887403 (MainThread): Loading chainer
2020-11-06 08:44:31.890904 (MainThread): Loading macOS
2020-11-06 08:44:34.288484 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-06 08:44:34.291485 (MainThread): Tracking: tracking
2020-11-06 08:44:34.291985 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C051685C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0516767F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C051676E20>]}
2020-11-06 08:44:34.387497 (MainThread): Partial parsing not enabled
2020-11-06 08:44:34.392997 (MainThread): Parsing macros\adapters.sql
2020-11-06 08:44:34.522014 (MainThread): Parsing macros\catalog.sql
2020-11-06 08:44:34.532015 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-06 08:44:34.572577 (MainThread): Parsing macros\materializations\merge.sql
2020-11-06 08:44:34.581078 (MainThread): Parsing macros\materializations\table.sql
2020-11-06 08:44:34.602080 (MainThread): Parsing macros\materializations\view.sql
2020-11-06 08:44:34.620083 (MainThread): Parsing macros\core.sql
2020-11-06 08:44:34.638585 (MainThread): Parsing macros\adapters\common.sql
2020-11-06 08:44:34.795605 (MainThread): Parsing macros\etc\datetime.sql
2020-11-06 08:44:34.826109 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-06 08:44:34.829609 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-06 08:44:34.835110 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-06 08:44:34.842110 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-06 08:44:34.846611 (MainThread): Parsing macros\etc\query.sql
2020-11-06 08:44:34.850112 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-06 08:44:34.878616 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-06 08:44:34.924621 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-06 08:44:34.932123 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-06 08:44:34.953125 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-06 08:44:35.029634 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-06 08:44:35.142149 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-06 08:44:35.148150 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-06 08:44:35.198656 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-06 08:44:35.221659 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-06 08:44:35.237161 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-06 08:44:35.255163 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-06 08:44:35.263164 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-06 08:44:35.268165 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-06 08:44:35.274666 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-06 08:44:35.314671 (MainThread): Partial parsing not enabled
2020-11-06 08:44:35.446493 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:44:35.505999 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:44:35.549505 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:44:35.585509 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-06 08:44:36.084087 (MainThread): WARNING: Found documentation for resource "my_first_dbt_model" which was not found or is disabled
2020-11-06 08:44:36.085088 (MainThread): WARNING: Found documentation for resource "my_second_dbt_model" which was not found or is disabled
2020-11-06 08:44:36.085088 (MainThread): [WARNING]: Test 'test.cko_dbt_am.unique_my_first_dbt_model_id' (models\schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2020-11-06 08:44:36.087087 (MainThread): [WARNING]: Test 'test.cko_dbt_am.not_null_my_first_dbt_model_id' (models\schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2020-11-06 08:44:36.088087 (MainThread): [WARNING]: Test 'test.cko_dbt_am.unique_my_second_dbt_model_id' (models\schema.yml) depends on a node named 'my_second_dbt_model' which was not found
2020-11-06 08:44:36.091087 (MainThread): [WARNING]: Test 'test.cko_dbt_am.not_null_my_second_dbt_model_id' (models\schema.yml) depends on a node named 'my_second_dbt_model' which was not found
2020-11-06 08:44:36.190104 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-06 08:44:36.307714 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-06 08:44:36.312714 (MainThread): 
2020-11-06 08:44:36.314715 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 08:44:36.326715 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-06 08:44:36.364234 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-06 08:44:36.364234 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-06 08:44:36.364234 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-06 08:44:37.757594 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.39 seconds
2020-11-06 08:44:37.768095 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-06 08:44:38.127640 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 08:44:38.145142 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 08:44:38.145642 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-06 08:44:38.145642 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-06 08:44:39.384380 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.24 seconds
2020-11-06 08:44:39.433409 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-06 08:44:39.688335 (MainThread): Using snowflake connection "master".
2020-11-06 08:44:39.689353 (MainThread): On master: BEGIN
2020-11-06 08:44:39.689353 (MainThread): Opening a new connection, currently in state init
2020-11-06 08:44:41.596200 (MainThread): SQL status: SUCCESS 1 in 1.91 seconds
2020-11-06 08:44:41.597200 (MainThread): On master: COMMIT
2020-11-06 08:44:41.598200 (MainThread): Using snowflake connection "master".
2020-11-06 08:44:41.599200 (MainThread): On master: COMMIT
2020-11-06 08:44:42.147196 (MainThread): SQL status: SUCCESS 1 in 0.55 seconds
2020-11-06 08:44:42.148196 (MainThread): On master: Close
2020-11-06 08:44:42.441612 (MainThread): 09:44:42 | Concurrency: 1 threads (target='dev')
2020-11-06 08:44:42.443624 (MainThread): 09:44:42 | 
2020-11-06 08:44:42.478863 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 08:44:42.485863 (Thread-1): 09:44:42 | 1 of 2 START table model cko_dbt_am.pageviews_extract_ephemere....... [RUN]
2020-11-06 08:44:42.495866 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:44:42.497864 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 08:44:42.639896 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-06 08:44:42.648908 (Thread-1): finished collecting timing info
2020-11-06 08:44:42.867987 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-06 08:44:42.877004 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:44:42.878003 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: BEGIN
2020-11-06 08:44:42.878003 (Thread-1): Opening a new connection, currently in state init
2020-11-06 08:44:44.519895 (Thread-1): SQL status: SUCCESS 1 in 1.64 seconds
2020-11-06 08:44:44.520912 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:44:44.521911 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract_ephemere"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract_ephemere  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
      );
2020-11-06 08:44:47.085744 (Thread-1): SQL status: SUCCESS 1 in 2.56 seconds
2020-11-06 08:44:47.091744 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-06 08:44:47.092745 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:44:47.092745 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-06 08:44:47.274253 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-11-06 08:44:47.360794 (Thread-1): finished collecting timing info
2020-11-06 08:44:47.362811 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: Close
2020-11-06 08:44:47.607141 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45a8f8c5-17f4-4f12-b9d3-7e461ba9fc43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C051806460>]}
2020-11-06 08:44:47.613140 (Thread-1): 09:44:47 | 1 of 2 OK created table model cko_dbt_am.pageviews_extract_ephemere.. [SUCCESS 1 in 5.12s]
2020-11-06 08:44:47.616088 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 08:44:47.619097 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-06 08:44:47.621097 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-06 08:44:47.622101 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-06 08:44:47.683622 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-06 08:44:47.688622 (Thread-1): finished collecting timing info
2020-11-06 08:44:47.690623 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-06 08:44:47.692621 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 08:44:47.694622 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:44:47.695623 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 08:44:47.762156 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-06 08:44:47.765139 (Thread-1): finished collecting timing info
2020-11-06 08:44:47.767640 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 08:44:47.769640 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-06 08:44:47.776141 (Thread-1): 09:44:47 | 2 of 2 START incremental model cko_dbt_am.pageviews_history.......... [RUN]
2020-11-06 08:44:47.779143 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:44:47.780643 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-06 08:44:47.873681 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-06 08:44:47.877683 (Thread-1): finished collecting timing info
2020-11-06 08:44:48.092708 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:44:48.093708 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    

      create or replace temporary table analytics.cko_dbt_am.pageviews_history__dbt_tmp  as
      (with __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM analytics.cko_dbt_am.pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."USERS_EXTRACT"

where id in (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_ephemeral as (
-- Use the `ref` function to select from other models



SELECT 
	pageviews.*
	,customer_postcode
FROM  analytics.cko_dbt_am.pageviews_extract_ephemere pageviews
LEFT OUTER JOIN __dbt__CTE__users_extract_Ephemere users  on users.id=pageviews.user_id
)/* Config line */

 
		Select * FROM __dbt__CTE__pageviews_history_ephemeral


	WHERE PAGEVIEW_DATE_HOUR > (select max(PAGEVIEW_DATE_HOUR) from analytics.cko_dbt_am.pageviews_history)

      );
2020-11-06 08:44:48.094208 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 08:44:51.216605 (Thread-1): SQL status: SUCCESS 1 in 3.12 seconds
2020-11-06 08:44:51.238608 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:44:51.239606 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history__dbt_tmp
2020-11-06 08:44:51.424833 (Thread-1): SQL status: SUCCESS 5 in 0.19 seconds
2020-11-06 08:44:51.430833 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:44:51.431833 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history
2020-11-06 08:44:51.585893 (Thread-1): SQL status: SUCCESS 5 in 0.15 seconds
2020-11-06 08:44:51.591894 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:44:51.592393 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history
2020-11-06 08:44:51.749434 (Thread-1): SQL status: SUCCESS 5 in 0.16 seconds
2020-11-06 08:44:51.781436 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-06 08:44:51.783444 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:44:51.783945 (Thread-1): On model.cko_dbt_am.pageviews_history: BEGIN
2020-11-06 08:44:51.996945 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2020-11-06 08:44:51.997454 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:44:51.997454 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */


        insert into analytics.cko_dbt_am.pageviews_history ("USER_ID", "PAGEVIEW_DATE_HOUR", "COUNT_PAGEVIEWS", "COUNT_DISCTINT_PAGEVIEWS", "CUSTOMER_POSTCODE")
        (
            select "USER_ID", "PAGEVIEW_DATE_HOUR", "COUNT_PAGEVIEWS", "COUNT_DISCTINT_PAGEVIEWS", "CUSTOMER_POSTCODE"
            from analytics.cko_dbt_am.pageviews_history__dbt_tmp
        );
2020-11-06 08:44:52.430693 (Thread-1): SQL status: SUCCESS 0 in 0.43 seconds
2020-11-06 08:44:52.438196 (Thread-1): On model.cko_dbt_am.pageviews_history: COMMIT
2020-11-06 08:44:52.439195 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:44:52.439694 (Thread-1): On model.cko_dbt_am.pageviews_history: COMMIT
2020-11-06 08:44:52.720231 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2020-11-06 08:44:52.743235 (Thread-1): finished collecting timing info
2020-11-06 08:44:52.745234 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-06 08:44:53.027770 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45a8f8c5-17f4-4f12-b9d3-7e461ba9fc43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C051C543A0>]}
2020-11-06 08:44:53.035771 (Thread-1): 09:44:53 | 2 of 2 OK created incremental model cko_dbt_am.pageviews_history..... [SUCCESS 0 in 5.25s]
2020-11-06 08:44:53.128783 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-06 08:44:53.136283 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 08:44:53.137783 (MainThread): Using snowflake connection "master".
2020-11-06 08:44:53.138783 (MainThread): On master: BEGIN
2020-11-06 08:44:53.139785 (MainThread): Opening a new connection, currently in state closed
2020-11-06 08:44:54.839068 (MainThread): SQL status: SUCCESS 1 in 1.70 seconds
2020-11-06 08:44:54.839068 (MainThread): On master: COMMIT
2020-11-06 08:44:54.839068 (MainThread): Using snowflake connection "master".
2020-11-06 08:44:54.840067 (MainThread): On master: COMMIT
2020-11-06 08:44:55.065024 (MainThread): SQL status: SUCCESS 1 in 0.22 seconds
2020-11-06 08:44:55.066023 (MainThread): On master: Close
2020-11-06 08:44:55.646759 (MainThread): 09:44:55 | 
2020-11-06 08:44:55.650259 (MainThread): 09:44:55 | Finished running 1 table model, 1 incremental model in 19.33s.
2020-11-06 08:44:55.658260 (MainThread): Connection 'master' was properly closed.
2020-11-06 08:44:55.659261 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-06 08:44:55.659760 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-06 08:44:55.660259 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-06 08:44:55.717275 (MainThread): 
2020-11-06 08:44:55.723274 (MainThread): Completed successfully
2020-11-06 08:44:55.734275 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-11-06 08:44:55.742276 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C051B48D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C051C96970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C051C965E0>]}
2020-11-06 08:44:55.744278 (MainThread): Flushing usage events
2020-11-06 08:46:22.377600 (MainThread): Running with dbt=0.18.1
2020-11-06 08:46:22.877806 (MainThread): Loading KWallet
2020-11-06 08:46:22.884822 (MainThread): Loading SecretService
2020-11-06 08:46:22.890824 (MainThread): Loading Windows
2020-11-06 08:46:23.459520 (MainThread): Loading chainer
2020-11-06 08:46:23.463019 (MainThread): Loading macOS
2020-11-06 08:46:25.829860 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-06 08:46:25.834860 (MainThread): Tracking: tracking
2020-11-06 08:46:25.835360 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260C1D24C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260C1D0F5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260C1D0FE20>]}
2020-11-06 08:46:26.008881 (MainThread): Partial parsing not enabled
2020-11-06 08:46:26.019883 (MainThread): Parsing macros\adapters.sql
2020-11-06 08:46:26.497443 (MainThread): Parsing macros\catalog.sql
2020-11-06 08:46:26.509944 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-06 08:46:26.563451 (MainThread): Parsing macros\materializations\merge.sql
2020-11-06 08:46:26.575954 (MainThread): Parsing macros\materializations\table.sql
2020-11-06 08:46:26.598455 (MainThread): Parsing macros\materializations\view.sql
2020-11-06 08:46:26.621958 (MainThread): Parsing macros\core.sql
2020-11-06 08:46:26.650462 (MainThread): Parsing macros\adapters\common.sql
2020-11-06 08:46:26.861989 (MainThread): Parsing macros\etc\datetime.sql
2020-11-06 08:46:26.913996 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-06 08:46:26.918496 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-06 08:46:26.928997 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-06 08:46:26.944499 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-06 08:46:26.953500 (MainThread): Parsing macros\etc\query.sql
2020-11-06 08:46:26.963002 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-06 08:46:27.015508 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-06 08:46:27.122021 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-06 08:46:27.136523 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-06 08:46:27.161026 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-06 08:46:27.230035 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-06 08:46:27.319547 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-06 08:46:27.327047 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-06 08:46:27.395557 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-06 08:46:27.417559 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-06 08:46:27.438563 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-06 08:46:27.462064 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-06 08:46:27.471066 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-06 08:46:27.476567 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-06 08:46:27.482567 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-06 08:46:27.507070 (MainThread): Partial parsing not enabled
2020-11-06 08:46:27.613084 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:46:27.669591 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:46:27.712596 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:46:27.747100 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-06 08:46:28.279672 (MainThread): WARNING: Found documentation for resource "my_first_dbt_model" which was not found or is disabled
2020-11-06 08:46:28.283673 (MainThread): WARNING: Found documentation for resource "my_second_dbt_model" which was not found or is disabled
2020-11-06 08:46:28.283673 (MainThread): [WARNING]: Test 'test.cko_dbt_am.unique_my_first_dbt_model_id' (models\schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2020-11-06 08:46:28.291672 (MainThread): [WARNING]: Test 'test.cko_dbt_am.not_null_my_first_dbt_model_id' (models\schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2020-11-06 08:46:28.297673 (MainThread): [WARNING]: Test 'test.cko_dbt_am.unique_my_second_dbt_model_id' (models\schema.yml) depends on a node named 'my_second_dbt_model' which was not found
2020-11-06 08:46:28.299673 (MainThread): [WARNING]: Test 'test.cko_dbt_am.not_null_my_second_dbt_model_id' (models\schema.yml) depends on a node named 'my_second_dbt_model' which was not found
2020-11-06 08:46:28.429208 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-06 08:46:28.564668 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-06 08:46:28.568670 (MainThread): 
2020-11-06 08:46:28.570668 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 08:46:28.588668 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-06 08:46:28.627196 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-06 08:46:28.627695 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-06 08:46:28.627695 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-06 08:46:30.867587 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.24 seconds
2020-11-06 08:46:30.897587 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-06 08:46:31.240747 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 08:46:31.294754 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 08:46:31.295253 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-06 08:46:31.296254 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-06 08:46:32.466342 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 7 in 1.17 seconds
2020-11-06 08:46:32.504328 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-06 08:46:32.782305 (MainThread): Using snowflake connection "master".
2020-11-06 08:46:32.783306 (MainThread): On master: BEGIN
2020-11-06 08:46:32.783306 (MainThread): Opening a new connection, currently in state init
2020-11-06 08:46:34.991711 (MainThread): SQL status: SUCCESS 1 in 2.21 seconds
2020-11-06 08:46:34.992711 (MainThread): On master: COMMIT
2020-11-06 08:46:34.993711 (MainThread): Using snowflake connection "master".
2020-11-06 08:46:34.994695 (MainThread): On master: COMMIT
2020-11-06 08:46:35.258944 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2020-11-06 08:46:35.259944 (MainThread): On master: Close
2020-11-06 08:46:35.481851 (MainThread): 09:46:35 | Concurrency: 1 threads (target='dev')
2020-11-06 08:46:35.483836 (MainThread): 09:46:35 | 
2020-11-06 08:46:35.515839 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 08:46:35.522839 (Thread-1): 09:46:35 | 1 of 3 START table model cko_dbt_am.pageviews_extract_ephemere....... [RUN]
2020-11-06 08:46:35.524841 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:46:35.526839 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 08:46:35.645395 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-06 08:46:35.649395 (Thread-1): finished collecting timing info
2020-11-06 08:46:35.872457 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-06 08:46:35.880955 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:46:35.881955 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: BEGIN
2020-11-06 08:46:35.882456 (Thread-1): Opening a new connection, currently in state init
2020-11-06 08:46:37.788710 (Thread-1): SQL status: SUCCESS 1 in 1.91 seconds
2020-11-06 08:46:37.789710 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:46:37.789710 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract_ephemere"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract_ephemere  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
      );
2020-11-06 08:46:40.211380 (Thread-1): SQL status: SUCCESS 1 in 2.42 seconds
2020-11-06 08:46:40.216380 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-06 08:46:40.217381 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:46:40.218380 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-06 08:46:40.367171 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-11-06 08:46:40.445686 (Thread-1): finished collecting timing info
2020-11-06 08:46:40.446687 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: Close
2020-11-06 08:46:40.681835 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd631a93b-f16f-4b3d-8862-db52025ff130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260C21E7AC0>]}
2020-11-06 08:46:40.688838 (Thread-1): 09:46:40 | 1 of 3 OK created table model cko_dbt_am.pageviews_extract_ephemere.. [SUCCESS 1 in 5.16s]
2020-11-06 08:46:40.691837 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 08:46:40.694839 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-06 08:46:40.696839 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-06 08:46:40.697838 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-06 08:46:40.756382 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-06 08:46:40.759868 (Thread-1): finished collecting timing info
2020-11-06 08:46:40.762367 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-06 08:46:40.764868 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 08:46:40.771369 (Thread-1): 09:46:40 | 2 of 3 START table model cko_dbt_am.pageviews_history_ephemeral...... [RUN]
2020-11-06 08:46:40.773880 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:46:40.775881 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 08:46:40.846901 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-06 08:46:40.850886 (Thread-1): finished collecting timing info
2020-11-06 08:46:40.875911 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-06 08:46:40.886910 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:46:40.887912 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: BEGIN
2020-11-06 08:46:40.887912 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 08:46:43.080665 (Thread-1): SQL status: SUCCESS 1 in 2.19 seconds
2020-11-06 08:46:43.080665 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:46:43.081666 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history_ephemeral"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_history_ephemeral  as
      (with __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM analytics.cko_dbt_am.pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."USERS_EXTRACT"

where id in (SELECT user_id FROM active_user)
)-- Use the `ref` function to select from other models



SELECT 
	pageviews.*
	,customer_postcode
FROM  analytics.cko_dbt_am.pageviews_extract_ephemere pageviews
LEFT OUTER JOIN __dbt__CTE__users_extract_Ephemere users  on users.id=pageviews.user_id
      );
2020-11-06 08:46:46.609224 (Thread-1): SQL status: SUCCESS 1 in 3.53 seconds
2020-11-06 08:46:46.614224 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: COMMIT
2020-11-06 08:46:46.615724 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:46:46.616224 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: COMMIT
2020-11-06 08:46:46.751242 (Thread-1): SQL status: SUCCESS 1 in 0.13 seconds
2020-11-06 08:46:46.764244 (Thread-1): finished collecting timing info
2020-11-06 08:46:46.766244 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: Close
2020-11-06 08:46:46.977773 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd631a93b-f16f-4b3d-8862-db52025ff130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260C231A970>]}
2020-11-06 08:46:46.987272 (Thread-1): 09:46:46 | 2 of 3 OK created table model cko_dbt_am.pageviews_history_ephemeral. [SUCCESS 1 in 6.20s]
2020-11-06 08:46:47.176296 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 08:46:47.178796 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-06 08:46:47.185798 (Thread-1): 09:46:47 | 3 of 3 START incremental model cko_dbt_am.pageviews_history.......... [RUN]
2020-11-06 08:46:47.220302 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:46:47.220801 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-06 08:46:47.321813 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-06 08:46:47.324813 (Thread-1): finished collecting timing info
2020-11-06 08:46:47.428827 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:46:47.429326 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    

      create or replace temporary table analytics.cko_dbt_am.pageviews_history__dbt_tmp  as
      (/* Config line */

 
		Select * FROM analytics.cko_dbt_am.pageviews_history_ephemeral


	WHERE PAGEVIEW_DATE_HOUR > (select max(PAGEVIEW_DATE_HOUR) from analytics.cko_dbt_am.pageviews_history)

      );
2020-11-06 08:46:47.429326 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 08:46:49.392620 (Thread-1): SQL status: SUCCESS 1 in 1.96 seconds
2020-11-06 08:46:49.449128 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:46:49.449128 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history__dbt_tmp
2020-11-06 08:46:49.654804 (Thread-1): SQL status: SUCCESS 5 in 0.20 seconds
2020-11-06 08:46:49.672806 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:46:49.673805 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history
2020-11-06 08:46:49.855411 (Thread-1): SQL status: SUCCESS 5 in 0.18 seconds
2020-11-06 08:46:49.872428 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:46:49.873428 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history
2020-11-06 08:46:50.073572 (Thread-1): SQL status: SUCCESS 5 in 0.20 seconds
2020-11-06 08:46:50.164616 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-06 08:46:50.172601 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:46:50.173602 (Thread-1): On model.cko_dbt_am.pageviews_history: BEGIN
2020-11-06 08:46:50.709411 (Thread-1): SQL status: SUCCESS 1 in 0.54 seconds
2020-11-06 08:46:50.709912 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:46:50.710911 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */


        insert into analytics.cko_dbt_am.pageviews_history ("USER_ID", "PAGEVIEW_DATE_HOUR", "COUNT_PAGEVIEWS", "COUNT_DISCTINT_PAGEVIEWS", "CUSTOMER_POSTCODE")
        (
            select "USER_ID", "PAGEVIEW_DATE_HOUR", "COUNT_PAGEVIEWS", "COUNT_DISCTINT_PAGEVIEWS", "CUSTOMER_POSTCODE"
            from analytics.cko_dbt_am.pageviews_history__dbt_tmp
        );
2020-11-06 08:46:51.180043 (Thread-1): SQL status: SUCCESS 0 in 0.47 seconds
2020-11-06 08:46:51.185044 (Thread-1): On model.cko_dbt_am.pageviews_history: COMMIT
2020-11-06 08:46:51.186045 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:46:51.186045 (Thread-1): On model.cko_dbt_am.pageviews_history: COMMIT
2020-11-06 08:46:51.450602 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-11-06 08:46:51.471604 (Thread-1): finished collecting timing info
2020-11-06 08:46:51.472604 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-06 08:46:51.776013 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd631a93b-f16f-4b3d-8862-db52025ff130', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260C231A520>]}
2020-11-06 08:46:51.783012 (Thread-1): 09:46:51 | 3 of 3 OK created incremental model cko_dbt_am.pageviews_history..... [SUCCESS 0 in 4.59s]
2020-11-06 08:46:51.786011 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-06 08:46:51.799012 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 08:46:51.801026 (MainThread): Using snowflake connection "master".
2020-11-06 08:46:51.801526 (MainThread): On master: BEGIN
2020-11-06 08:46:51.802026 (MainThread): Opening a new connection, currently in state closed
2020-11-06 08:46:53.469704 (MainThread): SQL status: SUCCESS 1 in 1.67 seconds
2020-11-06 08:46:53.470705 (MainThread): On master: COMMIT
2020-11-06 08:46:53.470705 (MainThread): Using snowflake connection "master".
2020-11-06 08:46:53.470705 (MainThread): On master: COMMIT
2020-11-06 08:46:53.728346 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2020-11-06 08:46:53.729346 (MainThread): On master: Close
2020-11-06 08:46:53.977237 (MainThread): 09:46:53 | 
2020-11-06 08:46:53.987747 (MainThread): 09:46:53 | Finished running 2 table models, 1 incremental model in 25.41s.
2020-11-06 08:46:53.991745 (MainThread): Connection 'master' was properly closed.
2020-11-06 08:46:53.992246 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-06 08:46:53.992746 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-06 08:46:53.992746 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-06 08:46:54.033257 (MainThread): 
2020-11-06 08:46:54.065258 (MainThread): Completed successfully
2020-11-06 08:46:54.070261 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-11-06 08:46:54.074259 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260C21CC880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260C21CAE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260C21CAA60>]}
2020-11-06 08:46:54.075258 (MainThread): Flushing usage events
2020-11-06 08:51:15.500822 (MainThread): Running with dbt=0.18.1
2020-11-06 08:51:15.947909 (MainThread): Loading KWallet
2020-11-06 08:51:15.950908 (MainThread): Loading SecretService
2020-11-06 08:51:15.953414 (MainThread): Loading Windows
2020-11-06 08:51:16.172941 (MainThread): Loading chainer
2020-11-06 08:51:16.174441 (MainThread): Loading macOS
2020-11-06 08:51:17.001511 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-06 08:51:17.005512 (MainThread): Tracking: tracking
2020-11-06 08:51:17.005512 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D15F535C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D15F524760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D15F524D90>]}
2020-11-06 08:51:17.070515 (MainThread): Partial parsing not enabled
2020-11-06 08:51:17.074522 (MainThread): Parsing macros\adapters.sql
2020-11-06 08:51:17.151547 (MainThread): Parsing macros\catalog.sql
2020-11-06 08:51:17.157564 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-06 08:51:17.186060 (MainThread): Parsing macros\materializations\merge.sql
2020-11-06 08:51:17.192568 (MainThread): Parsing macros\materializations\table.sql
2020-11-06 08:51:17.206567 (MainThread): Parsing macros\materializations\view.sql
2020-11-06 08:51:17.219580 (MainThread): Parsing macros\core.sql
2020-11-06 08:51:17.230587 (MainThread): Parsing macros\adapters\common.sql
2020-11-06 08:51:17.341603 (MainThread): Parsing macros\etc\datetime.sql
2020-11-06 08:51:17.366603 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-06 08:51:17.369299 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-06 08:51:17.375306 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-06 08:51:17.380806 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-06 08:51:17.386307 (MainThread): Parsing macros\etc\query.sql
2020-11-06 08:51:17.388807 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-06 08:51:17.413831 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-06 08:51:17.452817 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-06 08:51:17.457833 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-06 08:51:17.477325 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-06 08:51:17.601877 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-06 08:51:17.810975 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-06 08:51:17.825960 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-06 08:51:17.970006 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-06 08:51:18.075054 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-06 08:51:18.142094 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-06 08:51:18.201601 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-06 08:51:18.236653 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-06 08:51:18.261658 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-06 08:51:18.281659 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-06 08:51:18.354170 (MainThread): Partial parsing not enabled
2020-11-06 08:51:18.704714 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:51:18.897738 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:51:18.991251 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:51:19.130768 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:51:19.181775 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-06 08:51:20.043966 (MainThread): WARNING: Found documentation for resource "my_first_dbt_model" which was not found or is disabled
2020-11-06 08:51:20.043966 (MainThread): WARNING: Found documentation for resource "my_second_dbt_model" which was not found or is disabled
2020-11-06 08:51:20.044965 (MainThread): [WARNING]: Test 'test.cko_dbt_am.unique_my_first_dbt_model_id' (models\schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2020-11-06 08:51:20.049965 (MainThread): [WARNING]: Test 'test.cko_dbt_am.not_null_my_first_dbt_model_id' (models\schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2020-11-06 08:51:20.053965 (MainThread): [WARNING]: Test 'test.cko_dbt_am.unique_my_second_dbt_model_id' (models\schema.yml) depends on a node named 'my_second_dbt_model' which was not found
2020-11-06 08:51:20.061966 (MainThread): [WARNING]: Test 'test.cko_dbt_am.not_null_my_second_dbt_model_id' (models\schema.yml) depends on a node named 'my_second_dbt_model' which was not found
2020-11-06 08:51:20.219011 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-06 08:51:20.404071 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-06 08:51:20.408073 (MainThread): 
2020-11-06 08:51:20.411071 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 08:51:20.434088 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-06 08:51:20.489099 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-06 08:51:20.489599 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-06 08:51:20.490100 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-06 08:51:23.598527 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 3.11 seconds
2020-11-06 08:51:23.625545 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-06 08:51:24.145656 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 08:51:24.190698 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 08:51:24.190698 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-06 08:51:24.191697 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-06 08:51:26.135469 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.94 seconds
2020-11-06 08:51:26.178993 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-06 08:51:26.401595 (MainThread): Using snowflake connection "master".
2020-11-06 08:51:26.402592 (MainThread): On master: BEGIN
2020-11-06 08:51:26.403593 (MainThread): Opening a new connection, currently in state init
2020-11-06 08:51:28.396093 (MainThread): SQL status: SUCCESS 1 in 1.99 seconds
2020-11-06 08:51:28.398095 (MainThread): On master: COMMIT
2020-11-06 08:51:28.399095 (MainThread): Using snowflake connection "master".
2020-11-06 08:51:28.400095 (MainThread): On master: COMMIT
2020-11-06 08:51:28.680569 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2020-11-06 08:51:28.681570 (MainThread): On master: Close
2020-11-06 08:51:28.916439 (MainThread): 09:51:28 | Concurrency: 1 threads (target='dev')
2020-11-06 08:51:28.917439 (MainThread): 09:51:28 | 
2020-11-06 08:51:28.946072 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 08:51:28.952573 (Thread-1): 09:51:28 | 1 of 4 START table model cko_dbt_am.pageviews_extract_ephemere....... [RUN]
2020-11-06 08:51:28.959569 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:51:28.960568 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 08:51:29.093597 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-06 08:51:29.097597 (Thread-1): finished collecting timing info
2020-11-06 08:51:29.335697 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-06 08:51:29.344694 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:51:29.345193 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: BEGIN
2020-11-06 08:51:29.345693 (Thread-1): Opening a new connection, currently in state init
2020-11-06 08:51:30.889875 (Thread-1): SQL status: SUCCESS 1 in 1.54 seconds
2020-11-06 08:51:30.890874 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:51:30.890874 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract_ephemere"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract_ephemere  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
      );
2020-11-06 08:51:32.783235 (Thread-1): SQL status: SUCCESS 1 in 1.89 seconds
2020-11-06 08:51:32.788248 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-06 08:51:32.789247 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:51:32.789747 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-06 08:51:32.941357 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-11-06 08:51:33.020368 (Thread-1): finished collecting timing info
2020-11-06 08:51:33.021367 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: Close
2020-11-06 08:51:33.248266 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd98c5331-cb36-40d5-817f-0580c3ebaf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D15FAAD550>]}
2020-11-06 08:51:33.255266 (Thread-1): 09:51:33 | 1 of 4 OK created table model cko_dbt_am.pageviews_extract_ephemere.. [SUCCESS 1 in 4.29s]
2020-11-06 08:51:33.299279 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 08:51:33.302790 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-06 08:51:33.310792 (Thread-1): 09:51:33 | 2 of 4 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-06 08:51:33.313792 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:51:33.314792 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-06 08:51:33.379795 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-06 08:51:33.383796 (Thread-1): finished collecting timing info
2020-11-06 08:51:33.413813 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-06 08:51:33.426313 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:51:33.426814 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-06 08:51:33.427315 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 08:51:35.650028 (Thread-1): SQL status: SUCCESS 1 in 2.22 seconds
2020-11-06 08:51:35.650028 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:51:35.651027 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        Round(O_CustKEY/100.0,0)*100 as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1000"."ORDERS"
    WHERE  DATEADD(year,25,O_orderdate)>DATEADD(month,-1,current_Date()) and DATEADD(year,25,O_orderdate)<DATEADD(month,1,current_Date())


    ) pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-06 08:51:45.144459 (Thread-1): SQL status: SUCCESS 1 in 9.49 seconds
2020-11-06 08:51:45.151458 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-06 08:51:45.152458 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:51:45.152458 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-06 08:51:45.312362 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2020-11-06 08:51:45.323378 (Thread-1): finished collecting timing info
2020-11-06 08:51:45.324379 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-06 08:51:45.575272 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd98c5331-cb36-40d5-817f-0580c3ebaf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D15FB08A00>]}
2020-11-06 08:51:45.583273 (Thread-1): 09:51:45 | 2 of 4 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 12.26s]
2020-11-06 08:51:45.606275 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-06 08:51:45.607275 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-06 08:51:45.608775 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-06 08:51:45.609776 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-06 08:51:45.675284 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-06 08:51:45.680284 (Thread-1): finished collecting timing info
2020-11-06 08:51:45.684285 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-06 08:51:45.686787 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 08:51:45.693287 (Thread-1): 09:51:45 | 3 of 4 START table model cko_dbt_am.pageviews_history_ephemeral...... [RUN]
2020-11-06 08:51:45.707288 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:51:45.708287 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 08:51:45.805304 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-06 08:51:45.810303 (Thread-1): finished collecting timing info
2020-11-06 08:51:45.837807 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-06 08:51:45.847809 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:51:45.848808 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: BEGIN
2020-11-06 08:51:45.849314 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 08:51:49.020718 (Thread-1): SQL status: SUCCESS 1 in 3.17 seconds
2020-11-06 08:51:49.020718 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:51:49.020718 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history_ephemeral"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_history_ephemeral  as
      (with __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM analytics.cko_dbt_am.pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."USERS_EXTRACT"

where id in (SELECT user_id FROM active_user)
)-- Use the `ref` function to select from other models



SELECT 
	pageviews.*
	,customer_postcode
FROM  analytics.cko_dbt_am.pageviews_extract_ephemere pageviews
LEFT OUTER JOIN __dbt__CTE__users_extract_Ephemere users  on users.id=pageviews.user_id
      );
2020-11-06 08:51:52.698546 (Thread-1): SQL status: SUCCESS 1 in 3.68 seconds
2020-11-06 08:51:52.703544 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: COMMIT
2020-11-06 08:51:52.704542 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:51:52.705543 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: COMMIT
2020-11-06 08:51:52.903634 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2020-11-06 08:51:52.916637 (Thread-1): finished collecting timing info
2020-11-06 08:51:52.918636 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: Close
2020-11-06 08:51:53.265272 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd98c5331-cb36-40d5-817f-0580c3ebaf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D15F770310>]}
2020-11-06 08:51:53.271272 (Thread-1): 09:51:53 | 3 of 4 OK created table model cko_dbt_am.pageviews_history_ephemeral. [SUCCESS 1 in 7.56s]
2020-11-06 08:51:53.274283 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 08:51:53.279284 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-06 08:51:53.285303 (Thread-1): 09:51:53 | 4 of 4 START incremental model cko_dbt_am.pageviews_history.......... [RUN]
2020-11-06 08:51:53.288298 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:51:53.289297 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-06 08:51:53.366300 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-06 08:51:53.370303 (Thread-1): finished collecting timing info
2020-11-06 08:51:53.549884 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:51:53.550884 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    

      create or replace temporary table analytics.cko_dbt_am.pageviews_history__dbt_tmp  as
      (/* Config line */

 
		Select * FROM analytics.cko_dbt_am.pageviews_history_ephemeral


	WHERE PAGEVIEW_DATE_HOUR > (select max(PAGEVIEW_DATE_HOUR) from analytics.cko_dbt_am.pageviews_history)

      );
2020-11-06 08:51:53.551885 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 08:51:56.264444 (Thread-1): SQL status: SUCCESS 1 in 2.71 seconds
2020-11-06 08:51:56.407466 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:51:56.408466 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history__dbt_tmp
2020-11-06 08:51:56.780654 (Thread-1): SQL status: SUCCESS 5 in 0.37 seconds
2020-11-06 08:51:56.798639 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:51:56.799640 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history
2020-11-06 08:51:56.968194 (Thread-1): SQL status: SUCCESS 5 in 0.17 seconds
2020-11-06 08:51:56.985223 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:51:56.985223 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history
2020-11-06 08:51:57.141181 (Thread-1): SQL status: SUCCESS 5 in 0.15 seconds
2020-11-06 08:51:57.244710 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-06 08:51:57.281733 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:51:57.281733 (Thread-1): On model.cko_dbt_am.pageviews_history: BEGIN
2020-11-06 08:51:57.536359 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2020-11-06 08:51:57.537359 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:51:57.538360 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */


        insert into analytics.cko_dbt_am.pageviews_history ("USER_ID", "PAGEVIEW_DATE_HOUR", "COUNT_PAGEVIEWS", "COUNT_DISCTINT_PAGEVIEWS", "CUSTOMER_POSTCODE")
        (
            select "USER_ID", "PAGEVIEW_DATE_HOUR", "COUNT_PAGEVIEWS", "COUNT_DISCTINT_PAGEVIEWS", "CUSTOMER_POSTCODE"
            from analytics.cko_dbt_am.pageviews_history__dbt_tmp
        );
2020-11-06 08:51:57.934635 (Thread-1): SQL status: SUCCESS 0 in 0.40 seconds
2020-11-06 08:51:57.939635 (Thread-1): On model.cko_dbt_am.pageviews_history: COMMIT
2020-11-06 08:51:57.941636 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:51:57.942635 (Thread-1): On model.cko_dbt_am.pageviews_history: COMMIT
2020-11-06 08:51:58.235460 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2020-11-06 08:51:58.267462 (Thread-1): finished collecting timing info
2020-11-06 08:51:58.270462 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-06 08:51:58.575761 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd98c5331-cb36-40d5-817f-0580c3ebaf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D15FB15790>]}
2020-11-06 08:51:58.586775 (Thread-1): 09:51:58 | 4 of 4 OK created incremental model cko_dbt_am.pageviews_history..... [SUCCESS 0 in 5.29s]
2020-11-06 08:51:58.599762 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-06 08:51:58.616773 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 08:51:58.618774 (MainThread): Using snowflake connection "master".
2020-11-06 08:51:58.619775 (MainThread): On master: BEGIN
2020-11-06 08:51:58.620774 (MainThread): Opening a new connection, currently in state closed
2020-11-06 08:52:00.609861 (MainThread): SQL status: SUCCESS 1 in 1.99 seconds
2020-11-06 08:52:00.610361 (MainThread): On master: COMMIT
2020-11-06 08:52:00.611362 (MainThread): Using snowflake connection "master".
2020-11-06 08:52:00.611862 (MainThread): On master: COMMIT
2020-11-06 08:52:00.940155 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2020-11-06 08:52:00.941173 (MainThread): On master: Close
2020-11-06 08:52:01.128104 (MainThread): 09:52:01 | 
2020-11-06 08:52:01.130087 (MainThread): 09:52:01 | Finished running 3 table models, 1 incremental model in 40.72s.
2020-11-06 08:52:01.135089 (MainThread): Connection 'master' was properly closed.
2020-11-06 08:52:01.136088 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-06 08:52:01.137088 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-06 08:52:01.137088 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-06 08:52:01.218615 (MainThread): 
2020-11-06 08:52:01.223618 (MainThread): Completed successfully
2020-11-06 08:52:01.228616 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-11-06 08:52:01.232616 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D15FAAD430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D15FAADDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D15FB08A00>]}
2020-11-06 08:52:01.233617 (MainThread): Flushing usage events
2020-11-06 08:52:35.200966 (MainThread): Running with dbt=0.18.1
2020-11-06 08:52:35.700529 (MainThread): Loading KWallet
2020-11-06 08:52:35.703534 (MainThread): Loading SecretService
2020-11-06 08:52:35.706531 (MainThread): Loading Windows
2020-11-06 08:52:36.037072 (MainThread): Loading chainer
2020-11-06 08:52:36.050074 (MainThread): Loading macOS
2020-11-06 08:52:37.073806 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-06 08:52:37.076806 (MainThread): Tracking: tracking
2020-11-06 08:52:37.076806 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268DD9C3C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268DD9B38B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268DD9B3EB0>]}
2020-11-06 08:52:37.177319 (MainThread): Partial parsing not enabled
2020-11-06 08:52:37.181319 (MainThread): Parsing macros\adapters.sql
2020-11-06 08:52:37.397846 (MainThread): Parsing macros\catalog.sql
2020-11-06 08:52:37.403848 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-06 08:52:37.463857 (MainThread): Parsing macros\materializations\merge.sql
2020-11-06 08:52:37.508861 (MainThread): Parsing macros\materializations\table.sql
2020-11-06 08:52:37.576870 (MainThread): Parsing macros\materializations\view.sql
2020-11-06 08:52:37.591871 (MainThread): Parsing macros\core.sql
2020-11-06 08:52:37.605373 (MainThread): Parsing macros\adapters\common.sql
2020-11-06 08:52:37.739891 (MainThread): Parsing macros\etc\datetime.sql
2020-11-06 08:52:37.766393 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-06 08:52:37.769894 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-06 08:52:37.775895 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-06 08:52:37.782396 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-06 08:52:37.788397 (MainThread): Parsing macros\etc\query.sql
2020-11-06 08:52:37.792896 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-06 08:52:37.820900 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-06 08:52:37.864406 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-06 08:52:37.871907 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-06 08:52:37.891911 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-06 08:52:37.953917 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-06 08:52:38.033927 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-06 08:52:38.044428 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-06 08:52:38.110437 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-06 08:52:38.152442 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-06 08:52:38.167444 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-06 08:52:38.193448 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-06 08:52:38.201949 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-06 08:52:38.207451 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-06 08:52:38.223952 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-06 08:52:38.242953 (MainThread): Partial parsing not enabled
2020-11-06 08:52:38.426478 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:52:38.537492 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:52:38.583998 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:52:38.651007 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:52:38.709013 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-06 08:52:39.507644 (MainThread): WARNING: Found documentation for resource "my_first_dbt_model" which was not found or is disabled
2020-11-06 08:52:39.507644 (MainThread): WARNING: Found documentation for resource "my_second_dbt_model" which was not found or is disabled
2020-11-06 08:52:39.508143 (MainThread): [WARNING]: Test 'test.cko_dbt_am.unique_my_first_dbt_model_id' (models\schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2020-11-06 08:52:39.549649 (MainThread): [WARNING]: Test 'test.cko_dbt_am.not_null_my_first_dbt_model_id' (models\schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2020-11-06 08:52:39.558149 (MainThread): [WARNING]: Test 'test.cko_dbt_am.unique_my_second_dbt_model_id' (models\schema.yml) depends on a node named 'my_second_dbt_model' which was not found
2020-11-06 08:52:39.566652 (MainThread): [WARNING]: Test 'test.cko_dbt_am.not_null_my_second_dbt_model_id' (models\schema.yml) depends on a node named 'my_second_dbt_model' which was not found
2020-11-06 08:52:39.675665 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-06 08:52:39.847015 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-06 08:52:39.854017 (MainThread): 
2020-11-06 08:52:39.857017 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 08:52:39.874019 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-06 08:52:39.915024 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-06 08:52:39.915524 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-06 08:52:39.915524 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-06 08:52:41.527693 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.61 seconds
2020-11-06 08:52:41.538693 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-06 08:52:41.827336 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 08:52:41.844839 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 08:52:41.844839 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-06 08:52:41.845339 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-06 08:52:43.260110 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.41 seconds
2020-11-06 08:52:43.277108 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-06 08:52:43.751212 (MainThread): Using snowflake connection "master".
2020-11-06 08:52:43.752213 (MainThread): On master: BEGIN
2020-11-06 08:52:43.752213 (MainThread): Opening a new connection, currently in state init
2020-11-06 08:52:45.170067 (MainThread): SQL status: SUCCESS 1 in 1.42 seconds
2020-11-06 08:52:45.170067 (MainThread): On master: COMMIT
2020-11-06 08:52:45.171065 (MainThread): Using snowflake connection "master".
2020-11-06 08:52:45.171065 (MainThread): On master: COMMIT
2020-11-06 08:52:46.135862 (MainThread): SQL status: SUCCESS 1 in 0.96 seconds
2020-11-06 08:52:46.135862 (MainThread): On master: Close
2020-11-06 08:52:46.365446 (MainThread): 09:52:46 | Concurrency: 1 threads (target='dev')
2020-11-06 08:52:46.365446 (MainThread): 09:52:46 | 
2020-11-06 08:52:46.379446 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 08:52:46.382447 (Thread-1): 09:52:46 | 1 of 4 START table model cko_dbt_am.pageviews_extract_ephemere....... [RUN]
2020-11-06 08:52:46.384446 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:52:46.384446 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 08:52:46.429447 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-06 08:52:46.432449 (Thread-1): finished collecting timing info
2020-11-06 08:52:46.526469 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-06 08:52:46.529970 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:52:46.530469 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: BEGIN
2020-11-06 08:52:46.530469 (Thread-1): Opening a new connection, currently in state init
2020-11-06 08:52:47.791857 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2020-11-06 08:52:47.791857 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:52:47.792856 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract_ephemere"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract_ephemere  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
      );
2020-11-06 08:52:50.304739 (Thread-1): SQL status: SUCCESS 1 in 2.51 seconds
2020-11-06 08:52:50.309740 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-06 08:52:50.310740 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:52:50.311240 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-06 08:52:50.453762 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-06 08:52:50.549793 (Thread-1): finished collecting timing info
2020-11-06 08:52:50.551794 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: Close
2020-11-06 08:52:51.515039 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd050e507-745a-49fe-b771-b6ca83a29a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268DDF37820>]}
2020-11-06 08:52:51.523039 (Thread-1): 09:52:51 | 1 of 4 OK created table model cko_dbt_am.pageviews_extract_ephemere.. [SUCCESS 1 in 5.13s]
2020-11-06 08:52:51.528039 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 08:52:51.529039 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-06 08:52:51.536041 (Thread-1): 09:52:51 | 2 of 4 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-06 08:52:51.545040 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:52:51.546040 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-06 08:52:51.605057 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-06 08:52:51.609558 (Thread-1): finished collecting timing info
2020-11-06 08:52:51.641062 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-06 08:52:51.656063 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:52:51.656563 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-06 08:52:51.657064 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 08:52:54.693159 (Thread-1): SQL status: SUCCESS 1 in 3.04 seconds
2020-11-06 08:52:54.694161 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:52:54.695160 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        Round(O_CustKEY/100.0,0)*100 as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1000"."ORDERS"
    WHERE  DATEADD(year,25,O_orderdate)>DATEADD(month,-1,current_Date()) and DATEADD(year,25,O_orderdate)<DATEADD(month,1,current_Date())


    ) pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-06 08:53:05.439557 (Thread-1): SQL status: SUCCESS 1 in 10.74 seconds
2020-11-06 08:53:05.446558 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-06 08:53:05.448559 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:53:05.449560 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-06 08:53:05.595585 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-11-06 08:53:05.610586 (Thread-1): finished collecting timing info
2020-11-06 08:53:05.612087 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-06 08:53:05.816638 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd050e507-745a-49fe-b771-b6ca83a29a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268DDF99D60>]}
2020-11-06 08:53:05.825638 (Thread-1): 09:53:05 | 2 of 4 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 14.27s]
2020-11-06 08:53:05.837640 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-06 08:53:05.838639 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-06 08:53:05.840640 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-06 08:53:05.841639 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-06 08:53:05.953669 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-06 08:53:05.958670 (Thread-1): finished collecting timing info
2020-11-06 08:53:05.964185 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-06 08:53:05.966685 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 08:53:05.975187 (Thread-1): 09:53:05 | 3 of 4 START table model cko_dbt_am.pageviews_history_ephemeral...... [RUN]
2020-11-06 08:53:05.991189 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:53:05.992189 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 08:53:06.218717 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-06 08:53:06.297226 (Thread-1): finished collecting timing info
2020-11-06 08:53:06.461747 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-06 08:53:06.478749 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:53:06.479250 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: BEGIN
2020-11-06 08:53:06.479750 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 08:53:08.670162 (Thread-1): SQL status: SUCCESS 1 in 2.19 seconds
2020-11-06 08:53:08.671162 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:53:08.671162 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history_ephemeral"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_history_ephemeral  as
      (with __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM analytics.cko_dbt_am.pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."USERS_EXTRACT"

where id in (SELECT user_id FROM active_user)
)-- Use the `ref` function to select from other models



SELECT 
	pageviews.*
	,customer_postcode
FROM  analytics.cko_dbt_am.pageviews_extract_ephemere pageviews
LEFT OUTER JOIN __dbt__CTE__users_extract_Ephemere users  on users.id=pageviews.user_id
      );
2020-11-06 08:53:11.502530 (Thread-1): SQL status: SUCCESS 1 in 2.83 seconds
2020-11-06 08:53:11.508032 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: COMMIT
2020-11-06 08:53:11.509031 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:53:11.510032 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: COMMIT
2020-11-06 08:53:11.756141 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2020-11-06 08:53:11.768643 (Thread-1): finished collecting timing info
2020-11-06 08:53:11.770644 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: Close
2020-11-06 08:53:11.973167 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd050e507-745a-49fe-b771-b6ca83a29a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268DDF99E80>]}
2020-11-06 08:53:11.976168 (Thread-1): 09:53:11 | 3 of 4 OK created table model cko_dbt_am.pageviews_history_ephemeral. [SUCCESS 1 in 5.98s]
2020-11-06 08:53:11.980169 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 08:53:11.981169 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-06 08:53:11.984670 (Thread-1): 09:53:11 | 4 of 4 START incremental model cko_dbt_am.pageviews_history.......... [RUN]
2020-11-06 08:53:11.986170 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:53:11.986669 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-06 08:53:12.032176 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-06 08:53:12.086182 (Thread-1): finished collecting timing info
2020-11-06 08:53:12.190197 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:53:12.190695 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    

      create or replace temporary table analytics.cko_dbt_am.pageviews_history__dbt_tmp  as
      (/* Config line */

 
		Select * FROM analytics.cko_dbt_am.pageviews_history_ephemeral


	WHERE PAGEVIEW_DATE_HOUR > (select max(PAGEVIEW_DATE_HOUR) from analytics.cko_dbt_am.pageviews_history)

      );
2020-11-06 08:53:12.191195 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 08:53:17.138041 (Thread-1): SQL status: SUCCESS 1 in 4.95 seconds
2020-11-06 08:53:17.161041 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:53:17.162041 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history__dbt_tmp
2020-11-06 08:53:17.384143 (Thread-1): SQL status: SUCCESS 5 in 0.22 seconds
2020-11-06 08:53:17.391151 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:53:17.391151 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history
2020-11-06 08:53:17.586199 (Thread-1): SQL status: SUCCESS 5 in 0.19 seconds
2020-11-06 08:53:17.592207 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:53:17.592207 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history
2020-11-06 08:53:17.896296 (Thread-1): SQL status: SUCCESS 5 in 0.30 seconds
2020-11-06 08:53:17.928297 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-06 08:53:17.936297 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:53:17.936297 (Thread-1): On model.cko_dbt_am.pageviews_history: BEGIN
2020-11-06 08:53:18.404419 (Thread-1): SQL status: SUCCESS 1 in 0.47 seconds
2020-11-06 08:53:18.404419 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:53:18.404419 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */


        insert into analytics.cko_dbt_am.pageviews_history ("USER_ID", "PAGEVIEW_DATE_HOUR", "COUNT_PAGEVIEWS", "COUNT_DISCTINT_PAGEVIEWS", "CUSTOMER_POSTCODE")
        (
            select "USER_ID", "PAGEVIEW_DATE_HOUR", "COUNT_PAGEVIEWS", "COUNT_DISCTINT_PAGEVIEWS", "CUSTOMER_POSTCODE"
            from analytics.cko_dbt_am.pageviews_history__dbt_tmp
        );
2020-11-06 08:53:18.784022 (Thread-1): SQL status: SUCCESS 0 in 0.38 seconds
2020-11-06 08:53:18.787022 (Thread-1): On model.cko_dbt_am.pageviews_history: COMMIT
2020-11-06 08:53:18.787523 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:53:18.787523 (Thread-1): On model.cko_dbt_am.pageviews_history: COMMIT
2020-11-06 08:53:19.257671 (Thread-1): SQL status: SUCCESS 1 in 0.47 seconds
2020-11-06 08:53:19.266670 (Thread-1): finished collecting timing info
2020-11-06 08:53:19.266670 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-06 08:53:19.717857 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd050e507-745a-49fe-b771-b6ca83a29a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268DDFA2700>]}
2020-11-06 08:53:19.724860 (Thread-1): 09:53:19 | 4 of 4 OK created incremental model cko_dbt_am.pageviews_history..... [SUCCESS 0 in 7.73s]
2020-11-06 08:53:19.729857 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-06 08:53:19.735857 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 08:53:19.736859 (MainThread): Using snowflake connection "master".
2020-11-06 08:53:19.739858 (MainThread): On master: BEGIN
2020-11-06 08:53:19.740857 (MainThread): Opening a new connection, currently in state closed
2020-11-06 08:53:22.037301 (MainThread): SQL status: SUCCESS 1 in 2.30 seconds
2020-11-06 08:53:22.037801 (MainThread): On master: COMMIT
2020-11-06 08:53:22.038800 (MainThread): Using snowflake connection "master".
2020-11-06 08:53:22.038800 (MainThread): On master: COMMIT
2020-11-06 08:53:22.388345 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2020-11-06 08:53:22.388844 (MainThread): On master: Close
2020-11-06 08:53:22.583369 (MainThread): 09:53:22 | 
2020-11-06 08:53:22.658878 (MainThread): 09:53:22 | Finished running 3 table models, 1 incremental model in 42.73s.
2020-11-06 08:53:22.659879 (MainThread): Connection 'master' was properly closed.
2020-11-06 08:53:22.660379 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-06 08:53:22.660379 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-06 08:53:22.660879 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-06 08:53:22.695884 (MainThread): 
2020-11-06 08:53:22.847403 (MainThread): Completed successfully
2020-11-06 08:53:23.171445 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-11-06 08:53:23.176445 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268DDF37E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268DDF37460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268DDF37640>]}
2020-11-06 08:53:23.176946 (MainThread): Flushing usage events
2020-11-06 08:54:14.671042 (MainThread): Running with dbt=0.18.1
2020-11-06 08:54:16.020213 (MainThread): Loading KWallet
2020-11-06 08:54:16.026714 (MainThread): Loading SecretService
2020-11-06 08:54:16.030713 (MainThread): Loading Windows
2020-11-06 08:54:16.438764 (MainThread): Loading chainer
2020-11-06 08:54:16.440765 (MainThread): Loading macOS
2020-11-06 08:54:17.601149 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-06 08:54:17.603149 (MainThread): Tracking: tracking
2020-11-06 08:54:17.603149 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245766548E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002457663F880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002457663FEB0>]}
2020-11-06 08:54:17.689166 (MainThread): Partial parsing not enabled
2020-11-06 08:54:17.692665 (MainThread): Parsing macros\adapters.sql
2020-11-06 08:54:17.777715 (MainThread): Parsing macros\catalog.sql
2020-11-06 08:54:17.783714 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-06 08:54:17.813725 (MainThread): Parsing macros\materializations\merge.sql
2020-11-06 08:54:17.821074 (MainThread): Parsing macros\materializations\table.sql
2020-11-06 08:54:17.834075 (MainThread): Parsing macros\materializations\view.sql
2020-11-06 08:54:17.847086 (MainThread): Parsing macros\core.sql
2020-11-06 08:54:17.861088 (MainThread): Parsing macros\adapters\common.sql
2020-11-06 08:54:17.999614 (MainThread): Parsing macros\etc\datetime.sql
2020-11-06 08:54:18.024131 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-06 08:54:18.027131 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-06 08:54:18.032131 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-06 08:54:18.040134 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-06 08:54:18.045133 (MainThread): Parsing macros\etc\query.sql
2020-11-06 08:54:18.053133 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-06 08:54:18.079134 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-06 08:54:18.120158 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-06 08:54:18.127159 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-06 08:54:18.149160 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-06 08:54:18.209171 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-06 08:54:18.286193 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-06 08:54:18.291193 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-06 08:54:18.336225 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-06 08:54:18.355216 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-06 08:54:18.370217 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-06 08:54:18.388219 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-06 08:54:18.395218 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-06 08:54:18.400225 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-06 08:54:18.405737 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-06 08:54:18.423234 (MainThread): Partial parsing not enabled
2020-11-06 08:54:18.542271 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:54:18.694329 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:54:18.791369 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:54:18.960915 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:54:19.058948 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-06 08:54:20.451262 (MainThread): WARNING: Found documentation for resource "my_first_dbt_model" which was not found or is disabled
2020-11-06 08:54:20.451763 (MainThread): WARNING: Found documentation for resource "my_second_dbt_model" which was not found or is disabled
2020-11-06 08:54:20.452263 (MainThread): [WARNING]: Test 'test.cko_dbt_am.unique_my_first_dbt_model_id' (models\schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2020-11-06 08:54:20.468773 (MainThread): [WARNING]: Test 'test.cko_dbt_am.not_null_my_first_dbt_model_id' (models\schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2020-11-06 08:54:20.482774 (MainThread): [WARNING]: Test 'test.cko_dbt_am.unique_my_second_dbt_model_id' (models\schema.yml) depends on a node named 'my_second_dbt_model' which was not found
2020-11-06 08:54:20.494778 (MainThread): [WARNING]: Test 'test.cko_dbt_am.not_null_my_second_dbt_model_id' (models\schema.yml) depends on a node named 'my_second_dbt_model' which was not found
2020-11-06 08:54:20.677339 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-06 08:54:20.878383 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-06 08:54:20.886884 (MainThread): 
2020-11-06 08:54:20.890393 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 08:54:20.919394 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-06 08:54:20.973428 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-06 08:54:20.973929 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-06 08:54:20.973929 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-06 08:54:24.043010 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 3.07 seconds
2020-11-06 08:54:24.079009 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-06 08:54:24.718543 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 08:54:24.818056 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 08:54:24.820556 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-06 08:54:24.821556 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-06 08:54:26.694942 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 8 in 1.87 seconds
2020-11-06 08:54:26.717945 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-06 08:54:26.940991 (MainThread): Using snowflake connection "master".
2020-11-06 08:54:26.940991 (MainThread): On master: BEGIN
2020-11-06 08:54:26.940991 (MainThread): Opening a new connection, currently in state init
2020-11-06 08:54:27.809712 (MainThread): SQL status: SUCCESS 1 in 0.87 seconds
2020-11-06 08:54:27.809712 (MainThread): On master: COMMIT
2020-11-06 08:54:27.809712 (MainThread): Using snowflake connection "master".
2020-11-06 08:54:27.810711 (MainThread): On master: COMMIT
2020-11-06 08:54:28.182661 (MainThread): SQL status: SUCCESS 1 in 0.37 seconds
2020-11-06 08:54:28.183663 (MainThread): On master: Close
2020-11-06 08:54:28.408131 (MainThread): 09:54:28 | Concurrency: 1 threads (target='dev')
2020-11-06 08:54:28.409115 (MainThread): 09:54:28 | 
2020-11-06 08:54:28.458642 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 08:54:28.467661 (Thread-1): 09:54:28 | 1 of 4 START table model cko_dbt_am.pageviews_extract_ephemere....... [RUN]
2020-11-06 08:54:28.472643 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:54:28.473642 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 08:54:28.605700 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-06 08:54:28.610702 (Thread-1): finished collecting timing info
2020-11-06 08:54:28.938783 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-06 08:54:28.952783 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:54:28.953782 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: BEGIN
2020-11-06 08:54:28.954783 (Thread-1): Opening a new connection, currently in state init
2020-11-06 08:54:30.883378 (Thread-1): SQL status: SUCCESS 1 in 1.93 seconds
2020-11-06 08:54:30.884378 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:54:30.884378 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract_ephemere"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract_ephemere  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
      );
2020-11-06 08:54:33.174536 (Thread-1): SQL status: SUCCESS 1 in 2.29 seconds
2020-11-06 08:54:33.180537 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-06 08:54:33.181538 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 08:54:33.182536 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: COMMIT
2020-11-06 08:54:33.327556 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-06 08:54:33.444069 (Thread-1): finished collecting timing info
2020-11-06 08:54:33.446070 (Thread-1): On model.cko_dbt_am.pageviews_extract_ephemere: Close
2020-11-06 08:54:33.652597 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '181cb1cd-c255-4633-a658-30aa200b5341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024576BC0A60>]}
2020-11-06 08:54:33.661099 (Thread-1): 09:54:33 | 1 of 4 OK created table model cko_dbt_am.pageviews_extract_ephemere.. [SUCCESS 1 in 5.18s]
2020-11-06 08:54:33.665597 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 08:54:33.668098 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-06 08:54:33.678599 (Thread-1): 09:54:33 | 2 of 4 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-06 08:54:33.687600 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:54:33.693102 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-06 08:54:33.788114 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-06 08:54:33.796114 (Thread-1): finished collecting timing info
2020-11-06 08:54:33.855121 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-06 08:54:33.877625 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:54:33.878125 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-06 08:54:33.880125 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 08:54:35.641287 (Thread-1): SQL status: SUCCESS 1 in 1.76 seconds
2020-11-06 08:54:35.642288 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:54:35.643287 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        Round(O_CustKEY/100000.0,0)*100000 as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1000"."ORDERS"
    WHERE  DATEADD(year,25,O_orderdate)>DATEADD(month,-1,current_Date()) and DATEADD(year,25,O_orderdate)<DATEADD(month,1,current_Date())


    ) pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-06 08:54:42.819916 (Thread-1): SQL status: SUCCESS 1 in 7.18 seconds
2020-11-06 08:54:42.822916 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-06 08:54:42.823416 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 08:54:42.823416 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-06 08:54:42.944432 (Thread-1): SQL status: SUCCESS 1 in 0.12 seconds
2020-11-06 08:54:42.950443 (Thread-1): finished collecting timing info
2020-11-06 08:54:42.951442 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-06 08:54:43.162489 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '181cb1cd-c255-4633-a658-30aa200b5341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024576C397F0>]}
2020-11-06 08:54:43.166488 (Thread-1): 09:54:43 | 2 of 4 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 9.48s]
2020-11-06 08:54:43.173489 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-06 08:54:43.174489 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-06 08:54:43.175490 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-06 08:54:43.176490 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-06 08:54:43.202491 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-06 08:54:43.206491 (Thread-1): finished collecting timing info
2020-11-06 08:54:43.207492 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-06 08:54:43.210493 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 08:54:43.216493 (Thread-1): 09:54:43 | 3 of 4 START table model cko_dbt_am.pageviews_history_ephemeral...... [RUN]
2020-11-06 08:54:43.243504 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:54:43.243504 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 08:54:43.299011 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-06 08:54:43.300512 (Thread-1): finished collecting timing info
2020-11-06 08:54:43.310513 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-06 08:54:43.314012 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:54:43.314513 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: BEGIN
2020-11-06 08:54:43.314513 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 08:54:44.326178 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2020-11-06 08:54:44.326677 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:54:44.327177 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history_ephemeral"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_history_ephemeral  as
      (with __dbt__CTE__users_extract_Ephemere as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM analytics.cko_dbt_am.pageviews_extract_ephemere)


select *
From "ANALYTICS"."CKO_DBT_AM"."USERS_EXTRACT"

where id in (SELECT user_id FROM active_user)
)-- Use the `ref` function to select from other models



SELECT 
	pageviews.*
	,customer_postcode
FROM  analytics.cko_dbt_am.pageviews_extract_ephemere pageviews
LEFT OUTER JOIN __dbt__CTE__users_extract_Ephemere users  on users.id=pageviews.user_id
      );
2020-11-06 08:54:47.702404 (Thread-1): SQL status: SUCCESS 1 in 3.38 seconds
2020-11-06 08:54:47.708405 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: COMMIT
2020-11-06 08:54:47.708905 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 08:54:47.708905 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: COMMIT
2020-11-06 08:54:47.877934 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2020-11-06 08:54:47.884935 (Thread-1): finished collecting timing info
2020-11-06 08:54:47.884935 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: Close
2020-11-06 08:54:48.084994 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '181cb1cd-c255-4633-a658-30aa200b5341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024576BC0F40>]}
2020-11-06 08:54:48.088994 (Thread-1): 09:54:48 | 3 of 4 OK created table model cko_dbt_am.pageviews_history_ephemeral. [SUCCESS 1 in 4.84s]
2020-11-06 08:54:48.095993 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 08:54:48.098996 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-06 08:54:48.102995 (Thread-1): 09:54:48 | 4 of 4 START incremental model cko_dbt_am.pageviews_history.......... [RUN]
2020-11-06 08:54:48.105995 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:54:48.107995 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-06 08:54:48.156019 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-06 08:54:48.158017 (Thread-1): finished collecting timing info
2020-11-06 08:54:48.359546 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:54:48.360046 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    

      create or replace temporary table analytics.cko_dbt_am.pageviews_history__dbt_tmp  as
      (/* Config line */

 
		Select * FROM analytics.cko_dbt_am.pageviews_history_ephemeral


	WHERE PAGEVIEW_DATE_HOUR > (select max(PAGEVIEW_DATE_HOUR) from analytics.cko_dbt_am.pageviews_history)

      );
2020-11-06 08:54:48.360546 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 08:54:51.195805 (Thread-1): SQL status: SUCCESS 1 in 2.84 seconds
2020-11-06 08:54:51.258360 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:54:51.259360 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history__dbt_tmp
2020-11-06 08:54:51.444747 (Thread-1): SQL status: SUCCESS 5 in 0.18 seconds
2020-11-06 08:54:51.462747 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:54:51.463747 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history
2020-11-06 08:54:51.668903 (Thread-1): SQL status: SUCCESS 5 in 0.20 seconds
2020-11-06 08:54:51.688415 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:54:51.689416 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history
2020-11-06 08:54:51.859476 (Thread-1): SQL status: SUCCESS 5 in 0.17 seconds
2020-11-06 08:54:51.990022 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-06 08:54:52.002524 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:54:52.003024 (Thread-1): On model.cko_dbt_am.pageviews_history: BEGIN
2020-11-06 08:54:52.234561 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2020-11-06 08:54:52.235562 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:54:52.236561 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */


        insert into analytics.cko_dbt_am.pageviews_history ("USER_ID", "PAGEVIEW_DATE_HOUR", "COUNT_PAGEVIEWS", "COUNT_DISCTINT_PAGEVIEWS", "CUSTOMER_POSTCODE")
        (
            select "USER_ID", "PAGEVIEW_DATE_HOUR", "COUNT_PAGEVIEWS", "COUNT_DISCTINT_PAGEVIEWS", "CUSTOMER_POSTCODE"
            from analytics.cko_dbt_am.pageviews_history__dbt_tmp
        );
2020-11-06 08:54:52.668615 (Thread-1): SQL status: SUCCESS 0 in 0.43 seconds
2020-11-06 08:54:52.673615 (Thread-1): On model.cko_dbt_am.pageviews_history: COMMIT
2020-11-06 08:54:52.674614 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 08:54:52.674614 (Thread-1): On model.cko_dbt_am.pageviews_history: COMMIT
2020-11-06 08:54:53.014188 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2020-11-06 08:54:53.034701 (Thread-1): finished collecting timing info
2020-11-06 08:54:53.036701 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-06 08:54:53.289195 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '181cb1cd-c255-4633-a658-30aa200b5341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024576BE83D0>]}
2020-11-06 08:54:53.297214 (Thread-1): 09:54:53 | 4 of 4 OK created incremental model cko_dbt_am.pageviews_history..... [SUCCESS 0 in 5.18s]
2020-11-06 08:54:53.300196 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-06 08:54:53.311709 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 08:54:53.313209 (MainThread): Using snowflake connection "master".
2020-11-06 08:54:53.313710 (MainThread): On master: BEGIN
2020-11-06 08:54:53.314209 (MainThread): Opening a new connection, currently in state closed
2020-11-06 08:54:55.445579 (MainThread): SQL status: SUCCESS 1 in 2.13 seconds
2020-11-06 08:54:55.445579 (MainThread): On master: COMMIT
2020-11-06 08:54:55.446577 (MainThread): Using snowflake connection "master".
2020-11-06 08:54:55.447577 (MainThread): On master: COMMIT
2020-11-06 08:54:55.712814 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2020-11-06 08:54:55.713823 (MainThread): On master: Close
2020-11-06 08:54:55.957797 (MainThread): 09:54:55 | 
2020-11-06 08:54:55.959779 (MainThread): 09:54:55 | Finished running 3 table models, 1 incremental model in 35.07s.
2020-11-06 08:54:55.964781 (MainThread): Connection 'master' was properly closed.
2020-11-06 08:54:55.965780 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-06 08:54:55.965780 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-06 08:54:55.966780 (MainThread): Connection 'model.cko_dbt_am.pageviews_history' was properly closed.
2020-11-06 08:54:56.043797 (MainThread): 
2020-11-06 08:54:56.046808 (MainThread): Completed successfully
2020-11-06 08:54:56.053809 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-11-06 08:54:56.077811 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024576BC0670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024576BC09A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024576BC0970>]}
2020-11-06 08:54:56.078810 (MainThread): Flushing usage events
2020-11-06 09:09:12.591452 (MainThread): Running with dbt=0.18.1
2020-11-06 09:09:13.086533 (MainThread): Loading KWallet
2020-11-06 09:09:13.096534 (MainThread): Loading SecretService
2020-11-06 09:09:13.107535 (MainThread): Loading Windows
2020-11-06 09:09:13.330065 (MainThread): Loading chainer
2020-11-06 09:09:13.332063 (MainThread): Loading macOS
2020-11-06 09:09:15.364841 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-06 09:09:15.378842 (MainThread): Tracking: tracking
2020-11-06 09:09:15.379842 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019192DE4670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019192DD4850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019192DD4E50>]}
2020-11-06 09:09:15.656414 (MainThread): Partial parsing not enabled
2020-11-06 09:09:15.667914 (MainThread): Parsing macros\adapters.sql
2020-11-06 09:09:16.152992 (MainThread): Parsing macros\catalog.sql
2020-11-06 09:09:16.165992 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-06 09:09:16.213999 (MainThread): Parsing macros\materializations\merge.sql
2020-11-06 09:09:16.224000 (MainThread): Parsing macros\materializations\table.sql
2020-11-06 09:09:16.242007 (MainThread): Parsing macros\materializations\view.sql
2020-11-06 09:09:16.261011 (MainThread): Parsing macros\core.sql
2020-11-06 09:09:16.277010 (MainThread): Parsing macros\adapters\common.sql
2020-11-06 09:09:16.437071 (MainThread): Parsing macros\etc\datetime.sql
2020-11-06 09:09:16.471084 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-06 09:09:16.475084 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-06 09:09:16.483074 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-06 09:09:16.491074 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-06 09:09:16.501074 (MainThread): Parsing macros\etc\query.sql
2020-11-06 09:09:16.506087 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-06 09:09:16.545103 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-06 09:09:16.607108 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-06 09:09:16.615108 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-06 09:09:16.641136 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-06 09:09:16.758160 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-06 09:09:16.895681 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-06 09:09:16.902182 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-06 09:09:16.948201 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-06 09:09:16.966201 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-06 09:09:16.980201 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-06 09:09:16.997219 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-06 09:09:17.005221 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-06 09:09:17.009236 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-06 09:09:17.014236 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-06 09:09:17.031237 (MainThread): Partial parsing not enabled
2020-11-06 09:09:17.207315 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 09:09:17.354355 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemeral".
2020-11-06 09:09:17.425407 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 09:09:17.526422 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 09:09:17.960982 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 09:09:18.009988 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 09:09:18.051009 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_ephemeral".
2020-11-06 09:09:18.106008 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-06 09:09:18.295050 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.view_pageviews_history_Latest_PostCode".
2020-11-06 09:09:18.910256 (MainThread): WARNING: Found documentation for resource "my_first_dbt_model" which was not found or is disabled
2020-11-06 09:09:18.910756 (MainThread): WARNING: Found documentation for resource "my_second_dbt_model" which was not found or is disabled
2020-11-06 09:09:18.911756 (MainThread): [WARNING]: Test 'test.cko_dbt_am.unique_my_first_dbt_model_id' (models\schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2020-11-06 09:09:18.913256 (MainThread): [WARNING]: Test 'test.cko_dbt_am.not_null_my_first_dbt_model_id' (models\schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2020-11-06 09:09:18.918258 (MainThread): [WARNING]: Test 'test.cko_dbt_am.unique_my_second_dbt_model_id' (models\schema.yml) depends on a node named 'my_second_dbt_model' which was not found
2020-11-06 09:09:18.919266 (MainThread): [WARNING]: Test 'test.cko_dbt_am.not_null_my_second_dbt_model_id' (models\schema.yml) depends on a node named 'my_second_dbt_model' which was not found
2020-11-06 09:09:19.369323 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-06 09:09:19.768376 (MainThread): Found 9 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-06 09:09:19.771287 (MainThread): 
2020-11-06 09:09:19.773287 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 09:09:19.795287 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-06 09:09:19.831291 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-06 09:09:19.831291 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-06 09:09:19.832289 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-06 09:09:22.539075 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.71 seconds
2020-11-06 09:09:22.549076 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-06 09:09:22.791820 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 09:09:22.808820 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 09:09:22.809821 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-06 09:09:22.809821 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-06 09:09:23.981668 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 2 in 1.17 seconds
2020-11-06 09:09:23.995174 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-06 09:09:24.270427 (MainThread): Using snowflake connection "master".
2020-11-06 09:09:24.271427 (MainThread): On master: BEGIN
2020-11-06 09:09:24.271926 (MainThread): Opening a new connection, currently in state init
2020-11-06 09:09:26.374772 (MainThread): SQL status: SUCCESS 1 in 2.10 seconds
2020-11-06 09:09:26.375772 (MainThread): On master: COMMIT
2020-11-06 09:09:26.376278 (MainThread): Using snowflake connection "master".
2020-11-06 09:09:26.377280 (MainThread): On master: COMMIT
2020-11-06 09:09:26.682321 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2020-11-06 09:09:26.682821 (MainThread): On master: Close
2020-11-06 09:09:26.867345 (MainThread): 10:09:26 | Concurrency: 1 threads (target='dev')
2020-11-06 09:09:27.002362 (MainThread): 10:09:27 | 
2020-11-06 09:09:27.093873 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemeral
2020-11-06 09:09:27.094873 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemeral".
2020-11-06 09:09:27.095873 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemeral
2020-11-06 09:09:27.190385 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemeral"
2020-11-06 09:09:27.204387 (Thread-1): finished collecting timing info
2020-11-06 09:09:27.206388 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemeral
2020-11-06 09:09:27.206388 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-06 09:09:27.209388 (Thread-1): 10:09:27 | 1 of 5 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-06 09:09:27.227891 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 09:09:27.229392 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-06 09:09:27.247893 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-06 09:09:27.249893 (Thread-1): finished collecting timing info
2020-11-06 09:09:27.344408 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-06 09:09:27.351908 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 09:09:27.352408 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-06 09:09:27.352408 (Thread-1): Opening a new connection, currently in state init
2020-11-06 09:09:29.031373 (Thread-1): SQL status: SUCCESS 1 in 1.68 seconds
2020-11-06 09:09:29.032390 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 09:09:29.032390 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        Round(O_CustKEY/100000.0,0)*100000 as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1000"."ORDERS"
    WHERE  DATEADD(year,25,O_orderdate)>DATEADD(month,-1,current_Date()) and DATEADD(year,25,O_orderdate)<DATEADD(month,1,current_Date())


    ) pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-06 09:09:43.119031 (Thread-1): SQL status: SUCCESS 1 in 14.09 seconds
2020-11-06 09:09:43.124544 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-06 09:09:43.125544 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 09:09:43.125544 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-06 09:09:43.264590 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-06 09:09:43.369620 (Thread-1): finished collecting timing info
2020-11-06 09:09:43.374620 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-06 09:09:43.610235 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd358fb4d-1d7a-466f-ada8-0a2cab04866b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191934787C0>]}
2020-11-06 09:09:43.618236 (Thread-1): 10:09:43 | 1 of 5 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 16.38s]
2020-11-06 09:09:43.627750 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-06 09:09:43.629747 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 09:09:43.630747 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemere".
2020-11-06 09:09:43.631749 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 09:09:43.694751 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemere"
2020-11-06 09:09:43.701752 (Thread-1): finished collecting timing info
2020-11-06 09:09:43.704753 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemere
2020-11-06 09:09:43.706769 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-06 09:09:43.734773 (Thread-1): 10:09:43 | 2 of 5 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-06 09:09:43.776777 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 09:09:43.777277 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-06 09:09:43.863289 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-06 09:09:43.881790 (Thread-1): finished collecting timing info
2020-11-06 09:09:44.004307 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-06 09:09:44.143823 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 09:09:44.144323 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-06 09:09:44.144824 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 09:09:45.834185 (Thread-1): SQL status: SUCCESS 1 in 1.69 seconds
2020-11-06 09:09:45.835186 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 09:09:45.835186 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as Customer_postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1000"."CUSTOMER"
      );
2020-11-06 09:09:54.216391 (Thread-1): SQL status: SUCCESS 1 in 8.38 seconds
2020-11-06 09:09:54.221391 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-06 09:09:54.222391 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 09:09:54.222391 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-06 09:09:54.375432 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-11-06 09:09:54.386942 (Thread-1): finished collecting timing info
2020-11-06 09:09:54.388442 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-06 09:09:54.997849 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd358fb4d-1d7a-466f-ada8-0a2cab04866b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001919313DA90>]}
2020-11-06 09:09:55.001350 (Thread-1): 10:09:55 | 2 of 5 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 11.22s]
2020-11-06 09:09:55.023862 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-06 09:09:55.023862 (Thread-1): Began running node model.cko_dbt_am.users_extract_ephemeral
2020-11-06 09:09:55.024862 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_ephemeral".
2020-11-06 09:09:55.024862 (Thread-1): Compiling model.cko_dbt_am.users_extract_ephemeral
2020-11-06 09:09:55.133880 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_ephemeral"
2020-11-06 09:09:55.136381 (Thread-1): finished collecting timing info
2020-11-06 09:09:55.137880 (Thread-1): Finished running node model.cko_dbt_am.users_extract_ephemeral
2020-11-06 09:09:55.138380 (Thread-1): Began running node model.cko_dbt_am.users_extract_Ephemere
2020-11-06 09:09:55.139380 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_Ephemere".
2020-11-06 09:09:55.139881 (Thread-1): Compiling model.cko_dbt_am.users_extract_Ephemere
2020-11-06 09:09:55.209995 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_Ephemere"
2020-11-06 09:09:55.214496 (Thread-1): finished collecting timing info
2020-11-06 09:09:55.215996 (Thread-1): Finished running node model.cko_dbt_am.users_extract_Ephemere
2020-11-06 09:09:55.215996 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 09:09:55.219497 (Thread-1): 10:09:55 | 3 of 5 START table model cko_dbt_am.pageviews_history_ephemeral...... [RUN]
2020-11-06 09:09:55.220997 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 09:09:55.221498 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 09:09:55.258501 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-06 09:09:55.261002 (Thread-1): finished collecting timing info
2020-11-06 09:09:55.279104 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-06 09:09:55.287105 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 09:09:55.287105 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: BEGIN
2020-11-06 09:09:55.287605 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 09:09:56.722947 (Thread-1): SQL status: SUCCESS 1 in 1.44 seconds
2020-11-06 09:09:56.723948 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 09:09:56.723948 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history_ephemeral"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_history_ephemeral  as
      (with __dbt__CTE__pageviews_extract_ephemeral as (
/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
),  __dbt__CTE__users_extract_ephemeral as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM __dbt__CTE__pageviews_extract_ephemeral)


select *
From "ANALYTICS"."CKO_DBT_AM"."USERS_EXTRACT"

where id in (SELECT user_id FROM active_user)
)-- Use the `ref` function to select from other models



SELECT 
	pageviews.*
	,customer_postcode
FROM  __dbt__CTE__pageviews_extract_ephemeral pageviews
LEFT OUTER JOIN __dbt__CTE__users_extract_ephemeral users  on users.id=pageviews.user_id
      );
2020-11-06 09:10:00.390160 (Thread-1): SQL status: SUCCESS 1 in 3.66 seconds
2020-11-06 09:10:00.395171 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: COMMIT
2020-11-06 09:10:00.396170 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 09:10:00.396170 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: COMMIT
2020-11-06 09:10:01.073319 (Thread-1): SQL status: SUCCESS 1 in 0.68 seconds
2020-11-06 09:10:01.093342 (Thread-1): finished collecting timing info
2020-11-06 09:10:01.095342 (Thread-1): On model.cko_dbt_am.pageviews_history_ephemeral: Close
2020-11-06 09:10:01.374897 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd358fb4d-1d7a-466f-ada8-0a2cab04866b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019193339280>]}
2020-11-06 09:10:01.381898 (Thread-1): 10:10:01 | 3 of 5 OK created table model cko_dbt_am.pageviews_history_ephemeral. [SUCCESS 1 in 6.15s]
2020-11-06 09:10:01.462909 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 09:10:01.493410 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-06 09:10:01.510414 (Thread-1): 10:10:01 | 4 of 5 START incremental model cko_dbt_am.pageviews_history.......... [RUN]
2020-11-06 09:10:01.527426 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 09:10:01.531427 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-06 09:10:01.810461 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-06 09:10:01.863969 (Thread-1): finished collecting timing info
2020-11-06 09:10:02.200568 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-06 09:10:02.264075 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 09:10:02.264575 (Thread-1): On model.cko_dbt_am.pageviews_history: BEGIN
2020-11-06 09:10:02.265075 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 09:10:04.155316 (Thread-1): SQL status: SUCCESS 1 in 1.89 seconds
2020-11-06 09:10:04.155816 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 09:10:04.155816 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_history  as
      (/* Config line */

 
		Select * FROM analytics.cko_dbt_am.pageviews_history_ephemeral


      );
2020-11-06 09:10:10.446679 (Thread-1): SQL status: SUCCESS 1 in 6.29 seconds
2020-11-06 09:10:10.451678 (Thread-1): On model.cko_dbt_am.pageviews_history: COMMIT
2020-11-06 09:10:10.452680 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 09:10:10.453681 (Thread-1): On model.cko_dbt_am.pageviews_history: COMMIT
2020-11-06 09:10:10.645752 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-11-06 09:10:10.668768 (Thread-1): finished collecting timing info
2020-11-06 09:10:10.670768 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-06 09:10:10.906878 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd358fb4d-1d7a-466f-ada8-0a2cab04866b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191932C8CA0>]}
2020-11-06 09:10:10.914880 (Thread-1): 10:10:10 | 4 of 5 OK created incremental model cko_dbt_am.pageviews_history..... [SUCCESS 1 in 9.38s]
2020-11-06 09:10:10.926893 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-06 09:10:10.929893 (Thread-1): Began running node model.cko_dbt_am.view_pageviews_history_Latest_PostCode
2020-11-06 09:10:10.939895 (Thread-1): 10:10:10 | 5 of 5 START view model cko_dbt_am.view_pageviews_history_Latest_PostCode [RUN]
2020-11-06 09:10:10.944893 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.view_pageviews_history_Latest_PostCode".
2020-11-06 09:10:10.945893 (Thread-1): Compiling model.cko_dbt_am.view_pageviews_history_Latest_PostCode
2020-11-06 09:10:11.009409 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.view_pageviews_history_Latest_PostCode"
2020-11-06 09:10:11.012909 (Thread-1): finished collecting timing info
2020-11-06 09:10:11.364453 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.view_pageviews_history_Latest_PostCode"
2020-11-06 09:10:11.373454 (Thread-1): Using snowflake connection "model.cko_dbt_am.view_pageviews_history_Latest_PostCode".
2020-11-06 09:10:11.373955 (Thread-1): On model.cko_dbt_am.view_pageviews_history_Latest_PostCode: BEGIN
2020-11-06 09:10:11.374455 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 09:10:12.718171 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2020-11-06 09:10:12.718672 (Thread-1): Using snowflake connection "model.cko_dbt_am.view_pageviews_history_Latest_PostCode".
2020-11-06 09:10:12.718672 (Thread-1): On model.cko_dbt_am.view_pageviews_history_Latest_PostCode: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.view_pageviews_history_Latest_PostCode"} */

  create or replace  view analytics.cko_dbt_am.view_pageviews_history_Latest_PostCode  as (
    -- Use the `ref` function to select from other models



SELECT 
	pageviews.*
	,customer_postcode as Latest_Post_code
FROM  analytics.cko_dbt_am.pageviews_history pageviews
LEFT OUTER JOIN "ANALYTICS"."CKO_DBT_AM"."USERS_EXTRACT" users  on users.id=pageviews.user_id
  );
2020-11-06 09:10:12.996368 (Thread-1): Snowflake query id: 019815a6-00a6-d74c-0000-6c5d00024036
2020-11-06 09:10:12.997368 (Thread-1): Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'CUSTOMER_POSTCODE'
2020-11-06 09:10:12.997368 (Thread-1): finished collecting timing info
2020-11-06 09:10:12.998367 (Thread-1): On model.cko_dbt_am.view_pageviews_history_Latest_PostCode: ROLLBACK
2020-11-06 09:10:13.260363 (Thread-1): On model.cko_dbt_am.view_pageviews_history_Latest_PostCode: Close
2020-11-06 09:10:13.503203 (Thread-1): Database Error in model view_pageviews_history_Latest_PostCode (models\view_pageviews_history_Latest_PostCode.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'CUSTOMER_POSTCODE'
  compiled SQL at target\run\cko_dbt_am\models\view_pageviews_history_Latest_PostCode.sql
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\cursor.py", line 594, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\alexandre\anaconda3\lib\site-packages\snowflake\connector\errors.py", line 83, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 002028 (42601): SQL compilation error:
ambiguous column name 'CUSTOMER_POSTCODE'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\base\impl.py", line 224, in execute
    return self.connections.execute(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 309, in add_query
    connection, cursor = super().add_query(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "c:\users\alexandre\anaconda3\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model view_pageviews_history_Latest_PostCode (models\view_pageviews_history_Latest_PostCode.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'CUSTOMER_POSTCODE'
  compiled SQL at target\run\cko_dbt_am\models\view_pageviews_history_Latest_PostCode.sql
2020-11-06 09:10:13.527216 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd358fb4d-1d7a-466f-ada8-0a2cab04866b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191932DC9D0>]}
2020-11-06 09:10:13.535718 (Thread-1): 10:10:13 | 5 of 5 ERROR creating view model cko_dbt_am.view_pageviews_history_Latest_PostCode [ERROR in 2.58s]
2020-11-06 09:10:13.540718 (Thread-1): Finished running node model.cko_dbt_am.view_pageviews_history_Latest_PostCode
2020-11-06 09:10:13.546717 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 09:10:13.547736 (MainThread): Using snowflake connection "master".
2020-11-06 09:10:13.548720 (MainThread): On master: BEGIN
2020-11-06 09:10:13.548720 (MainThread): Opening a new connection, currently in state closed
2020-11-06 09:10:16.396034 (MainThread): SQL status: SUCCESS 1 in 2.85 seconds
2020-11-06 09:10:16.396533 (MainThread): On master: COMMIT
2020-11-06 09:10:16.397533 (MainThread): Using snowflake connection "master".
2020-11-06 09:10:16.398033 (MainThread): On master: COMMIT
2020-11-06 09:10:16.682891 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2020-11-06 09:10:16.682891 (MainThread): On master: Close
2020-11-06 09:10:16.916970 (MainThread): 10:10:16 | 
2020-11-06 09:10:16.918467 (MainThread): 10:10:16 | Finished running 3 table models, 1 incremental model, 1 view model in 57.14s.
2020-11-06 09:10:16.923953 (MainThread): Connection 'master' was properly closed.
2020-11-06 09:10:16.925453 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-06 09:10:16.926454 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-06 09:10:16.926954 (MainThread): Connection 'model.cko_dbt_am.view_pageviews_history_Latest_PostCode' was properly closed.
2020-11-06 09:10:17.120010 (MainThread): 
2020-11-06 09:10:17.191019 (MainThread): Completed with 1 error and 0 warnings:
2020-11-06 09:10:17.247526 (MainThread): 
2020-11-06 09:10:17.250026 (MainThread): Database Error in model view_pageviews_history_Latest_PostCode (models\view_pageviews_history_Latest_PostCode.sql)
2020-11-06 09:10:17.255027 (MainThread):   002028 (42601): SQL compilation error:
2020-11-06 09:10:17.264028 (MainThread):   ambiguous column name 'CUSTOMER_POSTCODE'
2020-11-06 09:10:17.266029 (MainThread):   compiled SQL at target\run\cko_dbt_am\models\view_pageviews_history_Latest_PostCode.sql
2020-11-06 09:10:17.269529 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2020-11-06 09:10:17.280030 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001919333A760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001919333A460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001919333AFD0>]}
2020-11-06 09:10:17.281031 (MainThread): Flushing usage events
2020-11-06 09:11:23.261698 (MainThread): Running with dbt=0.18.1
2020-11-06 09:11:23.992534 (MainThread): Loading KWallet
2020-11-06 09:11:23.998535 (MainThread): Loading SecretService
2020-11-06 09:11:24.005062 (MainThread): Loading Windows
2020-11-06 09:11:24.567764 (MainThread): Loading chainer
2020-11-06 09:11:24.573764 (MainThread): Loading macOS
2020-11-06 09:11:26.786365 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-06 09:11:26.791350 (MainThread): Tracking: tracking
2020-11-06 09:11:26.792351 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240DFFC4DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240DFFB77F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240DFFB7DC0>]}
2020-11-06 09:11:26.936430 (MainThread): Partial parsing not enabled
2020-11-06 09:11:26.945432 (MainThread): Parsing macros\adapters.sql
2020-11-06 09:11:27.197015 (MainThread): Parsing macros\catalog.sql
2020-11-06 09:11:27.214526 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-06 09:11:27.287058 (MainThread): Parsing macros\materializations\merge.sql
2020-11-06 09:11:27.304060 (MainThread): Parsing macros\materializations\table.sql
2020-11-06 09:11:27.336112 (MainThread): Parsing macros\materializations\view.sql
2020-11-06 09:11:27.369098 (MainThread): Parsing macros\core.sql
2020-11-06 09:11:27.399116 (MainThread): Parsing macros\adapters\common.sql
2020-11-06 09:11:27.779705 (MainThread): Parsing macros\etc\datetime.sql
2020-11-06 09:11:27.848245 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-06 09:11:27.856246 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-06 09:11:27.870230 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-06 09:11:27.887259 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-06 09:11:27.902266 (MainThread): Parsing macros\etc\query.sql
2020-11-06 09:11:27.911266 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-06 09:11:27.983813 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-06 09:11:28.089852 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-06 09:11:28.105359 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-06 09:11:28.168362 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-06 09:11:28.333429 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-06 09:11:28.540479 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-06 09:11:28.557482 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-06 09:11:28.710559 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-06 09:11:28.762579 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-06 09:11:28.803621 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-06 09:11:28.851622 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-06 09:11:28.873623 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-06 09:11:28.886635 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-06 09:11:28.901663 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-06 09:11:28.952650 (MainThread): Partial parsing not enabled
2020-11-06 09:11:29.237775 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 09:11:29.381327 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemeral".
2020-11-06 09:11:29.462843 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 09:11:29.671898 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 09:11:29.776911 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 09:11:29.852422 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_ephemeral".
2020-11-06 09:11:29.938933 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.view_pageviews_history_Latest_PostCode".
2020-11-06 09:11:30.754035 (MainThread): WARNING: Found documentation for resource "my_first_dbt_model" which was not found or is disabled
2020-11-06 09:11:30.754535 (MainThread): WARNING: Found documentation for resource "my_second_dbt_model" which was not found or is disabled
2020-11-06 09:11:30.755034 (MainThread): [WARNING]: Test 'test.cko_dbt_am.unique_my_first_dbt_model_id' (models\schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2020-11-06 09:11:30.823543 (MainThread): [WARNING]: Test 'test.cko_dbt_am.not_null_my_first_dbt_model_id' (models\schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2020-11-06 09:11:30.835044 (MainThread): [WARNING]: Test 'test.cko_dbt_am.unique_my_second_dbt_model_id' (models\schema.yml) depends on a node named 'my_second_dbt_model' which was not found
2020-11-06 09:11:30.837544 (MainThread): [WARNING]: Test 'test.cko_dbt_am.not_null_my_second_dbt_model_id' (models\schema.yml) depends on a node named 'my_second_dbt_model' which was not found
2020-11-06 09:11:30.939557 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-06 09:11:31.086577 (MainThread): Found 7 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-06 09:11:31.092578 (MainThread): 
2020-11-06 09:11:31.095078 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 09:11:31.116080 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-06 09:11:31.181588 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-06 09:11:31.181588 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-06 09:11:31.182088 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-06 09:11:32.669062 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 1.49 seconds
2020-11-06 09:11:32.696079 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-06 09:11:33.254432 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 09:11:33.299451 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 09:11:33.300451 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-06 09:11:33.300451 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-06 09:11:35.635799 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 2.34 seconds
2020-11-06 09:11:35.654819 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-06 09:11:35.878815 (MainThread): Using snowflake connection "master".
2020-11-06 09:11:35.879815 (MainThread): On master: BEGIN
2020-11-06 09:11:35.879815 (MainThread): Opening a new connection, currently in state init
2020-11-06 09:11:38.011763 (MainThread): SQL status: SUCCESS 1 in 2.13 seconds
2020-11-06 09:11:38.012764 (MainThread): On master: COMMIT
2020-11-06 09:11:38.013764 (MainThread): Using snowflake connection "master".
2020-11-06 09:11:38.014264 (MainThread): On master: COMMIT
2020-11-06 09:11:38.799702 (MainThread): SQL status: SUCCESS 1 in 0.78 seconds
2020-11-06 09:11:38.800701 (MainThread): On master: Close
2020-11-06 09:11:39.551864 (MainThread): 10:11:39 | Concurrency: 1 threads (target='dev')
2020-11-06 09:11:39.553847 (MainThread): 10:11:39 | 
2020-11-06 09:11:39.588866 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemeral
2020-11-06 09:11:39.590853 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemeral".
2020-11-06 09:11:39.591850 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemeral
2020-11-06 09:11:39.701379 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemeral"
2020-11-06 09:11:39.705378 (Thread-1): finished collecting timing info
2020-11-06 09:11:39.708379 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemeral
2020-11-06 09:11:39.708379 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-06 09:11:39.716393 (Thread-1): 10:11:39 | 1 of 5 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-06 09:11:39.719392 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 09:11:39.720393 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-06 09:11:39.766408 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-06 09:11:39.770407 (Thread-1): finished collecting timing info
2020-11-06 09:11:39.988942 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-06 09:11:40.004944 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 09:11:40.005444 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-06 09:11:40.005943 (Thread-1): Opening a new connection, currently in state init
2020-11-06 09:11:42.050316 (Thread-1): SQL status: SUCCESS 1 in 2.04 seconds
2020-11-06 09:11:42.051298 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 09:11:42.052316 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        Round(O_CustKEY/100000.0,0)*100000 as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1000"."ORDERS"
    WHERE  DATEADD(year,25,O_orderdate)>DATEADD(month,-1,current_Date()) and DATEADD(year,25,O_orderdate)<DATEADD(month,1,current_Date())


    ) pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-06 09:11:52.657532 (Thread-1): SQL status: SUCCESS 1 in 10.61 seconds
2020-11-06 09:11:52.663033 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-06 09:11:52.664533 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 09:11:52.665032 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-06 09:11:52.885602 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2020-11-06 09:11:52.966134 (Thread-1): finished collecting timing info
2020-11-06 09:11:52.967633 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-06 09:11:53.257751 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fc9fe99-aaad-411c-bd88-be97fa2b6b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E05416A0>]}
2020-11-06 09:11:53.263752 (Thread-1): 10:11:53 | 1 of 5 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 13.54s]
2020-11-06 09:11:53.266738 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-06 09:11:53.268236 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-06 09:11:53.278763 (Thread-1): 10:11:53 | 2 of 5 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-06 09:11:53.280748 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 09:11:53.281748 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-06 09:11:53.326766 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-06 09:11:53.330750 (Thread-1): finished collecting timing info
2020-11-06 09:11:53.359795 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-06 09:11:53.366296 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 09:11:53.366796 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-06 09:11:53.367296 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 09:11:55.312341 (Thread-1): SQL status: SUCCESS 1 in 1.95 seconds
2020-11-06 09:11:55.313341 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 09:11:55.314340 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as Customer_postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1000"."CUSTOMER"
      );
2020-11-06 09:12:03.501335 (Thread-1): SQL status: SUCCESS 1 in 8.19 seconds
2020-11-06 09:12:03.507347 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-06 09:12:03.508347 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 09:12:03.509347 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-06 09:12:03.660389 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-11-06 09:12:03.672391 (Thread-1): finished collecting timing info
2020-11-06 09:12:03.673391 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-06 09:12:04.626670 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fc9fe99-aaad-411c-bd88-be97fa2b6b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E0683370>]}
2020-11-06 09:12:04.633670 (Thread-1): 10:12:04 | 2 of 5 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 11.34s]
2020-11-06 09:12:04.636670 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-06 09:12:04.637670 (Thread-1): Began running node model.cko_dbt_am.users_extract_ephemeral
2020-11-06 09:12:04.639671 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_ephemeral".
2020-11-06 09:12:04.640671 (Thread-1): Compiling model.cko_dbt_am.users_extract_ephemeral
2020-11-06 09:12:04.735698 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_ephemeral"
2020-11-06 09:12:04.738699 (Thread-1): finished collecting timing info
2020-11-06 09:12:04.742700 (Thread-1): Finished running node model.cko_dbt_am.users_extract_ephemeral
2020-11-06 09:12:04.744700 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 09:12:04.751699 (Thread-1): 10:12:04 | 3 of 5 START ephermeral model cko_dbt_am.pageviews_history_ephemeral. [RUN]
2020-11-06 09:12:04.754700 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 09:12:04.754700 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 09:12:04.839730 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-06 09:12:04.845230 (Thread-1): finished collecting timing info
2020-11-06 09:12:04.863733 (Thread-1): finished collecting timing info
2020-11-06 09:12:04.865733 (Thread-1): Compilation Error in model pageviews_history_ephemeral (models\pageviews_history_ephemeral.sql)
  No materialization 'ephermeral' was found for adapter snowflake! (searched types 'default' and 'snowflake')
Traceback (most recent call last):
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\task\run.py", line 222, in execute
    missing_materialization(model, self.adapter.type())
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\exceptions.py", line 611, in missing_materialization
    raise_compiler_error(
  File "c:\users\alexandre\anaconda3\lib\site-packages\dbt\exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model pageviews_history_ephemeral (models\pageviews_history_ephemeral.sql)
  No materialization 'ephermeral' was found for adapter snowflake! (searched types 'default' and 'snowflake')
2020-11-06 09:12:04.874234 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fc9fe99-aaad-411c-bd88-be97fa2b6b93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E0633880>]}
2020-11-06 09:12:04.888236 (Thread-1): 10:12:04 | 3 of 5 ERROR creating ephermeral model cko_dbt_am.pageviews_history_ephemeral [ERROR in 0.12s]
2020-11-06 09:12:04.894736 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 09:12:04.898737 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-06 09:12:04.900736 (Thread-1): 10:12:04 | 4 of 5 SKIP relation cko_dbt_am.pageviews_history.................... [SKIP]
2020-11-06 09:12:04.902236 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-06 09:12:04.903737 (Thread-1): Began running node model.cko_dbt_am.view_pageviews_history_Latest_PostCode
2020-11-06 09:12:04.904236 (Thread-1): 10:12:04 | 5 of 5 SKIP relation cko_dbt_am.view_pageviews_history_Latest_PostCode [SKIP]
2020-11-06 09:12:04.907237 (Thread-1): Finished running node model.cko_dbt_am.view_pageviews_history_Latest_PostCode
2020-11-06 09:12:04.910737 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 09:12:04.911237 (MainThread): Using snowflake connection "master".
2020-11-06 09:12:04.911737 (MainThread): On master: BEGIN
2020-11-06 09:12:04.912238 (MainThread): Opening a new connection, currently in state closed
2020-11-06 09:12:06.171477 (MainThread): SQL status: SUCCESS 1 in 1.26 seconds
2020-11-06 09:12:06.171477 (MainThread): On master: COMMIT
2020-11-06 09:12:06.172478 (MainThread): Using snowflake connection "master".
2020-11-06 09:12:06.173477 (MainThread): On master: COMMIT
2020-11-06 09:12:06.481620 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2020-11-06 09:12:06.482621 (MainThread): On master: Close
2020-11-06 09:12:06.693635 (MainThread): unclosed <socket.socket fd=1316, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.5.101', 53504), raddr=('168.63.27.166', 443)>
2020-11-06 09:12:06.701640 (MainThread): 10:12:06 | 
2020-11-06 09:12:06.704641 (MainThread): 10:12:06 | Finished running 2 table models, 1 ephermeral model, 1 incremental model, 1 view model in 35.61s.
2020-11-06 09:12:06.710641 (MainThread): Connection 'master' was properly closed.
2020-11-06 09:12:06.712640 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-06 09:12:06.713640 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-06 09:12:06.713640 (MainThread): Connection 'model.cko_dbt_am.pageviews_history_ephemeral' was properly closed.
2020-11-06 09:12:06.808695 (MainThread): 
2020-11-06 09:12:06.811695 (MainThread): Completed with 1 error and 0 warnings:
2020-11-06 09:12:06.822697 (MainThread): 
2020-11-06 09:12:06.826697 (MainThread): Compilation Error in model pageviews_history_ephemeral (models\pageviews_history_ephemeral.sql)
2020-11-06 09:12:06.829696 (MainThread):   No materialization 'ephermeral' was found for adapter snowflake! (searched types 'default' and 'snowflake')
2020-11-06 09:12:06.831698 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=2 TOTAL=5
2020-11-06 09:12:06.834696 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E063C550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E0693A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240E0693BB0>]}
2020-11-06 09:12:06.840697 (MainThread): Flushing usage events
2020-11-06 09:12:28.429745 (MainThread): Running with dbt=0.18.1
2020-11-06 09:12:29.166305 (MainThread): Loading KWallet
2020-11-06 09:12:29.173304 (MainThread): Loading SecretService
2020-11-06 09:12:29.180305 (MainThread): Loading Windows
2020-11-06 09:12:29.722550 (MainThread): Loading chainer
2020-11-06 09:12:29.726551 (MainThread): Loading macOS
2020-11-06 09:12:31.845572 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-06 09:12:31.850588 (MainThread): Tracking: tracking
2020-11-06 09:12:31.851588 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020068AC4A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020068AAC7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020068AACE50>]}
2020-11-06 09:12:31.998206 (MainThread): Partial parsing not enabled
2020-11-06 09:12:32.007208 (MainThread): Parsing macros\adapters.sql
2020-11-06 09:12:32.321297 (MainThread): Parsing macros\catalog.sql
2020-11-06 09:12:32.342300 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-06 09:12:32.474814 (MainThread): Parsing macros\materializations\merge.sql
2020-11-06 09:12:32.492817 (MainThread): Parsing macros\materializations\table.sql
2020-11-06 09:12:32.525323 (MainThread): Parsing macros\materializations\view.sql
2020-11-06 09:12:32.556342 (MainThread): Parsing macros\core.sql
2020-11-06 09:12:32.588345 (MainThread): Parsing macros\adapters\common.sql
2020-11-06 09:12:32.914968 (MainThread): Parsing macros\etc\datetime.sql
2020-11-06 09:12:32.985996 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-06 09:12:32.993977 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-06 09:12:33.006996 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-06 09:12:33.022997 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-06 09:12:33.035980 (MainThread): Parsing macros\etc\query.sql
2020-11-06 09:12:33.044981 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-06 09:12:33.117039 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-06 09:12:33.256069 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-06 09:12:33.272583 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-06 09:12:33.327098 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-06 09:12:33.580655 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-06 09:12:33.841189 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-06 09:12:33.856691 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-06 09:12:34.036714 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-06 09:12:34.095722 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-06 09:12:34.122222 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-06 09:12:34.159728 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-06 09:12:34.171228 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-06 09:12:34.177229 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-06 09:12:34.197232 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-06 09:12:34.226236 (MainThread): Partial parsing not enabled
2020-11-06 09:12:34.380755 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 09:12:34.458765 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemeral".
2020-11-06 09:12:34.499271 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 09:12:34.563279 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 09:12:34.612286 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 09:12:34.654789 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_ephemeral".
2020-11-06 09:12:34.695796 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.view_pageviews_history_Latest_PostCode".
2020-11-06 09:12:35.224863 (MainThread): WARNING: Found documentation for resource "my_first_dbt_model" which was not found or is disabled
2020-11-06 09:12:35.224863 (MainThread): WARNING: Found documentation for resource "my_second_dbt_model" which was not found or is disabled
2020-11-06 09:12:35.225362 (MainThread): [WARNING]: Test 'test.cko_dbt_am.unique_my_first_dbt_model_id' (models\schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2020-11-06 09:12:35.233864 (MainThread): [WARNING]: Test 'test.cko_dbt_am.not_null_my_first_dbt_model_id' (models\schema.yml) depends on a node named 'my_first_dbt_model' which was not found
2020-11-06 09:12:35.238364 (MainThread): [WARNING]: Test 'test.cko_dbt_am.unique_my_second_dbt_model_id' (models\schema.yml) depends on a node named 'my_second_dbt_model' which was not found
2020-11-06 09:12:35.241863 (MainThread): [WARNING]: Test 'test.cko_dbt_am.not_null_my_second_dbt_model_id' (models\schema.yml) depends on a node named 'my_second_dbt_model' which was not found
2020-11-06 09:12:35.357879 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.cko_dbt_am.example

2020-11-06 09:12:35.501897 (MainThread): Found 7 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-06 09:12:35.511399 (MainThread): 
2020-11-06 09:12:35.513900 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 09:12:35.534901 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-06 09:12:35.578909 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-06 09:12:35.579408 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-06 09:12:35.579408 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-06 09:12:38.121821 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.54 seconds
2020-11-06 09:12:38.150821 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-06 09:12:40.153079 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 09:12:40.214080 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 09:12:40.215082 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-06 09:12:40.215082 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-06 09:12:42.307545 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 3 in 2.09 seconds
2020-11-06 09:12:42.335046 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-06 09:12:42.711326 (MainThread): Using snowflake connection "master".
2020-11-06 09:12:42.712325 (MainThread): On master: BEGIN
2020-11-06 09:12:42.712325 (MainThread): Opening a new connection, currently in state init
2020-11-06 09:12:44.973868 (MainThread): SQL status: SUCCESS 1 in 2.26 seconds
2020-11-06 09:12:44.978852 (MainThread): On master: COMMIT
2020-11-06 09:12:44.979853 (MainThread): Using snowflake connection "master".
2020-11-06 09:12:44.979853 (MainThread): On master: COMMIT
2020-11-06 09:12:45.268250 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2020-11-06 09:12:45.269261 (MainThread): On master: Close
2020-11-06 09:12:45.544948 (MainThread): 10:12:45 | Concurrency: 1 threads (target='dev')
2020-11-06 09:12:45.546947 (MainThread): 10:12:45 | 
2020-11-06 09:12:45.608976 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemeral
2020-11-06 09:12:45.613976 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemeral".
2020-11-06 09:12:45.614975 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemeral
2020-11-06 09:12:45.803015 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemeral"
2020-11-06 09:12:45.809016 (Thread-1): finished collecting timing info
2020-11-06 09:12:45.815016 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemeral
2020-11-06 09:12:45.816017 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-06 09:12:45.828016 (Thread-1): 10:12:45 | 1 of 4 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-06 09:12:45.833019 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 09:12:45.834020 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-06 09:12:45.895045 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-06 09:12:45.899045 (Thread-1): finished collecting timing info
2020-11-06 09:12:46.150105 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-06 09:12:46.173128 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 09:12:46.174130 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-06 09:12:46.174130 (Thread-1): Opening a new connection, currently in state init
2020-11-06 09:12:47.968300 (Thread-1): SQL status: SUCCESS 1 in 1.79 seconds
2020-11-06 09:12:47.969299 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 09:12:47.970298 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 

SELECT * FROM 

    (Select 

        Round(O_CustKEY/100000.0,0)*100000 as user_id,
        'www.website.com/'||O_CLERK as URL,
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



    from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1000"."ORDERS"
    WHERE  DATEADD(year,25,O_orderdate)>DATEADD(month,-1,current_Date()) and DATEADD(year,25,O_orderdate)<DATEADD(month,1,current_Date())


    ) pageview

WHERE DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-06 09:12:55.845182 (Thread-1): SQL status: SUCCESS 1 in 7.87 seconds
2020-11-06 09:12:55.848182 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-06 09:12:55.848682 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 09:12:55.849182 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-06 09:12:55.988699 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-06 09:12:56.019703 (Thread-1): finished collecting timing info
2020-11-06 09:12:56.020204 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-06 09:12:56.629292 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '372ca461-2636-4ed3-a53e-b47d22126aa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020069047430>]}
2020-11-06 09:12:56.631802 (Thread-1): 10:12:56 | 1 of 4 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 10.80s]
2020-11-06 09:12:56.634802 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-06 09:12:56.635302 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-06 09:12:56.637804 (Thread-1): 10:12:56 | 2 of 4 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-06 09:12:56.643805 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 09:12:56.644304 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-06 09:12:56.660312 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-06 09:12:56.661312 (Thread-1): finished collecting timing info
2020-11-06 09:12:56.675313 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-06 09:12:56.677313 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 09:12:56.678314 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-06 09:12:56.678314 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 09:12:58.115767 (Thread-1): SQL status: SUCCESS 1 in 1.44 seconds
2020-11-06 09:12:58.115767 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 09:12:58.115767 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 
select C_CustKey as id ,C_ADDRESS as Customer_postcode from "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1000"."CUSTOMER"
      );
2020-11-06 09:13:07.246957 (Thread-1): SQL status: SUCCESS 1 in 9.13 seconds
2020-11-06 09:13:07.248956 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-06 09:13:07.249458 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 09:13:07.249958 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-06 09:13:07.396976 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2020-11-06 09:13:07.401475 (Thread-1): finished collecting timing info
2020-11-06 09:13:07.401976 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-06 09:13:07.625504 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '372ca461-2636-4ed3-a53e-b47d22126aa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200691328B0>]}
2020-11-06 09:13:07.628004 (Thread-1): 10:13:07 | 2 of 4 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 10.98s]
2020-11-06 09:13:07.649007 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-06 09:13:07.649508 (Thread-1): Began running node model.cko_dbt_am.users_extract_ephemeral
2020-11-06 09:13:07.650008 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_ephemeral".
2020-11-06 09:13:07.650508 (Thread-1): Compiling model.cko_dbt_am.users_extract_ephemeral
2020-11-06 09:13:07.678012 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_ephemeral"
2020-11-06 09:13:07.679511 (Thread-1): finished collecting timing info
2020-11-06 09:13:07.680512 (Thread-1): Finished running node model.cko_dbt_am.users_extract_ephemeral
2020-11-06 09:13:07.681511 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 09:13:07.682012 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 09:13:07.682512 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 09:13:07.752020 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-06 09:13:07.754520 (Thread-1): finished collecting timing info
2020-11-06 09:13:07.756021 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 09:13:07.758522 (Thread-1): Began running node model.cko_dbt_am.pageviews_history
2020-11-06 09:13:07.761022 (Thread-1): 10:13:07 | 3 of 4 START incremental model cko_dbt_am.pageviews_history.......... [RUN]
2020-11-06 09:13:07.864037 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 09:13:07.864536 (Thread-1): Compiling model.cko_dbt_am.pageviews_history
2020-11-06 09:13:07.897560 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-06 09:13:07.953067 (Thread-1): finished collecting timing info
2020-11-06 09:13:08.100127 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 09:13:08.101628 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    

      create or replace temporary table analytics.cko_dbt_am.pageviews_history__dbt_tmp  as
      (with __dbt__CTE__pageviews_extract_ephemeral as (
/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
),  __dbt__CTE__users_extract_ephemeral as (
-- Use the `ref` function to select from other models


with active_user as (Select Distinct user_id FROM __dbt__CTE__pageviews_extract_ephemeral)


select *
From "ANALYTICS"."CKO_DBT_AM"."USERS_EXTRACT"

where id in (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_ephemeral as (
-- Use the `ref` function to select from other models



SELECT 
	pageviews.*
	,customer_postcode
FROM  __dbt__CTE__pageviews_extract_ephemeral pageviews
LEFT OUTER JOIN __dbt__CTE__users_extract_ephemeral users  on users.id=pageviews.user_id
)/* Config line */

 
		Select * FROM __dbt__CTE__pageviews_history_ephemeral


	WHERE PAGEVIEW_DATE_HOUR > (select max(PAGEVIEW_DATE_HOUR) from analytics.cko_dbt_am.pageviews_history)

      );
2020-11-06 09:13:08.102128 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 09:13:15.190806 (Thread-1): SQL status: SUCCESS 1 in 7.09 seconds
2020-11-06 09:13:15.213807 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 09:13:15.213807 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history__dbt_tmp
2020-11-06 09:13:15.398831 (Thread-1): SQL status: SUCCESS 5 in 0.18 seconds
2020-11-06 09:13:15.405831 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 09:13:15.405831 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history
2020-11-06 09:13:15.578355 (Thread-1): SQL status: SUCCESS 5 in 0.17 seconds
2020-11-06 09:13:15.585355 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 09:13:15.585855 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */

    describe table analytics.cko_dbt_am.pageviews_history
2020-11-06 09:13:15.743376 (Thread-1): SQL status: SUCCESS 5 in 0.16 seconds
2020-11-06 09:13:15.776878 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_history"
2020-11-06 09:13:15.781379 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 09:13:15.781881 (Thread-1): On model.cko_dbt_am.pageviews_history: BEGIN
2020-11-06 09:13:16.116428 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2020-11-06 09:13:16.117428 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 09:13:16.117428 (Thread-1): On model.cko_dbt_am.pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_history"} */


        insert into analytics.cko_dbt_am.pageviews_history ("USER_ID", "PAGEVIEW_DATE_HOUR", "COUNT_PAGEVIEWS", "COUNT_DISCTINT_PAGEVIEWS", "CUSTOMER_POSTCODE")
        (
            select "USER_ID", "PAGEVIEW_DATE_HOUR", "COUNT_PAGEVIEWS", "COUNT_DISCTINT_PAGEVIEWS", "CUSTOMER_POSTCODE"
            from analytics.cko_dbt_am.pageviews_history__dbt_tmp
        );
2020-11-06 09:13:16.698628 (Thread-1): SQL status: SUCCESS 0 in 0.58 seconds
2020-11-06 09:13:16.700627 (Thread-1): On model.cko_dbt_am.pageviews_history: COMMIT
2020-11-06 09:13:16.701627 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_history".
2020-11-06 09:13:16.701627 (Thread-1): On model.cko_dbt_am.pageviews_history: COMMIT
2020-11-06 09:13:17.012741 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2020-11-06 09:13:17.025740 (Thread-1): finished collecting timing info
2020-11-06 09:13:17.025740 (Thread-1): On model.cko_dbt_am.pageviews_history: Close
2020-11-06 09:13:17.314281 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '372ca461-2636-4ed3-a53e-b47d22126aa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020069181880>]}
2020-11-06 09:13:17.317282 (Thread-1): 10:13:17 | 3 of 4 OK created incremental model cko_dbt_am.pageviews_history..... [SUCCESS 0 in 9.45s]
2020-11-06 09:13:17.323282 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history
2020-11-06 09:13:17.324282 (Thread-1): Began running node model.cko_dbt_am.view_pageviews_history_Latest_PostCode
2020-11-06 09:13:17.326783 (Thread-1): 10:13:17 | 4 of 4 START view model cko_dbt_am.view_pageviews_history_Latest_PostCode [RUN]
2020-11-06 09:13:17.360789 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.view_pageviews_history_Latest_PostCode".
2020-11-06 09:13:17.361288 (Thread-1): Compiling model.cko_dbt_am.view_pageviews_history_Latest_PostCode
2020-11-06 09:13:17.382290 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.view_pageviews_history_Latest_PostCode"
2020-11-06 09:13:17.383790 (Thread-1): finished collecting timing info
2020-11-06 09:13:17.471802 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.view_pageviews_history_Latest_PostCode"
2020-11-06 09:13:17.474800 (Thread-1): Using snowflake connection "model.cko_dbt_am.view_pageviews_history_Latest_PostCode".
2020-11-06 09:13:17.475301 (Thread-1): On model.cko_dbt_am.view_pageviews_history_Latest_PostCode: BEGIN
2020-11-06 09:13:17.475802 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 09:13:18.954025 (Thread-1): SQL status: SUCCESS 1 in 1.48 seconds
2020-11-06 09:13:18.955042 (Thread-1): Using snowflake connection "model.cko_dbt_am.view_pageviews_history_Latest_PostCode".
2020-11-06 09:13:18.955042 (Thread-1): On model.cko_dbt_am.view_pageviews_history_Latest_PostCode: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.view_pageviews_history_Latest_PostCode"} */

  create or replace  view analytics.cko_dbt_am.view_pageviews_history_Latest_PostCode  as (
    -- Use the `ref` function to select from other models



SELECT 
	pageviews.*
	,users.customer_postcode as Latest_Post_code
FROM  analytics.cko_dbt_am.pageviews_history pageviews
LEFT OUTER JOIN "ANALYTICS"."CKO_DBT_AM"."USERS_EXTRACT" users  on users.id=pageviews.user_id
  );
2020-11-06 09:13:19.403435 (Thread-1): SQL status: SUCCESS 1 in 0.45 seconds
2020-11-06 09:13:19.408436 (Thread-1): On model.cko_dbt_am.view_pageviews_history_Latest_PostCode: COMMIT
2020-11-06 09:13:19.409435 (Thread-1): Using snowflake connection "model.cko_dbt_am.view_pageviews_history_Latest_PostCode".
2020-11-06 09:13:19.409435 (Thread-1): On model.cko_dbt_am.view_pageviews_history_Latest_PostCode: COMMIT
2020-11-06 09:13:19.549132 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2020-11-06 09:13:19.570134 (Thread-1): finished collecting timing info
2020-11-06 09:13:19.571134 (Thread-1): On model.cko_dbt_am.view_pageviews_history_Latest_PostCode: Close
2020-11-06 09:13:19.785089 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '372ca461-2636-4ed3-a53e-b47d22126aa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200691E9250>]}
2020-11-06 09:13:19.791089 (Thread-1): 10:13:19 | 4 of 4 OK created view model cko_dbt_am.view_pageviews_history_Latest_PostCode [SUCCESS 1 in 2.42s]
2020-11-06 09:13:19.793537 (Thread-1): Finished running node model.cko_dbt_am.view_pageviews_history_Latest_PostCode
2020-11-06 09:13:19.799546 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 09:13:19.800547 (MainThread): Using snowflake connection "master".
2020-11-06 09:13:19.801547 (MainThread): On master: BEGIN
2020-11-06 09:13:19.801547 (MainThread): Opening a new connection, currently in state closed
2020-11-06 09:13:21.384562 (MainThread): SQL status: SUCCESS 1 in 1.58 seconds
2020-11-06 09:13:21.385560 (MainThread): On master: COMMIT
2020-11-06 09:13:21.386561 (MainThread): Using snowflake connection "master".
2020-11-06 09:13:21.387562 (MainThread): On master: COMMIT
2020-11-06 09:13:22.723326 (MainThread): SQL status: SUCCESS 1 in 1.33 seconds
2020-11-06 09:13:22.723326 (MainThread): On master: Close
2020-11-06 09:13:23.234469 (MainThread): 10:13:23 | 
2020-11-06 09:13:23.235469 (MainThread): 10:13:23 | Finished running 2 table models, 1 incremental model, 1 view model in 47.72s.
2020-11-06 09:13:23.237469 (MainThread): Connection 'master' was properly closed.
2020-11-06 09:13:23.237469 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-06 09:13:23.237469 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-06 09:13:23.238469 (MainThread): Connection 'model.cko_dbt_am.view_pageviews_history_Latest_PostCode' was properly closed.
2020-11-06 09:13:23.278472 (MainThread): 
2020-11-06 09:13:23.282980 (MainThread): Completed successfully
2020-11-06 09:13:23.285481 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-11-06 09:13:23.286980 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200691A0D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200691A0D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200691A0AC0>]}
2020-11-06 09:13:23.287481 (MainThread): Flushing usage events
2020-11-06 09:41:40.310813 (MainThread): Running with dbt=0.18.1
2020-11-06 09:41:40.640599 (MainThread): Loading KWallet
2020-11-06 09:41:40.643599 (MainThread): Loading SecretService
2020-11-06 09:41:40.646117 (MainThread): Loading Windows
2020-11-06 09:41:41.312116 (MainThread): Loading chainer
2020-11-06 09:41:41.314617 (MainThread): Loading macOS
2020-11-06 09:41:46.271986 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Alexandre\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-11-06 09:41:46.281986 (MainThread): Tracking: tracking
2020-11-06 09:41:46.282487 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F21B2F5A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F21B2E55B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F21B2E5DF0>]}
2020-11-06 09:41:46.467690 (MainThread): Partial parsing not enabled
2020-11-06 09:41:46.480692 (MainThread): Parsing macros\adapters.sql
2020-11-06 09:41:46.888243 (MainThread): Parsing macros\catalog.sql
2020-11-06 09:41:46.906745 (MainThread): Parsing macros\materializations\incremental.sql
2020-11-06 09:41:47.054291 (MainThread): Parsing macros\materializations\merge.sql
2020-11-06 09:41:47.068292 (MainThread): Parsing macros\materializations\table.sql
2020-11-06 09:41:47.092797 (MainThread): Parsing macros\materializations\view.sql
2020-11-06 09:41:47.135301 (MainThread): Parsing macros\core.sql
2020-11-06 09:41:47.238314 (MainThread): Parsing macros\adapters\common.sql
2020-11-06 09:41:47.508349 (MainThread): Parsing macros\etc\datetime.sql
2020-11-06 09:41:47.570357 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-11-06 09:41:47.575857 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-11-06 09:41:47.581858 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-11-06 09:41:47.588858 (MainThread): Parsing macros\etc\is_incremental.sql
2020-11-06 09:41:47.595360 (MainThread): Parsing macros\etc\query.sql
2020-11-06 09:41:47.599860 (MainThread): Parsing macros\materializations\helpers.sql
2020-11-06 09:41:47.642866 (MainThread): Parsing macros\materializations\common\merge.sql
2020-11-06 09:41:47.774381 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-11-06 09:41:47.794385 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-11-06 09:41:47.826889 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-11-06 09:41:48.024414 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-11-06 09:41:48.189935 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-11-06 09:41:48.198936 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-11-06 09:41:48.540979 (MainThread): Parsing macros\materializations\table\table.sql
2020-11-06 09:41:48.563982 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-11-06 09:41:48.620990 (MainThread): Parsing macros\materializations\view\view.sql
2020-11-06 09:41:48.640992 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-11-06 09:41:48.665496 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-11-06 09:41:48.670996 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-11-06 09:41:48.703500 (MainThread): Parsing macros\schema_tests\unique.sql
2020-11-06 09:41:48.758007 (MainThread): Partial parsing not enabled
2020-11-06 09:41:49.108053 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 09:41:49.311578 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemeral".
2020-11-06 09:41:49.393589 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 09:41:49.492101 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.tbl_pageviews_history".
2020-11-06 09:41:49.706654 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 09:41:49.784665 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_ephemeral".
2020-11-06 09:41:49.963686 (MainThread): Acquiring new snowflake connection "model.cko_dbt_am.view_pageviews_history_Latest_PostCode".
2020-11-06 09:41:51.483379 (MainThread): Found 7 models, 3 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2020-11-06 09:41:51.546387 (MainThread): 
2020-11-06 09:41:51.619898 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 09:41:51.764915 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_analytics".
2020-11-06 09:41:51.945438 (ThreadPoolExecutor-0_0): Using snowflake connection "list_analytics".
2020-11-06 09:41:51.945438 (ThreadPoolExecutor-0_0): On list_analytics: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics"} */

    show terse schemas in database analytics
    limit 10000
2020-11-06 09:41:51.945939 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-11-06 09:41:54.035593 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 3 in 2.09 seconds
2020-11-06 09:41:54.047595 (ThreadPoolExecutor-0_0): On list_analytics: Close
2020-11-06 09:41:54.470742 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 09:41:54.491746 (ThreadPoolExecutor-1_0): Using snowflake connection "list_analytics_cko_dbt_am".
2020-11-06 09:41:54.492245 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "connection_name": "list_analytics_cko_dbt_am"} */

    show terse objects in analytics.cko_dbt_am
2020-11-06 09:41:54.492245 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-11-06 09:41:56.195513 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 4 in 1.70 seconds
2020-11-06 09:41:56.206015 (ThreadPoolExecutor-1_0): On list_analytics_cko_dbt_am: Close
2020-11-06 09:41:56.710349 (MainThread): Using snowflake connection "master".
2020-11-06 09:41:56.710849 (MainThread): On master: BEGIN
2020-11-06 09:41:56.711350 (MainThread): Opening a new connection, currently in state init
2020-11-06 09:41:58.679115 (MainThread): SQL status: SUCCESS 1 in 1.97 seconds
2020-11-06 09:41:58.679615 (MainThread): On master: COMMIT
2020-11-06 09:41:58.680115 (MainThread): Using snowflake connection "master".
2020-11-06 09:41:58.680115 (MainThread): On master: COMMIT
2020-11-06 09:41:58.981153 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2020-11-06 09:41:58.981652 (MainThread): On master: Close
2020-11-06 09:41:59.675254 (MainThread): unclosed <socket.socket fd=1436, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.5.101', 54213), raddr=('168.63.27.166', 443)>
2020-11-06 09:42:00.554968 (MainThread): 10:42:00 | Concurrency: 1 threads (target='dev')
2020-11-06 09:42:00.563968 (MainThread): 10:42:00 | 
2020-11-06 09:42:00.582969 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract_ephemeral
2020-11-06 09:42:00.583971 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract_ephemeral".
2020-11-06 09:42:00.583971 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract_ephemeral
2020-11-06 09:42:00.629972 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract_ephemeral"
2020-11-06 09:42:00.631971 (Thread-1): finished collecting timing info
2020-11-06 09:42:00.633972 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract_ephemeral
2020-11-06 09:42:00.633972 (Thread-1): Began running node model.cko_dbt_am.pageviews_extract
2020-11-06 09:42:00.637478 (Thread-1): 10:42:00 | 1 of 4 START table model cko_dbt_am.pageviews_extract................ [RUN]
2020-11-06 09:42:00.638979 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 09:42:00.639479 (Thread-1): Compiling model.cko_dbt_am.pageviews_extract
2020-11-06 09:42:00.668483 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-06 09:42:00.670486 (Thread-1): finished collecting timing info
2020-11-06 09:42:00.754494 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.pageviews_extract"
2020-11-06 09:42:00.759995 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 09:42:00.759995 (Thread-1): On model.cko_dbt_am.pageviews_extract: BEGIN
2020-11-06 09:42:00.760495 (Thread-1): Opening a new connection, currently in state init
2020-11-06 09:42:02.069290 (Thread-1): SQL status: SUCCESS 1 in 1.31 seconds
2020-11-06 09:42:02.069290 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 09:42:02.069290 (Thread-1): On model.cko_dbt_am.pageviews_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.pageviews_extract"} */


      create or replace transient table analytics.cko_dbt_am.pageviews_extract  as
      (

   	/*SELECT & SHAPE snowflake's sample data to create a test Pageviews_Extract dataset */

SELECT * 
FROM 

    (
    	SELECT 

        Round(O_CustKEY/100000.0,0)*100000 as user_id, 
        'www.website.com/'||O_CLERK as URL,
        
        	/*Create a timestamp as not available in orginal dataset*/
        (DATEADD(year,25,O_orderdate):: VARCHAR ||' '|| (TIME(cast(uniform(1, 31535999, random()) as datetime))):: VARCHAR) ::datetime as  pageview_datetime



     	FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1000"."ORDERS"


    	WHERE  
			/*Limit the number of rows*/
    	DATEADD(year,25,O_orderdate)>DATEADD(month,-1,current_Date()) AND DATEADD(year,25,O_orderdate)<DATEADD(month,1,current_Date())


    ) pageview

WHERE 
/*Limit the number of rows*/
DATEADD(hour,-100,LOCALTIMESTAMP())<pageview_Datetime AND pageview_Datetime<LOCALTIMESTAMP()
      );
2020-11-06 09:42:18.628171 (Thread-1): SQL status: SUCCESS 1 in 16.56 seconds
2020-11-06 09:42:18.633189 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-06 09:42:18.634174 (Thread-1): Using snowflake connection "model.cko_dbt_am.pageviews_extract".
2020-11-06 09:42:18.635173 (Thread-1): On model.cko_dbt_am.pageviews_extract: COMMIT
2020-11-06 09:42:18.899809 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2020-11-06 09:42:18.982354 (Thread-1): finished collecting timing info
2020-11-06 09:42:18.983855 (Thread-1): On model.cko_dbt_am.pageviews_extract: Close
2020-11-06 09:42:19.255826 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f006fdbd-c479-425d-92d9-6181c9312d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F21B8FC220>]}
2020-11-06 09:42:19.261827 (Thread-1): 10:42:19 | 1 of 4 OK created table model cko_dbt_am.pageviews_extract........... [SUCCESS 1 in 18.61s]
2020-11-06 09:42:19.269840 (Thread-1): Finished running node model.cko_dbt_am.pageviews_extract
2020-11-06 09:42:19.271338 (Thread-1): Began running node model.cko_dbt_am.users_extract
2020-11-06 09:42:19.278342 (Thread-1): 10:42:19 | 2 of 4 START table model cko_dbt_am.users_extract.................... [RUN]
2020-11-06 09:42:19.281339 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 09:42:19.281839 (Thread-1): Compiling model.cko_dbt_am.users_extract
2020-11-06 09:42:19.335853 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract"
2020-11-06 09:42:19.339853 (Thread-1): finished collecting timing info
2020-11-06 09:42:19.381868 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.users_extract"
2020-11-06 09:42:19.388880 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 09:42:19.389880 (Thread-1): On model.cko_dbt_am.users_extract: BEGIN
2020-11-06 09:42:19.389880 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 09:42:21.576134 (Thread-1): SQL status: SUCCESS 1 in 2.19 seconds
2020-11-06 09:42:21.577133 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 09:42:21.578152 (Thread-1): On model.cko_dbt_am.users_extract: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.users_extract"} */


      create or replace transient table analytics.cko_dbt_am.users_extract  as
      (

	/*SELECT & SHAPE snowflake's sample data to create a test Users_Extract dataset */

SELECT 
	
	 C_CustKey as id 
	 ,C_ADDRESS as Customer_postcode 

FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1000"."CUSTOMER"
      );
2020-11-06 09:42:38.381333 (Thread-1): SQL status: SUCCESS 1 in 16.80 seconds
2020-11-06 09:42:38.383833 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-06 09:42:38.384334 (Thread-1): Using snowflake connection "model.cko_dbt_am.users_extract".
2020-11-06 09:42:38.384334 (Thread-1): On model.cko_dbt_am.users_extract: COMMIT
2020-11-06 09:42:38.999730 (Thread-1): SQL status: SUCCESS 1 in 0.61 seconds
2020-11-06 09:42:39.004731 (Thread-1): finished collecting timing info
2020-11-06 09:42:39.005231 (Thread-1): On model.cko_dbt_am.users_extract: Close
2020-11-06 09:42:39.414674 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f006fdbd-c479-425d-92d9-6181c9312d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F21B902C70>]}
2020-11-06 09:42:39.417675 (Thread-1): 10:42:39 | 2 of 4 OK created table model cko_dbt_am.users_extract............... [SUCCESS 1 in 20.13s]
2020-11-06 09:42:39.433178 (Thread-1): Finished running node model.cko_dbt_am.users_extract
2020-11-06 09:42:39.433679 (Thread-1): Began running node model.cko_dbt_am.users_extract_ephemeral
2020-11-06 09:42:39.435178 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.users_extract_ephemeral".
2020-11-06 09:42:39.435178 (Thread-1): Compiling model.cko_dbt_am.users_extract_ephemeral
2020-11-06 09:42:39.470182 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.users_extract_ephemeral"
2020-11-06 09:42:39.472683 (Thread-1): finished collecting timing info
2020-11-06 09:42:39.474182 (Thread-1): Finished running node model.cko_dbt_am.users_extract_ephemeral
2020-11-06 09:42:39.476683 (Thread-1): Began running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 09:42:39.477683 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.pageviews_history_ephemeral".
2020-11-06 09:42:39.477683 (Thread-1): Compiling model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 09:42:39.510395 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.pageviews_history_ephemeral"
2020-11-06 09:42:39.566654 (Thread-1): finished collecting timing info
2020-11-06 09:42:39.567654 (Thread-1): Finished running node model.cko_dbt_am.pageviews_history_ephemeral
2020-11-06 09:42:39.569654 (Thread-1): Began running node model.cko_dbt_am.tbl_pageviews_history
2020-11-06 09:42:39.572654 (Thread-1): 10:42:39 | 3 of 4 START incremental model cko_dbt_am.tbl_pageviews_history...... [RUN]
2020-11-06 09:42:39.659165 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.tbl_pageviews_history".
2020-11-06 09:42:39.659665 (Thread-1): Compiling model.cko_dbt_am.tbl_pageviews_history
2020-11-06 09:42:39.691168 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.tbl_pageviews_history"
2020-11-06 09:42:39.693669 (Thread-1): finished collecting timing info
2020-11-06 09:42:39.969205 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.tbl_pageviews_history"
2020-11-06 09:42:40.093721 (Thread-1): Using snowflake connection "model.cko_dbt_am.tbl_pageviews_history".
2020-11-06 09:42:40.094221 (Thread-1): On model.cko_dbt_am.tbl_pageviews_history: BEGIN
2020-11-06 09:42:40.094221 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 09:42:42.773546 (Thread-1): SQL status: SUCCESS 1 in 2.68 seconds
2020-11-06 09:42:42.774047 (Thread-1): Using snowflake connection "model.cko_dbt_am.tbl_pageviews_history".
2020-11-06 09:42:42.774047 (Thread-1): On model.cko_dbt_am.tbl_pageviews_history: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.tbl_pageviews_history"} */


      create or replace transient table analytics.cko_dbt_am.tbl_pageviews_history  as
      (
with __dbt__CTE__pageviews_extract_ephemeral as (
/* Config line */


/*test query base on Snowflake sample data to represent Users_extract*/ 



SELECT 
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME") as pageview_date_hour
	,count ("URL") as count_pageviews
	,Count(Distinct "URL") as count_disctint_pageviews

FROM 
	"ANALYTICS"."CKO_DBT_AM"."PAGEVIEWS_EXTRACT"
Group By
	user_id
	,date_trunc('HOUR', "PAGEVIEW_DATETIME")
),  __dbt__CTE__users_extract_ephemeral as (

/*Create a ephemaral table that contains only active user in the current pageviews_extract*/
WITH active_user as (SELECT DISTINCT user_id FROM __dbt__CTE__pageviews_extract_ephemeral)

SELECT *
FROM "ANALYTICS"."CKO_DBT_AM"."USERS_EXTRACT"

WHERE id IN (SELECT user_id FROM active_user)
),  __dbt__CTE__pageviews_history_ephemeral as (



/*Add the current user postcode based on the filtered users list named "users_extract_ephemeral" */


SELECT 
	pageviews.*
	,customer_postcode -- Postcode of the user when generated
FROM  __dbt__CTE__pageviews_extract_ephemeral pageviews 
LEFT OUTER JOIN __dbt__CTE__users_extract_ephemeral users  on users.id=pageviews.user_id
)/*Add Data from pageviews_history_ephemeral in the table "tbl_pageviews_history" selecting only data where the timestamp is greater the the maximun timestamp availble in the table "tbl_pageviews_history" */
	SELECT * FROM __dbt__CTE__pageviews_history_ephemeral


      );
2020-11-06 09:42:52.251824 (Thread-1): SQL status: SUCCESS 1 in 9.48 seconds
2020-11-06 09:42:52.261838 (Thread-1): On model.cko_dbt_am.tbl_pageviews_history: COMMIT
2020-11-06 09:42:52.262840 (Thread-1): Using snowflake connection "model.cko_dbt_am.tbl_pageviews_history".
2020-11-06 09:42:52.263838 (Thread-1): On model.cko_dbt_am.tbl_pageviews_history: COMMIT
2020-11-06 09:42:52.452711 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2020-11-06 09:42:52.478215 (Thread-1): finished collecting timing info
2020-11-06 09:42:52.481215 (Thread-1): On model.cko_dbt_am.tbl_pageviews_history: Close
2020-11-06 09:42:52.736747 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f006fdbd-c479-425d-92d9-6181c9312d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F21B8FC2E0>]}
2020-11-06 09:42:52.746249 (Thread-1): 10:42:52 | 3 of 4 OK created incremental model cko_dbt_am.tbl_pageviews_history. [SUCCESS 1 in 13.07s]
2020-11-06 09:42:52.756249 (Thread-1): Finished running node model.cko_dbt_am.tbl_pageviews_history
2020-11-06 09:42:52.760749 (Thread-1): Began running node model.cko_dbt_am.view_pageviews_history_Latest_PostCode
2020-11-06 09:42:52.771252 (Thread-1): 10:42:52 | 4 of 4 START view model cko_dbt_am.view_pageviews_history_Latest_PostCode [RUN]
2020-11-06 09:42:52.791754 (Thread-1): Acquiring new snowflake connection "model.cko_dbt_am.view_pageviews_history_Latest_PostCode".
2020-11-06 09:42:52.792255 (Thread-1): Compiling model.cko_dbt_am.view_pageviews_history_Latest_PostCode
2020-11-06 09:42:52.918271 (Thread-1): Writing injected SQL for node "model.cko_dbt_am.view_pageviews_history_Latest_PostCode"
2020-11-06 09:42:52.925270 (Thread-1): finished collecting timing info
2020-11-06 09:42:53.227807 (Thread-1): Writing runtime SQL for node "model.cko_dbt_am.view_pageviews_history_Latest_PostCode"
2020-11-06 09:42:53.233809 (Thread-1): Using snowflake connection "model.cko_dbt_am.view_pageviews_history_Latest_PostCode".
2020-11-06 09:42:53.234309 (Thread-1): On model.cko_dbt_am.view_pageviews_history_Latest_PostCode: BEGIN
2020-11-06 09:42:53.234808 (Thread-1): Opening a new connection, currently in state closed
2020-11-06 09:42:54.498877 (Thread-1): unclosed <socket.socket fd=1592, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.5.101', 54236), raddr=('168.63.27.166', 443)>
2020-11-06 09:42:56.459453 (Thread-1): SQL status: SUCCESS 1 in 3.22 seconds
2020-11-06 09:42:56.460467 (Thread-1): Using snowflake connection "model.cko_dbt_am.view_pageviews_history_Latest_PostCode".
2020-11-06 09:42:56.460467 (Thread-1): On model.cko_dbt_am.view_pageviews_history_Latest_PostCode: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "cko_test_snowflake_db", "target_name": "dev", "node_id": "model.cko_dbt_am.view_pageviews_history_Latest_PostCode"} */

  create or replace  view analytics.cko_dbt_am.view_pageviews_history_Latest_PostCode  as (
    

SELECT 
	pageviews.* -- Pageviews contains our Table tbl_Pageviews_history
	,users.customer_postcode as Latest_Post_code -- Add the latest postcode stored in the the table "USERS_EXTRACT"
FROM  analytics.cko_dbt_am.tbl_pageviews_history pageviews
LEFT OUTER JOIN "ANALYTICS"."CKO_DBT_AM"."USERS_EXTRACT" users  on users.id=pageviews.user_id
  );
2020-11-06 09:42:57.409149 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2020-11-06 09:42:57.416650 (Thread-1): On model.cko_dbt_am.view_pageviews_history_Latest_PostCode: COMMIT
2020-11-06 09:42:57.417651 (Thread-1): Using snowflake connection "model.cko_dbt_am.view_pageviews_history_Latest_PostCode".
2020-11-06 09:42:57.418151 (Thread-1): On model.cko_dbt_am.view_pageviews_history_Latest_PostCode: COMMIT
2020-11-06 09:42:57.595673 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2020-11-06 09:42:57.721189 (Thread-1): finished collecting timing info
2020-11-06 09:42:57.726691 (Thread-1): On model.cko_dbt_am.view_pageviews_history_Latest_PostCode: Close
2020-11-06 09:42:58.733836 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f006fdbd-c479-425d-92d9-6181c9312d34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F21B987640>]}
2020-11-06 09:42:58.741837 (Thread-1): 10:42:58 | 4 of 4 OK created view model cko_dbt_am.view_pageviews_history_Latest_PostCode [SUCCESS 1 in 5.94s]
2020-11-06 09:42:58.764838 (Thread-1): Finished running node model.cko_dbt_am.view_pageviews_history_Latest_PostCode
2020-11-06 09:42:58.767840 (MainThread): Acquiring new snowflake connection "master".
2020-11-06 09:42:58.771349 (MainThread): Using snowflake connection "master".
2020-11-06 09:42:58.771850 (MainThread): On master: BEGIN
2020-11-06 09:42:58.771850 (MainThread): Opening a new connection, currently in state closed
2020-11-06 09:43:00.764393 (MainThread): SQL status: SUCCESS 1 in 1.99 seconds
2020-11-06 09:43:00.765393 (MainThread): On master: COMMIT
2020-11-06 09:43:00.765893 (MainThread): Using snowflake connection "master".
2020-11-06 09:43:00.765893 (MainThread): On master: COMMIT
2020-11-06 09:43:01.097155 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2020-11-06 09:43:01.098154 (MainThread): On master: Close
2020-11-06 09:43:01.626142 (MainThread): 10:43:01 | 
2020-11-06 09:43:01.627142 (MainThread): 10:43:01 | Finished running 2 table models, 1 incremental model, 1 view model in 70.01s.
2020-11-06 09:43:01.629126 (MainThread): Connection 'master' was properly closed.
2020-11-06 09:43:01.630143 (MainThread): Connection 'list_analytics' was properly closed.
2020-11-06 09:43:01.630143 (MainThread): Connection 'list_analytics_cko_dbt_am' was properly closed.
2020-11-06 09:43:01.631142 (MainThread): Connection 'model.cko_dbt_am.view_pageviews_history_Latest_PostCode' was properly closed.
2020-11-06 09:43:01.713678 (MainThread): 
2020-11-06 09:43:01.715680 (MainThread): Completed successfully
2020-11-06 09:43:01.718680 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-11-06 09:43:01.720679 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F21B8FC040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F21B8FCE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F21B8FC670>]}
2020-11-06 09:43:01.721679 (MainThread): Flushing usage events
